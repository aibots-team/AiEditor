"use strict";var gm=Object.defineProperty;var bm=(n,e,t)=>e in n?gm(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var N=(n,e,t)=>(bm(n,typeof e!="symbol"?e+"":e,t),t);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function ve(n){this.content=n}ve.prototype={constructor:ve,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,i=r.find(n),o=r.content.slice();return i==-1?o.push(t||n,e):(o[i+1]=e,t&&(o[i]=t)),new ve(o)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new ve(t)},addToStart:function(n,e){return new ve([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new ve(t)},addBefore:function(n,e,t){var r=this.remove(e),i=r.content.slice(),o=r.find(n);return i.splice(o==-1?i.length:o,0,e,t),new ve(i)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=ve.from(n),n.size?new ve(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=ve.from(n),n.size?new ve(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=ve.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};ve.from=function(n){if(n instanceof ve)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new ve(e)};function qh(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),o=e.child(r);if(i==o){t+=i.nodeSize;continue}if(!i.sameMarkup(o))return t;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)t++;return t}if(i.content.size||o.content.size){let s=qh(i.content,o.content,t+1);if(s!=null)return s}t+=i.nodeSize}}function jh(n,e,t,r){for(let i=n.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:t,b:r};let s=n.child(--i),a=e.child(--o),u=s.nodeSize;if(s==a){t-=u,r-=u;continue}if(!s.sameMarkup(a))return{a:t,b:r};if(s.isText&&s.text!=a.text){let l=0,c=Math.min(s.text.length,a.text.length);for(;l<c&&s.text[s.text.length-l-1]==a.text[a.text.length-l-1];)l++,t--,r--;return{a:t,b:r}}if(s.content.size||a.content.size){let l=jh(s.content,a.content,t-1,r-1);if(l)return l}t-=u,r-=u}}class _{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,o){for(let s=0,a=0;a<t;s++){let u=this.content[s],l=a+u.nodeSize;if(l>e&&r(u,i+a,o||null,s)!==!1&&u.content.size){let c=a+1;u.nodesBetween(Math.max(0,e-c),Math.min(u.content.size,t-c),r,i+c)}a=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let o="",s=!0;return this.nodesBetween(e,t,(a,u)=>{let l=a.isText?a.text.slice(Math.max(e,u)-u,t-u):a.isLeaf?i?typeof i=="function"?i(a):i:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&l||a.isTextblock)&&r&&(s?s=!1:o+=r),o+=l},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new _(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let o=0,s=0;s<t;o++){let a=this.content[o],u=s+a.nodeSize;u>e&&((s<e||u>t)&&(a.isText?a=a.cut(Math.max(0,e-s),Math.min(a.text.length,t-s)):a=a.cut(Math.max(0,e-s-1),Math.min(a.content.size,t-s-1))),r.push(a),i+=a.nodeSize),s=u}return new _(r,i)}cutByIndex(e,t){return e==t?_.empty:e==0&&t==this.content.length?this:new _(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),o=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new _(i,o)}addToStart(e){return new _([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new _(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return qh(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return jh(this,e,t,r)}findIndex(e,t=-1){if(e==0)return Yi(0,e);if(e==this.size)return Yi(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let o=this.child(r),s=i+o.nodeSize;if(s>=e)return s==e||t>0?Yi(r+1,s):Yi(r,i);i=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return _.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new _(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return _.empty;let t,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(t||(t=e.slice(0,i)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new _(t||e,r)}static from(e){if(!e)return _.empty;if(e instanceof _)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new _([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}_.empty=new _([],0);const ma={index:0,offset:0};function Yi(n,e){return ma.index=n,ma.offset=e,ma}function _o(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!_o(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!_o(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let Q=class ku{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(o)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&_o(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);return r.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return ku.none;if(e instanceof ku)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}};Q.none=[];class Mo extends Error{}class O{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=Wh(this.content,e+this.openStart,t);return r&&new O(r,this.openStart,this.openEnd)}removeBetween(e,t){return new O(Uh(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return O.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new O(_.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)i++;return new O(e,r,i)}}O.empty=new O(_.empty,0,0);function Uh(n,e,t){let{index:r,offset:i}=n.findIndex(e),o=n.maybeChild(r),{index:s,offset:a}=n.findIndex(t);if(i==e||o.isText){if(a!=t&&!n.child(s).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=s)throw new RangeError("Removing non-flat range");return n.replaceChild(r,o.copy(Uh(o.content,e-i-1,t-i-1)))}function Wh(n,e,t,r){let{index:i,offset:o}=n.findIndex(e),s=n.maybeChild(i);if(o==e||s.isText)return r&&!r.canReplace(i,i,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=Wh(s.content,e-o-1,t);return a&&n.replaceChild(i,s.copy(a))}function ym(n,e,t){if(t.openStart>n.depth)throw new Mo("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new Mo("Inconsistent open depths");return Zh(n,e,t,0)}function Zh(n,e,t,r){let i=n.index(r),o=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let s=Zh(n,e,t,r+1);return o.copy(o.content.replaceChild(i,s))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let s=n.parent,a=s.content;return Nn(s,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:s,end:a}=xm(t,n);return Nn(o,Gh(n,s,a,e,r))}else return Nn(o,To(n,e,r))}function Kh(n,e){if(!e.type.compatibleContent(n.type))throw new Mo("Cannot join "+e.type.name+" onto "+n.type.name)}function wu(n,e,t){let r=n.node(t);return Kh(r,e.node(t)),r}function Rn(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function Jr(n,e,t,r){let i=(e||n).node(t),o=0,s=e?e.index(t):i.childCount;n&&(o=n.index(t),n.depth>t?o++:n.textOffset&&(Rn(n.nodeAfter,r),o++));for(let a=o;a<s;a++)Rn(i.child(a),r);e&&e.depth==t&&e.textOffset&&Rn(e.nodeBefore,r)}function Nn(n,e){return n.type.checkContent(e),n.copy(e)}function Gh(n,e,t,r,i){let o=n.depth>i&&wu(n,e,i+1),s=r.depth>i&&wu(t,r,i+1),a=[];return Jr(null,n,i,a),o&&s&&e.index(i)==t.index(i)?(Kh(o,s),Rn(Nn(o,Gh(n,e,t,r,i+1)),a)):(o&&Rn(Nn(o,To(n,e,i+1)),a),Jr(e,t,i,a),s&&Rn(Nn(s,To(t,r,i+1)),a)),Jr(r,null,i,a),new _(a)}function To(n,e,t){let r=[];if(Jr(null,n,t,r),n.depth>t){let i=wu(n,e,t+1);Rn(Nn(i,To(n,e,t+1)),r)}return Jr(e,null,t,r),new _(r)}function xm(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let o=t-1;o>=0;o--)i=e.node(o).copy(_.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}class ai{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Q.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let a=r;r=i,i=a}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new Do(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,o=t;for(let s=e;;){let{index:a,offset:u}=s.content.findIndex(o),l=o-u;if(r.push(s,a,i+u),!l||(s=s.child(a),s.isText))break;o=l-1,i+=u+1}return new ai(t,r,o)}static resolveCached(e,t){for(let i=0;i<ga.length;i++){let o=ga[i];if(o.pos==t&&o.doc==e)return o}let r=ga[ba]=ai.resolve(e,t);return ba=(ba+1)%vm,r}}let ga=[],ba=0,vm=12;class Do{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const km=Object.create(null);let Hn=class Cu{constructor(e,t,r,i=Q.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||_.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&_o(this.attrs,t||e.defaultAttrs||km)&&Q.sameSet(this.marks,r||Q.none)}copy(e=null){return e==this.content?this:new Cu(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Cu(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return O.empty;let i=this.resolve(e),o=this.resolve(t),s=r?0:i.sharedDepth(t),a=i.start(s),l=i.node(s).content.cut(i.pos-a,o.pos-a);return new O(l,i.depth-s,o.depth-s)}replace(e,t,r){return ym(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return ai.resolveCached(this,e)}resolveNoCache(e){return ai.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Jh(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=_.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),a=s&&s.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let u=i;u<o;u++)if(!this.type.allowsMarks(r.child(u).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,t);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=Q.none;for(let t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!Q.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=_.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,i,r)}};Hn.prototype.text=void 0;class Lo extends Hn{constructor(e,t,r,i){if(super(e,t,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Jh(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Lo(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Lo(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Jh(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Bn{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new wm(e,t);if(r.next==null)return Bn.empty;let i=Yh(r);r.next&&r.err("Unexpected trailing text");let o=Tm(Mm(i));return Dm(o,r),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let i=this;for(let o=t;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let i=[this];function o(s,a){let u=s.matchFragment(e,r);if(u&&(!t||u.validEnd))return _.from(a.map(l=>l.createAndFill()));for(let l=0;l<s.next.length;l++){let{type:c,next:d}=s.next[l];if(!(c.isText||c.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let f=o(d,a.concat(c));if(f)return f}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let a=i;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:a,next:u}=o.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!i.type||u.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&t(r.next[i].next)}return t(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}}Bn.empty=new Bn(!0);class wm{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Yh(n){let e=[];do e.push(Cm(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function Cm(n){let e=[];do e.push(Sm(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function Sm(n){let e=_m(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=Em(n,e);else break;return e}function Cc(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function Em(n,e){let t=Cc(n),r=t;return n.eat(",")&&(n.next!="}"?r=Cc(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function Am(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let i=[];for(let o in t){let s=t[o];s.groups.indexOf(e)>-1&&i.push(s)}return i.length==0&&n.err("No node type or group '"+e+"' found"),i}function _m(n){if(n.eat("(")){let e=Yh(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=Am(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function Mm(n){let e=[[]];return i(o(n,0),t()),e;function t(){return e.push([])-1}function r(s,a,u){let l={term:u,to:a};return e[s].push(l),l}function i(s,a){s.forEach(u=>u.to=a)}function o(s,a){if(s.type=="choice")return s.exprs.reduce((u,l)=>u.concat(o(l,a)),[]);if(s.type=="seq")for(let u=0;;u++){let l=o(s.exprs[u],a);if(u==s.exprs.length-1)return l;i(l,a=t())}else if(s.type=="star"){let u=t();return r(a,u),i(o(s.expr,u),u),[r(u)]}else if(s.type=="plus"){let u=t();return i(o(s.expr,a),u),i(o(s.expr,u),u),[r(u)]}else{if(s.type=="opt")return[r(a)].concat(o(s.expr,a));if(s.type=="range"){let u=a;for(let l=0;l<s.min;l++){let c=t();i(o(s.expr,u),c),u=c}if(s.max==-1)i(o(s.expr,u),u);else for(let l=s.min;l<s.max;l++){let c=t();r(u,c),i(o(s.expr,u),c),u=c}return[r(u)]}else{if(s.type=="name")return[r(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function Xh(n,e){return e-n}function Sc(n,e){let t=[];return r(e),t.sort(Xh);function r(i){let o=n[i];if(o.length==1&&!o[0].term)return r(o[0].to);t.push(i);for(let s=0;s<o.length;s++){let{term:a,to:u}=o[s];!a&&t.indexOf(u)==-1&&r(u)}}}function Tm(n){let e=Object.create(null);return t(Sc(n,0));function t(r){let i=[];r.forEach(s=>{n[s].forEach(({term:a,to:u})=>{if(!a)return;let l;for(let c=0;c<i.length;c++)i[c][0]==a&&(l=i[c][1]);Sc(n,u).forEach(c=>{l||i.push([a,l=[]]),l.indexOf(c)==-1&&l.push(c)})})});let o=e[r.join(",")]=new Bn(r.indexOf(n.length-1)>-1);for(let s=0;s<i.length;s++){let a=i[s][1].sort(Xh);o.next.push({type:i[s][0],next:e[a.join(",")]||t(a)})}return o}}function Dm(n,e){for(let t=0,r=[n];t<r.length;t++){let i=r[t],o=!i.validEnd,s=[];for(let a=0;a<i.next.length;a++){let{type:u,next:l}=i.next[a];s.push(u.name),o&&!(u.isText||u.hasRequiredAttrs())&&(o=!1),r.indexOf(l)==-1&&r.push(l)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Qh(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function ep(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let o=n[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function tp(n){let e=Object.create(null);if(n)for(let t in n)e[t]=new Lm(n[t]);return e}let Ec=class np{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=tp(r.attrs),this.defaultAttrs=Qh(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Bn.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:ep(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Hn(this,this.computeAttrs(e),_.from(t),Q.setFrom(r))}createChecked(e=null,t,r){return t=_.from(t),this.checkContent(t),new Hn(this,this.computeAttrs(e),t,Q.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=_.from(t),t.size){let s=this.contentMatch.fillBefore(t);if(!s)return null;t=s.append(t)}let i=this.contentMatch.matchFragment(t),o=i&&i.fillBefore(_.empty,!0);return o?new Hn(this,e,t.append(o),Q.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:Q.none:e}static compile(e,t){let r=Object.create(null);e.forEach((o,s)=>r[o]=new np(o,t,s));let i=t.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};class Lm{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class Ls{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=tp(i.attrs),this.excluded=null;let o=Qh(this.attrs);this.instance=o?new Q(this,o):null}create(e=null){return!e&&this.instance?this.instance:new Q(this,ep(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new Ls(o,i++,t,s)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}}class rp{constructor(e){this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=ve.from(e.nodes),t.marks=ve.from(e.marks||{}),this.nodes=Ec.compile(this.spec.nodes,this),this.marks=Ls.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",a=o.spec.marks;o.contentMatch=r[s]||(r[s]=Bn.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet=a=="_"?null:a?Ac(this,a.split(" ")):a==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:Ac(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Ec){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,i)}text(e,t){let r=this.nodes.text;return new Lo(r,r.defaultAttrs,e,Q.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return Hn.fromJSON(this,e)}markFromJSON(e){return Q.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function Ac(n,e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],o=n.marks[i],s=o;if(o)t.push(o);else for(let a in n.marks){let u=n.marks[a];(i=="_"||u.spec.group&&u.spec.group.split(" ").indexOf(i)>-1)&&t.push(s=u)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}let Mi=class Su{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=e.nodes[r.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let r=new Mc(this,t,!1);return r.addAll(e,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new Mc(this,t,!0);return r.addAll(e,t.from,t.to),O.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(Nm(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,t,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],a=s.style;if(!(a.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(s.getAttrs){let u=s.getAttrs(t);if(u===!1)continue;s.attrs=u||void 0}return s}}}static schemaRules(e){let t=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<t.length;s++){let a=t[s];if((a.priority==null?50:a.priority)<o)break}t.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Tc(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Tc(s)),s.node||s.ignore||s.mark||(s.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Su(e,Su.schemaRules(e)))}};const ip={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Om={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},op={ol:!0,ul:!0},Oo=1,Ro=2,Yr=4;function _c(n,e,t){return e!=null?(e?Oo:0)|(e==="full"?Ro:0):n&&n.whitespace=="pre"?Oo|Ro:t&~Yr}class Xi{constructor(e,t,r,i,o,s,a){this.type=e,this.attrs=t,this.marks=r,this.pendingMarks=i,this.solid=o,this.options=a,this.content=[],this.activeMarks=Q.none,this.stashMarks=[],this.match=s||(a&Yr?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(_.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Oo)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let t=_.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(_.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,r=this.pendingMarks;t<r.length;t++){let i=r[t];(this.type?this.type.allowsMarkType(i.type):Im(i.type,e))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!ip.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Mc{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let i=t.topNode,o,s=_c(null,t.preserveWhitespace,0)|(r?Yr:0);i?o=new Xi(i.type,i.attrs,Q.none,Q.none,!0,t.topMatch||i.type.contentMatch,s):r?o=new Xi(null,null,Q.none,Q.none,!0,null,s):o=new Xi(e.schema.topNodeType,null,Q.none,Q.none,!0,null,s),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){e.nodeType==3?this.addTextNode(e):e.nodeType==1&&this.addElement(e)}withStyleRules(e,t){let r=e.getAttribute("style");if(!r)return t();let i=this.readStyles(Hm(r));if(!i)return;let[o,s]=i,a=this.top;for(let u=0;u<s.length;u++)this.removePendingMark(s[u],a);for(let u=0;u<o.length;u++)this.addPendingMark(o[u]);t();for(let u=0;u<o.length;u++)this.removePendingMark(o[u],a);for(let u=0;u<s.length;u++)this.addPendingMark(s[u])}addTextNode(e){let t=e.nodeValue,r=this.top;if(r.options&Ro||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(r.options&Oo)r.options&Ro?t=t.replace(/\r\n?/g,`
`):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let i=r.content[r.content.length-1],o=e.previousSibling;(!i||o&&o.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let r=e.nodeName.toLowerCase(),i;op.hasOwnProperty(r)&&this.parser.normalizeLists&&Rm(e);let o=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,t));if(o?o.ignore:Om.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(e=o.skip);let s,a=this.top,u=this.needsBlock;if(ip.hasOwnProperty(r))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),s=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}o&&o.skip?this.addAll(e):this.withStyleRules(e,()=>this.addAll(e)),s&&this.sync(a),this.needsBlock=u}else this.withStyleRules(e,()=>{this.addElementByRule(e,o,o.consuming===!1?i:void 0)})}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=Q.none,r=Q.none;for(let i=0;i<e.length;i+=2)for(let o=void 0;;){let s=this.parser.matchStyle(e[i],e[i+1],this,o);if(!s)break;if(s.ignore)return null;if(s.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(a=>{s.clearMark(a)&&(r=a.addToSet(r))}):t=this.parser.schema.marks[s.mark].create(s.attrs).addToSet(t),s.consuming===!1)o=s;else break}return[t,r]}addElementByRule(e,t,r){let i,o,s;t.node?(o=this.parser.schema.nodes[t.node],o.isLeaf?this.insertNode(o.create(t.attrs))||this.leafFallback(e):i=this.enter(o,t.attrs||null,t.preserveWhitespace)):(s=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(s));let a=this.top;if(o&&o.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(u=>this.insertNode(u));else{let u=e;typeof t.contentElement=="string"?u=e.querySelector(t.contentElement):typeof t.contentElement=="function"?u=t.contentElement(e):t.contentElement&&(u=t.contentElement),this.findAround(e,u,!0),this.addAll(u)}i&&this.sync(a)&&this.open--,s&&this.removePendingMark(s,a)}addAll(e,t,r){let i=t||0;for(let o=t?e.childNodes[t]:e.firstChild,s=r==null?null:e.childNodes[r];o!=s;o=o.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(o);this.findAtPoint(e,i)}findPlace(e){let t,r;for(let i=this.open;i>=0;i--){let o=this.nodes[i],s=o.findWrapping(e);if(s&&(!t||t.length>s.length)&&(t=s,r=o,!s.length)||o.solid)break}if(!t)return!1;this.sync(r);for(let i=0;i<t.length;i++)this.enterInner(t[i],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let r=t.activeMarks;for(let i=0;i<e.marks.length;i++)(!t.type||t.type.allowsMarkType(e.marks[i].type))&&(r=e.marks[i].addToSet(r));return t.content.push(e.mark(r)),!0}return!1}enter(e,t,r){let i=this.findPlace(e.create(t));return i&&this.enterInner(e,t,!0,r),i}enterInner(e,t=null,r=!1,i){this.closeExtra();let o=this.top;o.applyPending(e),o.match=o.match&&o.match.matchType(e);let s=_c(e,i,o.options);o.options&Yr&&o.content.length==0&&(s|=Yr),this.nodes.push(new Xi(e,t,o.activeMarks,o.pendingMarks,r,null,s)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(a,u)=>{for(;a>=0;a--){let l=t[a];if(l==""){if(a==t.length-1||a==0)continue;for(;u>=o;u--)if(s(a-1,u))return!0;return!1}else{let c=u>0||u==0&&i?this.nodes[u].type:r&&u>=o?r.node(u-o).type:null;if(!c||c.name!=l&&c.groups.indexOf(l)==-1)return!1;u--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let t=Fm(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let r=this.open;r>=0;r--){let i=this.nodes[r];if(i.pendingMarks.lastIndexOf(e)>-1)i.pendingMarks=e.removeFromSet(i.pendingMarks);else{i.activeMarks=e.removeFromSet(i.activeMarks);let s=i.popFromStashMark(e);s&&i.type&&i.type.allowsMarkType(s.type)&&(i.activeMarks=s.addToSet(i.activeMarks))}if(i==t)break}}}function Rm(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&op.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function Nm(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function Hm(n){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,t,r=[];for(;t=e.exec(n);)r.push(t[1],t[2].trim());return r}function Tc(n){let e={};for(let t in n)e[t]=n[t];return e}function Im(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let o=[],s=a=>{o.push(a);for(let u=0;u<a.edgeCount;u++){let{type:l,next:c}=a.edge(u);if(l==e||o.indexOf(c)<0&&s(c))return!0}};if(s(i.contentMatch))return!0}}function Fm(n,e){for(let t=0;t<e.length;t++)if(n.eq(e[t]))return e[t]}class xt{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=ya(t).createDocumentFragment());let i=r,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let a=0,u=0;for(;a<o.length&&u<s.marks.length;){let l=s.marks[u];if(!this.marks[l.type.name]){u++;continue}if(!l.eq(o[a][0])||l.type.spec.spanning===!1)break;a++,u++}for(;a<o.length;)i=o.pop()[1];for(;u<s.marks.length;){let l=s.marks[u++],c=this.serializeMark(l,s.isInline,t);c&&(o.push([l,i]),i.appendChild(c.dom),i=c.contentDOM||c.dom)}}i.appendChild(this.serializeNodeInner(s,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=xt.renderSpec(ya(t),this.nodes[e.type.name](e));if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&xt.renderSpec(ya(r),i(e,t))}static renderSpec(e,t,r=null){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let i=t[0],o=i.indexOf(" ");o>0&&(r=i.slice(0,o),i=i.slice(o+1));let s,a=r?e.createElementNS(r,i):e.createElement(i),u=t[1],l=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){l=2;for(let c in u)if(u[c]!=null){let d=c.indexOf(" ");d>0?a.setAttributeNS(c.slice(0,d),c.slice(d+1),u[c]):a.setAttribute(c,u[c])}}for(let c=l;c<t.length;c++){let d=t[c];if(d===0){if(c<t.length-1||c>l)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:f,contentDOM:h}=xt.renderSpec(e,d,r);if(a.appendChild(f),h){if(s)throw new RangeError("Multiple content holes");s=h}}}return{dom:a,contentDOM:s}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new xt(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Dc(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return Dc(e.marks)}}function Dc(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function ya(n){return n.document||window.document}const sp=65535,ap=Math.pow(2,16);function Pm(n,e){return n+e*ap}function Lc(n){return n&sp}function Bm(n){return(n-(n&sp))/ap}const up=1,lp=2,xo=4,cp=8;class Eu{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&cp)>0}get deletedBefore(){return(this.delInfo&(up|xo))>0}get deletedAfter(){return(this.delInfo&(lp|xo))>0}get deletedAcross(){return(this.delInfo&xo)>0}}class $e{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&$e.empty)return $e.empty}recover(e){let t=0,r=Lc(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+Bm(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let u=this.ranges[a]-(this.inverted?i:0);if(u>e)break;let l=this.ranges[a+o],c=this.ranges[a+s],d=u+l;if(e<=d){let f=l?e==u?-1:e==d?1:t:t,h=u+i+(f<0?0:c);if(r)return h;let p=e==(t<0?u:d)?null:Pm(a/3,e-u),m=e==u?lp:e==d?up:xo;return(t<0?e!=u:e!=d)&&(m|=cp),new Eu(h,m,p)}i+=c-l}return r?e+i:new Eu(e+i,0,null)}touches(e,t){let r=0,i=Lc(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let u=this.ranges[a]-(this.inverted?r:0);if(u>e)break;let l=this.ranges[a+o],c=u+l;if(e<=c&&a==i*3)return!0;r+=this.ranges[a+s]-l}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],a=s-(this.inverted?o:0),u=s+(this.inverted?0:o),l=this.ranges[i+t],c=this.ranges[i+r];e(a,a+l,u,u+c),o+=c-l}}invert(){return new $e(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?$e.empty:new $e(e<0?[0,-e,0]:[0,0,e])}}$e.empty=new $e([]);class fr{constructor(e=[],t,r=0,i=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=i}slice(e=0,t=this.maps.length){return new fr(this.maps,this.mirror,e,t)}copy(){return new fr(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new fr;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this.maps[o],a=s.mapResult(e,t);if(a.recover!=null){let u=this.getMirror(o);if(u!=null&&u>o&&u<this.to){o=u,e=this.maps[u].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new Eu(e,i,null)}}const xa=Object.create(null);class Me{getMap(){return $e.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=xa[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in xa)throw new RangeError("Duplicate use of step JSON ID "+e);return xa[e]=t,t.prototype.jsonID=e,t}}class fe{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new fe(e,null)}static fail(e){return new fe(null,e)}static fromReplace(e,t,r,i){try{return fe.ok(e.replace(t,r,i))}catch(o){if(o instanceof Mo)return fe.fail(o.message);throw o}}}function fl(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(fl(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return _.fromArray(r)}class an extends Me{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new O(fl(t.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return fe.fromReplace(e,this.from,this.to,o)}invert(){return new vt(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new an(t.pos,r.pos,this.mark)}merge(e){return e instanceof an&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new an(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new an(t.from,t.to,e.markFromJSON(t.mark))}}Me.jsonID("addMark",an);class vt extends Me{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new O(fl(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return fe.fromReplace(e,this.from,this.to,r)}invert(){return new an(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new vt(t.pos,r.pos,this.mark)}merge(e){return e instanceof vt&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new vt(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new vt(t.from,t.to,e.markFromJSON(t.mark))}}Me.jsonID("removeMark",vt);class un extends Me{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return fe.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return fe.fromReplace(e,this.pos,this.pos+1,new O(_.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new un(this.pos,t.marks[i]);return new un(this.pos,this.mark)}}return new yr(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new un(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new un(t.pos,e.markFromJSON(t.mark))}}Me.jsonID("addNodeMark",un);class yr extends Me{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return fe.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return fe.fromReplace(e,this.pos,this.pos+1,new O(_.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new un(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new yr(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new yr(t.pos,e.markFromJSON(t.mark))}}Me.jsonID("removeNodeMark",yr);class ke extends Me{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Au(e,this.from,this.to)?fe.fail("Structure replace would overwrite content"):fe.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new $e([this.from,this.to-this.from,this.slice.size])}invert(e){return new ke(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new ke(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof ke)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?O.empty:new O(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new ke(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?O.empty:new O(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new ke(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ke(t.from,t.to,O.fromJSON(e,t.slice),!!t.structure)}}Me.jsonID("replace",ke);class be extends Me{constructor(e,t,r,i,o,s,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=a}apply(e){if(this.structure&&(Au(e,this.from,this.gapFrom)||Au(e,this.gapTo,this.to)))return fe.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return fe.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?fe.fromReplace(e,this.from,this.to,r):fe.fail("Content does not fit in gap")}getMap(){return new $e([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new be(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new be(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new be(t.from,t.to,t.gapFrom,t.gapTo,O.fromJSON(e,t.slice),t.insert,!!t.structure)}}Me.jsonID("replaceAround",be);function Au(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function $m(n,e,t,r){let i=[],o=[],s,a;n.doc.nodesBetween(e,t,(u,l,c)=>{if(!u.isInline)return;let d=u.marks;if(!r.isInSet(d)&&c.type.allowsMarkType(r.type)){let f=Math.max(l,e),h=Math.min(l+u.nodeSize,t),p=r.addToSet(d);for(let m=0;m<d.length;m++)d[m].isInSet(p)||(s&&s.to==f&&s.mark.eq(d[m])?s.to=h:i.push(s=new vt(f,h,d[m])));a&&a.to==f?a.to=h:o.push(a=new an(f,h,r))}}),i.forEach(u=>n.step(u)),o.forEach(u=>n.step(u))}function zm(n,e,t,r){let i=[],o=0;n.doc.nodesBetween(e,t,(s,a)=>{if(!s.isInline)return;o++;let u=null;if(r instanceof Ls){let l=s.marks,c;for(;c=r.isInSet(l);)(u||(u=[])).push(c),l=c.removeFromSet(l)}else r?r.isInSet(s.marks)&&(u=[r]):u=s.marks;if(u&&u.length){let l=Math.min(a+s.nodeSize,t);for(let c=0;c<u.length;c++){let d=u[c],f;for(let h=0;h<i.length;h++){let p=i[h];p.step==o-1&&d.eq(i[h].style)&&(f=p)}f?(f.to=l,f.step=o):i.push({style:d,from:Math.max(a,e),to:l,step:o})}}}),i.forEach(s=>n.step(new vt(s.from,s.to,s.style)))}function Vm(n,e,t,r=t.contentMatch){let i=n.doc.nodeAt(e),o=[],s=e+1;for(let a=0;a<i.childCount;a++){let u=i.child(a),l=s+u.nodeSize,c=r.matchType(u.type);if(!c)o.push(new ke(s,l,O.empty));else{r=c;for(let d=0;d<u.marks.length;d++)t.allowsMarkType(u.marks[d].type)||n.step(new vt(s,l,u.marks[d]));if(u.isText&&!t.spec.code){let d,f=/\r?\n|\r/g,h;for(;d=f.exec(u.text);)h||(h=new O(_.from(t.schema.text(" ",t.allowedMarks(u.marks))),0,0)),o.push(new ke(s+d.index,s+d.index+d[0].length,h))}}s=l}if(!r.validEnd){let a=r.fillBefore(_.empty,!0);n.replace(s,s,new O(a,0,0))}for(let a=o.length-1;a>=0;a--)n.step(o[a])}function qm(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function Mr(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),o=n.$from.index(r),s=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(o,s,t))return r;if(r==0||i.type.spec.isolating||!qm(i,o,s))break}return null}function jm(n,e,t){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),a=i.after(o+1),u=s,l=a,c=_.empty,d=0;for(let p=o,m=!1;p>t;p--)m||r.index(p)>0?(m=!0,c=_.from(r.node(p).copy(c)),d++):u--;let f=_.empty,h=0;for(let p=o,m=!1;p>t;p--)m||i.after(p+1)<i.end(p)?(m=!0,f=_.from(i.node(p).copy(f)),h++):l++;n.step(new be(u,l,s,a,new O(c.append(f),d,h),c.size-d,!0))}function hl(n,e,t=null,r=n){let i=Um(n,e),o=i&&Wm(r,e);return o?i.map(Oc).concat({type:e,attrs:t}).concat(o.map(Oc)):null}function Oc(n){return{type:n,attrs:null}}function Um(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return t.canReplaceWith(r,i,s)?o:null}function Wm(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let u=(s.length?s[s.length-1]:e).contentMatch;for(let l=r;u&&l<i;l++)u=u.matchType(t.child(l).type);return!u||!u.validEnd?null:s}function Zm(n,e,t){let r=_.empty;for(let s=t.length-1;s>=0;s--){if(r.size){let a=t[s].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=_.from(t[s].type.create(t[s].attrs,r))}let i=e.start,o=e.end;n.step(new be(i,o,i,o,new O(r,0,0),t.length,!0))}function Km(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=n.steps.length;n.doc.nodesBetween(e,t,(s,a)=>{if(s.isTextblock&&!s.hasMarkup(r,i)&&Gm(n.doc,n.mapping.slice(o).map(a),r)){n.clearIncompatible(n.mapping.slice(o).map(a,1),r);let u=n.mapping.slice(o),l=u.map(a,1),c=u.map(a+s.nodeSize,1);return n.step(new be(l,c,l+1,c-1,new O(_.from(r.create(i,null,s.marks)),0,0),1,!0)),!1}})}function Gm(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function Jm(n,e,t,r,i){let o=n.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);let s=t.create(r,null,i||o.marks);if(o.isLeaf)return n.replaceWith(e,e+o.nodeSize,s);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new be(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new O(_.from(s),0,0),1,!0))}function hr(n,e,t=1,r){let i=n.resolve(e),o=i.depth-t,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let l=i.depth-1,c=t-2;l>o;l--,c--){let d=i.node(l),f=i.index(l);if(d.type.spec.isolating)return!1;let h=d.content.cutByIndex(f,d.childCount),p=r&&r[c+1];p&&(h=h.replaceChild(0,p.type.create(p.attrs)));let m=r&&r[c]||d;if(!d.canReplace(f+1,d.childCount)||!m.type.validContent(h))return!1}let a=i.indexAfter(o),u=r&&r[0];return i.node(o).canReplaceWith(a,a,u?u.type:i.node(o+1).type)}function Ym(n,e,t=1,r){let i=n.doc.resolve(e),o=_.empty,s=_.empty;for(let a=i.depth,u=i.depth-t,l=t-1;a>u;a--,l--){o=_.from(i.node(a).copy(o));let c=r&&r[l];s=_.from(c?c.type.create(c.attrs,s):i.node(a).copy(s))}n.step(new ke(e,e,new O(o.append(s),t,t),!0))}function xn(n,e){let t=n.resolve(e),r=t.index();return dp(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function dp(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}function Os(n,e,t=-1){let r=n.resolve(e);for(let i=r.depth;;i--){let o,s,a=r.index(i);if(i==r.depth?(o=r.nodeBefore,s=r.nodeAfter):t>0?(o=r.node(i+1),a++,s=r.node(i).maybeChild(a)):(o=r.node(i).maybeChild(a-1),s=r.node(i+1)),o&&!o.isTextblock&&dp(o,s)&&r.node(i).canReplace(a,a+1))return e;if(i==0)break;e=t<0?r.before(i):r.after(i)}}function Xm(n,e,t){let r=new ke(e-t,e+t,O.empty,!0);n.step(r)}function Qm(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,t))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,t))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function fp(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let o=0;o<t.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(t.openStart==0&&t.size?2:1);o++)for(let s=r.depth;s>=0;s--){let a=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,u=r.index(s)+(a>0?1:0),l=r.node(s),c=!1;if(o==1)c=l.canReplace(u,u,i);else{let d=l.contentMatchAt(u).findWrapping(i.firstChild.type);c=d&&l.canReplaceWith(u,u,d[0])}if(c)return a==0?r.pos:a<0?r.before(s+1):r.after(s+1)}return null}function pl(n,e,t=e,r=O.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return hp(i,o,r)?new ke(e,t,r):new eg(i,o,r).fit()}function hp(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class eg{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=_.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=_.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let l=this.findFittable();l?this.placeNodes(l):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,a=i.depth;for(;s&&a&&o.childCount==1;)o=o.firstChild.content,s--,a--;let u=new O(o,s,a);return e>-1?new be(r.pos,e,this.$to.pos,this.$to.end(),u,t):u.size||r.pos!=this.$to.pos?new ke(r.pos,i.pos,u):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=va(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:u,match:l}=this.frontier[a],c,d=null;if(t==1&&(s?l.matchType(s.type)||(d=l.fillBefore(_.from(s),!1)):o&&u.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:a,parent:o,inject:d};if(t==2&&s&&(c=l.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:a,parent:o,wrap:c};if(o&&l.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=va(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new O(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=va(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new O(Zr(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new O(Zr(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let m=0;m<o.length;m++)this.openFrontierNode(o[m]);let s=this.unplaced,a=r?r.content:s.content,u=s.openStart-e,l=0,c=[],{match:d,type:f}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)c.push(i.child(m));d=d.matchFragment(i)}let h=a.size+e-(s.content.size-s.openEnd);for(;l<a.childCount;){let m=a.child(l),g=d.matchType(m.type);if(!g)break;l++,(l>1||u==0||m.content.size)&&(d=g,c.push(pp(m.mark(f.allowedMarks(m.marks)),l==1?u:0,l==a.childCount?h:-1)))}let p=l==a.childCount;p||(h=-1),this.placed=Kr(this.placed,t,_.from(c)),this.frontier[t].match=d,p&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=a;m<h;m++){let y=g.lastChild;this.frontier.push({type:y.type,match:y.contentMatchAt(y.childCount)}),g=y.content}this.unplaced=p?e==0?O.empty:new O(Zr(s.content,e-1,1),e-1,h<0?s.openEnd:e-1):new O(Zr(s.content,e,l),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!ka(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=ka(e,t,i,r,o);if(s){for(let a=t-1;a>=0;a--){let{match:u,type:l}=this.frontier[a],c=ka(e,a,l,u,!0);if(!c||c.childCount)continue e}return{depth:t,fit:s,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Kr(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Kr(this.placed,this.depth,_.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(_.empty,!0);t.childCount&&(this.placed=Kr(this.placed,this.frontier.length,t))}}function Zr(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Zr(n.firstChild.content,e-1,t)))}function Kr(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Kr(n.lastChild.content,e-1,t)))}function va(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function pp(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,pp(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(_.empty,!0)))),n.copy(r)}function ka(n,e,t,r,i){let o=n.node(e),s=i?n.indexAfter(e):n.index(e);if(s==o.childCount&&!t.compatibleContent(o.type))return null;let a=r.fillBefore(o.content,!0,s);return a&&!tg(t,o.content,s)?a:null}function tg(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function ng(n){return n.spec.defining||n.spec.definingForContent}function rg(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),o=n.doc.resolve(t);if(hp(i,o,r))return n.step(new ke(e,t,r));let s=gp(i,n.doc.resolve(t));s[s.length-1]==0&&s.pop();let a=-(i.depth+1);s.unshift(a);for(let f=i.depth,h=i.pos-1;f>0;f--,h--){let p=i.node(f).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;s.indexOf(f)>-1?a=f:i.before(f)==h&&s.splice(1,0,-f)}let u=s.indexOf(a),l=[],c=r.openStart;for(let f=r.content,h=0;;h++){let p=f.firstChild;if(l.push(p),h==r.openStart)break;f=p.content}for(let f=c-1;f>=0;f--){let h=l[f],p=ng(h.type);if(p&&!h.sameMarkup(i.node(Math.abs(a)-1)))c=f;else if(p||!h.type.isTextblock)break}for(let f=r.openStart;f>=0;f--){let h=(f+c+1)%(r.openStart+1),p=l[h];if(p)for(let m=0;m<s.length;m++){let g=s[(m+u)%s.length],y=!0;g<0&&(y=!1,g=-g);let x=i.node(g-1),v=i.index(g-1);if(x.canReplaceWith(v,v,p.type,p.marks))return n.replace(i.before(g),y?o.after(g):t,new O(mp(r.content,0,r.openStart,h),h,r.openEnd))}}let d=n.steps.length;for(let f=s.length-1;f>=0&&(n.replace(e,t,r),!(n.steps.length>d));f--){let h=s[f];h<0||(e=i.before(h),t=o.after(h))}}function mp(n,e,t,r,i){if(e<t){let o=n.firstChild;n=n.replaceChild(0,o.copy(mp(o.content,e+1,t,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(n).append(n);n=s.append(o.matchFragment(s).fillBefore(_.empty,!0))}return n}function ig(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=Qm(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new O(_.from(r),0,0))}function og(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),o=gp(r,i);for(let s=0;s<o.length;s++){let a=o[s],u=s==o.length-1;if(u&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),i.end(a));if(a>0&&(u||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return n.delete(r.before(a),i.after(a))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&t>r.end(s)&&i.end(s)-t!=i.depth-s)return n.delete(r.before(s),t);n.delete(e,t)}function gp(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let o=n.start(i);if(o<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&t.push(i)}return t}class pr extends Me{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return fe.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return fe.fromReplace(e,this.pos,this.pos+1,new O(_.from(i),0,t.isLeaf?0:1))}getMap(){return $e.empty}invert(e){return new pr(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new pr(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new pr(t.pos,t.attr,t.value)}}Me.jsonID("attr",pr);class ui extends Me{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return fe.ok(r)}getMap(){return $e.empty}invert(e){return new ui(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new ui(t.attr,t.value)}}Me.jsonID("docAttr",ui);let xr=class extends Error{};xr=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};xr.prototype=Object.create(Error.prototype);xr.prototype.constructor=xr;xr.prototype.name="TransformError";class ml{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new fr}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new xr(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=O.empty){let i=pl(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new O(_.from(r),0,0))}delete(e,t){return this.replace(e,t,O.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return rg(this,e,t,r),this}replaceRangeWith(e,t,r){return ig(this,e,t,r),this}deleteRange(e,t){return og(this,e,t),this}lift(e,t){return jm(this,e,t),this}join(e,t=1){return Xm(this,e,t),this}wrap(e,t){return Zm(this,e,t),this}setBlockType(e,t=e,r,i=null){return Km(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return Jm(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new pr(e,t,r)),this}setDocAttribute(e,t){return this.step(new ui(e,t)),this}addNodeMark(e,t){return this.step(new un(e,t)),this}removeNodeMark(e,t){if(!(t instanceof Q)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new yr(e,t)),this}split(e,t=1,r){return Ym(this,e,t,r),this}addMark(e,t,r){return $m(this,e,t,r),this}removeMark(e,t,r){return zm(this,e,t,r),this}clearIncompatible(e,t,r){return Vm(this,e,t,r),this}}const wa=Object.create(null);class z{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new bp(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=O.empty){let r=t.content.lastChild,i=null;for(let a=0;a<t.openEnd;a++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:u,$to:l}=s[a],c=e.mapping.slice(o);e.replaceRange(c.map(u.pos),c.map(l.pos),a?O.empty:t),a==0&&Hc(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:a}=i[o],u=e.mapping.slice(r),l=u.map(s.pos),c=u.map(a.pos);o?e.deleteRange(l,c):(e.replaceRangeWith(l,c,t),Hc(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new B(e):sr(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=t<0?sr(e.node(0),e.node(o),e.before(o+1),e.index(o),t,r):sr(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,r);if(s)return s}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Je(e.node(0))}static atStart(e){return sr(e,e,0,0,1)||new Je(e)}static atEnd(e){return sr(e,e,e.content.size,e.childCount,-1)||new Je(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=wa[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in wa)throw new RangeError("Duplicate use of selection JSON ID "+e);return wa[e]=t,t.prototype.jsonID=e,t}getBookmark(){return B.between(this.$anchor,this.$head).getBookmark()}}z.prototype.visible=!0;class bp{constructor(e,t){this.$from=e,this.$to=t}}let Rc=!1;function Nc(n){!Rc&&!n.parent.inlineContent&&(Rc=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class B extends z{constructor(e,t=e){Nc(e),Nc(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return z.near(r);let i=e.resolve(t.map(this.anchor));return new B(i.parent.inlineContent?i:r,r)}replace(e,t=O.empty){if(super.replace(e,t),t==O.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof B&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Rs(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new B(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let o=z.findFrom(t,r,!0)||z.findFrom(t,-r,!0);if(o)t=o.$head;else return z.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(z.findFrom(e,-r,!0)||z.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new B(e,t)}}z.jsonID("text",B);class Rs{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Rs(e.map(this.anchor),e.map(this.head))}resolve(e){return B.between(e.resolve(this.anchor),e.resolve(this.head))}}class $ extends z{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),o=e.resolve(i);return r?z.near(o):new $(o)}content(){return new O(_.from(this.node),0,0)}eq(e){return e instanceof $&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new gl(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new $(e.resolve(t.anchor))}static create(e,t){return new $(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}$.prototype.visible=!1;z.jsonID("node",$);class gl{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new Rs(r,r):new gl(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&$.isSelectable(r)?new $(t):z.near(t)}}class Je extends z{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=O.empty){if(t==O.empty){e.delete(0,e.doc.content.size);let r=z.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Je(e)}map(e){return new Je(e)}eq(e){return e instanceof Je}getBookmark(){return sg}}z.jsonID("all",Je);const sg={map(){return this},resolve(n){return new Je(n)}};function sr(n,e,t,r,i,o=!1){if(e.inlineContent)return B.create(n,t);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let a=e.child(s);if(a.isAtom){if(!o&&$.isSelectable(a))return $.create(n,t-(i<0?a.nodeSize:0))}else{let u=sr(n,a,t+i,i<0?a.childCount:0,i,o);if(u)return u}t+=a.nodeSize*i}return null}function Hc(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof ke||i instanceof be))return;let o=n.mapping.maps[r],s;o.forEach((a,u,l,c)=>{s==null&&(s=c)}),n.setSelection(z.near(n.doc.resolve(s),t))}const Ic=1,Qi=2,Fc=4;class ag extends ml{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Ic)&~Qi,this.storedMarks=null,this}get selectionSet(){return(this.updated&Ic)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Qi,this}ensureMarks(e){return Q.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Qi)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~Qi,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Q.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let i=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(t);o=r==t?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,i.text(e,o)),this.selection.empty||this.setSelection(z.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Fc,this}get scrolledIntoView(){return(this.updated&Fc)>0}}function Pc(n,e){return!e||!n?n:n.bind(e)}class Gr{constructor(e,t,r){this.name=e,this.init=Pc(t.init,r),this.apply=Pc(t.apply,r)}}const ug=[new Gr("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Gr("selection",{init(n,e){return n.selection||z.atStart(e.doc)},apply(n){return n.selection}}),new Gr("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Gr("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class Ca{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=ug.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Gr(r.key,r.spec.state,r))})}}class cr{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let u=i?i[s].n:0,l=i?i[s].state:this,c=u<t.length&&a.spec.appendTransaction.call(a,u?t.slice(u):t,l,r);if(c&&r.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<s?{state:r,n:t.length}:{state:this,n:0})}t.push(c),r=r.applyInner(c),o=!0}i&&(i[s]={state:r,n:t.length})}}if(!o)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new cr(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new ag(this)}static create(e){let t=new Ca(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new cr(t);for(let i=0;i<t.fields.length;i++)r[t.fields[i].name]=t.fields[i].init(e,r);return r}reconfigure(e){let t=new Ca(this.schema,e.plugins),r=t.fields,i=new cr(t);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(t[r]=o.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Ca(e.schema,e.plugins),o=new cr(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=Hn.fromJSON(e.schema,t.doc);else if(s.name=="selection")o.selection=z.fromJSON(o.doc,t.selection);else if(s.name=="storedMarks")t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let u=r[a],l=u.spec.state;if(u.key==s.name&&l&&l.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){o[s.name]=l.fromJSON.call(u,e,t[a],o);return}}o[s.name]=s.init(e,o)}}),o}}function yp(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=yp(i,e,{})),t[r]=i}return t}class oe{constructor(e){this.spec=e,this.props={},e.props&&yp(e.props,this,this.props),this.key=e.key?e.key.key:xp("plugin")}getState(e){return e[this.key]}}const Sa=Object.create(null);function xp(n){return n in Sa?n+"$"+ ++Sa[n]:(Sa[n]=0,n+"$")}class ae{constructor(e="key"){this.key=xp(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Le=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},li=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let Bc=null;const Vt=function(n,e,t){let r=Bc||(Bc=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},$n=function(n,e,t,r){return t&&($c(n,e,t,r,-1)||$c(n,e,t,r,1))},lg=/^(img|br|input|textarea|hr)$/i;function $c(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:yt(n))){let o=n.parentNode;if(!o||o.nodeType!=1||bl(n)||lg.test(n.nodeName)||n.contentEditable=="false")return!1;e=Le(n)+(i<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?yt(n):0}else return!1}}function yt(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function cg(n,e,t){for(let r=e==0,i=e==yt(n);r||i;){if(n==t)return!0;let o=Le(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,i=i&&o==yt(n)}}function bl(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Ns=function(n){return n.focusNode&&$n(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function Mn(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function dg(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function fg(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:r.offset}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:r.startOffset}}}const _t=typeof navigator<"u"?navigator:null,zc=typeof document<"u"?document:null,vn=_t&&_t.userAgent||"",_u=/Edge\/(\d+)/.exec(vn),vp=/MSIE \d/.exec(vn),Mu=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(vn),Ie=!!(vp||Mu||_u),fn=vp?document.documentMode:Mu?+Mu[1]:_u?+_u[1]:0,at=!Ie&&/gecko\/(\d+)/i.test(vn);at&&+(/Firefox\/(\d+)/.exec(vn)||[0,0])[1];const Tu=!Ie&&/Chrome\/(\d+)/.exec(vn),Ee=!!Tu,hg=Tu?+Tu[1]:0,Oe=!Ie&&!!_t&&/Apple Computer/.test(_t.vendor),vr=Oe&&(/Mobile\/\w+/.test(vn)||!!_t&&_t.maxTouchPoints>2),Ke=vr||(_t?/Mac/.test(_t.platform):!1),pg=_t?/Win/.test(_t.platform):!1,ot=/Android \d/.test(vn),Ti=!!zc&&"webkitFontSmoothing"in zc.documentElement.style,mg=Ti?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function gg(n){return{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Bt(n,e){return typeof n=="number"?n:n[e]}function bg(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function Vc(n,e,t){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,o=n.dom.ownerDocument;for(let s=t||n.dom;s;s=li(s)){if(s.nodeType!=1)continue;let a=s,u=a==o.body,l=u?gg(o):bg(a),c=0,d=0;if(e.top<l.top+Bt(r,"top")?d=-(l.top-e.top+Bt(i,"top")):e.bottom>l.bottom-Bt(r,"bottom")&&(d=e.bottom-e.top>l.bottom-l.top?e.top+Bt(i,"top")-l.top:e.bottom-l.bottom+Bt(i,"bottom")),e.left<l.left+Bt(r,"left")?c=-(l.left-e.left+Bt(i,"left")):e.right>l.right-Bt(r,"right")&&(c=e.right-l.right+Bt(i,"right")),c||d)if(u)o.defaultView.scrollBy(c,d);else{let f=a.scrollLeft,h=a.scrollTop;d&&(a.scrollTop+=d),c&&(a.scrollLeft+=c);let p=a.scrollLeft-f,m=a.scrollTop-h;e={left:e.left-p,top:e.top-m,right:e.right-p,bottom:e.bottom-m}}if(u||/^(fixed|sticky)$/.test(getComputedStyle(s).position))break}}function yg(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,s=t+1;s<Math.min(innerHeight,e.bottom);s+=5){let a=n.root.elementFromPoint(o,s);if(!a||a==n.dom||!n.dom.contains(a))continue;let u=a.getBoundingClientRect();if(u.top>=t-20){r=a,i=u.top;break}}return{refDOM:r,refTop:i,stack:kp(n.dom)}}function kp(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=li(r));return e}function xg({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;wp(t,r==0?0:r-e)}function wp(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:i,left:o}=n[t];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let Xn=null;function vg(n){if(n.setActive)return n.setActive();if(Xn)return n.focus(Xn);let e=kp(n);n.focus(Xn==null?{get preventScroll(){return Xn={preventScroll:!0},!0}}:void 0),Xn||(Xn=!1,wp(e,0))}function Cp(n,e){let t,r=2e8,i,o=0,s=e.top,a=e.top,u,l;for(let c=n.firstChild,d=0;c;c=c.nextSibling,d++){let f;if(c.nodeType==1)f=c.getClientRects();else if(c.nodeType==3)f=Vt(c).getClientRects();else continue;for(let h=0;h<f.length;h++){let p=f[h];if(p.top<=s&&p.bottom>=a){s=Math.max(p.bottom,s),a=Math.min(p.top,a);let m=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(m<r){t=c,r=m,i=m&&t.nodeType==3?{left:p.right<e.left?p.right:p.left,top:e.top}:e,c.nodeType==1&&m&&(o=d+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!u&&p.left<=e.left&&p.right>=e.left&&(u=c,l={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!t&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(o=d+1)}}return!t&&u&&(t=u,i=l,r=0),t&&t.nodeType==3?kg(t,i):!t||r&&t.nodeType==1?{node:n,offset:o}:Cp(t,i)}function kg(n,e){let t=n.nodeValue.length,r=document.createRange();for(let i=0;i<t;i++){r.setEnd(n,i+1),r.setStart(n,i);let o=Jt(r,1);if(o.top!=o.bottom&&yl(e,o))return{node:n,offset:i+(e.left>=(o.left+o.right)/2?1:0)}}return{node:n,offset:0}}function yl(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function wg(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function Cg(n,e,t){let{node:r,offset:i}=Cp(e,t),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&t.left>(s.left+s.right)/2?1:-1}return n.docView.posFromDOM(r,i,o)}function Sg(n,e,t,r){let i=-1;for(let o=e,s=!1;o!=n.dom;){let a=n.docView.nearestDesc(o,!0);if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent&&!s||!a.contentDOM)){let u=a.dom.getBoundingClientRect();if(a.node.isBlock&&a.parent&&!s&&(s=!0,u.left>r.left||u.top>r.top?i=a.posBefore:(u.right<r.left||u.bottom<r.top)&&(i=a.posAfter)),!a.contentDOM&&i<0&&!a.node.isText)return(a.node.isBlock?r.top<(u.top+u.bottom)/2:r.left<(u.left+u.right)/2)?a.posBefore:a.posAfter}o=a.dom.parentNode}return i>-1?i:n.docView.posFromDOM(e,t,-1)}function Sp(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),o=i;;){let s=n.childNodes[o];if(s.nodeType==1){let a=s.getClientRects();for(let u=0;u<a.length;u++){let l=a[u];if(yl(e,l))return Sp(s,e,l)}}if((o=(o+1)%r)==i)break}return n}function Eg(n,e){let t=n.dom.ownerDocument,r,i=0,o=fg(t,e.left,e.top);o&&({node:r,offset:i}=o);let s=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!s||!n.dom.contains(s.nodeType!=1?s.parentNode:s)){let l=n.dom.getBoundingClientRect();if(!yl(e,l)||(s=Sp(n.dom,e,l),!s))return null}if(Oe)for(let l=s;r&&l;l=li(l))l.draggable&&(r=void 0);if(s=wg(s,e),r){if(at&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let c=r.childNodes[i],d;c.nodeName=="IMG"&&(d=c.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&i++}let l;Ti&&i&&r.nodeType==1&&(l=r.childNodes[i-1]).nodeType==1&&l.contentEditable=="false"&&l.getBoundingClientRect().top>=e.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(a=Sg(n,r,i,e))}a==null&&(a=Cg(n,s,e));let u=n.docView.nearestDesc(s,!0);return{pos:a,inside:u?u.posAtStart-u.border:-1}}function qc(n){return n.top<n.bottom||n.left<n.right}function Jt(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(qc(r))return r}return Array.prototype.find.call(t,qc)||n.getBoundingClientRect()}const Ag=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Ep(n,e,t){let{node:r,offset:i,atom:o}=n.docView.domFromPos(e,t<0?-1:1),s=Ti||at;if(r.nodeType==3)if(s&&(Ag.test(r.nodeValue)||(t<0?!i:i==r.nodeValue.length))){let u=Jt(Vt(r,i,i),t);if(at&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let l=Jt(Vt(r,i-1,i-1),-1);if(l.top==u.top){let c=Jt(Vt(r,i,i+1),-1);if(c.top!=u.top)return $r(c,c.left<l.left)}}return u}else{let u=i,l=i,c=t<0?1:-1;return t<0&&!i?(l++,c=-1):t>=0&&i==r.nodeValue.length?(u--,c=1):t<0?u--:l++,$r(Jt(Vt(r,u,l),c),c<0)}if(!n.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(t<0||i==yt(r))){let u=r.childNodes[i-1];if(u.nodeType==1)return Ea(u.getBoundingClientRect(),!1)}if(o==null&&i<yt(r)){let u=r.childNodes[i];if(u.nodeType==1)return Ea(u.getBoundingClientRect(),!0)}return Ea(r.getBoundingClientRect(),t>=0)}if(o==null&&i&&(t<0||i==yt(r))){let u=r.childNodes[i-1],l=u.nodeType==3?Vt(u,yt(u)-(s?0:1)):u.nodeType==1&&(u.nodeName!="BR"||!u.nextSibling)?u:null;if(l)return $r(Jt(l,1),!1)}if(o==null&&i<yt(r)){let u=r.childNodes[i];for(;u.pmViewDesc&&u.pmViewDesc.ignoreForCoords;)u=u.nextSibling;let l=u?u.nodeType==3?Vt(u,0,s?0:1):u.nodeType==1?u:null:null;if(l)return $r(Jt(l,-1),!0)}return $r(Jt(r.nodeType==3?Vt(r):r,-t),t>=0)}function $r(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function Ea(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function Ap(n,e,t){let r=n.state,i=n.root.activeElement;r!=e&&n.updateState(e),i!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function _g(n,e,t){let r=e.selection,i=t=="up"?r.$from:r.$to;return Ap(n,e,()=>{let{node:o}=n.docView.domFromPos(i.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(o,!0);if(!a)break;if(a.node.isBlock){o=a.contentDOM||a.dom;break}o=a.dom.parentNode}let s=Ep(n,i.pos,1);for(let a=o.firstChild;a;a=a.nextSibling){let u;if(a.nodeType==1)u=a.getClientRects();else if(a.nodeType==3)u=Vt(a,0,a.nodeValue.length).getClientRects();else continue;for(let l=0;l<u.length;l++){let c=u[l];if(c.bottom>c.top+1&&(t=="up"?s.top-c.top>(c.bottom-s.top)*2:c.bottom-s.bottom>(s.bottom-c.top)*2))return!1}}return!0})}const Mg=/[\u0590-\u08ac]/;function Tg(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,a=n.domSelection();return!Mg.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?o:s:Ap(n,e,()=>{let{focusNode:u,focusOffset:l,anchorNode:c,anchorOffset:d}=n.domSelectionRange(),f=a.caretBidiLevel;a.modify("move",t,"character");let h=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:p,focusOffset:m}=n.domSelectionRange(),g=p&&!h.contains(p.nodeType==1?p:p.parentNode)||u==p&&l==m;try{a.collapse(c,d),u&&(u!=c||l!=d)&&a.extend&&a.extend(u,l)}catch{}return f!=null&&(a.caretBidiLevel=f),g})}let jc=null,Uc=null,Wc=!1;function Dg(n,e,t){return jc==e&&Uc==t?Wc:(jc=e,Uc=t,Wc=t=="up"||t=="down"?_g(n,e,t):Tg(n,e,t))}const Ye=0,Zc=1,Tn=2,Mt=3;class Di{constructor(e,t,r,i){this.parent=e,this.children=t,this.dom=r,this.contentDOM=i,this.dirty=Ye,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>Le(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!t||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],a=o+s.size;if(a>e||s instanceof Mp){i=e-o;break}o=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof _p&&o.side>=0;r--);if(t<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&t&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,t):{node:this.contentDOM,offset:o?Le(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,t):{node:this.contentDOM,offset:o?Le(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,a=0;;a++){let u=this.children[a],l=s+u.size;if(i==-1&&e<=l){let c=s+u.border;if(e>=c&&t<=l-u.border&&u.node&&u.contentDOM&&this.contentDOM.contains(u.contentDOM))return u.parseRange(e,t,c);e=s;for(let d=a;d>0;d--){let f=this.children[d-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){i=Le(f.dom)+1;break}e-=f.size}i==-1&&(i=0)}if(i>-1&&(l>t||a==this.children.length-1)){t=l;for(let c=a+1;c<this.children.length;c++){let d=this.children[c];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){o=Le(d.dom);break}t+=d.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=l}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){let o=Math.min(e,t),s=Math.max(e,t);for(let f=0,h=0;f<this.children.length;f++){let p=this.children[f],m=h+p.size;if(o>h&&s<m)return p.setSelection(e-h-p.border,t-h-p.border,r,i);h=m}let a=this.domFromPos(e,e?-1:1),u=t==e?a:this.domFromPos(t,t?-1:1),l=r.getSelection(),c=!1;if((at||Oe)&&e==t){let{node:f,offset:h}=a;if(f.nodeType==3){if(c=!!(h&&f.nodeValue[h-1]==`
`),c&&h==f.nodeValue.length)for(let p=f,m;p;p=p.parentNode){if(m=p.nextSibling){m.nodeName=="BR"&&(a=u={node:m.parentNode,offset:Le(m)+1});break}let g=p.pmViewDesc;if(g&&g.node&&g.node.isBlock)break}}else{let p=f.childNodes[h-1];c=p&&(p.nodeName=="BR"||p.contentEditable=="false")}}if(at&&l.focusNode&&l.focusNode!=u.node&&l.focusNode.nodeType==1){let f=l.focusNode.childNodes[l.focusOffset];f&&f.contentEditable=="false"&&(i=!0)}if(!(i||c&&Oe)&&$n(a.node,a.offset,l.anchorNode,l.anchorOffset)&&$n(u.node,u.offset,l.focusNode,l.focusOffset))return;let d=!1;if((l.extend||e==t)&&!c){l.collapse(a.node,a.offset);try{e!=t&&l.extend(u.node,u.offset),d=!0}catch{}}if(!d){if(e>t){let h=a;a=u,u=h}let f=document.createRange();f.setEnd(u.node,u.offset),f.setStart(a.node,a.offset),l.removeAllRanges(),l.addRange(f)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?e<=s&&t>=r:e<s&&t>r){let a=r+o.border,u=s-o.border;if(e>=a&&t<=u){this.dirty=e==r||t==s?Tn:Zc,e==a&&t==u&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Mt:o.markDirty(e-a,t-a);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?Tn:Mt}r=s}this.dirty=Tn}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?Tn:Zc;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class _p extends Di{constructor(e,t,r,i){let o,s=t.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!t.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return this.dirty==Ye&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class Lg extends Di{constructor(e,t,r,i){super(e,[],t,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class zn extends Di{constructor(e,t,r,i){super(e,[],r,i),this.mark=t}static create(e,t,r,i){let o=i.nodeViews[t.type.name],s=o&&o(t,i,r);return(!s||!s.dom)&&(s=xt.renderSpec(document,t.type.spec.toDOM(t,r))),new zn(e,t,s.dom,s.contentDOM||s.dom)}parseRule(){return this.dirty&Mt||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Mt&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=Ye){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Ye}}slice(e,t,r){let i=zn.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;t<s&&(o=Ou(o,t,s,r)),e>0&&(o=Ou(o,0,e,r));for(let a=0;a<o.length;a++)o[a].parent=i;return i.children=o,i}}class hn extends Di{constructor(e,t,r,i,o,s,a,u,l){super(e,[],o,s),this.node=t,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a}static create(e,t,r,i,o,s){let a=o.nodeViews[t.type.name],u,l=a&&a(t,o,()=>{if(!u)return s;if(u.parent)return u.parent.posBeforeChild(u)},r,i),c=l&&l.dom,d=l&&l.contentDOM;if(t.isText){if(!c)c=document.createTextNode(t.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:d}=xt.renderSpec(document,t.type.spec.toDOM(t)));!d&&!t.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let f=c;return c=Lp(c,r,t),l?u=new Og(e,t,r,i,c,d||null,f,l,o,s+1):t.isText?new Hs(e,t,r,i,c,f,o):new hn(e,t,r,i,c,d||null,f,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>_.empty)}return e}matchesNode(e,t,r){return this.dirty==Ye&&e.eq(this.node)&&Lu(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,i=t,o=e.composing?this.localCompositionInfo(e,t):null,s=o&&o.pos>-1?o:null,a=o&&o.pos<0,u=new Ng(this,s&&s.node,e);Fg(this.node,this.innerDeco,(l,c,d)=>{l.spec.marks?u.syncToMarks(l.spec.marks,r,e):l.type.side>=0&&!d&&u.syncToMarks(c==this.node.childCount?Q.none:this.node.child(c).marks,r,e),u.placeWidget(l,e,i)},(l,c,d,f)=>{u.syncToMarks(l.marks,r,e);let h;u.findNodeMatch(l,c,d,f)||a&&e.state.selection.from>i&&e.state.selection.to<i+l.nodeSize&&(h=u.findIndexWithChild(o.node))>-1&&u.updateNodeAt(l,c,d,h,e)||u.updateNextNode(l,c,d,e,f,i)||u.addNode(l,c,d,e,i),i+=l.nodeSize}),u.syncToMarks([],r,e),this.node.isTextblock&&u.addTextblockHacks(),u.destroyRest(),(u.changed||this.dirty==Tn)&&(s&&this.protectLocalComposition(e,s),Tp(this.contentDOM,this.children,e),vr&&Pg(this.dom))}localCompositionInfo(e,t){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof B)||r<t||i>t+this.node.content.size)return null;let o=e.domSelectionRange(),s=Bg(o.focusNode,o.focusOffset);if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let a=s.nodeValue,u=$g(this.node.content,a,r-t,i-t);return u<0?null:{node:s,pos:u,text:a}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:i}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new Lg(this,o,t,i);e.input.compositionNodes.push(s),this.children=Ou(this.children,r,r+i.length,e,s)}update(e,t,r,i){return this.dirty==Mt||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,i),!0)}updateInner(e,t,r,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Ye}updateOuterDeco(e){if(Lu(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Dp(this.dom,this.nodeDOM,Du(this.outerDeco,this.node,t),Du(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function Kc(n,e,t,r,i){Lp(r,e,n);let o=new hn(void 0,n,e,t,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class Hs extends hn{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,null,s,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return this.dirty==Mt||this.dirty!=Ye&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=Ye||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=Ye,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let i=this.node.cut(e,t),o=document.createTextNode(i.text);return new Hs(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Mt)}get domAtom(){return!1}}class Mp extends Di{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Ye&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class Og extends hn{constructor(e,t,r,i,o,s,a,u,l,c){super(e,t,r,i,o,s,a,l,c),this.spec=u}update(e,t,r,i){if(this.dirty==Mt)return!1;if(this.spec.update){let o=this.spec.update(e,t,r);return o&&this.updateInner(e,t,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,i){this.spec.setSelection?this.spec.setSelection(e,t,r):super.setSelection(e,t,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function Tp(n,e,t){let r=n.firstChild,i=!1;for(let o=0;o<e.length;o++){let s=e[o],a=s.dom;if(a.parentNode==n){for(;a!=r;)r=Gc(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(a,r);if(s instanceof zn){let u=r?r.previousSibling:n.lastChild;Tp(s.contentDOM,s.children,t),r=u?u.nextSibling:n.firstChild}}for(;r;)r=Gc(r),i=!0;i&&t.trackWrites==n&&(t.trackWrites=null)}const Xr=function(n){n&&(this.nodeName=n)};Xr.prototype=Object.create(null);const Dn=[new Xr];function Du(n,e,t){if(n.length==0)return Dn;let r=t?Dn[0]:new Xr,i=[r];for(let o=0;o<n.length;o++){let s=n[o].type.attrs;if(s){s.nodeName&&i.push(r=new Xr(s.nodeName));for(let a in s){let u=s[a];u!=null&&(t&&i.length==1&&i.push(r=new Xr(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+u:a=="style"?r.style=(r.style?r.style+";":"")+u:a!="nodeName"&&(r[a]=u))}}}return i}function Dp(n,e,t,r){if(t==Dn&&r==Dn)return e;let i=e;for(let o=0;o<r.length;o++){let s=r[o],a=t[o];if(o){let u;a&&a.nodeName==s.nodeName&&i!=n&&(u=i.parentNode)&&u.nodeName.toLowerCase()==s.nodeName||(u=document.createElement(s.nodeName),u.pmIsDeco=!0,u.appendChild(i),a=Dn[0]),i=u}Rg(i,a||Dn[0],s)}return i}function Rg(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=t.class?t.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&n.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&n.classList.add(i[o]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)n.style.removeProperty(i[1])}t.style&&(n.style.cssText+=t.style)}}function Lp(n,e,t){return Dp(n,n,Dn,Du(e,t,n.nodeType!=1))}function Lu(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function Gc(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class Ng{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=Hg(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let i=0,o=this.stack.length>>1,s=Math.min(o,e.length);for(;i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=Ye,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let u=this.index;u<Math.min(this.index+3,this.top.children.length);u++){let l=this.top.children[u];if(l.matchesMark(e[o])&&!this.isLocked(l.dom)){a=u;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let u=zn.create(this.top,e[o],t,r);this.top.children.splice(this.index,0,u),this.top=u,this.changed=!0}this.index=0,o++}}findNodeMatch(e,t,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,t,r))o=this.top.children.indexOf(s,this.index);else for(let a=this.index,u=Math.min(this.top.children.length,a+5);a<u;a++){let l=this.top.children[a];if(l.matchesNode(e,t,r)&&!this.preMatch.matched.has(l)){o=a;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,t,r,i,o){let s=this.top.children[i];return s.dirty==Mt&&s.dom==s.contentDOM&&(s.dirty=Tn),s.update(e,t,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=t}}updateNextNode(e,t,r,i,o,s){for(let a=this.index;a<this.top.children.length;a++){let u=this.top.children[a];if(u instanceof hn){let l=this.preMatch.matched.get(u);if(l!=null&&l!=o)return!1;let c=u.dom,d,f=this.isLocked(c)&&!(e.isText&&u.node&&u.node.isText&&u.nodeDOM.nodeValue==e.text&&u.dirty!=Mt&&Lu(t,u.outerDeco));if(!f&&u.update(e,t,r,i))return this.destroyBetween(this.index,a),u.dom!=c&&(this.changed=!0),this.index++,!0;if(!f&&(d=this.recreateWrapper(u,e,t,r,i,s)))return this.top.children[this.index]=d,d.contentDOM&&(d.dirty=Tn,d.updateChildren(i,s+1),d.dirty=Ye),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,i,o,s){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content))return null;let a=hn.create(this.top,t,r,i,o,s);if(a.contentDOM){a.children=e.children,e.children=[];for(let u of a.children)u.parent=a}return e.destroy(),a}addNode(e,t,r,i,o){let s=hn.create(this.top,e,t,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,t,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new _p(this.top,e,t,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof zn;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof Hs)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Oe||Ee)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new Mp(this.top,[],r,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function Hg(n,e){let t=e,r=t.children.length,i=n.childCount,o=new Map,s=[];e:for(;i>0;){let a;for(;;)if(r){let l=t.children[r-1];if(l instanceof zn)t=l,r=l.children.length;else{a=l,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let u=a.node;if(u){if(u!=n.child(i-1))break;--i,o.set(a,i),s.push(a)}}return{index:i,matched:o,matches:s.reverse()}}function Ig(n,e){return n.type.side-e.type.side}function Fg(n,e,t,r){let i=e.locals(n),o=0;if(i.length==0){for(let l=0;l<n.childCount;l++){let c=n.child(l);r(c,i,e.forChild(o,c),l),o+=c.nodeSize}return}let s=0,a=[],u=null;for(let l=0;;){let c,d;for(;s<i.length&&i[s].to==o;){let g=i[s++];g.widget&&(c?(d||(d=[c])).push(g):c=g)}if(c)if(d){d.sort(Ig);for(let g=0;g<d.length;g++)t(d[g],l,!!u)}else t(c,l,!!u);let f,h;if(u)h=-1,f=u,u=null;else if(l<n.childCount)h=l,f=n.child(l++);else break;for(let g=0;g<a.length;g++)a[g].to<=o&&a.splice(g--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)a.push(i[s++]);let p=o+f.nodeSize;if(f.isText){let g=p;s<i.length&&i[s].from<g&&(g=i[s].from);for(let y=0;y<a.length;y++)a[y].to<g&&(g=a[y].to);g<p&&(u=f.cut(g-o),f=f.cut(0,g-o),p=g,h=-1)}else for(;s<i.length&&i[s].to<p;)s++;let m=f.isInline&&!f.isLeaf?a.filter(g=>!g.inline):a.slice();r(f,m,e.forChild(o,f),h),o=p}}function Pg(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function Bg(n,e){for(;;){if(n.nodeType==3)return n;if(n.nodeType==1&&e>0){if(n.childNodes.length>e&&n.childNodes[e].nodeType==3)return n.childNodes[e];n=n.childNodes[e-1],e=yt(n)}else if(n.nodeType==1&&e<n.childNodes.length)n=n.childNodes[e],e=0;else return null}}function $g(n,e,t,r){for(let i=0,o=0;i<n.childCount&&o<=r;){let s=n.child(i++),a=o;if(o+=s.nodeSize,!s.isText)continue;let u=s.text;for(;i<n.childCount;){let l=n.child(i++);if(o+=l.nodeSize,!l.isText)break;u+=l.text}if(o>=t){if(o>=r&&u.slice(r-e.length-a,r-a)==e)return r-e.length;let l=a<r?u.lastIndexOf(e,r-a-1):-1;if(l>=0&&l+e.length+a>=t)return a+l;if(t==r&&u.length>=r+e.length-a&&u.slice(r-a,r-a+e.length)==e)return r}}return-1}function Ou(n,e,t,r,i){let o=[];for(let s=0,a=0;s<n.length;s++){let u=n[s],l=a,c=a+=u.size;l>=t||c<=e?o.push(u):(l<e&&o.push(u.slice(0,e-l,r)),i&&(o.push(i),i=void 0),c>t&&o.push(u.slice(t-l,u.size,r)))}return o}function xl(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),o=i&&i.size==0,s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;let a=r.resolve(s),u,l;if(Ns(t)){for(u=a;i&&!i.node;)i=i.parent;let c=i.node;if(i&&c.isAtom&&$.isSelectable(c)&&i.parent&&!(c.isInline&&cg(t.focusNode,t.focusOffset,i.dom))){let d=i.posBefore;l=new $(s==d?a:r.resolve(d))}}else{let c=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(c<0)return null;u=r.resolve(c)}if(!l){let c=e=="pointer"||n.state.selection.head<a.pos&&!o?1:-1;l=vl(n,u,a,c)}return l}function Op(n){return n.editable?n.hasFocus():Np(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Ut(n,e=!1){let t=n.state.selection;if(Rp(n,t),!!Op(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Ee){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&$n(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)Vg(n);else{let{anchor:r,head:i}=t,o,s;Jc&&!(t instanceof B)&&(t.$from.parent.inlineContent||(o=Yc(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(s=Yc(n,t.to))),n.docView.setSelection(r,i,n.root,e),Jc&&(o&&Xc(o),s&&Xc(s)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&zg(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const Jc=Oe||Ee&&hg<63;function Yc(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,o=r?t.childNodes[r-1]:null;if(Oe&&i&&i.contentEditable=="false")return Aa(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return Aa(i);if(o)return Aa(o)}}function Aa(n){return n.contentEditable="true",Oe&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Xc(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function zg(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!Op(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function Vg(n){let e=n.domSelection(),t=document.createRange(),r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?t.setEnd(r.parentNode,Le(r)+1):t.setEnd(r,0),t.collapse(!1),e.removeAllRanges(),e.addRange(t),!i&&!n.state.selection.visible&&Ie&&fn<=11&&(r.disabled=!0,r.disabled=!1)}function Rp(n,e){if(e instanceof $){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(Qc(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else Qc(n)}function Qc(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function vl(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||B.between(e,t,r)}function ed(n){return n.editable&&!n.hasFocus()?!1:Np(n)}function Np(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function qg(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return $n(e.node,e.offset,t.anchorNode,t.anchorOffset)}function Ru(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),o=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return o&&z.findFrom(o,e)}function Yt(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function td(n,e,t){let r=n.state.selection;if(r instanceof B)if(t.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=n.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return Yt(n,new B(r.$anchor,s))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let i=Ru(n.state,e);return i&&i instanceof $?Yt(n,i):!1}else if(!(Ke&&t.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let a=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=n.docView.descAt(a))&&!s.contentDOM?$.isSelectable(o)?Yt(n,new $(e<0?n.state.doc.resolve(i.pos-o.nodeSize):i)):Ti?Yt(n,new B(n.state.doc.resolve(e<0?a:a+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof $&&r.node.isInline)return Yt(n,new B(e>0?r.$to:r.$from));{let i=Ru(n.state,e);return i?Yt(n,i):!1}}}function No(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Qr(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function Qn(n,e){return e<0?jg(n):Ug(n)}function jg(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,o,s=!1;for(at&&t.nodeType==1&&r<No(t)&&Qr(t.childNodes[r],-1)&&(s=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(Qr(a,-1))i=t,o=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(Hp(t))break;{let a=t.previousSibling;for(;a&&Qr(a,-1);)i=t.parentNode,o=Le(a),a=a.previousSibling;if(a)t=a,r=No(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}s?Nu(n,t,r):i&&Nu(n,i,o)}function Ug(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=No(t),o,s;for(;;)if(r<i){if(t.nodeType!=1)break;let a=t.childNodes[r];if(Qr(a,1))o=t,s=++r;else break}else{if(Hp(t))break;{let a=t.nextSibling;for(;a&&Qr(a,1);)o=a.parentNode,s=Le(a)+1,a=a.nextSibling;if(a)t=a,r=0,i=No(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}o&&Nu(n,o,s)}function Hp(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function Wg(n,e){for(;n&&e==n.childNodes.length&&!bl(n);)e=Le(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function Zg(n,e){for(;n&&!e&&!bl(n);)e=Le(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Nu(n,e,t){if(e.nodeType!=3){let o,s;(s=Wg(e,t))?(e=s,t=0):(o=Zg(e,t))&&(e=o,t=o.nodeValue.length)}let r=n.domSelection();if(Ns(r)){let o=document.createRange();o.setEnd(e,t),o.setStart(e,t),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&Ut(n)},50)}function nd(n,e){let t=n.state.doc.resolve(e);if(!(Ee||pg)&&t.parent.inlineContent){let i=n.coordsAtPos(e);if(e>t.start()){let o=n.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<t.end()){let o=n.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function rd(n,e,t){let r=n.state.selection;if(r instanceof B&&!r.empty||t.indexOf("s")>-1||Ke&&t.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let s=Ru(n.state,e);if(s&&s instanceof $)return Yt(n,s)}if(!i.parent.inlineContent){let s=e<0?i:o,a=r instanceof Je?z.near(s,e):z.findFrom(s,e);return a?Yt(n,a):!1}return!1}function id(n,e){if(!(n.state.selection instanceof B))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(o&&!o.isText){let s=n.state.tr;return e<0?s.delete(t.pos-o.nodeSize,t.pos):s.delete(t.pos,t.pos+o.nodeSize),n.dispatch(s),!0}return!1}function od(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function Kg(n){if(!Oe||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;od(n,r,"true"),setTimeout(()=>od(n,r,"false"),20)}return!1}function Gg(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function Jg(n,e){let t=e.keyCode,r=Gg(e);if(t==8||Ke&&t==72&&r=="c")return id(n,-1)||Qn(n,-1);if(t==46&&!e.shiftKey||Ke&&t==68&&r=="c")return id(n,1)||Qn(n,1);if(t==13||t==27)return!0;if(t==37||Ke&&t==66&&r=="c"){let i=t==37?nd(n,n.state.selection.from)=="ltr"?-1:1:-1;return td(n,i,r)||Qn(n,i)}else if(t==39||Ke&&t==70&&r=="c"){let i=t==39?nd(n,n.state.selection.from)=="ltr"?1:-1:1;return td(n,i,r)||Qn(n,i)}else{if(t==38||Ke&&t==80&&r=="c")return rd(n,-1,r)||Qn(n,-1);if(t==40||Ke&&t==78&&r=="c")return Kg(n)||rd(n,1,r)||Qn(n,1);if(r==(Ke?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Ip(n,e){n.someProp("transformCopied",h=>{e=h(e,n)});let t=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let h=r.firstChild;t.push(h.type.name,h.attrs!=h.type.defaultAttrs?h.attrs:null),r=h.content}let s=n.someProp("clipboardSerializer")||xt.fromSchema(n.state.schema),a=Vp(),u=a.createElement("div");u.appendChild(s.serializeFragment(r,{document:a}));let l=u.firstChild,c,d=0;for(;l&&l.nodeType==1&&(c=zp[l.nodeName.toLowerCase()]);){for(let h=c.length-1;h>=0;h--){let p=a.createElement(c[h]);for(;u.firstChild;)p.appendChild(u.firstChild);u.appendChild(p),d++}l=u.firstChild}l&&l.nodeType==1&&l.setAttribute("data-pm-slice",`${i} ${o}${d?` -${d}`:""} ${JSON.stringify(t)}`);let f=n.someProp("clipboardTextSerializer",h=>h(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:u,text:f}}function Fp(n,e,t,r,i){let o=i.parent.type.spec.code,s,a;if(!t&&!e)return null;let u=e&&(r||o||!t);if(u){if(n.someProp("transformPastedText",f=>{e=f(e,o||r,n)}),o)return e?new O(_.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):O.empty;let d=n.someProp("clipboardTextParser",f=>f(e,i,r,n));if(d)a=d;else{let f=i.marks(),{schema:h}=n.state,p=xt.fromSchema(h);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let g=s.appendChild(document.createElement("p"));m&&g.appendChild(p.serializeNode(h.text(m,f)))})}}else n.someProp("transformPastedHTML",d=>{t=d(t,n)}),s=Qg(t),Ti&&e2(s);let l=s&&s.querySelector("[data-pm-slice]"),c=l&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(l.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let d=+c[3];d>0;d--){let f=s.firstChild;for(;f&&f.nodeType!=1;)f=f.nextSibling;if(!f)break;s=f}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||Mi.fromSchema(n.state.schema)).parseSlice(s,{preserveWhitespace:!!(u||c),context:i,ruleFromNode(f){return f.nodeName=="BR"&&!f.nextSibling&&f.parentNode&&!Yg.test(f.parentNode.nodeName)?{ignore:!0}:null}})),c)a=t2(sd(a,+c[1],+c[2]),c[4]);else if(a=O.maxOpen(Xg(a.content,i),!0),a.openStart||a.openEnd){let d=0,f=0;for(let h=a.content.firstChild;d<a.openStart&&!h.type.spec.isolating;d++,h=h.firstChild);for(let h=a.content.lastChild;f<a.openEnd&&!h.type.spec.isolating;f++,h=h.lastChild);a=sd(a,d,f)}return n.someProp("transformPasted",d=>{a=d(a,n)}),a}const Yg=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Xg(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),o,s=[];if(n.forEach(a=>{if(!s)return;let u=i.findWrapping(a.type),l;if(!u)return s=null;if(l=s.length&&o.length&&Bp(u,o,a,s[s.length-1],0))s[s.length-1]=l;else{s.length&&(s[s.length-1]=$p(s[s.length-1],o.length));let c=Pp(a,u);s.push(c),i=i.matchType(c.type),o=u}}),s)return _.from(s)}return n}function Pp(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,_.from(n));return n}function Bp(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let o=Bp(n,e,t,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(_.from(Pp(t,n,i+1))))}}function $p(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,$p(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(_.empty,!0);return n.copy(t.append(r))}function Hu(n,e,t,r,i,o){let s=e<0?n.firstChild:n.lastChild,a=s.content;return n.childCount>1&&(o=0),i<r-1&&(a=Hu(a,e,t,r,i+1,o)),i>=t&&(a=e<0?s.contentMatchAt(0).fillBefore(a,o<=i).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(_.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,s.copy(a))}function sd(n,e,t){return e<n.openStart&&(n=new O(Hu(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new O(Hu(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const zp={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let ad=null;function Vp(){return ad||(ad=document.implementation.createHTMLDocument("title"))}function Qg(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=Vp().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&zp[r[1].toLowerCase()])&&(n=i.map(o=>"<"+o+">").join("")+n+i.map(o=>"</"+o+">").reverse().join("")),t.innerHTML=n,i)for(let o=0;o<i.length;o++)t=t.querySelector(i[o])||t;return t}function e2(n){let e=n.querySelectorAll(Ee?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function t2(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:i,openStart:o,openEnd:s}=n;for(let a=r.length-2;a>=0;a-=2){let u=t.nodes[r[a]];if(!u||u.hasRequiredAttrs())break;i=_.from(u.create(r[a+1],i)),o++,s++}return new O(i,o,s)}const Re={},Ne={},n2={touchstart:!0,touchmove:!0};class r2{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function i2(n){for(let e in Re){let t=Re[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{s2(n,r)&&!kl(n,r)&&(n.editable||!(r.type in Ne))&&t(n,r)},n2[e]?{passive:!0}:void 0)}Oe&&n.dom.addEventListener("input",()=>null),Iu(n)}function ln(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function o2(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function Iu(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>kl(n,r))})}function kl(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function s2(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function a2(n,e){!kl(n,e)&&Re[e.type]&&(n.editable||!(e.type in Ne))&&Re[e.type](n,e)}Ne.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!jp(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(ot&&Ee&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),vr&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,Mn(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||Jg(n,t)?t.preventDefault():ln(n,"key")};Ne.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Ne.keypress=(n,e)=>{let t=e;if(jp(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||Ke&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof B)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode);!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,i))&&n.dispatch(n.state.tr.insertText(i).scrollIntoView()),t.preventDefault()}};function Is(n){return{left:n.clientX,top:n.clientY}}function u2(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function wl(n,e,t,r,i){if(r==-1)return!1;let o=n.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(n.someProp(e,a=>s>o.depth?a(n,t,o.nodeAfter,o.before(s),i,!0):a(n,t,o.node(s),o.before(s),i,!1)))return!0;return!1}function mr(n,e,t){n.focused||n.focus();let r=n.state.tr.setSelection(e);t=="pointer"&&r.setMeta("pointer",!0),n.dispatch(r)}function l2(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&$.isSelectable(r)?(mr(n,new $(t),"pointer"),!0):!1}function c2(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof $&&(r=t.node);let o=n.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let a=s>o.depth?o.nodeAfter:o.node(s);if($.isSelectable(a)){r&&t.$from.depth>0&&s>=t.$from.depth&&o.before(t.$from.depth+1)==t.$from.pos?i=o.before(t.$from.depth):i=o.before(s);break}}return i!=null?(mr(n,$.create(n.state.doc,i),"pointer"),!0):!1}function d2(n,e,t,r,i){return wl(n,"handleClickOn",e,t,r)||n.someProp("handleClick",o=>o(n,e,r))||(i?c2(n,t):l2(n,t))}function f2(n,e,t,r){return wl(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function h2(n,e,t,r){return wl(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||p2(n,t,r)}function p2(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(mr(n,B.create(r,0,r.content.size),"pointer"),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),a=i.before(o);if(s.inlineContent)mr(n,B.create(r,a+1,a+1+s.content.size),"pointer");else if($.isSelectable(s))mr(n,$.create(r,a),"pointer");else continue;return!0}}function Cl(n){return Ho(n)}const qp=Ke?"metaKey":"ctrlKey";Re.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=Cl(n),i=Date.now(),o="singleClick";i-n.input.lastClick.time<500&&u2(t,n.input.lastClick)&&!t[qp]&&(n.input.lastClick.type=="singleClick"?o="doubleClick":n.input.lastClick.type=="doubleClick"&&(o="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:o};let s=n.posAtCoords(Is(t));s&&(o=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new m2(n,s,t,!!r)):(o=="doubleClick"?f2:h2)(n,s.pos,s.inside,t)?t.preventDefault():ln(n,"pointer"))};class m2{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[qp],this.allowDefault=r.shiftKey;let o,s;if(t.inside>-1)o=e.state.doc.nodeAt(t.inside),s=t.inside;else{let c=e.state.doc.resolve(t.pos);o=c.parent,s=c.depth?c.before():0}const a=i?null:r.target,u=a?e.docView.nearestDesc(a,!0):null;this.target=u?u.dom:null;let{selection:l}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||l instanceof $&&l.from<=s&&l.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&at&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ln(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Ut(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Is(e))),this.updateAllowDefault(e),this.allowDefault||!t?ln(this.view,"pointer"):d2(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Oe&&this.mightDrag&&!this.mightDrag.node.isAtom||Ee&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(mr(this.view,z.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):ln(this.view,"pointer")}move(e){this.updateAllowDefault(e),ln(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Re.touchstart=n=>{n.input.lastTouch=Date.now(),Cl(n),ln(n,"pointer")};Re.touchmove=n=>{n.input.lastTouch=Date.now(),ln(n,"pointer")};Re.contextmenu=n=>Cl(n);function jp(n,e){return n.composing?!0:Oe&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const g2=ot?5e3:-1;Ne.compositionstart=Ne.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Ho(n,!0),n.markCursor=null;else if(Ho(n),at&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){n.domSelection().collapse(s,s.nodeValue.length);break}else i=s,o=-1}}n.input.composing=!0}Up(n,g2)};Ne.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,Up(n,20))};function Up(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Ho(n),e))}function Wp(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=b2());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function b2(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Ho(n,e=!1){if(!(ot&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),Wp(n),e||n.docView&&n.docView.dirty){let t=xl(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):n.updateState(n.state),!0}return!1}}function y2(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const ci=Ie&&fn<15||vr&&mg<604;Re.copy=Ne.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let o=ci?null:t.clipboardData,s=r.content(),{dom:a,text:u}=Ip(n,s);o?(t.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",u)):y2(n,a),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function x2(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function v2(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?di(n,r.value,null,i,e):di(n,r.textContent,r.innerHTML,i,e)},50)}function di(n,e,t,r,i){let o=Fp(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",u=>u(n,i,o||O.empty)))return!0;if(!o)return!1;let s=x2(o),a=s?n.state.tr.replaceSelectionWith(s,r):n.state.tr.replaceSelection(o);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Zp(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Ne.paste=(n,e)=>{let t=e;if(n.composing&&!ot)return;let r=ci?null:t.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&di(n,Zp(r),r.getData("text/html"),i,t)?t.preventDefault():v2(n,t)};class Kp{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const Gp=Ke?"altKey":"ctrlKey";Re.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,o=i.empty?null:n.posAtCoords(Is(t)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof $?i.to-1:i.to))){if(r&&r.mightDrag)s=$.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let c=n.docView.nearestDesc(t.target,!0);c&&c.node.type.spec.draggable&&c!=n.docView&&(s=$.create(n.state.doc,c.posBefore))}}let a=(s||n.state.selection).content(),{dom:u,text:l}=Ip(n,a);t.dataTransfer.clearData(),t.dataTransfer.setData(ci?"Text":"text/html",u.innerHTML),t.dataTransfer.effectAllowed="copyMove",ci||t.dataTransfer.setData("text/plain",l),n.dragging=new Kp(a,!t[Gp],s)};Re.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Ne.dragover=Ne.dragenter=(n,e)=>e.preventDefault();Ne.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let i=n.posAtCoords(Is(t));if(!i)return;let o=n.state.doc.resolve(i.pos),s=r&&r.slice;s?n.someProp("transformPasted",p=>{s=p(s,n)}):s=Fp(n,Zp(t.dataTransfer),ci?null:t.dataTransfer.getData("text/html"),!1,o);let a=!!(r&&!t[Gp]);if(n.someProp("handleDrop",p=>p(n,t,s||O.empty,a))){t.preventDefault();return}if(!s)return;t.preventDefault();let u=s?fp(n.state.doc,o.pos,s):o.pos;u==null&&(u=o.pos);let l=n.state.tr;if(a){let{node:p}=r;p?p.replace(l):l.deleteSelection()}let c=l.mapping.map(u),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,f=l.doc;if(d?l.replaceRangeWith(c,c,s.content.firstChild):l.replaceRange(c,c,s),l.doc.eq(f))return;let h=l.doc.resolve(c);if(d&&$.isSelectable(s.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(s.content.firstChild))l.setSelection(new $(h));else{let p=l.mapping.map(u);l.mapping.maps[l.mapping.maps.length-1].forEach((m,g,y,x)=>p=x),l.setSelection(vl(n,h,l.doc.resolve(p)))}n.focus(),n.dispatch(l.setMeta("uiEvent","drop"))};Re.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Ut(n)},20))};Re.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Re.beforeinput=(n,e)=>{if(Ee&&ot&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",o=>o(n,Mn(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in Ne)Re[n]=Ne[n];function fi(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class Io{constructor(e,t){this.toDOM=e,this.spec=t||In,this.side=this.spec.side||0}map(e,t,r,i){let{pos:o,deleted:s}=e.mapResult(t.from+i,this.side<0?-1:1);return s?null:new pe(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Io&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&fi(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class pn{constructor(e,t){this.attrs=e,this.spec=t||In}map(e,t,r,i){let o=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new pe(o,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof pn&&fi(this.attrs,e.attrs)&&fi(this.spec,e.spec)}static is(e){return e.type instanceof pn}destroy(){}}class Sl{constructor(e,t){this.attrs=e,this.spec=t||In}map(e,t,r,i){let o=e.mapResult(t.from+i,1);if(o.deleted)return null;let s=e.mapResult(t.to+i,-1);return s.deleted||s.pos<=o.pos?null:new pe(o.pos-r,s.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),o;return i==t.from&&!(o=e.child(r)).isText&&i+o.nodeSize==t.to}eq(e){return this==e||e instanceof Sl&&fi(this.attrs,e.attrs)&&fi(this.spec,e.spec)}destroy(){}}class pe{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new pe(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new pe(e,e,new Io(t,r))}static inline(e,t,r,i){return new pe(e,t,new pn(r,i))}static node(e,t,r,i){return new pe(e,t,new Sl(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof pn}get widget(){return this.type instanceof Io}}const ar=[],In={};class ne{constructor(e,t){this.local=e.length?e:ar,this.children=t.length?t:ar}static create(e,t){return t.length?Fo(t,e,0,In):Se}find(e,t,r){let i=[];return this.findInner(e??0,t??1e9,i,0,r),i}findInner(e,t,r,i,o){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=t&&a.to>=e&&(!o||o(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let a=this.children[s]+1;this.children[s+2].findInner(e-a,t-a,r,i+a,o)}}map(e,t,r){return this==Se||e.maps.length==0?this:this.mapInner(e,t,0,0,r||In)}mapInner(e,t,r,i,o){let s;for(let a=0;a<this.local.length;a++){let u=this.local[a].map(e,r,i);u&&u.type.valid(t,u)?(s||(s=[])).push(u):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?k2(this.children,s||[],e,t,r,i,o):s?new ne(s.sort(Fn),ar):Se}add(e,t){return t.length?this==Se?ne.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,o=0;e.forEach((a,u)=>{let l=u+r,c;if(c=Yp(t,a,l)){for(i||(i=this.children.slice());o<i.length&&i[o]<u;)o+=3;i[o]==u?i[o+2]=i[o+2].addInner(a,c,l+1):i.splice(o,0,u,u+a.nodeSize,Fo(c,a,l+1,In)),o+=3}});let s=Jp(o?Xp(t):t,-r);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new ne(s.length?this.local.concat(s).sort(Fn):this.local,i||this.children)}remove(e){return e.length==0||this==Se?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,a=r[o]+t,u=r[o+1]+t;for(let c=0,d;c<e.length;c++)(d=e[c])&&d.from>a&&d.to<u&&(e[c]=null,(s||(s=[])).push(d));if(!s)continue;r==this.children&&(r=this.children.slice());let l=r[o+2].removeInner(s,a+1);l!=Se?r[o+2]=l:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let a=0;a<i.length;a++)i[a].eq(s,t)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new ne(i,r):Se}forChild(e,t){if(this==Se)return this;if(t.isLeaf)return ne.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let o=e+1,s=o+t.content.size;for(let a=0;a<this.local.length;a++){let u=this.local[a];if(u.from<s&&u.to>o&&u.type instanceof pn){let l=Math.max(o,u.from)-o,c=Math.min(s,u.to)-o;l<c&&(i||(i=[])).push(u.copy(l,c))}}if(i){let a=new ne(i.sort(Fn),ar);return r?new nn([a,r]):a}return r||Se}eq(e){if(this==e)return!0;if(!(e instanceof ne)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return El(this.localsInner(e))}localsInner(e){if(this==Se)return ar;if(e.inlineContent||!this.local.some(pn.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof pn||t.push(this.local[r]);return t}}ne.empty=new ne([],[]);ne.removeOverlap=El;const Se=ne.empty;class nn{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,In));return nn.from(r)}forChild(e,t){if(t.isLeaf)return ne.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,t);o!=Se&&(o instanceof nn?r=r.concat(o.members):r.push(o))}return nn.from(r)}eq(e){if(!(e instanceof nn)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!t)t=o;else{r&&(t=t.slice(),r=!1);for(let s=0;s<o.length;s++)t.push(o[s])}}return t?El(r?t:t.sort(Fn)):ar}static from(e){switch(e.length){case 0:return Se;case 1:return e[0];default:return new nn(e.every(t=>t instanceof ne)?e:e.reduce((t,r)=>t.concat(r instanceof ne?r:r.members),[]))}}}function k2(n,e,t,r,i,o,s){let a=n.slice();for(let l=0,c=o;l<t.maps.length;l++){let d=0;t.maps[l].forEach((f,h,p,m)=>{let g=m-p-(h-f);for(let y=0;y<a.length;y+=3){let x=a[y+1];if(x<0||f>x+c-d)continue;let v=a[y]+c-d;h>=v?a[y+1]=f<=v?-2:-1:f>=c&&g&&(a[y]+=g,a[y+1]+=g)}d+=g}),c=t.maps[l].map(c,-1)}let u=!1;for(let l=0;l<a.length;l+=3)if(a[l+1]<0){if(a[l+1]==-2){u=!0,a[l+1]=-1;continue}let c=t.map(n[l]+o),d=c-i;if(d<0||d>=r.content.size){u=!0;continue}let f=t.map(n[l+1]+o,-1),h=f-i,{index:p,offset:m}=r.content.findIndex(d),g=r.maybeChild(p);if(g&&m==d&&m+g.nodeSize==h){let y=a[l+2].mapInner(t,g,c+1,n[l]+o+1,s);y!=Se?(a[l]=d,a[l+1]=h,a[l+2]=y):(a[l+1]=-2,u=!0)}else u=!0}if(u){let l=w2(a,n,e,t,i,o,s),c=Fo(l,r,0,s);e=c.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,f=0;d<c.children.length;d+=3){let h=c.children[d];for(;f<a.length&&a[f]<h;)f+=3;a.splice(f,0,c.children[d],c.children[d+1],c.children[d+2])}}return new ne(e.sort(Fn),a)}function Jp(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new pe(i.from+e,i.to+e,i.type))}return t}function w2(n,e,t,r,i,o,s){function a(u,l){for(let c=0;c<u.local.length;c++){let d=u.local[c].map(r,i,l);d?t.push(d):s.onRemove&&s.onRemove(u.local[c].spec)}for(let c=0;c<u.children.length;c+=3)a(u.children[c+2],u.children[c]+l+1)}for(let u=0;u<n.length;u+=3)n[u+1]==-1&&a(n[u+2],e[u]+o+1);return t}function Yp(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let o=0,s;o<n.length;o++)(s=n[o])&&s.from>t&&s.to<r&&((i||(i=[])).push(s),n[o]=null);return i}function Xp(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function Fo(n,e,t,r){let i=[],o=!1;e.forEach((a,u)=>{let l=Yp(n,a,u+t);if(l){o=!0;let c=Fo(l,a,t+u+1,r);c!=Se&&i.push(u,u+a.nodeSize,c)}});let s=Jp(o?Xp(n):n,-t).sort(Fn);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||i.length?new ne(s,i):Se}function Fn(n,e){return n.from-e.from||n.to-e.to}function El(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==n&&(e=n.slice()),e[i]=o.copy(o.from,r.to),ud(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,o.from),ud(e,i,r.copy(o.from,r.to)));break}}}return e}function ud(n,e,t){for(;e<n.length&&Fn(t,n[e])>0;)e++;n.splice(e,0,t)}function _a(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Se&&e.push(r)}),n.cursorWrapper&&e.push(ne.create(n.state.doc,[n.cursorWrapper.deco])),nn.from(e)}const C2={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},S2=Ie&&fn<=11;class E2{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class A2{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new E2,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);Ie&&fn<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),S2&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,C2)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(ed(this.view)){if(this.suppressingSelectionUpdates)return Ut(this.view);if(Ie&&fn<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&$n(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let o=e.focusNode;o;o=li(o))t.add(o);for(let o=e.anchorNode;o;o=li(o))if(t.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&ed(e)&&!this.ignoreSelectionChange(r),o=-1,s=-1,a=!1,u=[];if(e.editable)for(let c=0;c<t.length;c++){let d=this.registerMutation(t[c],u);d&&(o=o<0?d.from:Math.min(d.from,o),s=s<0?d.to:Math.max(d.to,s),d.typeOver&&(a=!0))}if(at&&u.length>1){let c=u.filter(d=>d.nodeName=="BR");if(c.length==2){let d=c[0],f=c[1];d.parentNode&&d.parentNode.parentNode==f.parentNode?f.remove():d.remove()}}let l=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Ns(r)&&(l=xl(e))&&l.eq(z.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Ut(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),_2(e)),this.handleDOMChange(o,s,a,u),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Ut(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++)t.push(e.addedNodes[c]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(Ie&&fn<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:d,nextSibling:f}=e.addedNodes[c];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(o=f)}let s=i&&i.parentNode==e.target?Le(i)+1:0,a=r.localPosFromDOM(e.target,s,-1),u=o&&o.parentNode==e.target?Le(o):e.target.childNodes.length,l=r.localPosFromDOM(e.target,u,1);return{from:a,to:l}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let ld=new WeakMap,cd=!1;function _2(n){if(!ld.has(n)&&(ld.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=at,cd)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),cd=!0}}function M2(n){let e;function t(u){u.preventDefault(),u.stopImmediatePropagation(),e=u.getTargetRanges()[0]}n.dom.addEventListener("beforeinput",t,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",t,!0);let r=e.startContainer,i=e.startOffset,o=e.endContainer,s=e.endOffset,a=n.domAtPos(n.state.selection.anchor);return $n(a.node,a.offset,o,s)&&([r,i,o,s]=[o,s,r,i]),{anchorNode:r,anchorOffset:i,focusNode:o,focusOffset:s}}function T2(n,e,t){let{node:r,fromOffset:i,toOffset:o,from:s,to:a}=n.docView.parseRange(e,t),u=n.domSelectionRange(),l,c=u.anchorNode;if(c&&n.dom.contains(c.nodeType==1?c:c.parentNode)&&(l=[{node:c,offset:u.anchorOffset}],Ns(u)||l.push({node:u.focusNode,offset:u.focusOffset})),Ee&&n.input.lastKeyCode===8)for(let g=o;g>i;g--){let y=r.childNodes[g-1],x=y.pmViewDesc;if(y.nodeName=="BR"&&!x){o=g;break}if(!x||x.size)break}let d=n.state.doc,f=n.someProp("domParser")||Mi.fromSchema(n.state.schema),h=d.resolve(s),p=null,m=f.parse(r,{topNode:h.parent,topMatch:h.parent.contentMatchAt(h.index()),topOpen:!0,from:i,to:o,preserveWhitespace:h.parent.type.whitespace=="pre"?"full":!0,findPositions:l,ruleFromNode:D2,context:h});if(l&&l[0].pos!=null){let g=l[0].pos,y=l[1]&&l[1].pos;y==null&&(y=g),p={anchor:g+s,head:y+s}}return{doc:m,sel:p,from:s,to:a}}function D2(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Oe&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Oe&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const L2=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function O2(n,e,t,r,i){let o=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let A=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,T=xl(n,A);if(T&&!n.state.selection.eq(T)){if(Ee&&ot&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",V=>V(n,Mn(13,"Enter"))))return;let I=n.state.tr.setSelection(T);A=="pointer"?I.setMeta("pointer",!0):A=="key"&&I.scrollIntoView(),o&&I.setMeta("composition",o),n.dispatch(I)}return}let s=n.state.doc.resolve(e),a=s.sharedDepth(t);e=s.before(a+1),t=n.state.doc.resolve(t).after(a+1);let u=n.state.selection,l=T2(n,e,t),c=n.state.doc,d=c.slice(l.from,l.to),f,h;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(f=n.state.selection.to,h="end"):(f=n.state.selection.from,h="start"),n.input.lastKeyCode=null;let p=H2(d.content,l.doc.content,l.from,f,h);if((vr&&n.input.lastIOSEnter>Date.now()-225||ot)&&i.some(A=>A.nodeType==1&&!L2.test(A.nodeName))&&(!p||p.endA>=p.endB)&&n.someProp("handleKeyDown",A=>A(n,Mn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!p)if(r&&u instanceof B&&!u.empty&&u.$head.sameParent(u.$anchor)&&!n.composing&&!(l.sel&&l.sel.anchor!=l.sel.head))p={start:u.from,endA:u.to,endB:u.to};else{if(l.sel){let A=dd(n,n.state.doc,l.sel);if(A&&!A.eq(n.state.selection)){let T=n.state.tr.setSelection(A);o&&T.setMeta("composition",o),n.dispatch(T)}}return}if(Ee&&n.cursorWrapper&&l.sel&&l.sel.anchor==n.cursorWrapper.deco.from&&l.sel.head==l.sel.anchor){let A=p.endB-p.start;l.sel={anchor:l.sel.anchor+A,head:l.sel.anchor+A}}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&p.start==p.endB&&n.state.selection instanceof B&&(p.start>n.state.selection.from&&p.start<=n.state.selection.from+2&&n.state.selection.from>=l.from?p.start=n.state.selection.from:p.endA<n.state.selection.to&&p.endA>=n.state.selection.to-2&&n.state.selection.to<=l.to&&(p.endB+=n.state.selection.to-p.endA,p.endA=n.state.selection.to)),Ie&&fn<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>l.from&&l.doc.textBetween(p.start-l.from-1,p.start-l.from+1)==" "&&(p.start--,p.endA--,p.endB--);let m=l.doc.resolveNoCache(p.start-l.from),g=l.doc.resolveNoCache(p.endB-l.from),y=c.resolve(p.start),x=m.sameParent(g)&&m.parent.inlineContent&&y.end()>=p.endA,v;if((vr&&n.input.lastIOSEnter>Date.now()-225&&(!x||i.some(A=>A.nodeName=="DIV"||A.nodeName=="P"))||!x&&m.pos<l.doc.content.size&&!m.sameParent(g)&&(v=z.findFrom(l.doc.resolve(m.pos+1),1,!0))&&v.head==g.pos)&&n.someProp("handleKeyDown",A=>A(n,Mn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>p.start&&N2(c,p.start,p.endA,m,g)&&n.someProp("handleKeyDown",A=>A(n,Mn(8,"Backspace")))){ot&&Ee&&n.domObserver.suppressSelectionUpdates();return}Ee&&ot&&p.endB==p.start&&(n.input.lastAndroidDelete=Date.now()),ot&&!x&&m.start()!=g.start()&&g.parentOffset==0&&m.depth==g.depth&&l.sel&&l.sel.anchor==l.sel.head&&l.sel.head==p.endA&&(p.endB-=2,g=l.doc.resolveNoCache(p.endB-l.from),setTimeout(()=>{n.someProp("handleKeyDown",function(A){return A(n,Mn(13,"Enter"))})},20));let b=p.start,w=p.endA,k,C,E;if(x){if(m.pos==g.pos)Ie&&fn<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Ut(n),20)),k=n.state.tr.delete(b,w),C=c.resolve(p.start).marksAcross(c.resolve(p.endA));else if(p.endA==p.endB&&(E=R2(m.parent.content.cut(m.parentOffset,g.parentOffset),y.parent.content.cut(y.parentOffset,p.endA-y.start()))))k=n.state.tr,E.type=="add"?k.addMark(b,w,E.mark):k.removeMark(b,w,E.mark);else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let A=m.parent.textBetween(m.parentOffset,g.parentOffset);if(n.someProp("handleTextInput",T=>T(n,b,w,A)))return;k=n.state.tr.insertText(A,b,w)}}if(k||(k=n.state.tr.replace(b,w,l.doc.slice(p.start-l.from,p.endB-l.from))),l.sel){let A=dd(n,k.doc,l.sel);A&&!(Ee&&ot&&n.composing&&A.empty&&(p.start!=p.endB||n.input.lastAndroidDelete<Date.now()-100)&&(A.head==b||A.head==k.mapping.map(w)-1)||Ie&&A.empty&&A.head==b)&&k.setSelection(A)}C&&k.ensureMarks(C),o&&k.setMeta("composition",o),n.dispatch(k.scrollIntoView())}function dd(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:vl(n,e.resolve(t.anchor),e.resolve(t.head))}function R2(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,i=t,o=r,s,a,u;for(let c=0;c<r.length;c++)i=r[c].removeFromSet(i);for(let c=0;c<t.length;c++)o=t[c].removeFromSet(o);if(i.length==1&&o.length==0)a=i[0],s="add",u=c=>c.mark(a.addToSet(c.marks));else if(i.length==0&&o.length==1)a=o[0],s="remove",u=c=>c.mark(a.removeFromSet(c.marks));else return null;let l=[];for(let c=0;c<e.childCount;c++)l.push(u(e.child(c)));if(_.from(l).eq(n))return{mark:a,type:s}}function N2(n,e,t,r,i){if(!r.parent.isTextblock||t-e<=i.pos-r.pos||Ma(r,!0,!1)<i.pos)return!1;let o=n.resolve(e);if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=n.resolve(Ma(o,!0,!0));return!s.parent.isTextblock||s.pos>t||Ma(s,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function Ma(n,e,t){let r=n.depth,i=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,i++,e=!1;if(t){let o=n.node(r).maybeChild(n.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function H2(n,e,t,r,i){let o=n.findDiffStart(e,t);if(o==null)return null;let{a:s,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(i=="end"){let u=Math.max(0,o-Math.min(s,a));r-=s+u-o}if(s<o&&n.size<e.size){let u=r<=o&&r>=s?o-r:0;o-=u,o&&o<e.size&&fd(e.textBetween(o-1,o+1))&&(o+=u?1:-1),a=o+(a-s),s=o}else if(a<o){let u=r<=o&&r>=a?o-r:0;o-=u,o&&o<n.size&&fd(n.textBetween(o-1,o+1))&&(o+=u?1:-1),s=o+(s-a),a=o}return{start:o,endA:s,endB:a}}function fd(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class I2{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new r2,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(bd),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=md(this),pd(this),this.nodeViews=gd(this),this.docView=Kc(this.state.doc,hd(this),_a(this),this.dom,this),this.domObserver=new A2(this,(r,i,o,s)=>O2(this,r,i,o,s)),this.domObserver.start(),i2(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Iu(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(bd),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let i=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(Wp(this),s=!0),this.state=e;let a=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let h=gd(this);P2(h,this.nodeViews)&&(this.nodeViews=h,o=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&Iu(this),this.editable=md(this),pd(this);let u=_a(this),l=hd(this),c=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",d=o||!this.docView.matchesNode(e.doc,l,u);(d||!e.selection.eq(i.selection))&&(s=!0);let f=c=="preserve"&&s&&this.dom.style.overflowAnchor==null&&yg(this);if(s){this.domObserver.stop();let h=d&&(Ie||Ee)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&F2(i.selection,e.selection);if(d){let p=Ee?this.trackWrites=this.domSelectionRange().focusNode:null;(o||!this.docView.update(e.doc,l,u,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=Kc(e.doc,l,u,this.dom,this)),p&&!this.trackWrites&&(h=!0)}h||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&qg(this))?Ut(this,h):(Rp(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():f&&xg(f)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof $){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&Vc(this,t.getBoundingClientRect(),e)}else Vc(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-t.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new Kp(e.slice,e.move,i<0?void 0:$.create(this.state.doc,i))}someProp(e,t){let r=this._props&&this._props[e],i;if(r!=null&&(i=t?t(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[e];if(a!=null&&(i=t?t(a):a))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let a=o[s].props[e];if(a!=null&&(i=t?t(a):a))return i}}hasFocus(){if(Ie){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&vg(this.dom),Ut(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return Eg(this,e)}coordsAtPos(e,t=1){return Ep(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let i=this.docView.posFromDOM(e,t,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return Dg(this,t||this.state,e)}pasteHTML(e,t){return di(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return di(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(o2(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],_a(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return this.docView==null}dispatchEvent(e){return a2(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){return Oe&&this.root.nodeType===11&&dg(this.dom.ownerDocument)==this.dom?M2(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function hd(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[pe.node(0,n.state.doc.content.size,e)]}function pd(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:pe.widget(n.state.selection.head,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function md(n){return!n.someProp("editable",e=>e(n.state)===!1)}function F2(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function gd(n){let e=Object.create(null);function t(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function P2(n,e){let t=0,r=0;for(let i in n){if(n[i]!=e[i])return!0;t++}for(let i in e)r++;return t!=r}function bd(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var gn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Po={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},B2=typeof navigator<"u"&&/Mac/.test(navigator.platform),$2=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var we=0;we<10;we++)gn[48+we]=gn[96+we]=String(we);for(var we=1;we<=24;we++)gn[we+111]="F"+we;for(var we=65;we<=90;we++)gn[we]=String.fromCharCode(we+32),Po[we]=String.fromCharCode(we);for(var Ta in gn)Po.hasOwnProperty(Ta)||(Po[Ta]=gn[Ta]);function z2(n){var e=B2&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||$2&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Po:gn)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const V2=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function q2(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,o,s;for(let a=0;a<e.length-1;a++){let u=e[a];if(/^(cmd|meta|m)$/i.test(u))s=!0;else if(/^a(lt)?$/i.test(u))r=!0;else if(/^(c|ctrl|control)$/i.test(u))i=!0;else if(/^s(hift)?$/i.test(u))o=!0;else if(/^mod$/i.test(u))V2?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+u)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),s&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function j2(n){let e=Object.create(null);for(let t in n)e[q2(t)]=n[t];return e}function Da(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function U2(n){return new oe({props:{handleKeyDown:Al(n)}})}function Al(n){let e=j2(n);return function(t,r){let i=z2(r),o,s=e[Da(i,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let a=e[Da(i,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=gn[r.keyCode])&&o!=i){let a=e[Da(o,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}const W2=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function Z2(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const K2=(n,e,t)=>{let r=Z2(n,t);if(!r)return!1;let i=Qp(r);if(!i){let s=r.blockRange(),a=s&&Mr(s);return a==null?!1:(e&&e(n.tr.lift(s,a).scrollIntoView()),!0)}let o=i.nodeBefore;if(!o.type.spec.isolating&&n0(n,i,e))return!0;if(r.parent.content.size==0&&(kr(o,"end")||$.isSelectable(o))){let s=pl(n.doc,r.before(),r.after(),O.empty);if(s&&s.slice.size<s.to-s.from){if(e){let a=n.tr.step(s);a.setSelection(kr(o,"end")?z.findFrom(a.doc.resolve(a.mapping.map(i.pos,-1)),-1):$.create(a.doc,i.pos-o.nodeSize)),e(a.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1};function kr(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const G2=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;o=Qp(r)}let s=o&&o.nodeBefore;return!s||!$.isSelectable(s)?!1:(e&&e(n.tr.setSelection($.create(n.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function Qp(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function J2(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const Y2=(n,e,t)=>{let r=J2(n,t);if(!r)return!1;let i=e0(r);if(!i)return!1;let o=i.nodeAfter;if(n0(n,i,e))return!0;if(r.parent.content.size==0&&(kr(o,"start")||$.isSelectable(o))){let s=pl(n.doc,r.before(),r.after(),O.empty);if(s&&s.slice.size<s.to-s.from){if(e){let a=n.tr.step(s);a.setSelection(kr(o,"start")?z.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):$.create(a.doc,a.mapping.map(i.pos))),e(a.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},X2=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;o=e0(r)}let s=o&&o.nodeAfter;return!s||!$.isSelectable(s)?!1:(e&&e(n.tr.setSelection($.create(n.doc,o.pos)).scrollIntoView()),!0)};function e0(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const Q2=(n,e)=>{let t=n.selection,r=t instanceof $,i;if(r){if(t.node.isTextblock||!xn(n.doc,t.from))return!1;i=t.from}else if(i=Os(n.doc,t.from,-1),i==null)return!1;if(e){let o=n.tr.join(i);r&&o.setSelection($.create(o.doc,i-n.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},eb=(n,e)=>{let t=n.selection,r;if(t instanceof $){if(t.node.isTextblock||!xn(n.doc,t.to))return!1;r=t.to}else if(r=Os(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},tb=(n,e)=>{let{$from:t,$to:r}=n.selection,i=t.blockRange(r),o=i&&Mr(i);return o==null?!1:(e&&e(n.tr.lift(i,o).scrollIntoView()),!0)},nb=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function t0(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const rb=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let i=t.node(-1),o=t.indexAfter(-1),s=t0(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let a=t.after(),u=n.tr.replaceWith(a,a,s.createAndFill());u.setSelection(z.near(u.doc.resolve(a),1)),e(u.scrollIntoView())}return!0},ib=(n,e)=>{let t=n.selection,{$from:r,$to:i}=t;if(t instanceof Je||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=t0(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=n.tr.insert(s,o.createAndFill());a.setSelection(B.create(a.doc,s+1)),e(a.scrollIntoView())}return!0},ob=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let o=t.before();if(hr(n.doc,o))return e&&e(n.tr.split(o).scrollIntoView()),!0}let r=t.blockRange(),i=r&&Mr(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)},sb=(n,e)=>{let{$from:t,to:r}=n.selection,i,o=t.sharedDepth(r);return o==0?!1:(i=t.before(o),e&&e(n.tr.setSelection($.create(n.doc,i))),!0)};function ab(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||xn(n.doc,e.pos))?!1:(t&&t(n.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function n0(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,o,s;if(r.type.spec.isolating||i.type.spec.isolating)return!1;if(ab(n,e,t))return!0;let a=e.parent.canReplace(e.index(),e.index()+1);if(a&&(o=(s=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&s.matchType(o[0]||i.type).validEnd){if(t){let d=e.pos+i.nodeSize,f=_.empty;for(let m=o.length-1;m>=0;m--)f=_.from(o[m].create(null,f));f=_.from(r.copy(f));let h=n.tr.step(new be(e.pos-1,d,e.pos,d,new O(f,1,0),o.length,!0)),p=d+2*o.length;xn(h.doc,p)&&h.join(p),t(h.scrollIntoView())}return!0}let u=z.findFrom(e,1),l=u&&u.$from.blockRange(u.$to),c=l&&Mr(l);if(c!=null&&c>=e.depth)return t&&t(n.tr.lift(l,c).scrollIntoView()),!0;if(a&&kr(i,"start",!0)&&kr(r,"end")){let d=r,f=[];for(;f.push(d),!d.isTextblock;)d=d.lastChild;let h=i,p=1;for(;!h.isTextblock;h=h.firstChild)p++;if(d.canReplace(d.childCount,d.childCount,h.content)){if(t){let m=_.empty;for(let y=f.length-1;y>=0;y--)m=_.from(f[y].copy(m));let g=n.tr.step(new be(e.pos-f.length,e.pos+i.nodeSize,e.pos+p,e.pos+i.nodeSize-p,new O(m,f.length,0),0,!0));t(g.scrollIntoView())}return!0}}return!1}function r0(n){return function(e,t){let r=e.selection,i=n<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(t&&t(e.tr.setSelection(B.create(e.doc,n<0?i.start(o):i.end(o)))),!0):!1}}const ub=r0(-1),lb=r0(1);function cb(n,e=null){return function(t,r){let{$from:i,$to:o}=t.selection,s=i.blockRange(o),a=s&&hl(s,n,e);return a?(r&&r(t.tr.wrap(s,a).scrollIntoView()),!0):!1}}function yd(n,e=null){return function(t,r){let i=!1;for(let o=0;o<t.selection.ranges.length&&!i;o++){let{$from:{pos:s},$to:{pos:a}}=t.selection.ranges[o];t.doc.nodesBetween(s,a,(u,l)=>{if(i)return!1;if(!(!u.isTextblock||u.hasMarkup(n,e)))if(u.type==n)i=!0;else{let c=t.doc.resolve(l),d=c.index();i=c.parent.canReplaceWith(d,d+1,n)}})}if(!i)return!1;if(r){let o=t.tr;for(let s=0;s<t.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:u}}=t.selection.ranges[s];o.setBlockType(a,u,n,e)}r(o.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function db(n,e=null){return function(t,r){let{$from:i,$to:o}=t.selection,s=i.blockRange(o),a=!1,u=s;if(!s)return!1;if(s.depth>=2&&i.node(s.depth-1).type.compatibleContent(n)&&s.startIndex==0){if(i.index(s.depth-1)==0)return!1;let c=t.doc.resolve(s.start-2);u=new Do(c,c,s.depth),s.endIndex<s.parent.childCount&&(s=new Do(i,t.doc.resolve(o.end(s.depth)),s.depth)),a=!0}let l=hl(u,n,e,s);return l?(r&&r(fb(t.tr,s,l,a,n).scrollIntoView()),!0):!1}}function fb(n,e,t,r,i){let o=_.empty;for(let c=t.length-1;c>=0;c--)o=_.from(t[c].type.create(t[c].attrs,o));n.step(new be(e.start-(r?2:0),e.end,e.start,e.end,new O(o,0,0),t.length,!0));let s=0;for(let c=0;c<t.length;c++)t[c].type==i&&(s=c+1);let a=t.length-s,u=e.start+t.length-(r?2:0),l=e.parent;for(let c=e.startIndex,d=e.endIndex,f=!0;c<d;c++,f=!1)!f&&hr(n.doc,u,a)&&(n.split(u,a),u+=2*a),u+=l.child(c).nodeSize;return n}function hb(n){return function(e,t){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,s=>s.childCount>0&&s.firstChild.type==n);return o?t?r.node(o.depth-1).type==n?pb(e,t,n,o):mb(e,t,o):!0:!1}}function pb(n,e,t,r){let i=n.tr,o=r.end,s=r.$to.end(r.depth);o<s&&(i.step(new be(o-1,s,o,s,new O(_.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new Do(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));const a=Mr(r);if(a==null)return!1;i.lift(r,a);let u=i.mapping.map(o,-1)-1;return xn(i.doc,u)&&i.join(u),e(i.scrollIntoView()),!0}function mb(n,e,t){let r=n.tr,i=t.parent;for(let h=t.end,p=t.endIndex-1,m=t.startIndex;p>m;p--)h-=i.child(p).nodeSize,r.delete(h-1,h+1);let o=r.doc.resolve(t.start),s=o.nodeAfter;if(r.mapping.map(t.end)!=t.start+o.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,u=t.endIndex==i.childCount,l=o.node(-1),c=o.index(-1);if(!l.canReplace(c+(a?0:1),c+1,s.content.append(u?_.empty:_.from(i))))return!1;let d=o.pos,f=d+s.nodeSize;return r.step(new be(d-(a?1:0),f+(u?1:0),d+1,f-1,new O((a?_.empty:_.from(i.copy(_.empty))).append(u?_.empty:_.from(i.copy(_.empty))),a?0:1,u?0:1),a?0:1)),e(r.scrollIntoView()),!0}function gb(n){return function(e,t){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,l=>l.childCount>0&&l.firstChild.type==n);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let a=o.parent,u=a.child(s-1);if(u.type!=n)return!1;if(t){let l=u.lastChild&&u.lastChild.type==a.type,c=_.from(l?n.create():null),d=new O(_.from(n.create(null,_.from(a.type.create(null,c)))),l?3:1,0),f=o.start,h=o.end;t(e.tr.step(new be(f-(l?3:1),h,f,h,d,1,!0)).scrollIntoView())}return!0}}function Fs(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:i}=t,{storedMarks:o}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),filterTransaction:e.filterTransaction,plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=t.selection,i=t.doc,o=t.storedMarks,t}}}class Ps{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:i}=t,{tr:o}=r,s=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([a,u])=>[a,(...c)=>{const d=u(...c)(s);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a=[],u=!!e,l=e||o.tr,c=()=>(!u&&t&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(l),a.every(f=>f===!0)),d={...Object.fromEntries(Object.entries(r).map(([f,h])=>[f,(...m)=>{const g=this.buildProps(l,t),y=h(...m)(g);return a.push(y),d}])),run:c};return d}createCan(e){const{rawCommands:t,state:r}=this,i=!1,o=e||r.tr,s=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(t).map(([u,l])=>[u,(...c)=>l(...c)({...s,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(e,t=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a={tr:e,editor:i,view:s,state:Fs({state:o,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([u,l])=>[u,(...c)=>l(...c)(a)]))}};return a}}let bb=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(i=>i!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}};function H(n,e,t){return n.config[e]===void 0&&n.parent?H(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?H(n.parent,e,t):null}):n.config[e]}function Bs(n){const e=n.filter(i=>i.type==="extension"),t=n.filter(i=>i.type==="node"),r=n.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function i0(n){const e=[],{nodeExtensions:t,markExtensions:r}=Bs(n),i=[...t,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},u=H(s,"addGlobalAttributes",a);if(!u)return;u().forEach(c=>{c.types.forEach(d=>{Object.entries(c.attributes).forEach(([f,h])=>{e.push({type:d,name:f,attribute:{...o,...h}})})})})}),i.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},u=H(s,"addAttributes",a);if(!u)return;const l=u();Object.entries(l).forEach(([c,d])=>{const f={...o,...d};typeof(f==null?void 0:f.default)=="function"&&(f.default=f.default()),f!=null&&f.isRequired&&(f==null?void 0:f.default)===void 0&&delete f.default,e.push({type:s.name,name:c,attribute:f})})}),e}function xe(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function J(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}if(i==="class"){const a=o?o.split(" "):[],u=r[i]?r[i].split(" "):[],l=a.filter(c=>!u.includes(c));r[i]=[...u,...l].join(" ")}else i==="style"?r[i]=[r[i],o].join("; "):r[i]=o}),r},{})}function Fu(n,e){return e.filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>J(t,r),{})}function o0(n){return typeof n=="function"}function W(n,e=void 0,...t){return o0(n)?e?n.bind(e)(...t):n(...t):n}function yb(n={}){return Object.keys(n).length===0&&n.constructor===Object}function xb(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function xd(n,e){return n.style?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const i=e.reduce((o,s)=>{const a=s.attribute.parseHTML?s.attribute.parseHTML(t):xb(t.getAttribute(s.name));return a==null?o:{...o,[s.name]:a}},{});return{...r,...i}}}}function vd(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&yb(t)?!1:t!=null))}function vb(n,e){var t;const r=i0(n),{nodeExtensions:i,markExtensions:o}=Bs(n),s=(t=i.find(l=>H(l,"topNode")))===null||t===void 0?void 0:t.name,a=Object.fromEntries(i.map(l=>{const c=r.filter(y=>y.type===l.name),d={name:l.name,options:l.options,storage:l.storage,editor:e},f=n.reduce((y,x)=>{const v=H(x,"extendNodeSchema",d);return{...y,...v?v(l):{}}},{}),h=vd({...f,content:W(H(l,"content",d)),marks:W(H(l,"marks",d)),group:W(H(l,"group",d)),inline:W(H(l,"inline",d)),atom:W(H(l,"atom",d)),selectable:W(H(l,"selectable",d)),draggable:W(H(l,"draggable",d)),code:W(H(l,"code",d)),defining:W(H(l,"defining",d)),isolating:W(H(l,"isolating",d)),attrs:Object.fromEntries(c.map(y=>{var x;return[y.name,{default:(x=y==null?void 0:y.attribute)===null||x===void 0?void 0:x.default}]}))}),p=W(H(l,"parseHTML",d));p&&(h.parseDOM=p.map(y=>xd(y,c)));const m=H(l,"renderHTML",d);m&&(h.toDOM=y=>m({node:y,HTMLAttributes:Fu(y,c)}));const g=H(l,"renderText",d);return g&&(h.toText=g),[l.name,h]})),u=Object.fromEntries(o.map(l=>{const c=r.filter(g=>g.type===l.name),d={name:l.name,options:l.options,storage:l.storage,editor:e},f=n.reduce((g,y)=>{const x=H(y,"extendMarkSchema",d);return{...g,...x?x(l):{}}},{}),h=vd({...f,inclusive:W(H(l,"inclusive",d)),excludes:W(H(l,"excludes",d)),group:W(H(l,"group",d)),spanning:W(H(l,"spanning",d)),code:W(H(l,"code",d)),attrs:Object.fromEntries(c.map(g=>{var y;return[g.name,{default:(y=g==null?void 0:g.attribute)===null||y===void 0?void 0:y.default}]}))}),p=W(H(l,"parseHTML",d));p&&(h.parseDOM=p.map(g=>xd(g,c)));const m=H(l,"renderHTML",d);return m&&(h.toDOM=g=>m({mark:g,HTMLAttributes:Fu(g,c)})),[l.name,h]}));return new rp({topNode:s,nodes:a,marks:u})}function La(n,e){return e.nodes[n]||e.marks[n]||null}function kd(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}const kb=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(i,o,s,a)=>{var u,l;const c=((l=(u=i.type.spec).toText)===null||l===void 0?void 0:l.call(u,{node:i,pos:o,parent:s,index:a}))||i.textContent||"%leaf%";t+=c.slice(0,Math.max(0,r-o))}),t};function _l(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class $s{constructor(e){this.find=e.find,this.handler=e.handler}}const wb=(n,e)=>{if(_l(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function Oa(n){var e;const{editor:t,from:r,to:i,text:o,rules:s,plugin:a}=n,{view:u}=t;if(u.composing)return!1;const l=u.state.doc.resolve(r);if(l.parent.type.spec.code||!((e=l.nodeBefore||l.nodeAfter)===null||e===void 0)&&e.marks.find(f=>f.type.spec.code))return!1;let c=!1;const d=kb(l)+o;return s.forEach(f=>{if(c)return;const h=wb(d,f.find);if(!h)return;const p=u.state.tr,m=Fs({state:u.state,transaction:p}),g={from:r-(h[0].length-o.length),to:i},{commands:y,chain:x,can:v}=new Ps({editor:t,state:m});f.handler({state:m,range:g,match:h,commands:y,chain:x,can:v})===null||!p.steps.length||(p.setMeta(a,{transform:p,from:r,to:i,text:o}),u.dispatch(p),c=!0)}),c}function Cb(n){const{editor:e,rules:t}=n,r=new oe({state:{init(){return null},apply(i,o){const s=i.getMeta(r);return s||(i.selectionSet||i.docChanged?null:o)}},props:{handleTextInput(i,o,s,a){return Oa({editor:e,from:o,to:s,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&Oa({editor:e,from:o.pos,to:o.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?Oa({editor:e,from:s.pos,to:s.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function Sb(n){return typeof n=="number"}class Eb{constructor(e){this.find=e.find,this.handler=e.handler}}const Ab=(n,e)=>{if(_l(e))return[...n.matchAll(e)];const t=e(n);return t?t.map(r=>{const i=[r.text];return i.index=r.index,i.input=n,i.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(r.replaceWith)),i}):[]};function _b(n){const{editor:e,state:t,from:r,to:i,rule:o,pasteEvent:s,dropEvent:a}=n,{commands:u,chain:l,can:c}=new Ps({editor:e,state:t}),d=[];return t.doc.nodesBetween(r,i,(h,p)=>{if(!h.isTextblock||h.type.spec.code)return;const m=Math.max(r,p),g=Math.min(i,p+h.content.size),y=h.textBetween(m-p,g-p,void 0,"");Ab(y,o.find).forEach(v=>{if(v.index===void 0)return;const b=m+v.index+1,w=b+v[0].length,k={from:t.tr.mapping.map(b),to:t.tr.mapping.map(w)},C=o.handler({state:t,range:k,match:v,commands:u,chain:l,can:c,pasteEvent:s,dropEvent:a});d.push(C)})}),d.every(h=>h!==null)}function Mb(n){const{editor:e,rules:t}=n;let r=null,i=!1,o=!1,s=new ClipboardEvent("paste"),a=new DragEvent("drop");return t.map(l=>new oe({view(c){const d=f=>{var h;r=!((h=c.dom.parentElement)===null||h===void 0)&&h.contains(f.target)?c.dom.parentElement:null};return window.addEventListener("dragstart",d),{destroy(){window.removeEventListener("dragstart",d)}}},props:{handleDOMEvents:{drop:(c,d)=>(o=r===c.dom.parentElement,a=d,!1),paste:(c,d)=>{var f;const h=(f=d.clipboardData)===null||f===void 0?void 0:f.getData("text/html");return s=d,i=!!(h!=null&&h.includes("data-pm-slice")),!1}}},appendTransaction:(c,d,f)=>{const h=c[0],p=h.getMeta("uiEvent")==="paste"&&!i,m=h.getMeta("uiEvent")==="drop"&&!o;if(!p&&!m)return;const g=d.doc.content.findDiffStart(f.doc.content),y=d.doc.content.findDiffEnd(f.doc.content);if(!Sb(g)||!y||g===y.b)return;const x=f.tr,v=Fs({state:f,transaction:x});if(!(!_b({editor:e,state:v,from:Math.max(g-1,0),to:y.b-1,rule:l,pasteEvent:s,dropEvent:a})||!x.steps.length))return a=new DragEvent("drop"),s=new ClipboardEvent("paste"),x}}))}function Tb(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return[...new Set(e)]}class dr{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=dr.resolve(e),this.schema=vb(this.extensions,t),this.extensions.forEach(r=>{var i;this.editor.extensionStorage[r.name]=r.storage;const o={name:r.name,options:r.options,storage:r.storage,editor:this.editor,type:La(r.name,this.schema)};r.type==="mark"&&(!((i=W(H(r,"keepOnSplit",o)))!==null&&i!==void 0)||i)&&this.splittableMarks.push(r.name);const s=H(r,"onBeforeCreate",o);s&&this.editor.on("beforeCreate",s);const a=H(r,"onCreate",o);a&&this.editor.on("create",a);const u=H(r,"onUpdate",o);u&&this.editor.on("update",u);const l=H(r,"onSelectionUpdate",o);l&&this.editor.on("selectionUpdate",l);const c=H(r,"onTransaction",o);c&&this.editor.on("transaction",c);const d=H(r,"onFocus",o);d&&this.editor.on("focus",d);const f=H(r,"onBlur",o);f&&this.editor.on("blur",f);const h=H(r,"onDestroy",o);h&&this.editor.on("destroy",h)})}static resolve(e){const t=dr.sort(dr.flatten(e)),r=Tb(t.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},i=H(t,"addExtensions",r);return i?[t,...this.flatten(i())]:t}).flat(10)}static sort(e){return e.sort((r,i)=>{const o=H(r,"priority")||100,s=H(i,"priority")||100;return o>s?-1:o<s?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:La(t.name,this.schema)},i=H(t,"addCommands",r);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,t=dr.sort([...this.extensions].reverse()),r=[],i=[],o=t.map(s=>{const a={name:s.name,options:s.options,storage:s.storage,editor:e,type:La(s.name,this.schema)},u=[],l=H(s,"addKeyboardShortcuts",a);let c={};if(s.type==="mark"&&s.config.exitable&&(c.ArrowRight=()=>de.handleExit({editor:e,mark:s})),l){const m=Object.fromEntries(Object.entries(l()).map(([g,y])=>[g,()=>y({editor:e})]));c={...c,...m}}const d=U2(c);u.push(d);const f=H(s,"addInputRules",a);kd(s,e.options.enableInputRules)&&f&&r.push(...f());const h=H(s,"addPasteRules",a);kd(s,e.options.enablePasteRules)&&h&&i.push(...h());const p=H(s,"addProseMirrorPlugins",a);if(p){const m=p();u.push(...m)}return u}).flat();return[Cb({editor:e,rules:r}),...Mb({editor:e,rules:i}),...o]}get attributes(){return i0(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Bs(this.extensions);return Object.fromEntries(t.filter(r=>!!H(r,"addNodeView")).map(r=>{const i=this.attributes.filter(u=>u.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:e,type:xe(r.name,this.schema)},s=H(r,"addNodeView",o);if(!s)return[];const a=(u,l,c,d)=>{const f=Fu(u,i);return s()({editor:e,node:u,getPos:c,decorations:d,HTMLAttributes:f,extension:r})};return[r.name,a]}))}}function Db(n){return Object.prototype.toString.call(n).slice(8,-1)}function Ra(n){return Db(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function zs(n,e){const t={...n};return Ra(n)&&Ra(e)&&Object.keys(e).forEach(r=>{Ra(e[r])?r in n?t[r]=zs(n[r],e[r]):Object.assign(t,{[r]:e[r]}):Object.assign(t,{[r]:e[r]})}),t}class re{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=W(H(this,"addOptions",{name:this.name}))),this.storage=W(H(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new re(e)}configure(e={}){const t=this.extend();return t.options=zs(this.options,e),t.storage=W(H(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new re(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=W(H(t,"addOptions",{name:t.name})),t.storage=W(H(t,"addStorage",{name:t.name,options:t.options})),t}}function Vs(n,e,t){const{from:r,to:i}=e,{blockSeparator:o=`

`,textSerializers:s={}}=t||{};let a="",u=!0;return n.nodesBetween(r,i,(l,c,d,f)=>{var h;const p=s==null?void 0:s[l.type.name];p?(l.isBlock&&!u&&(a+=o,u=!0),d&&(a+=p({node:l,pos:c,parent:d,index:f,range:e}))):l.isText?(a+=(h=l==null?void 0:l.text)===null||h===void 0?void 0:h.slice(Math.max(r,c)-c,i-c),u=!1):l.isBlock&&!u&&(a+=o,u=!0)}),a}function s0(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const Lb=re.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new oe({key:new ae("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:i}=e,{ranges:o}=i,s=Math.min(...o.map(c=>c.$from.pos)),a=Math.max(...o.map(c=>c.$to.pos)),u=s0(t);return Vs(r,{from:s,to:a},{textSerializers:u})}}})]}}),Ob=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),Rb=(n=!1)=>({commands:e})=>e.setContent("",n),Nb=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:i}=r;return t&&i.forEach(({$from:o,$to:s})=>{n.doc.nodesBetween(o.pos,s.pos,(a,u)=>{if(a.type.isText)return;const{doc:l,mapping:c}=e,d=l.resolve(c.map(u)),f=l.resolve(c.map(u+a.nodeSize)),h=d.blockRange(f);if(!h)return;const p=Mr(h);if(a.type.isTextblock){const{defaultType:m}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(h.start,m)}(p||p===0)&&e.lift(h,p)})}),!0},Hb=n=>e=>n(e),Ib=()=>({state:n,dispatch:e})=>ib(n,e),Fb=(n,e)=>({editor:t,tr:r})=>{const{state:i}=t,o=i.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const s=r.mapping.map(e);return r.insert(s,o.content),r.setSelection(new B(r.doc.resolve(s-1))),!0},Pb=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const i=n.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(e){const a=i.before(o),u=i.after(o);n.delete(a,u).scrollIntoView()}return!0}return!1},Bb=n=>({tr:e,state:t,dispatch:r})=>{const i=xe(n,t.schema),o=e.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(r){const u=o.before(s),l=o.after(s);e.delete(u,l).scrollIntoView()}return!0}return!1},$b=n=>({tr:e,dispatch:t})=>{const{from:r,to:i}=n;return t&&e.delete(r,i),!0},zb=()=>({state:n,dispatch:e})=>W2(n,e),Vb=()=>({commands:n})=>n.keyboardShortcut("Enter"),qb=()=>({state:n,dispatch:e})=>rb(n,e);function Bo(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>t.strict?e[i]===n[i]:_l(e[i])?e[i].test(n[i]):e[i]===n[i]):!0}function Pu(n,e,t={}){return n.find(r=>r.type===e&&Bo(r.attrs,t))}function jb(n,e,t={}){return!!Pu(n,e,t)}function Ml(n,e,t={}){if(!n||!e)return;let r=n.parent.childAfter(n.parentOffset);if(n.parentOffset===r.offset&&r.offset!==0&&(r=n.parent.childBefore(n.parentOffset)),!r.node)return;const i=Pu([...r.node.marks],e,t);if(!i)return;let o=r.index,s=n.start()+r.offset,a=o+1,u=s+r.node.nodeSize;for(Pu([...r.node.marks],e,t);o>0&&i.isInSet(n.parent.child(o-1).marks);)o-=1,s-=n.parent.child(o).nodeSize;for(;a<n.parent.childCount&&jb([...n.parent.child(a).marks],e,t);)u+=n.parent.child(a).nodeSize,a+=1;return{from:s,to:u}}function kn(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const Ub=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const o=kn(n,r.schema),{doc:s,selection:a}=t,{$from:u,from:l,to:c}=a;if(i){const d=Ml(u,o,e);if(d&&d.from<=l&&d.to>=c){const f=B.create(s,d.from,d.to);t.setSelection(f)}}return!0},Wb=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function Tl(n){return n instanceof B}function jt(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function a0(n,e=null){if(!e)return null;const t=z.atStart(n),r=z.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const i=t.from,o=r.to;return e==="all"?B.create(n,jt(0,i,o),jt(n.content.size,i,o)):B.create(n,jt(e,i,o),jt(e,i,o))}function Dl(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Zb=(n=null,e={})=>({editor:t,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const s=()=>{Dl()&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(o&&n===null&&!Tl(t.state.selection))return s(),!0;const a=a0(i.doc,n)||t.state.selection,u=t.state.selection.eq(a);return o&&(u||i.setSelection(a),u&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},Kb=(n,e)=>t=>n.every((r,i)=>e(r,{...t,index:i})),Gb=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e);function wd(n){const e=`<body>${n}</body>`;return new window.DOMParser().parseFromString(e,"text/html").body}function $o(n,e,t){if(t={slice:!0,parseOptions:{},...t},typeof n=="object"&&n!==null)try{return Array.isArray(n)&&n.length>0?_.fromArray(n.map(r=>e.nodeFromJSON(r))):e.nodeFromJSON(n)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",r),$o("",e,t)}if(typeof n=="string"){const r=Mi.fromSchema(e);return t.slice?r.parseSlice(wd(n),t.parseOptions).content:r.parse(wd(n),t.parseOptions)}return $o("",e,t)}function Jb(n,e,t){const r=n.steps.length-1;if(r<e)return;const i=n.steps[r];if(!(i instanceof ke||i instanceof be))return;const o=n.mapping.maps[r];let s=0;o.forEach((a,u,l,c)=>{s===0&&(s=c)}),n.setSelection(z.near(n.doc.resolve(s),t))}const Yb=n=>n.toString().startsWith("<"),Xb=(n,e,t)=>({tr:r,dispatch:i,editor:o})=>{if(i){t={parseOptions:{},updateSelection:!0,...t};const s=$o(e,o.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions}});if(s.toString()==="<>")return!0;let{from:a,to:u}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},l=!0,c=!0;if((Yb(s)?s:[s]).forEach(f=>{f.check(),l=l?f.isText&&f.marks.length===0:!1,c=c?f.isBlock:!1}),a===u&&c){const{parent:f}=r.doc.resolve(a);f.isTextblock&&!f.type.spec.code&&!f.childCount&&(a-=1,u+=1)}l?Array.isArray(e)?r.insertText(e.map(f=>f.text||"").join(""),a,u):typeof e=="object"&&e&&e.text?r.insertText(e.text,a,u):r.insertText(e,a,u):r.replaceWith(a,u,s),t.updateSelection&&Jb(r,r.steps.length-1,-1)}return!0},Qb=()=>({state:n,dispatch:e})=>Q2(n,e),ey=()=>({state:n,dispatch:e})=>eb(n,e),ty=()=>({state:n,dispatch:e})=>K2(n,e),ny=()=>({state:n,dispatch:e})=>Y2(n,e),ry=()=>({tr:n,state:e,dispatch:t})=>{try{const r=Os(e.doc,e.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch{return!1}},iy=()=>({state:n,dispatch:e,tr:t})=>{try{const r=Os(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}};function Ll(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function oy(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,i,o,s;for(let a=0;a<e.length-1;a+=1){const u=e[a];if(/^(cmd|meta|m)$/i.test(u))s=!0;else if(/^a(lt)?$/i.test(u))r=!0;else if(/^(c|ctrl|control)$/i.test(u))i=!0;else if(/^s(hift)?$/i.test(u))o=!0;else if(/^mod$/i.test(u))Dl()||Ll()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${u}`)}return r&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),s&&(t=`Meta-${t}`),o&&(t=`Shift-${t}`),t}const sy=n=>({editor:e,view:t,tr:r,dispatch:i})=>{const o=oy(n).split(/-(?!$)/),s=o.find(l=>!["Alt","Ctrl","Meta","Shift"].includes(l)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),u=e.captureTransaction(()=>{t.someProp("handleKeyDown",l=>l(t,a))});return u==null||u.steps.forEach(l=>{const c=l.map(r.mapping);c&&i&&r.maybeStep(c)}),!0};function hi(n,e,t={}){const{from:r,to:i,empty:o}=n.selection,s=e?xe(e,n.schema):null,a=[];n.doc.nodesBetween(r,i,(d,f)=>{if(d.isText)return;const h=Math.max(r,f),p=Math.min(i,f+d.nodeSize);a.push({node:d,from:h,to:p})});const u=i-r,l=a.filter(d=>s?s.name===d.node.type.name:!0).filter(d=>Bo(d.node.attrs,t,{strict:!1}));return o?!!l.length:l.reduce((d,f)=>d+f.to-f.from,0)>=u}const ay=(n,e={})=>({state:t,dispatch:r})=>{const i=xe(n,t.schema);return hi(t,i,e)?tb(t,r):!1},uy=()=>({state:n,dispatch:e})=>ob(n,e),ly=n=>({state:e,dispatch:t})=>{const r=xe(n,e.schema);return hb(r)(e,t)},cy=()=>({state:n,dispatch:e})=>nb(n,e);function qs(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function Cd(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,i)=>(t.includes(i)||(r[i]=n[i]),r),{})}const dy=(n,e)=>({tr:t,state:r,dispatch:i})=>{let o=null,s=null;const a=qs(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(o=xe(n,r.schema)),a==="mark"&&(s=kn(n,r.schema)),i&&t.selection.ranges.forEach(u=>{r.doc.nodesBetween(u.$from.pos,u.$to.pos,(l,c)=>{o&&o===l.type&&t.setNodeMarkup(c,void 0,Cd(l.attrs,e)),s&&l.marks.length&&l.marks.forEach(d=>{s===d.type&&t.addMark(c,c+l.nodeSize,s.create(Cd(d.attrs,e)))})})}),!0):!1},fy=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),hy=()=>({tr:n,commands:e})=>e.setTextSelection({from:0,to:n.doc.content.size}),py=()=>({state:n,dispatch:e})=>G2(n,e),my=()=>({state:n,dispatch:e})=>X2(n,e),gy=()=>({state:n,dispatch:e})=>sb(n,e),by=()=>({state:n,dispatch:e})=>lb(n,e),yy=()=>({state:n,dispatch:e})=>ub(n,e);function u0(n,e,t={}){return $o(n,e,{slice:!1,parseOptions:t})}const xy=(n,e=!1,t={})=>({tr:r,editor:i,dispatch:o})=>{const{doc:s}=r,a=u0(n,i.schema,t);return o&&r.replaceWith(0,s.content.size,a).setMeta("preventUpdate",!e),!0};function Li(n,e){const t=kn(e,n.schema),{from:r,to:i,empty:o}=n.selection,s=[];o?(n.storedMarks&&s.push(...n.storedMarks),s.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,i,u=>{s.push(...u.marks)});const a=s.find(u=>u.type.name===t.name);return a?{...a.attrs}:{}}function vy(n,e){const t=new ml(n);return e.forEach(r=>{r.steps.forEach(i=>{t.step(i)})}),t}function ky(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function wy(n,e,t){const r=[];return n.nodesBetween(e.from,e.to,(i,o)=>{t(i)&&r.push({node:i,pos:o})}),r}function l0(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function Ol(n){return e=>l0(e.$from,n)}function Rl(n,e){const t=xt.fromSchema(e).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(t),i.innerHTML}function Cy(n,e){const t={from:0,to:n.content.size};return Vs(n,t,e)}function Sy(n,e){const t=xe(e,n.schema),{from:r,to:i}=n.selection,o=[];n.doc.nodesBetween(r,i,a=>{o.push(a)});const s=o.reverse().find(a=>a.type.name===t.name);return s?{...s.attrs}:{}}function c0(n,e){const t=qs(typeof e=="string"?e:e.name,n.schema);return t==="node"?Sy(n,e):t==="mark"?Li(n,e):{}}function Ey(n,e=JSON.stringify){const t={};return n.filter(r=>{const i=e(r);return Object.prototype.hasOwnProperty.call(t,i)?!1:t[i]=!0})}function Ay(n){const e=Ey(n);return e.length===1?e:e.filter((t,r)=>!e.filter((o,s)=>s!==r).some(o=>t.oldRange.from>=o.oldRange.from&&t.oldRange.to<=o.oldRange.to&&t.newRange.from>=o.newRange.from&&t.newRange.to<=o.newRange.to))}function _y(n){const{mapping:e,steps:t}=n,r=[];return e.maps.forEach((i,o)=>{const s=[];if(i.ranges.length)i.forEach((a,u)=>{s.push({from:a,to:u})});else{const{from:a,to:u}=t[o];if(a===void 0||u===void 0)return;s.push({from:a,to:u})}s.forEach(({from:a,to:u})=>{const l=e.slice(o).map(a,-1),c=e.slice(o).map(u),d=e.invert().map(l,-1),f=e.invert().map(c);r.push({oldRange:{from:d,to:f},newRange:{from:l,to:c}})})}),Ay(r)}function Nl(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(i=>{const o=t.resolve(n-1),s=Ml(o,i.type);s&&r.push({mark:i,...s})}):t.nodesBetween(n,e,(i,o)=>{r.push(...i.marks.map(s=>({from:o,to:o+i.nodeSize,mark:s})))}),r}function vo(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const i=n.find(o=>o.type===e&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}function Bu(n,e,t={}){const{empty:r,ranges:i}=n.selection,o=e?kn(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(d=>o?o.name===d.type.name:!0).find(d=>Bo(d.attrs,t,{strict:!1}));let s=0;const a=[];if(i.forEach(({$from:d,$to:f})=>{const h=d.pos,p=f.pos;n.doc.nodesBetween(h,p,(m,g)=>{if(!m.isText&&!m.marks.length)return;const y=Math.max(h,g),x=Math.min(p,g+m.nodeSize),v=x-y;s+=v,a.push(...m.marks.map(b=>({mark:b,from:y,to:x})))})}),s===0)return!1;const u=a.filter(d=>o?o.name===d.mark.type.name:!0).filter(d=>Bo(d.mark.attrs,t,{strict:!1})).reduce((d,f)=>d+f.to-f.from,0),l=a.filter(d=>o?d.mark.type!==o&&d.mark.type.excludes(o):!0).reduce((d,f)=>d+f.to-f.from,0);return(u>0?u+l:u)>=s}function My(n,e,t={}){if(!e)return hi(n,null,t)||Bu(n,null,t);const r=qs(e,n.schema);return r==="node"?hi(n,e,t):r==="mark"?Bu(n,e,t):!1}function Sd(n,e){const{nodeExtensions:t}=Bs(e),r=t.find(s=>s.name===n);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=W(H(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function Ty(n){var e;const t=(e=n.type.createAndFill())===null||e===void 0?void 0:e.toJSON(),r=n.toJSON();return JSON.stringify(t)===JSON.stringify(r)}function d0(n){return n instanceof $}function js(n,e,t){const i=n.state.doc.content.size,o=jt(e,0,i),s=jt(t,0,i),a=n.coordsAtPos(o),u=n.coordsAtPos(s,-1),l=Math.min(a.top,u.top),c=Math.max(a.bottom,u.bottom),d=Math.min(a.left,u.left),f=Math.max(a.right,u.right),h=f-d,p=c-l,y={top:l,bottom:c,left:d,right:f,width:h,height:p,x:d,y:l};return{...y,toJSON:()=>y}}function Dy(n,e,t){var r;const{selection:i}=e;let o=null;if(Tl(i)&&(o=i.$cursor),o){const a=(r=n.storedMarks)!==null&&r!==void 0?r:o.marks();return!!t.isInSet(a)||!a.some(u=>u.type.excludes(t))}const{ranges:s}=i;return s.some(({$from:a,$to:u})=>{let l=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,u.pos,(c,d,f)=>{if(l)return!1;if(c.isInline){const h=!f||f.type.allowsMarkType(t),p=!!t.isInSet(c.marks)||!c.marks.some(m=>m.type.excludes(t));l=h&&p}return!l}),l})}const Ly=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const{selection:o}=t,{empty:s,ranges:a}=o,u=kn(n,r.schema);if(i)if(s){const l=Li(r,u);t.addStoredMark(u.create({...l,...e}))}else a.forEach(l=>{const c=l.$from.pos,d=l.$to.pos;r.doc.nodesBetween(c,d,(f,h)=>{const p=Math.max(h,c),m=Math.min(h+f.nodeSize,d);f.marks.find(y=>y.type===u)?f.marks.forEach(y=>{u===y.type&&t.addMark(p,m,u.create({...y.attrs,...e}))}):t.addMark(p,m,u.create(e))})});return Dy(r,t,u)},Oy=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),Ry=(n,e={})=>({state:t,dispatch:r,chain:i})=>{const o=xe(n,t.schema);return o.isTextblock?i().command(({commands:s})=>yd(o,e)(t)?!0:s.clearNodes()).command(({state:s})=>yd(o,e)(s,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Ny=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,i=jt(n,0,r.content.size),o=$.create(r,i);e.setSelection(o)}return!0},Hy=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:i,to:o}=typeof n=="number"?{from:n,to:n}:n,s=B.atStart(r).from,a=B.atEnd(r).to,u=jt(i,s,a),l=jt(o,s,a),c=B.create(r,u,l);e.setSelection(c)}return!0},Iy=n=>({state:e,dispatch:t})=>{const r=xe(n,e.schema);return gb(r)(e,t)};function Ed(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(i=>e==null?void 0:e.includes(i.type.name));n.tr.ensureMarks(r)}}const Fy=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:i})=>{const{selection:o,doc:s}=e,{$from:a,$to:u}=o,l=i.extensionManager.attributes,c=vo(l,a.node().type.name,a.node().attrs);if(o instanceof $&&o.node.isBlock)return!a.parentOffset||!hr(s,a.pos)?!1:(r&&(n&&Ed(t,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(r){const d=u.parentOffset===u.parent.content.size;o instanceof B&&e.deleteSelection();const f=a.depth===0?void 0:ky(a.node(-1).contentMatchAt(a.indexAfter(-1)));let h=d&&f?[{type:f,attrs:c}]:void 0,p=hr(e.doc,e.mapping.map(a.pos),1,h);if(!h&&!p&&hr(e.doc,e.mapping.map(a.pos),1,f?[{type:f}]:void 0)&&(p=!0,h=f?[{type:f,attrs:c}]:void 0),p&&(e.split(e.mapping.map(a.pos),1,h),f&&!d&&!a.parentOffset&&a.parent.type!==f)){const m=e.mapping.map(a.before()),g=e.doc.resolve(m);a.node(-1).canReplaceWith(g.index(),g.index()+1,f)&&e.setNodeMarkup(e.mapping.map(a.before()),f)}n&&Ed(t,i.extensionManager.splittableMarks),e.scrollIntoView()}return!0},Py=n=>({tr:e,state:t,dispatch:r,editor:i})=>{var o;const s=xe(n,t.schema),{$from:a,$to:u}=t.selection,l=t.selection.node;if(l&&l.isBlock||a.depth<2||!a.sameParent(u))return!1;const c=a.node(-1);if(c.type!==s)return!1;const d=i.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==s||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let g=_.empty;const y=a.index(-1)?1:a.index(-2)?2:3;for(let C=a.depth-y;C>=a.depth-3;C-=1)g=_.from(a.node(C).copy(g));const x=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,v=vo(d,a.node().type.name,a.node().attrs),b=((o=s.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(v))||void 0;g=g.append(_.from(s.createAndFill(null,b)||void 0));const w=a.before(a.depth-(y-1));e.replace(w,a.after(-x),new O(g,4-y,0));let k=-1;e.doc.nodesBetween(w,e.doc.content.size,(C,E)=>{if(k>-1)return!1;C.isTextblock&&C.content.size===0&&(k=E+1)}),k>-1&&e.setSelection(B.near(e.doc.resolve(k))),e.scrollIntoView()}return!0}const f=u.pos===a.end()?c.contentMatchAt(0).defaultType:null,h=vo(d,c.type.name,c.attrs),p=vo(d,a.node().type.name,a.node().attrs);e.delete(a.pos,u.pos);const m=f?[{type:s,attrs:h},{type:f,attrs:p}]:[{type:s,attrs:h}];if(!hr(e.doc,a.pos,2))return!1;if(r){const{selection:g,storedMarks:y}=t,{splittableMarks:x}=i.extensionManager,v=y||g.$to.parentOffset&&g.$from.marks();if(e.split(a.pos,2,m).scrollIntoView(),!v||!r)return!0;const b=v.filter(w=>x.includes(w.type.name));e.ensureMarks(b)}return!0},Na=(n,e)=>{const t=Ol(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===(i==null?void 0:i.type)&&xn(n.doc,t.pos)&&n.join(t.pos),!0},Ha=(n,e)=>{const t=Ol(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===(i==null?void 0:i.type)&&xn(n.doc,r)&&n.join(r),!0},By=(n,e,t,r={})=>({editor:i,tr:o,state:s,dispatch:a,chain:u,commands:l,can:c})=>{const{extensions:d,splittableMarks:f}=i.extensionManager,h=xe(n,s.schema),p=xe(e,s.schema),{selection:m,storedMarks:g}=s,{$from:y,$to:x}=m,v=y.blockRange(x),b=g||m.$to.parentOffset&&m.$from.marks();if(!v)return!1;const w=Ol(k=>Sd(k.type.name,d))(m);if(v.depth>=1&&w&&v.depth-w.depth<=1){if(w.node.type===h)return l.liftListItem(p);if(Sd(w.node.type.name,d)&&h.validContent(w.node.content)&&a)return u().command(()=>(o.setNodeMarkup(w.pos,h),!0)).command(()=>Na(o,h)).command(()=>Ha(o,h)).run()}return!t||!b||!a?u().command(()=>c().wrapInList(h,r)?!0:l.clearNodes()).wrapInList(h,r).command(()=>Na(o,h)).command(()=>Ha(o,h)).run():u().command(()=>{const k=c().wrapInList(h,r),C=b.filter(E=>f.includes(E.type.name));return o.ensureMarks(C),k?!0:l.clearNodes()}).wrapInList(h,r).command(()=>Na(o,h)).command(()=>Ha(o,h)).run()},$y=(n,e={},t={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=t,s=kn(n,r.schema);return Bu(r,s,e)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,e)},zy=(n,e,t={})=>({state:r,commands:i})=>{const o=xe(n,r.schema),s=xe(e,r.schema);return hi(r,o,t)?i.setNode(s):i.setNode(o,t)},Vy=(n,e={})=>({state:t,commands:r})=>{const i=xe(n,t.schema);return hi(t,i,e)?r.lift(i):r.wrapIn(i,e)},qy=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const i=t[r];let o;if(i.spec.isInputRules&&(o=i.getState(n))){if(e){const s=n.tr,a=o.transform;for(let u=a.steps.length-1;u>=0;u-=1)s.step(a.steps[u].invert(a.docs[u]));if(o.text){const u=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,n.schema.text(o.text,u))}else s.delete(o.from,o.to)}return!0}}return!1},jy=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:i}=t;return r||e&&i.forEach(o=>{n.removeMark(o.$from.pos,o.$to.pos)}),!0},Uy=(n,e={})=>({tr:t,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=e,{selection:a}=t,u=kn(n,r.schema),{$from:l,empty:c,ranges:d}=a;if(!i)return!0;if(c&&s){let{from:f,to:h}=a;const p=(o=l.marks().find(g=>g.type===u))===null||o===void 0?void 0:o.attrs,m=Ml(l,u,p);m&&(f=m.from,h=m.to),t.removeMark(f,h,u)}else d.forEach(f=>{t.removeMark(f.$from.pos,f.$to.pos,u)});return t.removeStoredMark(u),!0},Wy=(n,e={})=>({tr:t,state:r,dispatch:i})=>{let o=null,s=null;const a=qs(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(o=xe(n,r.schema)),a==="mark"&&(s=kn(n,r.schema)),i&&t.selection.ranges.forEach(u=>{const l=u.$from.pos,c=u.$to.pos;r.doc.nodesBetween(l,c,(d,f)=>{o&&o===d.type&&t.setNodeMarkup(f,void 0,{...d.attrs,...e}),s&&d.marks.length&&d.marks.forEach(h=>{if(s===h.type){const p=Math.max(f,l),m=Math.min(f+d.nodeSize,c);t.addMark(p,m,s.create({...h.attrs,...e}))}})})}),!0):!1},Zy=(n,e={})=>({state:t,dispatch:r})=>{const i=xe(n,t.schema);return cb(i,e)(t,r)},Ky=(n,e={})=>({state:t,dispatch:r})=>{const i=xe(n,t.schema);return db(i,e)(t,r)};var Gy=Object.freeze({__proto__:null,blur:Ob,clearContent:Rb,clearNodes:Nb,command:Hb,createParagraphNear:Ib,cut:Fb,deleteCurrentNode:Pb,deleteNode:Bb,deleteRange:$b,deleteSelection:zb,enter:Vb,exitCode:qb,extendMarkRange:Ub,first:Wb,focus:Zb,forEach:Kb,insertContent:Gb,insertContentAt:Xb,joinUp:Qb,joinDown:ey,joinBackward:ty,joinForward:ny,joinItemBackward:ry,joinItemForward:iy,keyboardShortcut:sy,lift:ay,liftEmptyBlock:uy,liftListItem:ly,newlineInCode:cy,resetAttributes:dy,scrollIntoView:fy,selectAll:hy,selectNodeBackward:py,selectNodeForward:my,selectParentNode:gy,selectTextblockEnd:by,selectTextblockStart:yy,setContent:xy,setMark:Ly,setMeta:Oy,setNode:Ry,setNodeSelection:Ny,setTextSelection:Hy,sinkListItem:Iy,splitBlock:Fy,splitListItem:Py,toggleList:By,toggleMark:$y,toggleNode:zy,toggleWrap:Vy,undoInputRule:qy,unsetAllMarks:jy,unsetMark:Uy,updateAttributes:Wy,wrapIn:Zy,wrapInList:Ky});const Jy=re.create({name:"commands",addCommands(){return{...Gy}}}),Yy=re.create({name:"editable",addProseMirrorPlugins(){return[new oe({key:new ae("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Xy=re.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new oe({key:new ae("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),Qy=re.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{const{selection:u,doc:l}=a,{empty:c,$anchor:d}=u,{pos:f,parent:h}=d,p=d.parent.isTextblock?a.doc.resolve(f-1):d,m=p.parent.type.spec.isolating,g=d.pos-d.parentOffset,y=m&&p.parent.childCount===1?g===d.pos:z.atStart(l).from===f;return!c||!y||!h.type.isTextblock||h.textContent.length?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Dl()||Ll()?o:i},addProseMirrorPlugins(){return[new oe({key:new ae("clearDocument"),appendTransaction:(n,e,t)=>{if(!(n.some(p=>p.docChanged)&&!e.doc.eq(t.doc)))return;const{empty:i,from:o,to:s}=e.selection,a=z.atStart(e.doc).from,u=z.atEnd(e.doc).to;if(i||!(o===a&&s===u)||!(t.doc.textBetween(0,t.doc.content.size," "," ").length===0))return;const d=t.tr,f=Fs({state:t,transaction:d}),{commands:h}=new Ps({editor:this.editor,state:f});if(h.clearNodes(),!!d.steps.length)return d}})]}}),ex=re.create({name:"tabindex",addProseMirrorPlugins(){return[new oe({key:new ae("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var f0=Object.freeze({__proto__:null,ClipboardTextSerializer:Lb,Commands:Jy,Editable:Yy,FocusEvents:Xy,Keymap:Qy,Tabindex:ex});const tx=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function nx(n,e,t){const r=document.querySelector(`style[data-tiptap-style${t?`-${t}`:""}]`);if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute(`data-tiptap-style${t?`-${t}`:""}`,""),i.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(i),i}class rx extends bb{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=nx(tx,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=o0(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});this.view.updateState(i)}unregisterPlugin(e){if(this.isDestroyed)return;const t=typeof e=="string"?`${e}$`:e.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(i=>!i.key.startsWith(t))});this.view.updateState(r)}createExtensionManager(){const t=[...this.options.enableCoreExtensions?Object.values(f0):[],...this.options.extensions].filter(r=>["extension","node","mark"].includes(r==null?void 0:r.type));this.extensionManager=new dr(t,this)}createCommandManager(){this.commandManager=new Ps({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const e=u0(this.options.content,this.schema,this.options.parseOptions),t=a0(e,this.options.autofocus);this.view=new I2(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:cr.create({doc:e,selection:t||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(s=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(s)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),o=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),o&&this.emit("blur",{editor:this,event:o.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return c0(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,i=typeof e=="string"?t:e;return My(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Rl(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return Cy(this.state.doc,{blockSeparator:t,textSerializers:{...s0(this.schema),...r}})}get isEmpty(){return Ty(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}}function Vn(n){return new $s({find:n.find,handler:({state:e,range:t,match:r})=>{const i=W(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=e,s=r[r.length-1],a=r[0];if(s){const u=a.search(/\S/),l=t.from+a.indexOf(s),c=l+s.length;if(Nl(t.from,t.to,e.doc).filter(h=>h.mark.type.excluded.find(m=>m===n.type&&m!==h.mark.type)).filter(h=>h.to>l).length)return null;c<t.to&&o.delete(c,t.to),l>t.from&&o.delete(t.from+u,l);const f=t.from+u+s.length;o.addMark(t.from+u,f,n.type.create(i||{})),o.removeStoredMark(n.type)}}})}function Hl(n){return new $s({find:n.find,handler:({state:e,range:t,match:r})=>{const i=W(n.getAttributes,void 0,r)||{},{tr:o}=e,s=t.from;let a=t.to;const u=n.type.create(i);if(r[1]){const l=r[0].lastIndexOf(r[1]);let c=s+l;c>a?c=a:a=c+r[1].length;const d=r[0][r[0].length-1];o.insertText(d,s+r[0].length-1),o.replaceWith(c,a,u)}else r[0]&&o.insert(s-1,n.type.create(i)).delete(o.mapping.map(s),o.mapping.map(a));o.scrollIntoView()}})}function $u(n){return new $s({find:n.find,handler:({state:e,range:t,match:r})=>{const i=e.doc.resolve(t.from),o=W(n.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,o)}})}function qn(n){return new $s({find:n.find,handler:({state:e,range:t,match:r,chain:i})=>{const o=W(n.getAttributes,void 0,r)||{},s=e.tr.delete(t.from,t.to),u=s.doc.resolve(t.from).blockRange(),l=u&&hl(u,n.type,o);if(!l)return null;if(s.wrap(u,l),n.keepMarks&&n.editor){const{selection:d,storedMarks:f}=e,{splittableMarks:h}=n.editor.extensionManager,p=f||d.$to.parentOffset&&d.$from.marks();if(p){const m=p.filter(g=>h.includes(g.type.name));s.ensureMarks(m)}}if(n.keepAttributes){const d=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(d,o).run()}const c=s.doc.resolve(t.from-1).nodeBefore;c&&c.type===n.type&&xn(s.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,c))&&s.join(t.from-1)}})}class de{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=W(H(this,"addOptions",{name:this.name}))),this.storage=W(H(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new de(e)}configure(e={}){const t=this.extend();return t.options=zs(this.options,e),t.storage=W(H(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new de(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=W(H(t,"addOptions",{name:t.name})),t.storage=W(H(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(l=>(l==null?void 0:l.type.name)===t.name))return!1;const u=s.find(l=>(l==null?void 0:l.type.name)===t.name);return u&&r.removeStoredMark(u),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}let K=class zu{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=W(H(this,"addOptions",{name:this.name}))),this.storage=W(H(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new zu(e)}configure(e={}){const t=this.extend();return t.options=zs(this.options,e),t.storage=W(H(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new zu(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=W(H(t,"addOptions",{name:t.name})),t.storage=W(H(t,"addStorage",{name:t.name,options:t.options})),t}};function bn(n){return new Eb({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:i})=>{const o=W(n.getAttributes,void 0,r,i);if(o===!1||o===null)return null;const{tr:s}=e,a=r[r.length-1],u=r[0];let l=t.to;if(a){const c=u.search(/\S/),d=t.from+u.indexOf(a),f=d+a.length;if(Nl(t.from,t.to,e.doc).filter(p=>p.mark.type.excluded.find(g=>g===n.type&&g!==p.mark.type)).filter(p=>p.to>d).length)return null;f<t.to&&s.delete(f,t.to),d>t.from&&s.delete(t.from+c,d),l=t.from+c+a.length,s.addMark(t.from+c,l,n.type.create(o||{})),s.removeStoredMark(n.type)}}})}function ix(n){return n.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}class X extends HTMLElement{constructor(){super();N(this,"template","");N(this,"editor");N(this,"options")}registerClickListener(){this.addEventListener("click",()=>{var r;const t=(r=this.editor)==null?void 0:r.chain();this.onClick(t),t==null||t.run()})}connectedCallback(){this.innerHTML=this.template}onClick(t){}onCreate(t,r){this.editor=t.editor,this.options=r}onTransaction(t){const r=this.querySelector("div");r&&(this.onActive(t.editor)?r.classList.add("active"):r.classList.remove("active"))}onActive(t){return!1}}class ox extends X{constructor(){super();const e=`
        <div style="height: 16px">
            <svg style="width: 15px;height: 15px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.82843 6.99955L8.36396 9.53509L6.94975 10.9493L2 5.99955L6.94975 1.0498L8.36396 2.46402L5.82843 4.99955H13C17.4183 4.99955 21 8.58127 21 12.9996C21 17.4178 17.4183 20.9996 13 20.9996H4V18.9996H13C16.3137 18.9996 19 16.3133 19 12.9996C19 9.68584 16.3137 6.99955 13 6.99955H5.82843Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.undo()}}class sx extends X{constructor(){super();const e=`
         <div style="height: 16px">
            <svg style="width: 15px;height: 15px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.1716 6.99955H11C7.68629 6.99955 5 9.68584 5 12.9996C5 16.3133 7.68629 18.9996 11 18.9996H20V20.9996H11C6.58172 20.9996 3 17.4178 3 12.9996C3 8.58127 6.58172 4.99955 11 4.99955H18.1716L15.636 2.46402L17.0503 1.0498L22 5.99955L17.0503 10.9493L15.636 9.53509L18.1716 6.99955Z"></path></svg>
         </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.redo()}}var Fe="top",Qe="bottom",et="right",Pe="left",Il="auto",Oi=[Fe,Qe,et,Pe],wr="start",pi="end",ax="clippingParents",h0="viewport",zr="popper",ux="reference",Ad=Oi.reduce(function(n,e){return n.concat([e+"-"+wr,e+"-"+pi])},[]),p0=[].concat(Oi,[Il]).reduce(function(n,e){return n.concat([e,e+"-"+wr,e+"-"+pi])},[]),lx="beforeRead",cx="read",dx="afterRead",fx="beforeMain",hx="main",px="afterMain",mx="beforeWrite",gx="write",bx="afterWrite",yx=[lx,cx,dx,fx,hx,px,mx,gx,bx];function Tt(n){return n?(n.nodeName||"").toLowerCase():null}function Ve(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function jn(n){var e=Ve(n).Element;return n instanceof e||n instanceof Element}function Xe(n){var e=Ve(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Fl(n){if(typeof ShadowRoot>"u")return!1;var e=Ve(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function xx(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var r=e.styles[t]||{},i=e.attributes[t]||{},o=e.elements[t];!Xe(o)||!Tt(o)||(Object.assign(o.style,r),Object.keys(i).forEach(function(s){var a=i[s];a===!1?o.removeAttribute(s):o.setAttribute(s,a===!0?"":a)}))})}function vx(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],o=e.attributes[r]||{},s=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:t[r]),a=s.reduce(function(u,l){return u[l]="",u},{});!Xe(i)||!Tt(i)||(Object.assign(i.style,a),Object.keys(o).forEach(function(u){i.removeAttribute(u)}))})}}const m0={name:"applyStyles",enabled:!0,phase:"write",fn:xx,effect:vx,requires:["computeStyles"]};function At(n){return n.split("-")[0]}var Pn=Math.max,zo=Math.min,Cr=Math.round;function Vu(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function g0(){return!/^((?!chrome|android).)*safari/i.test(Vu())}function Sr(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var r=n.getBoundingClientRect(),i=1,o=1;e&&Xe(n)&&(i=n.offsetWidth>0&&Cr(r.width)/n.offsetWidth||1,o=n.offsetHeight>0&&Cr(r.height)/n.offsetHeight||1);var s=jn(n)?Ve(n):window,a=s.visualViewport,u=!g0()&&t,l=(r.left+(u&&a?a.offsetLeft:0))/i,c=(r.top+(u&&a?a.offsetTop:0))/o,d=r.width/i,f=r.height/o;return{width:d,height:f,top:c,right:l+d,bottom:c+f,left:l,x:l,y:c}}function Pl(n){var e=Sr(n),t=n.offsetWidth,r=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:r}}function b0(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Fl(t)){var r=e;do{if(r&&n.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Wt(n){return Ve(n).getComputedStyle(n)}function kx(n){return["table","td","th"].indexOf(Tt(n))>=0}function wn(n){return((jn(n)?n.ownerDocument:n.document)||window.document).documentElement}function Us(n){return Tt(n)==="html"?n:n.assignedSlot||n.parentNode||(Fl(n)?n.host:null)||wn(n)}function _d(n){return!Xe(n)||Wt(n).position==="fixed"?null:n.offsetParent}function wx(n){var e=/firefox/i.test(Vu()),t=/Trident/i.test(Vu());if(t&&Xe(n)){var r=Wt(n);if(r.position==="fixed")return null}var i=Us(n);for(Fl(i)&&(i=i.host);Xe(i)&&["html","body"].indexOf(Tt(i))<0;){var o=Wt(i);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||e&&o.willChange==="filter"||e&&o.filter&&o.filter!=="none")return i;i=i.parentNode}return null}function Ri(n){for(var e=Ve(n),t=_d(n);t&&kx(t)&&Wt(t).position==="static";)t=_d(t);return t&&(Tt(t)==="html"||Tt(t)==="body"&&Wt(t).position==="static")?e:t||wx(n)||e}function Bl(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function ei(n,e,t){return Pn(n,zo(e,t))}function Cx(n,e,t){var r=ei(n,e,t);return r>t?t:r}function y0(){return{top:0,right:0,bottom:0,left:0}}function x0(n){return Object.assign({},y0(),n)}function v0(n,e){return e.reduce(function(t,r){return t[r]=n,t},{})}var Sx=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,x0(typeof e!="number"?e:v0(e,Oi))};function Ex(n){var e,t=n.state,r=n.name,i=n.options,o=t.elements.arrow,s=t.modifiersData.popperOffsets,a=At(t.placement),u=Bl(a),l=[Pe,et].indexOf(a)>=0,c=l?"height":"width";if(!(!o||!s)){var d=Sx(i.padding,t),f=Pl(o),h=u==="y"?Fe:Pe,p=u==="y"?Qe:et,m=t.rects.reference[c]+t.rects.reference[u]-s[u]-t.rects.popper[c],g=s[u]-t.rects.reference[u],y=Ri(o),x=y?u==="y"?y.clientHeight||0:y.clientWidth||0:0,v=m/2-g/2,b=d[h],w=x-f[c]-d[p],k=x/2-f[c]/2+v,C=ei(b,k,w),E=u;t.modifiersData[r]=(e={},e[E]=C,e.centerOffset=C-k,e)}}function Ax(n){var e=n.state,t=n.options,r=t.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||b0(e.elements.popper,i)&&(e.elements.arrow=i))}const _x={name:"arrow",enabled:!0,phase:"main",fn:Ex,effect:Ax,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Er(n){return n.split("-")[1]}var Mx={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Tx(n,e){var t=n.x,r=n.y,i=e.devicePixelRatio||1;return{x:Cr(t*i)/i||0,y:Cr(r*i)/i||0}}function Md(n){var e,t=n.popper,r=n.popperRect,i=n.placement,o=n.variation,s=n.offsets,a=n.position,u=n.gpuAcceleration,l=n.adaptive,c=n.roundOffsets,d=n.isFixed,f=s.x,h=f===void 0?0:f,p=s.y,m=p===void 0?0:p,g=typeof c=="function"?c({x:h,y:m}):{x:h,y:m};h=g.x,m=g.y;var y=s.hasOwnProperty("x"),x=s.hasOwnProperty("y"),v=Pe,b=Fe,w=window;if(l){var k=Ri(t),C="clientHeight",E="clientWidth";if(k===Ve(t)&&(k=wn(t),Wt(k).position!=="static"&&a==="absolute"&&(C="scrollHeight",E="scrollWidth")),k=k,i===Fe||(i===Pe||i===et)&&o===pi){b=Qe;var A=d&&k===w&&w.visualViewport?w.visualViewport.height:k[C];m-=A-r.height,m*=u?1:-1}if(i===Pe||(i===Fe||i===Qe)&&o===pi){v=et;var T=d&&k===w&&w.visualViewport?w.visualViewport.width:k[E];h-=T-r.width,h*=u?1:-1}}var I=Object.assign({position:a},l&&Mx),V=c===!0?Tx({x:h,y:m},Ve(t)):{x:h,y:m};if(h=V.x,m=V.y,u){var U;return Object.assign({},I,(U={},U[b]=x?"0":"",U[v]=y?"0":"",U.transform=(w.devicePixelRatio||1)<=1?"translate("+h+"px, "+m+"px)":"translate3d("+h+"px, "+m+"px, 0)",U))}return Object.assign({},I,(e={},e[b]=x?m+"px":"",e[v]=y?h+"px":"",e.transform="",e))}function Dx(n){var e=n.state,t=n.options,r=t.gpuAcceleration,i=r===void 0?!0:r,o=t.adaptive,s=o===void 0?!0:o,a=t.roundOffsets,u=a===void 0?!0:a,l={placement:At(e.placement),variation:Er(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Md(Object.assign({},l,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:u})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Md(Object.assign({},l,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Lx={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Dx,data:{}};var eo={passive:!0};function Ox(n){var e=n.state,t=n.instance,r=n.options,i=r.scroll,o=i===void 0?!0:i,s=r.resize,a=s===void 0?!0:s,u=Ve(e.elements.popper),l=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&l.forEach(function(c){c.addEventListener("scroll",t.update,eo)}),a&&u.addEventListener("resize",t.update,eo),function(){o&&l.forEach(function(c){c.removeEventListener("scroll",t.update,eo)}),a&&u.removeEventListener("resize",t.update,eo)}}const Rx={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Ox,data:{}};var Nx={left:"right",right:"left",bottom:"top",top:"bottom"};function ko(n){return n.replace(/left|right|bottom|top/g,function(e){return Nx[e]})}var Hx={start:"end",end:"start"};function Td(n){return n.replace(/start|end/g,function(e){return Hx[e]})}function $l(n){var e=Ve(n),t=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:t,scrollTop:r}}function zl(n){return Sr(wn(n)).left+$l(n).scrollLeft}function Ix(n,e){var t=Ve(n),r=wn(n),i=t.visualViewport,o=r.clientWidth,s=r.clientHeight,a=0,u=0;if(i){o=i.width,s=i.height;var l=g0();(l||!l&&e==="fixed")&&(a=i.offsetLeft,u=i.offsetTop)}return{width:o,height:s,x:a+zl(n),y:u}}function Fx(n){var e,t=wn(n),r=$l(n),i=(e=n.ownerDocument)==null?void 0:e.body,o=Pn(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=Pn(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+zl(n),u=-r.scrollTop;return Wt(i||t).direction==="rtl"&&(a+=Pn(t.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:a,y:u}}function Vl(n){var e=Wt(n),t=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+r)}function k0(n){return["html","body","#document"].indexOf(Tt(n))>=0?n.ownerDocument.body:Xe(n)&&Vl(n)?n:k0(Us(n))}function ti(n,e){var t;e===void 0&&(e=[]);var r=k0(n),i=r===((t=n.ownerDocument)==null?void 0:t.body),o=Ve(r),s=i?[o].concat(o.visualViewport||[],Vl(r)?r:[]):r,a=e.concat(s);return i?a:a.concat(ti(Us(s)))}function qu(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Px(n,e){var t=Sr(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function Dd(n,e,t){return e===h0?qu(Ix(n,t)):jn(e)?Px(e,t):qu(Fx(wn(n)))}function Bx(n){var e=ti(Us(n)),t=["absolute","fixed"].indexOf(Wt(n).position)>=0,r=t&&Xe(n)?Ri(n):n;return jn(r)?e.filter(function(i){return jn(i)&&b0(i,r)&&Tt(i)!=="body"}):[]}function $x(n,e,t,r){var i=e==="clippingParents"?Bx(n):[].concat(e),o=[].concat(i,[t]),s=o[0],a=o.reduce(function(u,l){var c=Dd(n,l,r);return u.top=Pn(c.top,u.top),u.right=zo(c.right,u.right),u.bottom=zo(c.bottom,u.bottom),u.left=Pn(c.left,u.left),u},Dd(n,s,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function w0(n){var e=n.reference,t=n.element,r=n.placement,i=r?At(r):null,o=r?Er(r):null,s=e.x+e.width/2-t.width/2,a=e.y+e.height/2-t.height/2,u;switch(i){case Fe:u={x:s,y:e.y-t.height};break;case Qe:u={x:s,y:e.y+e.height};break;case et:u={x:e.x+e.width,y:a};break;case Pe:u={x:e.x-t.width,y:a};break;default:u={x:e.x,y:e.y}}var l=i?Bl(i):null;if(l!=null){var c=l==="y"?"height":"width";switch(o){case wr:u[l]=u[l]-(e[c]/2-t[c]/2);break;case pi:u[l]=u[l]+(e[c]/2-t[c]/2);break}}return u}function mi(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=r===void 0?n.placement:r,o=t.strategy,s=o===void 0?n.strategy:o,a=t.boundary,u=a===void 0?ax:a,l=t.rootBoundary,c=l===void 0?h0:l,d=t.elementContext,f=d===void 0?zr:d,h=t.altBoundary,p=h===void 0?!1:h,m=t.padding,g=m===void 0?0:m,y=x0(typeof g!="number"?g:v0(g,Oi)),x=f===zr?ux:zr,v=n.rects.popper,b=n.elements[p?x:f],w=$x(jn(b)?b:b.contextElement||wn(n.elements.popper),u,c,s),k=Sr(n.elements.reference),C=w0({reference:k,element:v,strategy:"absolute",placement:i}),E=qu(Object.assign({},v,C)),A=f===zr?E:k,T={top:w.top-A.top+y.top,bottom:A.bottom-w.bottom+y.bottom,left:w.left-A.left+y.left,right:A.right-w.right+y.right},I=n.modifiersData.offset;if(f===zr&&I){var V=I[i];Object.keys(T).forEach(function(U){var M=[et,Qe].indexOf(U)>=0?1:-1,R=[Fe,Qe].indexOf(U)>=0?"y":"x";T[U]+=V[R]*M})}return T}function zx(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=t.boundary,o=t.rootBoundary,s=t.padding,a=t.flipVariations,u=t.allowedAutoPlacements,l=u===void 0?p0:u,c=Er(r),d=c?a?Ad:Ad.filter(function(p){return Er(p)===c}):Oi,f=d.filter(function(p){return l.indexOf(p)>=0});f.length===0&&(f=d);var h=f.reduce(function(p,m){return p[m]=mi(n,{placement:m,boundary:i,rootBoundary:o,padding:s})[At(m)],p},{});return Object.keys(h).sort(function(p,m){return h[p]-h[m]})}function Vx(n){if(At(n)===Il)return[];var e=ko(n);return[Td(n),e,Td(e)]}function qx(n){var e=n.state,t=n.options,r=n.name;if(!e.modifiersData[r]._skip){for(var i=t.mainAxis,o=i===void 0?!0:i,s=t.altAxis,a=s===void 0?!0:s,u=t.fallbackPlacements,l=t.padding,c=t.boundary,d=t.rootBoundary,f=t.altBoundary,h=t.flipVariations,p=h===void 0?!0:h,m=t.allowedAutoPlacements,g=e.options.placement,y=At(g),x=y===g,v=u||(x||!p?[ko(g)]:Vx(g)),b=[g].concat(v).reduce(function(Ht,it){return Ht.concat(At(it)===Il?zx(e,{placement:it,boundary:c,rootBoundary:d,padding:l,flipVariations:p,allowedAutoPlacements:m}):it)},[]),w=e.rects.reference,k=e.rects.popper,C=new Map,E=!0,A=b[0],T=0;T<b.length;T++){var I=b[T],V=At(I),U=Er(I)===wr,M=[Fe,Qe].indexOf(V)>=0,R=M?"width":"height",D=mi(e,{placement:I,boundary:c,rootBoundary:d,altBoundary:f,padding:l}),P=M?U?et:Pe:U?Qe:Fe;w[R]>k[R]&&(P=ko(P));var G=ko(P),he=[];if(o&&he.push(D[V]<=0),a&&he.push(D[P]<=0,D[G]<=0),he.every(function(Ht){return Ht})){A=I,E=!1;break}C.set(I,he)}if(E)for(var Te=p?3:1,rt=function(it){var It=b.find(function(Zn){var Ft=C.get(Zn);if(Ft)return Ft.slice(0,it).every(function(Kn){return Kn})});if(It)return A=It,"break"},ft=Te;ft>0;ft--){var Cn=rt(ft);if(Cn==="break")break}e.placement!==A&&(e.modifiersData[r]._skip=!0,e.placement=A,e.reset=!0)}}const jx={name:"flip",enabled:!0,phase:"main",fn:qx,requiresIfExists:["offset"],data:{_skip:!1}};function Ld(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Od(n){return[Fe,et,Qe,Pe].some(function(e){return n[e]>=0})}function Ux(n){var e=n.state,t=n.name,r=e.rects.reference,i=e.rects.popper,o=e.modifiersData.preventOverflow,s=mi(e,{elementContext:"reference"}),a=mi(e,{altBoundary:!0}),u=Ld(s,r),l=Ld(a,i,o),c=Od(u),d=Od(l);e.modifiersData[t]={referenceClippingOffsets:u,popperEscapeOffsets:l,isReferenceHidden:c,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":d})}const Wx={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Ux};function Zx(n,e,t){var r=At(n),i=[Pe,Fe].indexOf(r)>=0?-1:1,o=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,s=o[0],a=o[1];return s=s||0,a=(a||0)*i,[Pe,et].indexOf(r)>=0?{x:a,y:s}:{x:s,y:a}}function Kx(n){var e=n.state,t=n.options,r=n.name,i=t.offset,o=i===void 0?[0,0]:i,s=p0.reduce(function(c,d){return c[d]=Zx(d,e.rects,o),c},{}),a=s[e.placement],u=a.x,l=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=u,e.modifiersData.popperOffsets.y+=l),e.modifiersData[r]=s}const Gx={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Kx};function Jx(n){var e=n.state,t=n.name;e.modifiersData[t]=w0({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const Yx={name:"popperOffsets",enabled:!0,phase:"read",fn:Jx,data:{}};function Xx(n){return n==="x"?"y":"x"}function Qx(n){var e=n.state,t=n.options,r=n.name,i=t.mainAxis,o=i===void 0?!0:i,s=t.altAxis,a=s===void 0?!1:s,u=t.boundary,l=t.rootBoundary,c=t.altBoundary,d=t.padding,f=t.tether,h=f===void 0?!0:f,p=t.tetherOffset,m=p===void 0?0:p,g=mi(e,{boundary:u,rootBoundary:l,padding:d,altBoundary:c}),y=At(e.placement),x=Er(e.placement),v=!x,b=Bl(y),w=Xx(b),k=e.modifiersData.popperOffsets,C=e.rects.reference,E=e.rects.popper,A=typeof m=="function"?m(Object.assign({},e.rects,{placement:e.placement})):m,T=typeof A=="number"?{mainAxis:A,altAxis:A}:Object.assign({mainAxis:0,altAxis:0},A),I=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,V={x:0,y:0};if(k){if(o){var U,M=b==="y"?Fe:Pe,R=b==="y"?Qe:et,D=b==="y"?"height":"width",P=k[b],G=P+g[M],he=P-g[R],Te=h?-E[D]/2:0,rt=x===wr?C[D]:E[D],ft=x===wr?-E[D]:-C[D],Cn=e.elements.arrow,Ht=h&&Cn?Pl(Cn):{width:0,height:0},it=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:y0(),It=it[M],Zn=it[R],Ft=ei(0,C[D],Ht[D]),Kn=v?C[D]/2-Te-Ft-It-T.mainAxis:rt-Ft-It-T.mainAxis,Zt=v?-C[D]/2+Te+Ft+Zn+T.mainAxis:ft+Ft+Zn+T.mainAxis,Gn=e.elements.arrow&&Ri(e.elements.arrow),$i=Gn?b==="y"?Gn.clientTop||0:Gn.clientLeft||0:0,Hr=(U=I==null?void 0:I[b])!=null?U:0,zi=P+Kn-Hr-$i,Vi=P+Zt-Hr,Ir=ei(h?zo(G,zi):G,P,h?Pn(he,Vi):he);k[b]=Ir,V[b]=Ir-P}if(a){var Fr,qi=b==="x"?Fe:Pe,ji=b==="x"?Qe:et,Pt=k[w],Kt=w==="y"?"height":"width",Pr=Pt+g[qi],Sn=Pt-g[ji],Br=[Fe,Pe].indexOf(y)!==-1,Ui=(Fr=I==null?void 0:I[w])!=null?Fr:0,Wi=Br?Pr:Pt-C[Kt]-E[Kt]-Ui+T.altAxis,Zi=Br?Pt+C[Kt]+E[Kt]-Ui-T.altAxis:Sn,Ki=h&&Br?Cx(Wi,Pt,Zi):ei(h?Wi:Pr,Pt,h?Zi:Sn);k[w]=Ki,V[w]=Ki-Pt}e.modifiersData[r]=V}}const e3={name:"preventOverflow",enabled:!0,phase:"main",fn:Qx,requiresIfExists:["offset"]};function t3(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function n3(n){return n===Ve(n)||!Xe(n)?$l(n):t3(n)}function r3(n){var e=n.getBoundingClientRect(),t=Cr(e.width)/n.offsetWidth||1,r=Cr(e.height)/n.offsetHeight||1;return t!==1||r!==1}function i3(n,e,t){t===void 0&&(t=!1);var r=Xe(e),i=Xe(e)&&r3(e),o=wn(e),s=Sr(n,i,t),a={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(r||!r&&!t)&&((Tt(e)!=="body"||Vl(o))&&(a=n3(e)),Xe(e)?(u=Sr(e,!0),u.x+=e.clientLeft,u.y+=e.clientTop):o&&(u.x=zl(o))),{x:s.left+a.scrollLeft-u.x,y:s.top+a.scrollTop-u.y,width:s.width,height:s.height}}function o3(n){var e=new Map,t=new Set,r=[];n.forEach(function(o){e.set(o.name,o)});function i(o){t.add(o.name);var s=[].concat(o.requires||[],o.requiresIfExists||[]);s.forEach(function(a){if(!t.has(a)){var u=e.get(a);u&&i(u)}}),r.push(o)}return n.forEach(function(o){t.has(o.name)||i(o)}),r}function s3(n){var e=o3(n);return yx.reduce(function(t,r){return t.concat(e.filter(function(i){return i.phase===r}))},[])}function a3(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function u3(n){var e=n.reduce(function(t,r){var i=t[r.name];return t[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,t},{});return Object.keys(e).map(function(t){return e[t]})}var Rd={placement:"bottom",modifiers:[],strategy:"absolute"};function Nd(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function l3(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,r=t===void 0?[]:t,i=e.defaultOptions,o=i===void 0?Rd:i;return function(a,u,l){l===void 0&&(l=o);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},Rd,o),modifiersData:{},elements:{reference:a,popper:u},attributes:{},styles:{}},d=[],f=!1,h={state:c,setOptions:function(y){var x=typeof y=="function"?y(c.options):y;m(),c.options=Object.assign({},o,c.options,x),c.scrollParents={reference:jn(a)?ti(a):a.contextElement?ti(a.contextElement):[],popper:ti(u)};var v=s3(u3([].concat(r,c.options.modifiers)));return c.orderedModifiers=v.filter(function(b){return b.enabled}),p(),h.update()},forceUpdate:function(){if(!f){var y=c.elements,x=y.reference,v=y.popper;if(Nd(x,v)){c.rects={reference:i3(x,Ri(v),c.options.strategy==="fixed"),popper:Pl(v)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(T){return c.modifiersData[T.name]=Object.assign({},T.data)});for(var b=0;b<c.orderedModifiers.length;b++){if(c.reset===!0){c.reset=!1,b=-1;continue}var w=c.orderedModifiers[b],k=w.fn,C=w.options,E=C===void 0?{}:C,A=w.name;typeof k=="function"&&(c=k({state:c,options:E,name:A,instance:h})||c)}}}},update:a3(function(){return new Promise(function(g){h.forceUpdate(),g(c)})}),destroy:function(){m(),f=!0}};if(!Nd(a,u))return h;h.setOptions(l).then(function(g){!f&&l.onFirstUpdate&&l.onFirstUpdate(g)});function p(){c.orderedModifiers.forEach(function(g){var y=g.name,x=g.options,v=x===void 0?{}:x,b=g.effect;if(typeof b=="function"){var w=b({state:c,name:y,instance:h,options:v}),k=function(){};d.push(w||k)}})}function m(){d.forEach(function(g){return g()}),d=[]}return h}}var c3=[Rx,Yx,Lx,m0,Gx,jx,e3,_x,Wx],d3=l3({defaultModifiers:c3}),f3="tippy-box",C0="tippy-content",h3="tippy-backdrop",S0="tippy-arrow",E0="tippy-svg-arrow",_n={passive:!0,capture:!0},A0=function(){return document.body};function p3(n,e){return{}.hasOwnProperty.call(n,e)}function Ia(n,e,t){if(Array.isArray(n)){var r=n[e];return r??(Array.isArray(t)?t[e]:t)}return n}function ql(n,e){var t={}.toString.call(n);return t.indexOf("[object")===0&&t.indexOf(e+"]")>-1}function _0(n,e){return typeof n=="function"?n.apply(void 0,e):n}function Hd(n,e){if(e===0)return n;var t;return function(r){clearTimeout(t),t=setTimeout(function(){n(r)},e)}}function m3(n,e){var t=Object.assign({},n);return e.forEach(function(r){delete t[r]}),t}function g3(n){return n.split(/\s+/).filter(Boolean)}function ur(n){return[].concat(n)}function Id(n,e){n.indexOf(e)===-1&&n.push(e)}function b3(n){return n.filter(function(e,t){return n.indexOf(e)===t})}function y3(n){return n.split("-")[0]}function Vo(n){return[].slice.call(n)}function Fd(n){return Object.keys(n).reduce(function(e,t){return n[t]!==void 0&&(e[t]=n[t]),e},{})}function ni(){return document.createElement("div")}function gi(n){return["Element","Fragment"].some(function(e){return ql(n,e)})}function x3(n){return ql(n,"NodeList")}function v3(n){return ql(n,"MouseEvent")}function k3(n){return!!(n&&n._tippy&&n._tippy.reference===n)}function w3(n){return gi(n)?[n]:x3(n)?Vo(n):Array.isArray(n)?n:Vo(document.querySelectorAll(n))}function Fa(n,e){n.forEach(function(t){t&&(t.style.transitionDuration=e+"ms")})}function Pd(n,e){n.forEach(function(t){t&&t.setAttribute("data-state",e)})}function C3(n){var e,t=ur(n),r=t[0];return r!=null&&(e=r.ownerDocument)!=null&&e.body?r.ownerDocument:document}function S3(n,e){var t=e.clientX,r=e.clientY;return n.every(function(i){var o=i.popperRect,s=i.popperState,a=i.props,u=a.interactiveBorder,l=y3(s.placement),c=s.modifiersData.offset;if(!c)return!0;var d=l==="bottom"?c.top.y:0,f=l==="top"?c.bottom.y:0,h=l==="right"?c.left.x:0,p=l==="left"?c.right.x:0,m=o.top-r+d>u,g=r-o.bottom-f>u,y=o.left-t+h>u,x=t-o.right-p>u;return m||g||y||x})}function Pa(n,e,t){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){n[r](i,t)})}function Bd(n,e){for(var t=e;t;){var r;if(n.contains(t))return!0;t=t.getRootNode==null||(r=t.getRootNode())==null?void 0:r.host}return!1}var bt={isTouch:!1},$d=0;function E3(){bt.isTouch||(bt.isTouch=!0,window.performance&&document.addEventListener("mousemove",M0))}function M0(){var n=performance.now();n-$d<20&&(bt.isTouch=!1,document.removeEventListener("mousemove",M0)),$d=n}function A3(){var n=document.activeElement;if(k3(n)){var e=n._tippy;n.blur&&!e.state.isVisible&&n.blur()}}function _3(){document.addEventListener("touchstart",E3,_n),window.addEventListener("blur",A3)}var M3=typeof window<"u"&&typeof document<"u",T3=M3?!!window.msCrypto:!1;function er(n){var e=n==="destroy"?"n already-":" ";return[n+"() was called on a"+e+"destroyed instance. This is a no-op but","indicates a potential memory leak."].join(" ")}function zd(n){var e=/[ \t]{2,}/g,t=/^[ \t]*/gm;return n.replace(e," ").replace(t,"").trim()}function D3(n){return zd(`
  %ctippy.js

  %c`+zd(n)+`

  %c This is a development-only message. It will be removed in production.
  `)}function T0(n){return[D3(n),"color: #00C584; font-size: 1.3em; font-weight: bold;","line-height: 1.5","color: #a6a095;"]}var bi;({}).NODE_ENV!=="production"&&L3();function L3(){bi=new Set}function qt(n,e){if(n&&!bi.has(e)){var t;bi.add(e),(t=console).warn.apply(t,T0(e))}}function ju(n,e){if(n&&!bi.has(e)){var t;bi.add(e),(t=console).error.apply(t,T0(e))}}function O3(n){var e=!n,t=Object.prototype.toString.call(n)==="[object Object]"&&!n.addEventListener;ju(e,["tippy() was passed","`"+String(n)+"`","as its targets (first) argument. Valid types are: String, Element,","Element[], or NodeList."].join(" ")),ju(t,["tippy() was passed a plain object which is not supported as an argument","for virtual positioning. Use props.getReferenceClientRect instead."].join(" "))}var D0={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},R3={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},ze=Object.assign({appendTo:A0,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},D0,R3),N3=Object.keys(ze),H3=function(e){({}).NODE_ENV!=="production"&&O0(e,[]);var t=Object.keys(e);t.forEach(function(r){ze[r]=e[r]})};function L0(n){var e=n.plugins||[],t=e.reduce(function(r,i){var o=i.name,s=i.defaultValue;if(o){var a;r[o]=n[o]!==void 0?n[o]:(a=ze[o])!=null?a:s}return r},{});return Object.assign({},n,t)}function I3(n,e){var t=e?Object.keys(L0(Object.assign({},ze,{plugins:e}))):N3,r=t.reduce(function(i,o){var s=(n.getAttribute("data-tippy-"+o)||"").trim();if(!s)return i;if(o==="content")i[o]=s;else try{i[o]=JSON.parse(s)}catch{i[o]=s}return i},{});return r}function Vd(n,e){var t=Object.assign({},e,{content:_0(e.content,[n])},e.ignoreAttributes?{}:I3(n,e.plugins));return t.aria=Object.assign({},ze.aria,t.aria),t.aria={expanded:t.aria.expanded==="auto"?e.interactive:t.aria.expanded,content:t.aria.content==="auto"?e.interactive?null:"describedby":t.aria.content},t}function O0(n,e){n===void 0&&(n={}),e===void 0&&(e=[]);var t=Object.keys(n);t.forEach(function(r){var i=m3(ze,Object.keys(D0)),o=!p3(i,r);o&&(o=e.filter(function(s){return s.name===r}).length===0),qt(o,["`"+r+"`","is not a valid prop. You may have spelled it incorrectly, or if it's","a plugin, forgot to pass it in an array as props.plugins.",`

`,`All props: https://atomiks.github.io/tippyjs/v6/all-props/
`,"Plugins: https://atomiks.github.io/tippyjs/v6/plugins/"].join(" "))})}var F3=function(){return"innerHTML"};function Uu(n,e){n[F3()]=e}function qd(n){var e=ni();return n===!0?e.className=S0:(e.className=E0,gi(n)?e.appendChild(n):Uu(e,n)),e}function jd(n,e){gi(e.content)?(Uu(n,""),n.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?Uu(n,e.content):n.textContent=e.content)}function Wu(n){var e=n.firstElementChild,t=Vo(e.children);return{box:e,content:t.find(function(r){return r.classList.contains(C0)}),arrow:t.find(function(r){return r.classList.contains(S0)||r.classList.contains(E0)}),backdrop:t.find(function(r){return r.classList.contains(h3)})}}function R0(n){var e=ni(),t=ni();t.className=f3,t.setAttribute("data-state","hidden"),t.setAttribute("tabindex","-1");var r=ni();r.className=C0,r.setAttribute("data-state","hidden"),jd(r,n.props),e.appendChild(t),t.appendChild(r),i(n.props,n.props);function i(o,s){var a=Wu(e),u=a.box,l=a.content,c=a.arrow;s.theme?u.setAttribute("data-theme",s.theme):u.removeAttribute("data-theme"),typeof s.animation=="string"?u.setAttribute("data-animation",s.animation):u.removeAttribute("data-animation"),s.inertia?u.setAttribute("data-inertia",""):u.removeAttribute("data-inertia"),u.style.maxWidth=typeof s.maxWidth=="number"?s.maxWidth+"px":s.maxWidth,s.role?u.setAttribute("role",s.role):u.removeAttribute("role"),(o.content!==s.content||o.allowHTML!==s.allowHTML)&&jd(l,n.props),s.arrow?c?o.arrow!==s.arrow&&(u.removeChild(c),u.appendChild(qd(s.arrow))):u.appendChild(qd(s.arrow)):c&&u.removeChild(c)}return{popper:e,onUpdate:i}}R0.$$tippy=!0;var P3=1,to=[],Ba=[];function B3(n,e){var t=Vd(n,Object.assign({},ze,L0(Fd(e)))),r,i,o,s=!1,a=!1,u=!1,l=!1,c,d,f,h=[],p=Hd(zi,t.interactiveDebounce),m,g=P3++,y=null,x=b3(t.plugins),v={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},b={id:g,reference:n,popper:ni(),popperInstance:y,props:t,state:v,plugins:x,clearDelayTimeouts:Wi,setProps:Zi,setContent:Ki,show:cm,hide:dm,hideWithInteractivity:fm,enable:Br,disable:Ui,unmount:hm,destroy:pm};if(!t.render)return{}.NODE_ENV!=="production"&&ju(!0,"render() function has not been supplied."),b;var w=t.render(b),k=w.popper,C=w.onUpdate;k.setAttribute("data-tippy-root",""),k.id="tippy-"+b.id,b.popper=k,n._tippy=b,k._tippy=b;var E=x.map(function(S){return S.fn(b)}),A=n.hasAttribute("aria-expanded");return Gn(),Te(),P(),G("onCreate",[b]),t.showOnCreate&&Pr(),k.addEventListener("mouseenter",function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()}),k.addEventListener("mouseleave",function(){b.props.interactive&&b.props.trigger.indexOf("mouseenter")>=0&&M().addEventListener("mousemove",p)}),b;function T(){var S=b.props.touch;return Array.isArray(S)?S:[S,0]}function I(){return T()[0]==="hold"}function V(){var S;return!!((S=b.props.render)!=null&&S.$$tippy)}function U(){return m||n}function M(){var S=U().parentNode;return S?C3(S):document}function R(){return Wu(k)}function D(S){return b.state.isMounted&&!b.state.isVisible||bt.isTouch||c&&c.type==="focus"?0:Ia(b.props.delay,S?0:1,ze.delay)}function P(S){S===void 0&&(S=!1),k.style.pointerEvents=b.props.interactive&&!S?"":"none",k.style.zIndex=""+b.props.zIndex}function G(S,F,q){if(q===void 0&&(q=!0),E.forEach(function(Y){Y[S]&&Y[S].apply(Y,F)}),q){var te;(te=b.props)[S].apply(te,F)}}function he(){var S=b.props.aria;if(S.content){var F="aria-"+S.content,q=k.id,te=ur(b.props.triggerTarget||n);te.forEach(function(Y){var De=Y.getAttribute(F);if(b.state.isVisible)Y.setAttribute(F,De?De+" "+q:q);else{var Ue=De&&De.replace(q,"").trim();Ue?Y.setAttribute(F,Ue):Y.removeAttribute(F)}})}}function Te(){if(!(A||!b.props.aria.expanded)){var S=ur(b.props.triggerTarget||n);S.forEach(function(F){b.props.interactive?F.setAttribute("aria-expanded",b.state.isVisible&&F===U()?"true":"false"):F.removeAttribute("aria-expanded")})}}function rt(){M().removeEventListener("mousemove",p),to=to.filter(function(S){return S!==p})}function ft(S){if(!(bt.isTouch&&(u||S.type==="mousedown"))){var F=S.composedPath&&S.composedPath()[0]||S.target;if(!(b.props.interactive&&Bd(k,F))){if(ur(b.props.triggerTarget||n).some(function(q){return Bd(q,F)})){if(bt.isTouch||b.state.isVisible&&b.props.trigger.indexOf("click")>=0)return}else G("onClickOutside",[b,S]);b.props.hideOnClick===!0&&(b.clearDelayTimeouts(),b.hide(),a=!0,setTimeout(function(){a=!1}),b.state.isMounted||It())}}}function Cn(){u=!0}function Ht(){u=!1}function it(){var S=M();S.addEventListener("mousedown",ft,!0),S.addEventListener("touchend",ft,_n),S.addEventListener("touchstart",Ht,_n),S.addEventListener("touchmove",Cn,_n)}function It(){var S=M();S.removeEventListener("mousedown",ft,!0),S.removeEventListener("touchend",ft,_n),S.removeEventListener("touchstart",Ht,_n),S.removeEventListener("touchmove",Cn,_n)}function Zn(S,F){Kn(S,function(){!b.state.isVisible&&k.parentNode&&k.parentNode.contains(k)&&F()})}function Ft(S,F){Kn(S,F)}function Kn(S,F){var q=R().box;function te(Y){Y.target===q&&(Pa(q,"remove",te),F())}if(S===0)return F();Pa(q,"remove",d),Pa(q,"add",te),d=te}function Zt(S,F,q){q===void 0&&(q=!1);var te=ur(b.props.triggerTarget||n);te.forEach(function(Y){Y.addEventListener(S,F,q),h.push({node:Y,eventType:S,handler:F,options:q})})}function Gn(){I()&&(Zt("touchstart",Hr,{passive:!0}),Zt("touchend",Vi,{passive:!0})),g3(b.props.trigger).forEach(function(S){if(S!=="manual")switch(Zt(S,Hr),S){case"mouseenter":Zt("mouseleave",Vi);break;case"focus":Zt(T3?"focusout":"blur",Ir);break;case"focusin":Zt("focusout",Ir);break}})}function $i(){h.forEach(function(S){var F=S.node,q=S.eventType,te=S.handler,Y=S.options;F.removeEventListener(q,te,Y)}),h=[]}function Hr(S){var F,q=!1;if(!(!b.state.isEnabled||Fr(S)||a)){var te=((F=c)==null?void 0:F.type)==="focus";c=S,m=S.currentTarget,Te(),!b.state.isVisible&&v3(S)&&to.forEach(function(Y){return Y(S)}),S.type==="click"&&(b.props.trigger.indexOf("mouseenter")<0||s)&&b.props.hideOnClick!==!1&&b.state.isVisible?q=!0:Pr(S),S.type==="click"&&(s=!q),q&&!te&&Sn(S)}}function zi(S){var F=S.target,q=U().contains(F)||k.contains(F);if(!(S.type==="mousemove"&&q)){var te=Kt().concat(k).map(function(Y){var De,Ue=Y._tippy,Jn=(De=Ue.popperInstance)==null?void 0:De.state;return Jn?{popperRect:Y.getBoundingClientRect(),popperState:Jn,props:t}:null}).filter(Boolean);S3(te,S)&&(rt(),Sn(S))}}function Vi(S){var F=Fr(S)||b.props.trigger.indexOf("click")>=0&&s;if(!F){if(b.props.interactive){b.hideWithInteractivity(S);return}Sn(S)}}function Ir(S){b.props.trigger.indexOf("focusin")<0&&S.target!==U()||b.props.interactive&&S.relatedTarget&&k.contains(S.relatedTarget)||Sn(S)}function Fr(S){return bt.isTouch?I()!==S.type.indexOf("touch")>=0:!1}function qi(){ji();var S=b.props,F=S.popperOptions,q=S.placement,te=S.offset,Y=S.getReferenceClientRect,De=S.moveTransition,Ue=V()?Wu(k).arrow:null,Jn=Y?{getBoundingClientRect:Y,contextElement:Y.contextElement||U()}:n,wc={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Gi){var Yn=Gi.state;if(V()){var mm=R(),pa=mm.box;["placement","reference-hidden","escaped"].forEach(function(Ji){Ji==="placement"?pa.setAttribute("data-placement",Yn.placement):Yn.attributes.popper["data-popper-"+Ji]?pa.setAttribute("data-"+Ji,""):pa.removeAttribute("data-"+Ji)}),Yn.attributes.popper={}}}},En=[{name:"offset",options:{offset:te}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!De}},wc];V()&&Ue&&En.push({name:"arrow",options:{element:Ue,padding:3}}),En.push.apply(En,(F==null?void 0:F.modifiers)||[]),b.popperInstance=d3(Jn,k,Object.assign({},F,{placement:q,onFirstUpdate:f,modifiers:En}))}function ji(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function Pt(){var S=b.props.appendTo,F,q=U();b.props.interactive&&S===A0||S==="parent"?F=q.parentNode:F=_0(S,[q]),F.contains(k)||F.appendChild(k),b.state.isMounted=!0,qi(),{}.NODE_ENV!=="production"&&qt(b.props.interactive&&S===ze.appendTo&&q.nextElementSibling!==k,["Interactive tippy element may not be accessible via keyboard","navigation because it is not directly after the reference element","in the DOM source order.",`

`,"Using a wrapper <div> or <span> tag around the reference element","solves this by creating a new parentNode context.",`

`,"Specifying `appendTo: document.body` silences this warning, but it","assumes you are using a focus management solution to handle","keyboard navigation.",`

`,"See: https://atomiks.github.io/tippyjs/v6/accessibility/#interactivity"].join(" "))}function Kt(){return Vo(k.querySelectorAll("[data-tippy-root]"))}function Pr(S){b.clearDelayTimeouts(),S&&G("onTrigger",[b,S]),it();var F=D(!0),q=T(),te=q[0],Y=q[1];bt.isTouch&&te==="hold"&&Y&&(F=Y),F?r=setTimeout(function(){b.show()},F):b.show()}function Sn(S){if(b.clearDelayTimeouts(),G("onUntrigger",[b,S]),!b.state.isVisible){It();return}if(!(b.props.trigger.indexOf("mouseenter")>=0&&b.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(S.type)>=0&&s)){var F=D(!1);F?i=setTimeout(function(){b.state.isVisible&&b.hide()},F):o=requestAnimationFrame(function(){b.hide()})}}function Br(){b.state.isEnabled=!0}function Ui(){b.hide(),b.state.isEnabled=!1}function Wi(){clearTimeout(r),clearTimeout(i),cancelAnimationFrame(o)}function Zi(S){if({}.NODE_ENV!=="production"&&qt(b.state.isDestroyed,er("setProps")),!b.state.isDestroyed){G("onBeforeUpdate",[b,S]),$i();var F=b.props,q=Vd(n,Object.assign({},F,Fd(S),{ignoreAttributes:!0}));b.props=q,Gn(),F.interactiveDebounce!==q.interactiveDebounce&&(rt(),p=Hd(zi,q.interactiveDebounce)),F.triggerTarget&&!q.triggerTarget?ur(F.triggerTarget).forEach(function(te){te.removeAttribute("aria-expanded")}):q.triggerTarget&&n.removeAttribute("aria-expanded"),Te(),P(),C&&C(F,q),b.popperInstance&&(qi(),Kt().forEach(function(te){requestAnimationFrame(te._tippy.popperInstance.forceUpdate)})),G("onAfterUpdate",[b,S])}}function Ki(S){b.setProps({content:S})}function cm(){({}).NODE_ENV!=="production"&&qt(b.state.isDestroyed,er("show"));var S=b.state.isVisible,F=b.state.isDestroyed,q=!b.state.isEnabled,te=bt.isTouch&&!b.props.touch,Y=Ia(b.props.duration,0,ze.duration);if(!(S||F||q||te)&&!U().hasAttribute("disabled")&&(G("onShow",[b],!1),b.props.onShow(b)!==!1)){if(b.state.isVisible=!0,V()&&(k.style.visibility="visible"),P(),it(),b.state.isMounted||(k.style.transition="none"),V()){var De=R(),Ue=De.box,Jn=De.content;Fa([Ue,Jn],0)}f=function(){var En;if(!(!b.state.isVisible||l)){if(l=!0,k.offsetHeight,k.style.transition=b.props.moveTransition,V()&&b.props.animation){var ha=R(),Gi=ha.box,Yn=ha.content;Fa([Gi,Yn],Y),Pd([Gi,Yn],"visible")}he(),Te(),Id(Ba,b),(En=b.popperInstance)==null||En.forceUpdate(),G("onMount",[b]),b.props.animation&&V()&&Ft(Y,function(){b.state.isShown=!0,G("onShown",[b])})}},Pt()}}function dm(){({}).NODE_ENV!=="production"&&qt(b.state.isDestroyed,er("hide"));var S=!b.state.isVisible,F=b.state.isDestroyed,q=!b.state.isEnabled,te=Ia(b.props.duration,1,ze.duration);if(!(S||F||q)&&(G("onHide",[b],!1),b.props.onHide(b)!==!1)){if(b.state.isVisible=!1,b.state.isShown=!1,l=!1,s=!1,V()&&(k.style.visibility="hidden"),rt(),It(),P(!0),V()){var Y=R(),De=Y.box,Ue=Y.content;b.props.animation&&(Fa([De,Ue],te),Pd([De,Ue],"hidden"))}he(),Te(),b.props.animation?V()&&Zn(te,b.unmount):b.unmount()}}function fm(S){({}).NODE_ENV!=="production"&&qt(b.state.isDestroyed,er("hideWithInteractivity")),M().addEventListener("mousemove",p),Id(to,p),p(S)}function hm(){({}).NODE_ENV!=="production"&&qt(b.state.isDestroyed,er("unmount")),b.state.isVisible&&b.hide(),b.state.isMounted&&(ji(),Kt().forEach(function(S){S._tippy.unmount()}),k.parentNode&&k.parentNode.removeChild(k),Ba=Ba.filter(function(S){return S!==b}),b.state.isMounted=!1,G("onHidden",[b]))}function pm(){({}).NODE_ENV!=="production"&&qt(b.state.isDestroyed,er("destroy")),!b.state.isDestroyed&&(b.clearDelayTimeouts(),b.unmount(),$i(),delete n._tippy,b.state.isDestroyed=!0,G("onDestroy",[b]))}}function Ae(n,e){e===void 0&&(e={});var t=ze.plugins.concat(e.plugins||[]);({}).NODE_ENV!=="production"&&(O3(n),O0(e,t)),_3();var r=Object.assign({},e,{plugins:t}),i=w3(n);if({}.NODE_ENV!=="production"){var o=gi(r.content),s=i.length>1;qt(o&&s,["tippy() was passed an Element as the `content` prop, but more than","one tippy instance was created by this invocation. This means the","content element will only be appended to the last tippy instance.",`

`,"Instead, pass the .innerHTML of the element, or use a function that","returns a cloned version of the element instead.",`

`,`1) content: element.innerHTML
`,"2) content: () => element.cloneNode(true)"].join(" "))}var a=i.reduce(function(u,l){var c=l&&B3(l,r);return c&&u.push(c),u},[]);return gi(n)?a[0]:a}Ae.defaultProps=ze;Ae.setDefaultProps=H3;Ae.currentInput=bt;Object.assign({},m0,{effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow)}});Ae.setDefaultProps({render:R0});class Tr extends X{constructor(){super(...arguments);N(this,"tippyInstance");N(this,"tippyEl");N(this,"textEl");N(this,"menuData",[]);N(this,"menuTextWidth","40px");N(this,"defaultMenuIndex",0);N(this,"refreshMenuText",!0);N(this,"width","48px");N(this,"dropDivWith","100px");N(this,"dropDivHeight","260px");N(this,"showItemsTip",!1)}renderTemplate(){this.template=`
         <div style="width: ${this.width};">
         <div style="display: flex" id="tippy">
             <span style="line-height: 18px;font-size: 14px;text-align:center;overflow: hidden; width: ${this.menuTextWidth}" id="text">
                ${this.onMenuTextRender(this.defaultMenuIndex)}
             </span>
             <div style="width: 18px;height: 18px;display: inline-block">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 14L8 10H16L12 14Z"></path></svg>
             </div>
         </div>
         </div>
        `}connectedCallback(){this.renderTemplate(),super.connectedCallback(),this.textEl=this.querySelector("#text"),this.tippyInstance=Ae(this.querySelector("#tippy"),{content:this.createMenuElement(),appendTo:this.closest(".aie-container"),placement:"bottom",trigger:"click",interactive:!0,arrow:!1})}createMenuElement(){const t=document.createElement("div");t.style.height=this.dropDivHeight,t.style.width=this.dropDivWith,t.classList.add("aie-dropdown-container");for(let r=0;r<this.menuData.length;r++){const i=document.createElement("div");if(i.classList.add("aie-dropdown-item"),i.innerHTML=`
            <div class="red-dot-container" id="item${r}"><div class="${r==0?"red-dot":""}"></div></div>
            <div class="text">${this.onDropdownItemRender(r)}</div>
            `,i.addEventListener("click",()=>{this.onDropdownItemClick(r),this.tippyInstance.hide()}),this.showItemsTip){const o=this.menuData[r];Ae(i,{appendTo:()=>this.closest(".aie-container"),content:o.tip||o.title,theme:"aietip",arrow:!0,placement:"right"})}t.appendChild(i)}return this.tippyEl=t,t}onTransaction(t){var o,s;const r=(o=this.tippyEl)==null?void 0:o.querySelector(".red-dot");r&&r.classList.remove("red-dot");let i=this.defaultMenuIndex;for(let a=0;a<this.menuData.length;a++)if(this.onDropdownActive(t.editor,a)){i=a;break}if((s=this.tippyEl)==null||s.querySelector(`#item${i}`).children[0].classList.add("red-dot"),this.refreshMenuText&&this.textEl){const a=this.onMenuTextRender(i);typeof a=="string"||typeof a=="number"?this.textEl.innerHTML=a:(this.textEl.removeChild(this.textEl.firstChild),this.textEl.appendChild(a))}}}const $3={type:"logger",log(n){this.output("log",n)},warn(n){this.output("warn",n)},error(n){this.output("error",n)},output(n,e){console&&console[n]&&console[n].apply(console,e)}};class qo{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||$3,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,r,i){return i&&!this.debug?null:(typeof e[0]=="string"&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new qo(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new qo(this.logger,e)}}var kt=new qo;class Ws{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(r=>{this.observers[r]=this.observers[r]||[],this.observers[r].push(t)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e]=this.observers[e].filter(r=>r!==t)}}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.observers[e]&&[].concat(this.observers[e]).forEach(s=>{s(...r)}),this.observers["*"]&&[].concat(this.observers["*"]).forEach(s=>{s.apply(s,[e,...r])})}}function Vr(){let n,e;const t=new Promise((r,i)=>{n=r,e=i});return t.resolve=n,t.reject=e,t}function Ud(n){return n==null?"":""+n}function z3(n,e,t){n.forEach(r=>{e[r]&&(t[r]=e[r])})}function jl(n,e,t){function r(s){return s&&s.indexOf("###")>-1?s.replace(/###/g,"."):s}function i(){return!n||typeof n=="string"}const o=typeof e!="string"?[].concat(e):e.split(".");for(;o.length>1;){if(i())return{};const s=r(o.shift());!n[s]&&t&&(n[s]=new t),Object.prototype.hasOwnProperty.call(n,s)?n=n[s]:n={}}return i()?{}:{obj:n,k:r(o.shift())}}function Wd(n,e,t){const{obj:r,k:i}=jl(n,e,Object);r[i]=t}function V3(n,e,t,r){const{obj:i,k:o}=jl(n,e,Object);i[o]=i[o]||[],r&&(i[o]=i[o].concat(t)),r||i[o].push(t)}function jo(n,e){const{obj:t,k:r}=jl(n,e);if(t)return t[r]}function q3(n,e,t){const r=jo(n,t);return r!==void 0?r:jo(e,t)}function N0(n,e,t){for(const r in e)r!=="__proto__"&&r!=="constructor"&&(r in n?typeof n[r]=="string"||n[r]instanceof String||typeof e[r]=="string"||e[r]instanceof String?t&&(n[r]=e[r]):N0(n[r],e[r],t):n[r]=e[r]);return n}function tr(n){return n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var j3={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function U3(n){return typeof n=="string"?n.replace(/[&<>"'\/]/g,e=>j3[e]):n}const W3=[" ",",","?","!",";"];function Z3(n,e,t){e=e||"",t=t||"";const r=W3.filter(s=>e.indexOf(s)<0&&t.indexOf(s)<0);if(r.length===0)return!0;const i=new RegExp(`(${r.map(s=>s==="?"?"\\?":s).join("|")})`);let o=!i.test(n);if(!o){const s=n.indexOf(t);s>0&&!i.test(n.substring(0,s))&&(o=!0)}return o}function Uo(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!n)return;if(n[e])return n[e];const r=e.split(t);let i=n;for(let o=0;o<r.length;++o){if(!i||typeof i[r[o]]=="string"&&o+1<r.length)return;if(i[r[o]]===void 0){let s=2,a=r.slice(o,o+s).join(t),u=i[a];for(;u===void 0&&r.length>o+s;)s++,a=r.slice(o,o+s).join(t),u=i[a];if(u===void 0)return;if(u===null)return null;if(e.endsWith(a)){if(typeof u=="string")return u;if(a&&typeof u[a]=="string")return u[a]}const l=r.slice(o+s).join(t);return l?Uo(u,l,t):void 0}i=i[r[o]]}return i}function Wo(n){return n&&n.indexOf("_")>0?n.replace("_","-"):n}class Zd extends Ws{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,s=i.ignoreJSONStructure!==void 0?i.ignoreJSONStructure:this.options.ignoreJSONStructure;let a=[e,t];r&&typeof r!="string"&&(a=a.concat(r)),r&&typeof r=="string"&&(a=a.concat(o?r.split(o):r)),e.indexOf(".")>-1&&(a=e.split("."));const u=jo(this.data,a);return u||!s||typeof r!="string"?u:Uo(this.data&&this.data[e]&&this.data[e][t],r,o)}addResource(e,t,r,i){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const s=o.keySeparator!==void 0?o.keySeparator:this.options.keySeparator;let a=[e,t];r&&(a=a.concat(s?r.split(s):r)),e.indexOf(".")>-1&&(a=e.split("."),i=t,t=a[1]),this.addNamespaces(t),Wd(this.data,a,i),o.silent||this.emit("added",e,t,r,i)}addResources(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const o in r)(typeof r[o]=="string"||Object.prototype.toString.apply(r[o])==="[object Array]")&&this.addResource(e,t,o,r[o],{silent:!0});i.silent||this.emit("added",e,t,r)}addResourceBundle(e,t,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1},a=[e,t];e.indexOf(".")>-1&&(a=e.split("."),i=r,r=t,t=a[1]),this.addNamespaces(t);let u=jo(this.data,a)||{};i?N0(u,r,o):u={...u,...r},Wd(this.data,a,u),s.silent||this.emit("added",e,t,r)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(e,t)}:this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(i=>t[i]&&Object.keys(t[i]).length>0)}toJSON(){return this.data}}var H0={processors:{},addPostProcessor(n){this.processors[n.name]=n},handle(n,e,t,r,i){return n.forEach(o=>{this.processors[o]&&(e=this.processors[o].process(e,t,r,i))}),e}};const Kd={};class Zo extends Ws{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),z3(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=kt.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const r=this.resolve(e,t);return r&&r.res!==void 0}extractFromKey(e,t){let r=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const i=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let o=t.ns||this.options.defaultNS||[];const s=r&&e.indexOf(r)>-1,a=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!Z3(e,r,i);if(s&&!a){const u=e.match(this.interpolator.nestingRegexp);if(u&&u.length>0)return{key:e,namespaces:o};const l=e.split(r);(r!==i||r===i&&this.options.ns.indexOf(l[0])>-1)&&(o=l.shift()),e=l.join(i)}return typeof o=="string"&&(o=[o]),{key:e,namespaces:o}}translate(e,t,r){if(typeof t!="object"&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),typeof t=="object"&&(t={...t}),t||(t={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const i=t.returnDetails!==void 0?t.returnDetails:this.options.returnDetails,o=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator,{key:s,namespaces:a}=this.extractFromKey(e[e.length-1],t),u=a[a.length-1],l=t.lng||this.language,c=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(l&&l.toLowerCase()==="cimode"){if(c){const b=t.nsSeparator||this.options.nsSeparator;return i?{res:`${u}${b}${s}`,usedKey:s,exactUsedKey:s,usedLng:l,usedNS:u,usedParams:this.getUsedParamsDetails(t)}:`${u}${b}${s}`}return i?{res:s,usedKey:s,exactUsedKey:s,usedLng:l,usedNS:u,usedParams:this.getUsedParamsDetails(t)}:s}const d=this.resolve(e,t);let f=d&&d.res;const h=d&&d.usedKey||s,p=d&&d.exactUsedKey||s,m=Object.prototype.toString.apply(f),g=["[object Number]","[object Function]","[object RegExp]"],y=t.joinArrays!==void 0?t.joinArrays:this.options.joinArrays,x=!this.i18nFormat||this.i18nFormat.handleAsObject;if(x&&f&&(typeof f!="string"&&typeof f!="boolean"&&typeof f!="number")&&g.indexOf(m)<0&&!(typeof y=="string"&&m==="[object Array]")){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const b=this.options.returnedObjectHandler?this.options.returnedObjectHandler(h,f,{...t,ns:a}):`key '${s} (${this.language})' returned an object instead of string.`;return i?(d.res=b,d.usedParams=this.getUsedParamsDetails(t),d):b}if(o){const b=m==="[object Array]",w=b?[]:{},k=b?p:h;for(const C in f)if(Object.prototype.hasOwnProperty.call(f,C)){const E=`${k}${o}${C}`;w[C]=this.translate(E,{...t,joinArrays:!1,ns:a}),w[C]===E&&(w[C]=f[C])}f=w}}else if(x&&typeof y=="string"&&m==="[object Array]")f=f.join(y),f&&(f=this.extendTranslation(f,e,t,r));else{let b=!1,w=!1;const k=t.count!==void 0&&typeof t.count!="string",C=Zo.hasDefaultValue(t),E=k?this.pluralResolver.getSuffix(l,t.count,t):"",A=t.ordinal&&k?this.pluralResolver.getSuffix(l,t.count,{ordinal:!1}):"",T=t[`defaultValue${E}`]||t[`defaultValue${A}`]||t.defaultValue;!this.isValidLookup(f)&&C&&(b=!0,f=T),this.isValidLookup(f)||(w=!0,f=s);const V=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&w?void 0:f,U=C&&T!==f&&this.options.updateMissing;if(w||b||U){if(this.logger.log(U?"updateKey":"missingKey",l,u,s,U?T:f),o){const P=this.resolve(s,{...t,keySeparator:!1});P&&P.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let M=[];const R=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if(this.options.saveMissingTo==="fallback"&&R&&R[0])for(let P=0;P<R.length;P++)M.push(R[P]);else this.options.saveMissingTo==="all"?M=this.languageUtils.toResolveHierarchy(t.lng||this.language):M.push(t.lng||this.language);const D=(P,G,he)=>{const Te=C&&he!==f?he:V;this.options.missingKeyHandler?this.options.missingKeyHandler(P,u,G,Te,U,t):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(P,u,G,Te,U,t),this.emit("missingKey",P,u,G,f)};this.options.saveMissing&&(this.options.saveMissingPlurals&&k?M.forEach(P=>{this.pluralResolver.getSuffixes(P,t).forEach(G=>{D([P],s+G,t[`defaultValue${G}`]||T)})}):D(M,s,T))}f=this.extendTranslation(f,e,t,d,r),w&&f===s&&this.options.appendNamespaceToMissingKey&&(f=`${u}:${s}`),(w||b)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?f=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${u}:${s}`:s,b?f:void 0):f=this.options.parseMissingKeyHandler(f))}return i?(d.res=f,d.usedParams=this.getUsedParamsDetails(t),d):f}extendTranslation(e,t,r,i,o){var s=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const l=typeof e=="string"&&(r&&r.interpolation&&r.interpolation.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let c;if(l){const f=e.match(this.interpolator.nestingRegexp);c=f&&f.length}let d=r.replace&&typeof r.replace!="string"?r.replace:r;if(this.options.interpolation.defaultVariables&&(d={...this.options.interpolation.defaultVariables,...d}),e=this.interpolator.interpolate(e,d,r.lng||this.language,r),l){const f=e.match(this.interpolator.nestingRegexp),h=f&&f.length;c<h&&(r.nest=!1)}!r.lng&&this.options.compatibilityAPI!=="v1"&&i&&i.res&&(r.lng=i.usedLng),r.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var f=arguments.length,h=new Array(f),p=0;p<f;p++)h[p]=arguments[p];return o&&o[0]===h[0]&&!r.context?(s.logger.warn(`It seems you are nesting recursively key: ${h[0]} in key: ${t[0]}`),null):s.translate(...h,t)},r)),r.interpolation&&this.interpolator.reset()}const a=r.postProcess||this.options.postProcess,u=typeof a=="string"?[a]:a;return e!=null&&u&&u.length&&r.applyPostProcessor!==!1&&(e=H0.handle(u,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r,i,o,s,a;return typeof e=="string"&&(e=[e]),e.forEach(u=>{if(this.isValidLookup(r))return;const l=this.extractFromKey(u,t),c=l.key;i=c;let d=l.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));const f=t.count!==void 0&&typeof t.count!="string",h=f&&!t.ordinal&&t.count===0&&this.pluralResolver.shouldUseIntlApi(),p=t.context!==void 0&&(typeof t.context=="string"||typeof t.context=="number")&&t.context!=="",m=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);d.forEach(g=>{this.isValidLookup(r)||(a=g,!Kd[`${m[0]}-${g}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(a)&&(Kd[`${m[0]}-${g}`]=!0,this.logger.warn(`key "${i}" for languages "${m.join(", ")}" won't get resolved as namespace "${a}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),m.forEach(y=>{if(this.isValidLookup(r))return;s=y;const x=[c];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(x,c,y,g,t);else{let b;f&&(b=this.pluralResolver.getSuffix(y,t.count,t));const w=`${this.options.pluralSeparator}zero`,k=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(f&&(x.push(c+b),t.ordinal&&b.indexOf(k)===0&&x.push(c+b.replace(k,this.options.pluralSeparator)),h&&x.push(c+w)),p){const C=`${c}${this.options.contextSeparator}${t.context}`;x.push(C),f&&(x.push(C+b),t.ordinal&&b.indexOf(k)===0&&x.push(C+b.replace(k,this.options.pluralSeparator)),h&&x.push(C+w))}}let v;for(;v=x.pop();)this.isValidLookup(r)||(o=v,r=this.getResource(y,g,v,t))}))})}),{res:r,usedKey:i,exactUsedKey:o,usedLng:s,usedNS:a}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,r,i):this.resourceStore.getResource(e,t,r,i)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&typeof e.replace!="string";let i=r?e.replace:e;if(r&&typeof e.count<"u"&&(i.count=e.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!r){i={...i};for(const o of t)delete i[o]}return i}static hasDefaultValue(e){const t="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t===r.substring(0,t.length)&&e[r]!==void 0)return!0;return!1}}function $a(n){return n.charAt(0).toUpperCase()+n.slice(1)}class Gd{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=kt.create("languageUtils")}getScriptPartFromCode(e){if(e=Wo(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=Wo(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(typeof e=="string"&&e.indexOf("-")>-1){const t=["hans","hant","latn","cyrl","cans","mong","arab"];let r=e.split("-");return this.options.lowerCaseLng?r=r.map(i=>i.toLowerCase()):r.length===2?(r[0]=r[0].toLowerCase(),r[1]=r[1].toUpperCase(),t.indexOf(r[1].toLowerCase())>-1&&(r[1]=$a(r[1].toLowerCase()))):r.length===3&&(r[0]=r[0].toLowerCase(),r[1].length===2&&(r[1]=r[1].toUpperCase()),r[0]!=="sgn"&&r[2].length===2&&(r[2]=r[2].toUpperCase()),t.indexOf(r[1].toLowerCase())>-1&&(r[1]=$a(r[1].toLowerCase())),t.indexOf(r[2].toLowerCase())>-1&&(r[2]=$a(r[2].toLowerCase()))),r.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(r=>{if(t)return;const i=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(i))&&(t=i)}),!t&&this.options.supportedLngs&&e.forEach(r=>{if(t)return;const i=this.getLanguagePartFromCode(r);if(this.isSupportedCode(i))return t=i;t=this.options.supportedLngs.find(o=>{if(o===i)return o;if(!(o.indexOf("-")<0&&i.indexOf("-")<0)&&o.indexOf(i)===0)return o})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),typeof e=="string"&&(e=[e]),Object.prototype.toString.apply(e)==="[object Array]")return e;if(!t)return e.default||[];let r=e[t];return r||(r=e[this.getScriptPartFromCode(t)]),r||(r=e[this.formatLanguageCode(t)]),r||(r=e[this.getLanguagePartFromCode(t)]),r||(r=e.default),r||[]}toResolveHierarchy(e,t){const r=this.getFallbackCodes(t||this.options.fallbackLng||[],e),i=[],o=s=>{s&&(this.isSupportedCode(s)?i.push(s):this.logger.warn(`rejecting language code not found in supportedLngs: ${s}`))};return typeof e=="string"&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&o(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&o(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&o(this.getLanguagePartFromCode(e))):typeof e=="string"&&o(this.formatLanguageCode(e)),r.forEach(s=>{i.indexOf(s)<0&&o(this.formatLanguageCode(s))}),i}}let K3=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],G3={1:function(n){return+(n>1)},2:function(n){return+(n!=1)},3:function(n){return 0},4:function(n){return n%10==1&&n%100!=11?0:n%10>=2&&n%10<=4&&(n%100<10||n%100>=20)?1:2},5:function(n){return n==0?0:n==1?1:n==2?2:n%100>=3&&n%100<=10?3:n%100>=11?4:5},6:function(n){return n==1?0:n>=2&&n<=4?1:2},7:function(n){return n==1?0:n%10>=2&&n%10<=4&&(n%100<10||n%100>=20)?1:2},8:function(n){return n==1?0:n==2?1:n!=8&&n!=11?2:3},9:function(n){return+(n>=2)},10:function(n){return n==1?0:n==2?1:n<7?2:n<11?3:4},11:function(n){return n==1||n==11?0:n==2||n==12?1:n>2&&n<20?2:3},12:function(n){return+(n%10!=1||n%100==11)},13:function(n){return+(n!==0)},14:function(n){return n==1?0:n==2?1:n==3?2:3},15:function(n){return n%10==1&&n%100!=11?0:n%10>=2&&(n%100<10||n%100>=20)?1:2},16:function(n){return n%10==1&&n%100!=11?0:n!==0?1:2},17:function(n){return n==1||n%10==1&&n%100!=11?0:1},18:function(n){return n==0?0:n==1?1:2},19:function(n){return n==1?0:n==0||n%100>1&&n%100<11?1:n%100>10&&n%100<20?2:3},20:function(n){return n==1?0:n==0||n%100>0&&n%100<20?1:2},21:function(n){return n%100==1?1:n%100==2?2:n%100==3||n%100==4?3:0},22:function(n){return n==1?0:n==2?1:(n<0||n>10)&&n%10==0?2:3}};const J3=["v1","v2","v3"],Y3=["v4"],Jd={zero:0,one:1,two:2,few:3,many:4,other:5};function X3(){const n={};return K3.forEach(e=>{e.lngs.forEach(t=>{n[t]={numbers:e.nr,plurals:G3[e.fc]}})}),n}class Q3{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=kt.create("pluralResolver"),(!this.options.compatibilityJSON||Y3.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=X3()}addRule(e,t){this.rules[e]=t}getRule(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(Wo(e),{type:t.ordinal?"ordinal":"cardinal"})}catch{return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=this.getRule(e,t);return this.shouldUseIntlApi()?r&&r.resolvedOptions().pluralCategories.length>1:r&&r.numbers.length>1}getPluralFormsOfKey(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,r).map(i=>`${t}${i}`)}getSuffixes(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=this.getRule(e,t);return r?this.shouldUseIntlApi()?r.resolvedOptions().pluralCategories.sort((i,o)=>Jd[i]-Jd[o]).map(i=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${i}`):r.numbers.map(i=>this.getSuffix(e,i,t)):[]}getSuffix(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=this.getRule(e,r);return i?this.shouldUseIntlApi()?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${i.select(t)}`:this.getSuffixRetroCompatible(i,t):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,t){const r=e.noAbs?e.plurals(t):e.plurals(Math.abs(t));let i=e.numbers[r];this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1&&(i===2?i="plural":i===1&&(i=""));const o=()=>this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString();return this.options.compatibilityJSON==="v1"?i===1?"":typeof i=="number"?`_plural_${i.toString()}`:o():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1?o():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}shouldUseIntlApi(){return!J3.includes(this.options.compatibilityJSON)}}function Yd(n,e,t){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=q3(n,e,t);return!o&&i&&typeof t=="string"&&(o=Uo(n,t,r),o===void 0&&(o=Uo(e,t,r))),o}class ev{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=kt.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(t=>t),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const t=e.interpolation;this.escape=t.escape!==void 0?t.escape:U3,this.escapeValue=t.escapeValue!==void 0?t.escapeValue:!0,this.useRawValueToEscape=t.useRawValueToEscape!==void 0?t.useRawValueToEscape:!1,this.prefix=t.prefix?tr(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?tr(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?tr(t.nestingPrefix):t.nestingPrefixEscaped||tr("$t("),this.nestingSuffix=t.nestingSuffix?tr(t.nestingSuffix):t.nestingSuffixEscaped||tr(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator?t.nestingOptionsSeparator:t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces?t.maxReplaces:1e3,this.alwaysFormat=t.alwaysFormat!==void 0?t.alwaysFormat:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=`${this.prefix}(.+?)${this.suffix}`;this.regexp=new RegExp(e,"g");const t=`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`;this.regexpUnescape=new RegExp(t,"g");const r=`${this.nestingPrefix}(.+?)${this.nestingSuffix}`;this.nestingRegexp=new RegExp(r,"g")}interpolate(e,t,r,i){let o,s,a;const u=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function l(p){return p.replace(/\$/g,"$$$$")}const c=p=>{if(p.indexOf(this.formatSeparator)<0){const x=Yd(t,u,p,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(x,void 0,r,{...i,...t,interpolationkey:p}):x}const m=p.split(this.formatSeparator),g=m.shift().trim(),y=m.join(this.formatSeparator).trim();return this.format(Yd(t,u,g,this.options.keySeparator,this.options.ignoreJSONStructure),y,r,{...i,...t,interpolationkey:g})};this.resetRegExp();const d=i&&i.missingInterpolationHandler||this.options.missingInterpolationHandler,f=i&&i.interpolation&&i.interpolation.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:p=>l(p)},{regex:this.regexp,safeValue:p=>this.escapeValue?l(this.escape(p)):l(p)}].forEach(p=>{for(a=0;o=p.regex.exec(e);){const m=o[1].trim();if(s=c(m),s===void 0)if(typeof d=="function"){const y=d(e,o,i);s=typeof y=="string"?y:""}else if(i&&Object.prototype.hasOwnProperty.call(i,m))s="";else if(f){s=o[0];continue}else this.logger.warn(`missed to pass in variable ${m} for interpolating ${e}`),s="";else typeof s!="string"&&!this.useRawValueToEscape&&(s=Ud(s));const g=p.safeValue(s);if(e=e.replace(o[0],g),f?(p.regex.lastIndex+=s.length,p.regex.lastIndex-=o[0].length):p.regex.lastIndex=0,a++,a>=this.maxReplaces)break}}),e}nest(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,o,s;function a(u,l){const c=this.nestingOptionsSeparator;if(u.indexOf(c)<0)return u;const d=u.split(new RegExp(`${c}[ ]*{`));let f=`{${d[1]}`;u=d[0],f=this.interpolate(f,s);const h=f.match(/'/g),p=f.match(/"/g);(h&&h.length%2===0&&!p||p.length%2!==0)&&(f=f.replace(/'/g,'"'));try{s=JSON.parse(f),l&&(s={...l,...s})}catch(m){return this.logger.warn(`failed parsing options string in nesting for key ${u}`,m),`${u}${c}${f}`}return delete s.defaultValue,u}for(;i=this.nestingRegexp.exec(e);){let u=[];s={...r},s=s.replace&&typeof s.replace!="string"?s.replace:s,s.applyPostProcessor=!1,delete s.defaultValue;let l=!1;if(i[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(i[1])){const c=i[1].split(this.formatSeparator).map(d=>d.trim());i[1]=c.shift(),u=c,l=!0}if(o=t(a.call(this,i[1].trim(),s),s),o&&i[0]===e&&typeof o!="string")return o;typeof o!="string"&&(o=Ud(o)),o||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${e}`),o=""),l&&(o=u.reduce((c,d)=>this.format(c,d,r.lng,{...r,interpolationkey:i[1].trim()}),o.trim())),e=e.replace(i[0],o),this.regexp.lastIndex=0}return e}}function tv(n){let e=n.toLowerCase().trim();const t={};if(n.indexOf("(")>-1){const r=n.split("(");e=r[0].toLowerCase().trim();const i=r[1].substring(0,r[1].length-1);e==="currency"&&i.indexOf(":")<0?t.currency||(t.currency=i.trim()):e==="relativetime"&&i.indexOf(":")<0?t.range||(t.range=i.trim()):i.split(";").forEach(s=>{if(!s)return;const[a,...u]=s.split(":"),l=u.join(":").trim().replace(/^'+|'+$/g,"");t[a.trim()]||(t[a.trim()]=l),l==="false"&&(t[a.trim()]=!1),l==="true"&&(t[a.trim()]=!0),isNaN(l)||(t[a.trim()]=parseInt(l,10))})}return{formatName:e,formatOptions:t}}function nr(n){const e={};return function(r,i,o){const s=i+JSON.stringify(o);let a=e[s];return a||(a=n(Wo(i),o),e[s]=a),a(r)}}class nv{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=kt.create("formatter"),this.options=e,this.formats={number:nr((t,r)=>{const i=new Intl.NumberFormat(t,{...r});return o=>i.format(o)}),currency:nr((t,r)=>{const i=new Intl.NumberFormat(t,{...r,style:"currency"});return o=>i.format(o)}),datetime:nr((t,r)=>{const i=new Intl.DateTimeFormat(t,{...r});return o=>i.format(o)}),relativetime:nr((t,r)=>{const i=new Intl.RelativeTimeFormat(t,{...r});return o=>i.format(o,r.range||"day")}),list:nr((t,r)=>{const i=new Intl.ListFormat(t,{...r});return o=>i.format(o)})},this.init(e)}init(e){const r=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=r.formatSeparator?r.formatSeparator:r.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=nr(t)}format(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return t.split(this.formatSeparator).reduce((a,u)=>{const{formatName:l,formatOptions:c}=tv(u);if(this.formats[l]){let d=a;try{const f=i&&i.formatParams&&i.formatParams[i.interpolationkey]||{},h=f.locale||f.lng||i.locale||i.lng||r;d=this.formats[l](a,h,{...c,...i,...f})}catch(f){this.logger.warn(f)}return d}else this.logger.warn(`there was no format function for ${l}`);return a},e)}}function rv(n,e){n.pending[e]!==void 0&&(delete n.pending[e],n.pendingCount--)}class iv extends Ws{constructor(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=r,this.languageUtils=r.languageUtils,this.options=i,this.logger=kt.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(r,i.backend,i)}queueLoad(e,t,r,i){const o={},s={},a={},u={};return e.forEach(l=>{let c=!0;t.forEach(d=>{const f=`${l}|${d}`;!r.reload&&this.store.hasResourceBundle(l,d)?this.state[f]=2:this.state[f]<0||(this.state[f]===1?s[f]===void 0&&(s[f]=!0):(this.state[f]=1,c=!1,s[f]===void 0&&(s[f]=!0),o[f]===void 0&&(o[f]=!0),u[d]===void 0&&(u[d]=!0)))}),c||(a[l]=!0)}),(Object.keys(o).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(o),pending:Object.keys(s),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(u)}}loaded(e,t,r){const i=e.split("|"),o=i[0],s=i[1];t&&this.emit("failedLoading",o,s,t),r&&this.store.addResourceBundle(o,s,r),this.state[e]=t?-1:2;const a={};this.queue.forEach(u=>{V3(u.loaded,[o],s),rv(u,e),t&&u.errors.push(t),u.pendingCount===0&&!u.done&&(Object.keys(u.loaded).forEach(l=>{a[l]||(a[l]={});const c=u.loaded[l];c.length&&c.forEach(d=>{a[l][d]===void 0&&(a[l][d]=!0)})}),u.done=!0,u.errors.length?u.callback(u.errors):u.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(u=>!u.done)}read(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,s=arguments.length>5?arguments[5]:void 0;if(!e.length)return s(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:r,tried:i,wait:o,callback:s});return}this.readingCalls++;const a=(l,c)=>{if(this.readingCalls--,this.waitingReads.length>0){const d=this.waitingReads.shift();this.read(d.lng,d.ns,d.fcName,d.tried,d.wait,d.callback)}if(l&&c&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,r,i+1,o*2,s)},o);return}s(l,c)},u=this.backend[r].bind(this.backend);if(u.length===2){try{const l=u(e,t);l&&typeof l.then=="function"?l.then(c=>a(null,c)).catch(a):a(null,l)}catch(l){a(l)}return}return u(e,t,a)}prepareLoading(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();typeof e=="string"&&(e=this.languageUtils.toResolveHierarchy(e)),typeof t=="string"&&(t=[t]);const o=this.queueLoad(e,t,r,i);if(!o.toLoad.length)return o.pending.length||i(),null;o.toLoad.forEach(s=>{this.loadOne(s)})}load(e,t,r){this.prepareLoading(e,t,{},r)}reload(e,t,r){this.prepareLoading(e,t,{reload:!0},r)}loadOne(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=e.split("|"),i=r[0],o=r[1];this.read(i,o,"read",void 0,void 0,(s,a)=>{s&&this.logger.warn(`${t}loading namespace ${o} for language ${i} failed`,s),!s&&a&&this.logger.log(`${t}loaded namespace ${o} for language ${i}`,a),this.loaded(e,s,a)})}saveMissing(e,t,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)){this.logger.warn(`did not save key "${r}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if(this.backend&&this.backend.create){const u={...s,isUpdate:o},l=this.backend.create.bind(this.backend);if(l.length<6)try{let c;l.length===5?c=l(e,t,r,i,u):c=l(e,t,r,i),c&&typeof c.then=="function"?c.then(d=>a(null,d)).catch(a):a(null,c)}catch(c){a(c)}else l(e,t,r,i,a,u)}!e||!e[0]||this.store.addResource(e[0],t,r,i)}}}function Xd(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){let t={};if(typeof e[1]=="object"&&(t=e[1]),typeof e[1]=="string"&&(t.defaultValue=e[1]),typeof e[2]=="string"&&(t.tDescription=e[2]),typeof e[2]=="object"||typeof e[3]=="object"){const r=e[3]||e[2];Object.keys(r).forEach(i=>{t[i]=r[i]})}return t},interpolation:{escapeValue:!0,format:(n,e,t,r)=>n,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function Qd(n){return typeof n.ns=="string"&&(n.ns=[n.ns]),typeof n.fallbackLng=="string"&&(n.fallbackLng=[n.fallbackLng]),typeof n.fallbackNS=="string"&&(n.fallbackNS=[n.fallbackNS]),n.supportedLngs&&n.supportedLngs.indexOf("cimode")<0&&(n.supportedLngs=n.supportedLngs.concat(["cimode"])),n}function no(){}function ov(n){Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach(t=>{typeof n[t]=="function"&&(n[t]=n[t].bind(n))})}class yi extends Ws{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(super(),this.options=Qd(e),this.services={},this.logger=kt,this.modules={external:[]},ov(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;typeof t=="function"&&(r=t,t={}),!t.defaultNS&&t.defaultNS!==!1&&t.ns&&(typeof t.ns=="string"?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const i=Xd();this.options={...i,...this.options,...Qd(t)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...i.interpolation,...this.options.interpolation}),t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);function o(c){return c?typeof c=="function"?new c:c:null}if(!this.options.isClone){this.modules.logger?kt.init(o(this.modules.logger),this.options):kt.init(null,this.options);let c;this.modules.formatter?c=this.modules.formatter:typeof Intl<"u"&&(c=nv);const d=new Gd(this.options);this.store=new Zd(this.options.resources,this.options);const f=this.services;f.logger=kt,f.resourceStore=this.store,f.languageUtils=d,f.pluralResolver=new Q3(d,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),c&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(f.formatter=o(c),f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new ev(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new iv(o(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",function(h){for(var p=arguments.length,m=new Array(p>1?p-1:0),g=1;g<p;g++)m[g-1]=arguments[g];e.emit(h,...m)}),this.modules.languageDetector&&(f.languageDetector=o(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=o(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new Zo(this.services,this.options),this.translator.on("*",function(h){for(var p=arguments.length,m=new Array(p>1?p-1:0),g=1;g<p;g++)m[g-1]=arguments[g];e.emit(h,...m)}),this.modules.external.forEach(h=>{h.init&&h.init(this)})}if(this.format=this.options.interpolation.format,r||(r=no),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&c[0]!=="dev"&&(this.options.lng=c[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(c=>{this[c]=function(){return e.store[c](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(c=>{this[c]=function(){return e.store[c](...arguments),e}});const u=Vr(),l=()=>{const c=(d,f)=>{this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),u.resolve(f),r(d,f)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return c(null,this.t.bind(this));this.changeLanguage(this.options.lng,c)};return this.options.resources||!this.options.initImmediate?l():setTimeout(l,0),u}loadResources(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:no;const i=typeof e=="string"?e:this.language;if(typeof e=="function"&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if(i&&i.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const o=[],s=a=>{if(!a||a==="cimode")return;this.services.languageUtils.toResolveHierarchy(a).forEach(l=>{l!=="cimode"&&o.indexOf(l)<0&&o.push(l)})};i?s(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(u=>s(u)),this.options.preload&&this.options.preload.forEach(a=>s(a)),this.services.backendConnector.load(o,this.options.ns,a=>{!a&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(a)})}else r(null)}reloadResources(e,t,r){const i=Vr();return e||(e=this.languages),t||(t=this.options.ns),r||(r=no),this.services.backendConnector.reload(e,t,o=>{i.resolve(),r(o)}),i}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&H0.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let t=0;t<this.languages.length;t++){const r=this.languages[t];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}}changeLanguage(e,t){var r=this;this.isLanguageChangingTo=e;const i=Vr();this.emit("languageChanging",e);const o=u=>{this.language=u,this.languages=this.services.languageUtils.toResolveHierarchy(u),this.resolvedLanguage=void 0,this.setResolvedLanguage(u)},s=(u,l)=>{l?(o(l),this.translator.changeLanguage(l),this.isLanguageChangingTo=void 0,this.emit("languageChanged",l),this.logger.log("languageChanged",l)):this.isLanguageChangingTo=void 0,i.resolve(function(){return r.t(...arguments)}),t&&t(u,function(){return r.t(...arguments)})},a=u=>{!e&&!u&&this.services.languageDetector&&(u=[]);const l=typeof u=="string"?u:this.services.languageUtils.getBestMatchFromCodes(u);l&&(this.language||o(l),this.translator.language||this.translator.changeLanguage(l),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(l)),this.loadResources(l,c=>{s(c,l)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?a(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e),i}getFixedT(e,t,r){var i=this;const o=function(s,a){let u;if(typeof a!="object"){for(var l=arguments.length,c=new Array(l>2?l-2:0),d=2;d<l;d++)c[d-2]=arguments[d];u=i.options.overloadTranslationOptionHandler([s,a].concat(c))}else u={...a};u.lng=u.lng||o.lng,u.lngs=u.lngs||o.lngs,u.ns=u.ns||o.ns,u.keyPrefix=u.keyPrefix||r||o.keyPrefix;const f=i.options.keySeparator||".";let h;return u.keyPrefix&&Array.isArray(s)?h=s.map(p=>`${u.keyPrefix}${f}${p}`):h=u.keyPrefix?`${u.keyPrefix}${f}${s}`:s,i.t(h,u)};return typeof e=="string"?o.lng=e:o.lngs=e,o.ns=t,o.keyPrefix=r,o}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=t.lng||this.resolvedLanguage||this.languages[0],i=this.options?this.options.fallbackLng:!1,o=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const s=(a,u)=>{const l=this.services.backendConnector.state[`${a}|${u}`];return l===-1||l===2};if(t.precheck){const a=t.precheck(this,s);if(a!==void 0)return a}return!!(this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||s(r,e)&&(!i||s(o,e)))}loadNamespaces(e,t){const r=Vr();return this.options.ns?(typeof e=="string"&&(e=[e]),e.forEach(i=>{this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}),this.loadResources(i=>{r.resolve(),t&&t(i)}),r):(t&&t(),Promise.resolve())}loadLanguages(e,t){const r=Vr();typeof e=="string"&&(e=[e]);const i=this.options.preload||[],o=e.filter(s=>i.indexOf(s)<0);return o.length?(this.options.preload=i.concat(o),this.loadResources(s=>{r.resolve(),t&&t(s)}),r):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=this.services&&this.services.languageUtils||new Gd(Xd());return t.indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return new yi(e,t)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:no;const r=e.forkResourceStore;r&&delete e.forkResourceStore;const i={...this.options,...e,isClone:!0},o=new yi(i);return(e.debug!==void 0||e.prefix!==void 0)&&(o.logger=o.logger.clone(e)),["store","services","language"].forEach(a=>{o[a]=this[a]}),o.services={...this.services},o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},r&&(o.store=new Zd(this.store.data,i),o.services.resourceStore=o.store),o.translator=new Zo(o.services,i),o.translator.on("*",function(a){for(var u=arguments.length,l=new Array(u>1?u-1:0),c=1;c<u;c++)l[c-1]=arguments[c];o.emit(a,...l)}),o.init(i,t),o.translator.options=i,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Ce=yi.createInstance();Ce.createInstance=yi.createInstance;Ce.createInstance;Ce.dir;Ce.init;Ce.loadResources;Ce.reloadResources;Ce.use;Ce.changeLanguage;Ce.getFixedT;const j=Ce.t;Ce.exists;Ce.setDefaultNamespace;Ce.hasLoadedNamespace;Ce.loadNamespaces;Ce.loadLanguages;const sv=["paragraph","h1","h2","h3","h4","h5","h6"];let av=class extends Tr{constructor(){super(),this.menuData=sv.map(e=>j(e)),this.dropDivHeight="265px",this.dropDivWith="150px"}onDropdownActive(e,t){return t==0?e.isActive("paragraph"):e.isActive("heading",{level:t})}onDropdownItemClick(e){e==0?this.editor.chain().setParagraph().run():this.editor.chain().setHeading({level:e}).run()}onDropdownItemRender(e){return e==0?this.menuData[e]:`<h${e}>${this.menuData[e]}</h${e}>`}onMenuTextRender(e){return this.menuData[e].replace(" ","")}};const uv=[{name:"",value:"SimSun"},{name:"",value:"FangSong"},{name:"",value:"SimHei"},{name:"",value:"KaiTi"},{name:"",value:"Microsoft YaHei"},{name:"_GBK",value:"FangSong_GB2312"},{name:"Arial",value:"Arial"}];let lv=class extends Tr{constructor(){super(),this.width="72px",this.menuTextWidth="60px",this.dropDivWith="150px"}onCreate(e,t){var r;super.onCreate(e,t),this.menuData=((r=t.fontFamily)==null?void 0:r.values)||uv,this.menuData=[{name:j("default-font-family"),value:""}].concat(this.menuData)}onDropdownActive(e,t){return e.isActive("textStyle",{fontFamily:this.menuData[t].value})}onDropdownItemClick(e){const t=this.menuData[e].value;t?this.editor.chain().setFontFamily(t).run():this.editor.chain().unsetFontFamily().run()}onDropdownItemRender(e){return this.menuData[e].name}onMenuTextRender(e){return this.menuData[e].name}};const cv=[{name:"9",value:9},{name:"10",value:10},{name:"11",value:11},{name:"12",value:12},{name:"14",value:14},{name:"18",value:18},{name:"20",value:20},{name:"22",value:22},{name:"24",value:24},{name:"26",value:26},{name:"28",value:28},{name:"30",value:30},{name:"36",value:36},{name:"42",value:42},{name:"48",value:48},{name:"56",value:56},{name:"72",value:72}];class dv extends Tr{constructor(){super(),this.dropDivWith="134px"}onCreate(e,t){var r;super.onCreate(e,t),this.menuData=((r=t.fontSize)==null?void 0:r.values)||cv;for(let i=0;i<this.menuData.length;i++)if(this.menuData[i].value==14){this.defaultMenuIndex=i,this.menuData[i].name=`14${j("default")}`;break}}onDropdownActive(e,t){return e.isActive("textStyle",{fontSize:`${this.menuData[t].value}px`})}onDropdownItemClick(e){var r,i;const t=this.menuData[e].value;t==14?(r=this.editor)==null||r.chain().focus().unsetFontSize().run():(i=this.editor)==null||i.chain().focus().setFontSize(`${t}px`).run()}onDropdownItemRender(e){return this.menuData[e].name}onMenuTextRender(e){const t=this.menuData[e];return t.value==14?j("default-font-size"):t.name}}let fv=class extends X{constructor(){super();const e=`
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 11H12.5C13.8807 11 15 9.88071 15 8.5C15 7.11929 13.8807 6 12.5 6H8V11ZM18 15.5C18 17.9853 15.9853 20 13.5 20H6V4H12.5C14.9853 4 17 6.01472 17 8.5C17 9.70431 16.5269 10.7981 15.7564 11.6058C17.0979 12.3847 18 13.837 18 15.5ZM8 13V18H13.5C14.8807 18 16 16.8807 16 15.5C16 14.1193 14.8807 13 13.5 13H8Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.toggleBold()}onActive(e){return e.isActive("bold")}},hv=class extends X{constructor(){super();const e=`
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 20H7V18H9.92661L12.0425 6H9V4H17V6H14.0734L11.9575 18H15V20Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.toggleItalic()}onActive(e){return e.isActive("italic")}},pv=class extends X{constructor(){super();const e=`
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 3V12C8 14.2091 9.79086 16 12 16C14.2091 16 16 14.2091 16 12V3H18V12C18 15.3137 15.3137 18 12 18C8.68629 18 6 15.3137 6 12V3H8ZM4 20H20V22H4V20Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.toggleUnderline()}onActive(e){return e.isActive("underline")}},mv=class extends X{constructor(){super();const e=`
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.1538 14C17.3846 14.5161 17.5 15.0893 17.5 15.7196C17.5 17.0625 16.9762 18.1116 15.9286 18.867C14.8809 19.6223 13.4335 20 11.5862 20C9.94674 20 8.32335 19.6185 6.71592 18.8555V16.6009C8.23538 17.4783 9.7908 17.917 11.3822 17.917C13.9333 17.917 15.2128 17.1846 15.2208 15.7196C15.2208 15.0939 15.0049 14.5598 14.5731 14.1173C14.5339 14.0772 14.4939 14.0381 14.4531 14H3V12H21V14H17.1538ZM13.076 11H7.62908C7.4566 10.8433 7.29616 10.6692 7.14776 10.4778C6.71592 9.92084 6.5 9.24559 6.5 8.45207C6.5 7.21602 6.96583 6.165 7.89749 5.299C8.82916 4.43299 10.2706 4 12.2219 4C13.6934 4 15.1009 4.32808 16.4444 4.98426V7.13591C15.2448 6.44921 13.9293 6.10587 12.4978 6.10587C10.0187 6.10587 8.77917 6.88793 8.77917 8.45207C8.77917 8.87172 8.99709 9.23796 9.43293 9.55079C9.86878 9.86362 10.4066 10.1135 11.0463 10.3004C11.6665 10.4816 12.3431 10.7148 13.076 11H13.076Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.toggleStrike()}onActive(e){return e.isActive("strike")}},gv=class extends X{constructor(){super();const e=`
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.59567 4L10.5 9.92831L15.4043 4H18L11.7978 11.4971L18 18.9943V19H15.4091L10.5 13.0659L5.59092 19H3V18.9943L9.20216 11.4971L3 4H5.59567ZM21.8 16C21.8 15.5582 21.4418 15.2 21 15.2C20.5582 15.2 20.2 15.5582 20.2 16C20.2 16.0762 20.2107 16.15 20.2306 16.2198L19.0765 16.5496C19.0267 16.375 19 16.1906 19 16C19 14.8954 19.8954 14 21 14C22.1046 14 23 14.8954 23 16C23 16.5727 22.7593 17.0892 22.3735 17.4538L20.7441 19H23V20H19V19L21.5507 16.5803C21.7042 16.4345 21.8 16.2284 21.8 16Z"></path></svg>
         </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.toggleSubscript()}onActive(e){return e.isActive("subscript")}},bv=class extends X{constructor(){super();const e=`
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.59567 5L10.5 10.9283L15.4043 5H18L11.7978 12.4971L18 19.9943V20H15.4091L10.5 14.0659L5.59092 20H3V19.9943L9.20216 12.4971L3 5H5.59567ZM21.5507 6.5803C21.7042 6.43453 21.8 6.22845 21.8 6C21.8 5.55817 21.4418 5.2 21 5.2C20.5582 5.2 20.2 5.55817 20.2 6C20.2 6.07624 20.2107 6.14999 20.2306 6.21983L19.0765 6.54958C19.0267 6.37497 19 6.1906 19 6C19 4.89543 19.8954 4 21 4C22.1046 4 23 4.89543 23 6C23 6.57273 22.7593 7.08923 22.3735 7.45384L20.7441 9H23V10H19V9L21.5507 6.5803V6.5803Z"></path></svg>
         </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.toggleSuperscript()}onActive(e){return e.isActive("superscript")}};const yv=["ffffff","000000","e9d989","2972f4","609eec","de3c36","a1d533","7334c5","27b5d9","ff8926","f2f2f2","7f7f7f","ddd9c3","c6d9f0","dbe5f1","f2dcdb","ebf1dd","e5e0ec","dbeef3","fdeada","d8d8d8","595959","c4bd97","8db3e2","b8cce4","e5b9b7","d7e3bc","ccc1d9","b7dde8","fbd5b5","bfbfbf","3f3f3f","938953","548dd4","95b3d7","d99694","c3d69b","b2a2c7","92cddc","fac08f","a5a5a5","262626","494429","17365d","366092","953734","76923c","5f497a","31859b","e36c09","6e6e6e","0c0c0c","1d1b10","0f243e","244061","632423","4f6128","3f3151","205867","974806"],xv=["c00000","ff0000","ffc000","ffff00","92d050","00b050","00b0f0","0070c0","002060","7030a0"];class I0 extends X{constructor(){super();N(this,"historyColorsKey","historyColors");N(this,"historyColors",[]);N(this,"iconSvg");N(this,"menuColorEL");N(this,"onColorItemClick");N(this,"onDefaultColorClick")}connectedCallback(){this.template=`
            <div style="width: 36px;height: 18px;display: flex;padding-right: 0">
                <div style="width: 18px;height: 18px" class="currentColor">
                    <div style="height: 15px;width: 15px;padding:0 1.5px;line-height: 18px">${this.iconSvg}</div>
                    <div style="width: 18px;height: 3px;background: #333" id="menuColorEL"></div>
                </div>
                <div style="width: 18px;height: 18px" id="dropdown">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 14L8 10H16L12 14Z"></path></svg>
                </div>
            </div>
            `,super.connectedCallback();const t=localStorage.getItem(this.historyColorsKey);t&&(this.historyColors=JSON.parse(t)),this.querySelector(".currentColor").addEventListener("click",()=>{this.onColorItemClick(this.historyColors.length>0?this.historyColors[0]:"#ccc")}),this.menuColorEL=this.querySelector("#menuColorEL"),this.historyColors&&this.historyColors.length>0&&(this.menuColorEL.style.background=this.historyColors[0]),Ae(this.querySelector("#dropdown"),{content:this.createMenuElement(),placement:"bottom",trigger:"click",interactive:!0,arrow:!1})}createMenuElement(){const t=document.createElement("div");return t.style.height="278px",t.style.width="250px",t.classList.add("aie-dropdown-container"),t.innerHTML=`
        <div class="color-panel">
            <div class="color-panel-default-button" id="defaultColor">${j("default")}</div>
            <div style="display: flex;flex-wrap: wrap;padding-top: 5px">
                ${yv.map((r,i)=>`<div class="color-item" data-color="#${r}" style="width: 18px;height:18px;margin:1px;padding:1px;border:1px solid #${i==0?"efefef":r};background: #${r}"></div>`).join(" ")}
            </div>
            <div class="color-panel-title">${j("standardColors")}</div>
            <div style="display: flex;flex-wrap: wrap;">
                ${xv.map(r=>`<div class="color-item" data-color="#${r}" style="width: 18px;height:18px;margin:1px;padding:1px;border:1px solid #${r};background: #${r}"></div>`).join(" ")}
            </div>
            <div class="color-panel-title">${j("historyColors")}</div>
            <div style="display: flex;flex-wrap: wrap;" id="history-colors">
               ${this.historyColors.map(r=>`<div class="history-color-item" data-color="${r}" style="width: 22px;height: 23px;margin: 1px;background: ${r}"></div>`).join(" ")}
            </div>
        </div>
        `,t.querySelector("#defaultColor").addEventListener("click",()=>{this.onDefaultColorClick()}),t.querySelectorAll(".color-item").forEach(r=>{r.addEventListener("click",()=>{this.invokeColorItemClick(t,r)}),r.addEventListener("mouseover",()=>{r.style.border="solid 1px #999"}),r.addEventListener("mouseout",()=>{let i=r.getAttribute("data-color");i==="#ffffff"&&(i="#efefef"),r.style.border=`solid 1px ${i}`})}),t.querySelector("#history-colors").addEventListener("click",r=>{const i=r.target.closest(".history-color-item");i&&this.invokeColorItemClick(t,i)}),t}invokeColorItemClick(t,r){const i=r.getAttribute("data-color");this.historyColors=this.historyColors.filter(o=>o!==i),this.historyColors.unshift(i),this.historyColors.length>7&&(this.historyColors=this.historyColors.slice(0,7)),t.querySelector("#history-colors").innerHTML=`
                ${this.historyColors.map(o=>`<div class="history-color-item" data-color="${o}" style="width: 22px;height: 23px;margin: 1px;background: ${o}"></div>`).join(" ")}
                `,localStorage.setItem(this.historyColorsKey,JSON.stringify(this.historyColors)),this.menuColorEL.style.background=i,this.onColorItemClick(i)}}let vv=class extends I0{constructor(){super(),this.historyColorsKey="highlightHistoryColors",this.iconSvg='<svg style="width: 14px;height: 14px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15.2427 4.51138L8.50547 11.2486L7.79836 13.3699L6.7574 14.4109L9.58583 17.2393L10.6268 16.1983L12.7481 15.4912L19.4853 8.75402L15.2427 4.51138ZM21.6066 8.04692C21.9972 8.43744 21.9972 9.0706 21.6066 9.46113L13.8285 17.2393L11.7071 17.9464L10.2929 19.3606C9.90241 19.7511 9.26925 19.7511 8.87872 19.3606L4.63608 15.118C4.24556 14.7275 4.24556 14.0943 4.63608 13.7038L6.0503 12.2896L6.7574 10.1682L14.5356 2.39006C14.9261 1.99954 15.5593 1.99954 15.9498 2.39006L21.6066 8.04692ZM15.2427 7.33981L16.6569 8.75402L11.7071 13.7038L10.2929 12.2896L15.2427 7.33981ZM4.28253 16.8858L7.11096 19.7142L5.69674 21.1284L1.4541 19.7142L4.28253 16.8858Z"></path></svg>',this.onDefaultColorClick=()=>{var e;(e=this.editor)==null||e.chain().focus().unsetHighlight().run()},this.onColorItemClick=e=>{var t;(t=this.editor)==null||t.chain().focus().setHighlight({color:e}).run()}}onActive(e){return e.isActive("highlight")}};class kv extends I0{constructor(){super(),this.historyColorsKey="fontHistoryColors",this.iconSvg='<svg style="width: 14px;height: 14px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.55446 22H3.40039L11.0004 3H13.0004L20.6004 22H18.4463L16.0463 16H7.95446L5.55446 22ZM8.75446 14H15.2463L12.0004 5.88517L8.75446 14Z"></path></svg>',this.onDefaultColorClick=()=>{var e;(e=this.editor)==null||e.chain().focus().unsetColor().run()},this.onColorItemClick=e=>{var t;(t=this.editor)==null||t.chain().focus().setColor(e).run()}}onActive(e){return e.isActive("textStyle")}}class wv extends X{constructor(){super();const e=`
        <div no-hover style="width: 1px;height: 20px; display: flex">
            <div class="aie-menu-divider" />
        </div>
        `;this.template=e}}let Cv=class extends X{constructor(){super();const e=`
        <div>
             <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 4H21V6H8V4ZM3 3.5H6V6.5H3V3.5ZM3 10.5H6V13.5H3V10.5ZM3 17.5H6V20.5H3V17.5ZM8 11H21V13H8V11ZM8 18H21V20H8V18Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.toggleBulletList()}onActive(e){return e.isActive("bulletList")}},Sv=class extends X{constructor(){super();const e=`
        <div>
               <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 4H21V6H8V4ZM5 3V6H6V7H3V6H4V4H3V3H5ZM3 14V11.5H5V11H3V10H6V12.5H4V13H6V14H3ZM5 19.5H3V18.5H5V18H3V17H6V21H3V20H5V19.5ZM8 11H21V13H8V11ZM8 18H21V20H8V18Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.toggleOrderedList()}onActive(e){return e.isActive("orderedList")}};class Ev extends X{constructor(){super();const e=`
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 4H21V6H3V4ZM3 19H21V21H3V19ZM11 14H21V16H11V14ZM11 9H21V11H11V9ZM3 12.5L7 9V16L3 12.5Z"></path></svg>
         </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.outdent()}}class Av extends X{constructor(){super();const e=`
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 4H21V6H3V4ZM3 19H21V21H3V19ZM11 14H21V16H11V14ZM11 9H21V11H11V9ZM7 12.5L3 16V9L7 12.5Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.indent()}}const _v=[{icon:'<div style="width:18px;height: 18px;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 4H21V6H3V4ZM3 19H17V21H3V19ZM3 14H21V16H3V14ZM3 9H17V11H3V9Z"></path></svg></div>',title:"align-left",value:"left"},{icon:'<div style="width:18px;height: 18px;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 4H21V6H3V4ZM5 19H19V21H5V19ZM3 14H21V16H3V14ZM5 9H19V11H5V9Z"></path></svg></div>',title:"align-center",value:"center"},{icon:'<div style="width:18px;height: 18px;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 4H21V6H3V4ZM7 19H21V21H7V19ZM3 14H21V16H3V14ZM7 9H21V11H7V9Z"></path></svg></div>',title:"align-right",value:"right"},{icon:'<div style="width:18px;height: 18px;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 4H21V6H3V4ZM3 19H21V21H3V19ZM3 14H21V16H3V14ZM3 9H21V11H3V9Z"></path></svg></div>',title:"align-justify",value:"justify"}];class Mv extends Tr{constructor(){super(),this.menuData=_v.map(e=>({...e,title:j(e.title)})),this.dropDivHeight="112px",this.dropDivWith="60px",this.width="36px",this.menuTextWidth="20px",this.showItemsTip=!0}onDropdownActive(e,t){return e.isActive({textAlign:this.menuData[t].value})}onDropdownItemClick(e){this.editor.chain().focus().setTextAlign(this.menuData[e].value).run()}onDropdownItemRender(e){return this.menuData[e].icon}onMenuTextRender(e){return this.menuData[e].icon}}class F0{constructor(){N(this,"tippyInstance");N(this,"content");N(this,"onConfirmClickFunc");N(this,"onShowFunc")}setContent(e){this.content=e}onConfirmClick(e){this.onConfirmClickFunc=e}onShow(e){this.onShowFunc=e}setTrigger(e,t="bottom"){this.tippyInstance=Ae(e,{content:this.createContentElement(),appendTo:e.closest(".aie-container"),placement:t,trigger:"click",interactive:!0,arrow:!1,onShow:r=>{this.onShowFunc&&this.onShowFunc(r)}})}createContentElement(){const e=`
            <div class="aie-popover">
              <div class="aie-popover-header">
               <svg class="aie-popover-header-close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.0007 10.5865L16.9504 5.63672L18.3646 7.05093L13.4149 12.0007L18.3646 16.9504L16.9504 18.3646L12.0007 13.4149L7.05093 18.3646L5.63672 16.9504L10.5865 12.0007L5.63672 7.05093L7.05093 5.63672L12.0007 10.5865Z"></path></svg>
              </div>
              <div class="aie-popover-content">${this.content}</div>
              <div class="aie-popover-footer">
              <button class="aie-popover-footer-confirm" type="button">${j("confirm")}</button>
              </div>
            </div>
        `,t=document.createElement("div");return t.innerHTML=e,t.querySelector(".aie-popover-header-close").addEventListener("click",()=>{this.tippyInstance.hide()}),t.querySelector(".aie-popover-footer-confirm").addEventListener("click",()=>{this.onConfirmClickFunc&&this.onConfirmClickFunc(this.tippyInstance),this.tippyInstance.hide()}),t}}let Tv=class extends X{constructor(){super();const e=`
        <div>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.6572 14.8282L16.2429 13.414L17.6572 11.9998C19.2193 10.4377 19.2193 7.90506 17.6572 6.34296C16.0951 4.78086 13.5624 4.78086 12.0003 6.34296L10.5861 7.75717L9.17188 6.34296L10.5861 4.92875C12.9292 2.5856 16.7282 2.5856 19.0714 4.92875C21.4145 7.27189 21.4145 11.0709 19.0714 13.414L17.6572 14.8282ZM14.8287 17.6567L13.4145 19.0709C11.0714 21.414 7.27238 21.414 4.92923 19.0709C2.58609 16.7277 2.58609 12.9287 4.92923 10.5856L6.34345 9.17139L7.75766 10.5856L6.34345 11.9998C4.78135 13.5619 4.78135 16.0946 6.34345 17.6567C7.90555 19.2188 10.4382 19.2188 12.0003 17.6567L13.4145 16.2425L14.8287 17.6567ZM14.8287 7.75717L16.2429 9.17139L9.17188 16.2425L7.75766 14.8282L14.8287 7.75717Z"></path></svg>
        </div>
        `;this.template=e}connectedCallback(){super.connectedCallback();const e=new F0;e.setContent(`
            <div style="width: 250px">${j("link-address")}</div>
             <div style="width: 250px">
             <input type="text" id="href" style="width: 250px">
            </div>
            
            <div style="margin-top: 10px">${j("link-open-type")}</div>
            <div>
            <select id="target" style="width: 250px">
               <option value="">${j("default")}</option>
               <option value="_blank">${j("link-open-blank")}</option>
            </select>
            </div>
        `),e.onConfirmClick(t=>{var o,s;const r=t.popper.querySelector("#href").value;if(r.trim()===""){(o=this.editor)==null||o.chain().focus().extendMarkRange("link").unsetLink().run();return}let i=t.popper.querySelector("#target").value;i.trim()===""&&(i=null),(s=this.editor)==null||s.chain().focus().extendMarkRange("link").setLink({href:r,target:i,rel:null}).run()}),e.onShow(t=>{var i;const r=(i=this.editor)==null?void 0:i.getAttributes("link");r&&r.href?t.popper.querySelector("#href").value=r.href:t.popper.querySelector("#href").value="",r&&r.target?t.popper.querySelector("#target").value=r.target:t.popper.querySelector("#target").value=""}),e.setTrigger(this.querySelector("div"),"bottom")}};class Dv extends X{constructor(){super();const e=`
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3ZM5 5V19H19V5H5ZM11.0026 16L6.75999 11.7574L8.17421 10.3431L11.0026 13.1716L16.6595 7.51472L18.0737 8.92893L11.0026 16Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.toggleTaskList()}onActive(e){return e.isActive("taskList")}}const Lv=["1.0","1.25","1.5","2.0","2.5","3.0"];class Ov extends Tr{constructor(){super(),this.menuData=Lv,this.refreshMenuText=!1,this.dropDivHeight="180px",this.dropDivWith="70px",this.width="36px",this.menuTextWidth="20px"}onDropdownActive(e,t){return t==0?e.isActive("paragraph"):e.isActive("heading",{level:t})}onDropdownItemClick(e){const t=`${(Number(this.menuData[e])*100).toFixed(0)}%`;this.editor.chain().setLineHeight(t).run()}onDropdownItemRender(e){return this.menuData[e]}onMenuTextRender(e){return`
              <div style="width:18px;height: 18px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11 4H21V6H11V4ZM6 7V11H4V7H1L5 3L9 7H6ZM6 17H9L5 21L1 17H4V13H6V17ZM11 18H21V20H11V18ZM9 11H21V13H9V11Z"></path></svg>
              </div>
         `}}class Rv extends X{constructor(){super();const e=`
        <div>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.58341 17.3211C3.55316 16.2275 3 15 3 13.0104C3 9.51092 5.45651 6.37372 9.03059 4.82324L9.92328 6.20085C6.58804 8.00545 5.93618 10.3461 5.67564 11.8221C6.21263 11.5444 6.91558 11.4467 7.60471 11.5106C9.40908 11.6778 10.8312 13.1591 10.8312 15C10.8312 16.933 9.26416 18.5 7.33116 18.5C6.2581 18.5 5.23196 18.0096 4.58341 17.3211ZM14.5834 17.3211C13.5532 16.2275 13 15 13 13.0104C13 9.51092 15.4565 6.37372 19.0306 4.82324L19.9233 6.20085C16.588 8.00545 15.9362 10.3461 15.6756 11.8221C16.2126 11.5444 16.9156 11.4467 17.6047 11.5106C19.4091 11.6778 20.8312 13.1591 20.8312 15C20.8312 16.933 19.2642 18.5 17.3312 18.5C16.2581 18.5 15.232 18.0096 14.5834 17.3211Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.toggleBlockquote()}}let Nv=class extends X{constructor(){super();N(this,"fileInput");const t=`
        <div>
        <input type="file" accept="image/*" multiple  style="display: none">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2.9918 21C2.44405 21 2 20.5551 2 20.0066V3.9934C2 3.44476 2.45531 3 2.9918 3H21.0082C21.556 3 22 3.44495 22 3.9934V20.0066C22 20.5552 21.5447 21 21.0082 21H2.9918ZM20 15V5H4V19L14 9L20 15ZM20 17.8284L14 11.8284L6.82843 19H20V17.8284ZM8 11C6.89543 11 6 10.1046 6 9C6 7.89543 6.89543 7 8 7C9.10457 7 10 7.89543 10 9C10 10.1046 9.10457 11 8 11Z"></path></svg>
        </div>
        `;this.template=t,this.registerClickListener()}connectedCallback(){var t,r;super.connectedCallback(),(r=(t=this.options)==null?void 0:t.image)!=null&&r.customMenuInvoke?this.querySelector("input").remove():(this.fileInput=this.querySelector("input"),this.fileInput.addEventListener("change",()=>{var o,s;const i=(o=this.fileInput)==null?void 0:o.files;if(i&&i.length>0)for(let a of i)(s=this.editor)==null||s.commands.uploadImage(a);this.fileInput.value=""}))}onClick(t){var r,i,o;(i=(r=this.options)==null?void 0:r.image)!=null&&i.customMenuInvoke?this.options.image.customMenuInvoke(this.editor.aiEditor):(o=this.fileInput)==null||o.click()}};class Hv extends X{constructor(){super();N(this,"fileInput");const t=`
        <div>
        <input type="file" accept="video/*" style="display: none">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M2 3.9934C2 3.44476 2.45531 3 2.9918 3H21.0082C21.556 3 22 3.44495 22 3.9934V20.0066C22 20.5552 21.5447 21 21.0082 21H2.9918C2.44405 21 2 20.5551 2 20.0066V3.9934ZM4 5V19H20V5H4ZM10.6219 8.41459L15.5008 11.6672C15.6846 11.7897 15.7343 12.0381 15.6117 12.2219C15.5824 12.2658 15.5447 12.3035 15.5008 12.3328L10.6219 15.5854C10.4381 15.708 10.1897 15.6583 10.0672 15.4745C10.0234 15.4088 10 15.3316 10 15.2526V8.74741C10 8.52649 10.1791 8.34741 10.4 8.34741C10.479 8.34741 10.5562 8.37078 10.6219 8.41459Z"></path></svg>
        </div>
        `;this.template=t,this.registerClickListener()}connectedCallback(){var t,r;super.connectedCallback(),(r=(t=this.options)==null?void 0:t.video)!=null&&r.customMenuInvoke?this.querySelector("input").remove():(this.fileInput=this.querySelector("input"),this.fileInput.addEventListener("change",()=>{var o,s;const i=(o=this.fileInput)==null?void 0:o.files;if(i&&i.length>0)for(let a of i)(s=this.editor)==null||s.commands.uploadVideo(a);this.fileInput.value=""}))}onClick(t){var r,i,o;(i=(r=this.options)==null?void 0:r.video)!=null&&i.customMenuInvoke?this.options.video.customMenuInvoke(this.editor.aiEditor):(o=this.fileInput)==null||o.click()}}let Iv=class extends X{constructor(){super();const e=`
        <div>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23 11.9998L15.9289 19.0708L14.5147 17.6566L20.1716 11.9998L14.5147 6.34292L15.9289 4.92871L23 11.9998ZM3.82843 11.9998L9.48528 17.6566L8.07107 19.0708L1 11.9998L8.07107 4.92871L9.48528 6.34292L3.82843 11.9998Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.toggleCode()}onActive(e){return e.isActive("code")}},Fv=class extends X{constructor(){super();const e=`
        <div>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 3H21C21.5523 3 22 3.44772 22 4V20C22 20.5523 21.5523 21 21 21H3C2.44772 21 2 20.5523 2 20V4C2 3.44772 2.44772 3 3 3ZM4 5V19H20V5H4ZM20 12L16.4645 15.5355L15.0503 14.1213L17.1716 12L15.0503 9.87868L16.4645 8.46447L20 12ZM6.82843 12L8.94975 14.1213L7.53553 15.5355L4 12L7.53553 8.46447L8.94975 9.87868L6.82843 12ZM11.2443 17H9.11597L12.7557 7H14.884L11.2443 17Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.toggleCodeBlock()}onActive(e){return e.isActive("codeBlock")}};class Pv extends X{constructor(){super();const e=`
        <div style="height: 16px">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.9999 18.9967H20.9999V20.9967H11.9999L8.00229 20.9992L1.51457 14.5115C1.12405 14.1209 1.12405 13.4878 1.51457 13.0972L12.1212 2.49065C12.5117 2.10012 13.1449 2.10012 13.5354 2.49065L21.3136 10.2688C21.7041 10.6593 21.7041 11.2925 21.3136 11.683L13.9999 18.9967ZM15.6567 14.5115L19.1922 10.9759L12.8283 4.61197L9.29275 8.1475L15.6567 14.5115Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.unsetAllMarks()}}class Bv extends X{constructor(){super();const e=`
        <div>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2 11H4V13H2V11ZM6 11H18V13H6V11ZM20 11H22V13H20V11Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.setHorizontalRule()}}let $v=class extends X{constructor(){super();N(this,"instance");const t=`
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14 10H10V14H14V10ZM16 10V14H19V10H16ZM14 19V16H10V19H14ZM16 19H19V16H16V19ZM14 5H10V8H14V5ZM16 5V8H19V5H16ZM8 10H5V14H8V10ZM8 19V16H5V19H8ZM8 5H5V8H8V5ZM4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3Z"></path></svg>
        </div>
        `;this.template=t}connectedCallback(){super.connectedCallback(),this.instance=Ae(this.querySelector("svg"),{content:this.createMenuElement(),appendTo:this.closest(".aie-container"),placement:"bottom",trigger:"click",interactive:!0,arrow:!1})}createMenuElement(){const t=document.createElement("div");t.classList.add("aie-dropdown-container"),t.innerHTML=`
        <div style="margin: 5px">
            <div style="padding: 5px 0;font-size: 14px;display: flex"><span>${j("insertTable")}</span><span style="margin-left: auto" id="columnRows"></span></div>
            <div style="display: flex;flex-wrap: wrap;width: 240px;height: 200px" id="table-cells">
            ${[...Array(8).keys()].map((i,o)=>[...Array(10).keys()].map((s,a)=>`<div data-i="${o}" data-j="${a}" class="table-cell" style="width: 20px;height: 20px;margin:1px;"></div>`).join("")).join("")}
            </div>
        </div>
        `;const r=t.querySelector("#table-cells");return r.addEventListener("click",i=>{var s,a;const o=i.target.closest(".table-cell");if(o){let u=o.getAttribute("data-i"),l=o.getAttribute("data-j");(s=this.editor)==null||s.commands.insertTable({rows:Number(u)+1,cols:Number(l)+1,withHeaderRow:!0}),(a=this.instance)==null||a.hide()}}),r.addEventListener("mouseover",i=>{const o=i.target.closest(".table-cell");if(o){let s=Number(o.getAttribute("data-i")),a=Number(o.getAttribute("data-j"));const u=r.querySelectorAll("div"),l=t.querySelector("#columnRows");l.textContent=`${s+1} ${j("row")} x ${a+1} ${j("column")}`,u.forEach(c=>{let d=Number(c.getAttribute("data-i")),f=Number(c.getAttribute("data-j"));d<=s&&f<=a?c.classList.add("active"):c.classList.remove("active")})}}),r.addEventListener("mouseleave",()=>{r.querySelectorAll("div").forEach(s=>{s.classList.remove("active")});const o=t.querySelector("#columnRows");o.textContent=""}),t}};class zv extends X{constructor(){super();const e=`
        <div>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 18H16.5C17.8807 18 19 16.8807 19 15.5C19 14.1193 17.8807 13 16.5 13H3V11H16.5C18.9853 11 21 13.0147 21 15.5C21 17.9853 18.9853 20 16.5 20H15V22L11 19L15 16V18ZM3 4H21V6H3V4ZM9 18V20H3V18H9Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){e.setHardBreak()}}class Vv extends X{constructor(){super();N(this,"fileInput");const t=`
        <div>
        <input type="file" style="display: none">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.8287 7.7574L9.1718 13.4143C8.78127 13.8048 8.78127 14.4379 9.1718 14.8285C9.56232 15.219 10.1955 15.219 10.586 14.8285L16.2429 9.17161C17.4144 8.00004 17.4144 6.10055 16.2429 4.92897C15.0713 3.7574 13.1718 3.7574 12.0002 4.92897L6.34337 10.5858C4.39075 12.5384 4.39075 15.7043 6.34337 17.6569C8.29599 19.6095 11.4618 19.6095 13.4144 17.6569L19.0713 12L20.4855 13.4143L14.8287 19.0711C12.095 21.8048 7.66283 21.8048 4.92916 19.0711C2.19549 16.3374 2.19549 11.9053 4.92916 9.17161L10.586 3.51476C12.5386 1.56214 15.7045 1.56214 17.6571 3.51476C19.6097 5.46738 19.6097 8.63321 17.6571 10.5858L12.0002 16.2427C10.8287 17.4143 8.92916 17.4143 7.75759 16.2427C6.58601 15.0711 6.58601 13.1716 7.75759 12L13.4144 6.34319L14.8287 7.7574Z"></path></svg>
        </div>
        `;this.template=t,this.registerClickListener()}connectedCallback(){var t,r;super.connectedCallback(),(r=(t=this.options)==null?void 0:t.attachment)!=null&&r.customMenuInvoke?this.querySelector("input").remove():(this.fileInput=this.querySelector("input"),this.fileInput.addEventListener("change",()=>{var o,s;const i=(o=this.fileInput)==null?void 0:o.files;if(i&&i.length>0)for(let a of i)(s=this.editor)==null||s.commands.uploadAttachment(a);this.fileInput.value=""}))}onClick(t){var r,i,o;(i=(r=this.options)==null?void 0:r.attachment)!=null&&i.customMenuInvoke?this.options.attachment.customMenuInvoke(this.editor.aiEditor):(o=this.fileInput)==null||o.click()}}class qv extends X{constructor(){super();N(this,"fullscreenSvg",'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 3V5H4V9H2V3H8ZM2 21V15H4V19H8V21H2ZM22 21H16V19H20V15H22V21ZM22 9H20V5H16V3H22V9Z"></path></svg>');N(this,"fullscreenExitSvg",'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 7H22V9H16V3H18V7ZM8 9H2V7H6V3H8V9ZM18 17V21H16V15H22V17H18ZM8 15V21H6V17H2V15H8Z"></path></svg>');N(this,"isFullscreen",!1);const t=`
        <div>
        ${this.fullscreenSvg}
        </div>
        `;this.template=t,this.registerClickListener()}onClick(t){const r=this.closest(".aie-container");this.isFullscreen?(r.style.height="100%",r.style.width="",r.style.background="",r.style.position="",r.style.top="",r.style.left="",r.style.zIndex=""):(r.style.height="calc(100vh - 2px)",r.style.width="calc(100% - 2px)",r.style.position="absolute",r.style.top="0",r.style.left="0",r.style.zIndex="9999"),this.isFullscreen=!this.isFullscreen,this.querySelector("div").innerHTML=this.isFullscreen?this.fullscreenExitSvg:this.fullscreenSvg}}class jv extends X{constructor(){super();const e=`
        <div>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 2C17.5523 2 18 2.44772 18 3V7H21C21.5523 7 22 7.44772 22 8V18C22 18.5523 21.5523 19 21 19H18V21C18 21.5523 17.5523 22 17 22H7C6.44772 22 6 21.5523 6 21V19H3C2.44772 19 2 18.5523 2 18V8C2 7.44772 2.44772 7 3 7H6V3C6 2.44772 6.44772 2 7 2H17ZM16 17H8V20H16V17ZM20 9H4V17H6V16C6 15.4477 6.44772 15 7 15H17C17.5523 15 18 15.4477 18 16V17H20V9ZM8 10V12H5V10H8ZM16 4H8V7H16V4Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){let t=this.closest(".aie-container").querySelector(".aie-content").innerHTML;t=`<div class="aie-container" style="border: none;padding: 0;margin: 0"><div class="aie-content" style="border: none;height: auto;overflow: visible">${t}</div></div>`;const i=Array.from(document.querySelectorAll("style, link")).map(u=>u.outerHTML).join("")+t,o=document.createElement("iframe");o.id="aie-print-iframe",o.setAttribute("style","position: absolute; width: 0; height: 0; top: -10px; left: -10px;"),document.body.appendChild(o);const s=o.contentWindow,a=o.contentDocument||o.contentWindow&&o.contentWindow.document;a&&(a.open(),a.write(i),a.close()),s&&(o.onload=function(){try{setTimeout(()=>{s.focus();try{s.document.execCommand("print",!1)||s.print()}catch{s.print()}s.close()},10)}catch(u){console.error(u)}setTimeout(function(){document.body.removeChild(o)},100)})}}const Uv=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""];class Wv extends X{constructor(){super();const e=`
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20ZM8 13H16C16 15.2091 14.2091 17 12 17C9.79086 17 8 15.2091 8 13ZM8 11C7.17157 11 6.5 10.3284 6.5 9.5C6.5 8.67157 7.17157 8 8 8C8.82843 8 9.5 8.67157 9.5 9.5C9.5 10.3284 8.82843 11 8 11ZM16 11C15.1716 11 14.5 10.3284 14.5 9.5C14.5 8.67157 15.1716 8 16 8C16.8284 8 17.5 8.67157 17.5 9.5C17.5 10.3284 16.8284 11 16 11Z"></path></svg>
        </div>
        `;this.template=e}connectedCallback(){super.connectedCallback(),Ae(this.querySelector("svg"),{content:this.createMenuElement(),appendTo:this.closest(".aie-container"),placement:"bottom",trigger:"click",interactive:!0,arrow:!1})}createMenuElement(){const e=document.createElement("div");return e.style.height="220px",e.style.width="400px",e.classList.add("aie-dropdown-container"),e.innerHTML=`
        <div style="margin: 5px">
            <div class="emoji-cells">
            ${Uv.map(t=>`<div  class="emoji-cell">${t}</div>`).join("")}
            </div>
        </div>
        `,e.querySelector(".emoji-cells").addEventListener("click",t=>{var i;const r=t.target.closest(".emoji-cell");r&&((i=this.editor)==null||i.commands.insertContent(r.innerHTML))}),e}}class Zv extends X{constructor(){super();N(this,"svg",'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 4.99658V7.99658H19V4.99658H5ZM4 2.99658H20C20.5523 2.99658 21 3.4443 21 3.99658V8.99658C21 9.54887 20.5523 9.99658 20 9.99658H4C3.44772 9.99658 3 9.54887 3 8.99658V3.99658C3 3.4443 3.44772 2.99658 4 2.99658ZM6 11.9966H12C12.5523 11.9966 13 12.4443 13 12.9966V15.9966H14V21.9966H10V15.9966H11V13.9966H5C4.44772 13.9966 4 13.5489 4 12.9966V10.9966H6V11.9966ZM17.7322 13.7288L19.5 11.961L21.2678 13.7288C22.2441 14.7051 22.2441 16.288 21.2678 17.2643C20.2915 18.2407 18.7085 18.2407 17.7322 17.2643C16.7559 16.288 16.7559 14.7051 17.7322 13.7288Z"></path></svg>');const t=`
        <div style="height: 16px">
        ${this.svg}
        </div>
        `;this.template=t,this.registerClickListener()}onClick(t){var r;t.setPainter((r=this.editor)==null?void 0:r.state.selection.$head.marks())}}class Kv{constructor(e,t,r){N(this,"editor");N(this,"globalConfig");N(this,"aiModelName");N(this,"aiModelConfig");this.editor=e,this.globalConfig=t,this.aiModelName=r,this.aiModelConfig=t.models[r]}chat(e,t,r){const i=o=>{const s=this.createAiClient(o,r),a=this.wrapMessage(`${e}
${t}`);s.start(a)};this.globalConfig.onCreateClientUrl?this.globalConfig.onCreateClientUrl(this.aiModelName,this.aiModelConfig,i):i(this.createAiClientUrl())}}class Gv{constructor(e,t){N(this,"isStop",!1);N(this,"url");N(this,"webSocket");N(this,"isOpen",!1);N(this,"message");N(this,"listener");this.url=e,this.listener=t}start(e){this.listener.onStart(this),this.message=e,this.webSocket=new WebSocket(this.url),this.webSocket.onopen=t=>this.onOpen(t),this.webSocket.onmessage=t=>this.onMessage(t),this.webSocket.onclose=t=>this.onClose(t),this.webSocket.onerror=t=>this.onError(t)}stop(){this.webSocket&&(this.webSocket.close(),this.webSocket=void 0,this.isStop||(this.listener.onStop(),this.isStop=!0))}send(e){this.webSocket&&this.isOpen&&this.webSocket.send(e)}onOpen(e){this.isOpen=!0,this.send(this.message)}onMessage(e){this.listener.onMessage(e.data)}onClose(e){this.isOpen=!1,this.isStop||(this.listener.onStop(),this.isStop=!0)}onError(e){this.isOpen=!1,this.isStop||(this.listener.onStop(),this.isStop=!0)}}var cn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ni(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function P0(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var B0={exports:{}};function Jv(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var za={exports:{}};const Yv={},Xv=Object.freeze(Object.defineProperty({__proto__:null,default:Yv},Symbol.toStringTag,{value:"Module"})),Qv=P0(Xv);var ef;function Zs(){return ef||(ef=1,function(n,e){(function(t,r){n.exports=r()})(cn,function(){var t=t||function(r,i){var o;if(typeof window<"u"&&window.crypto&&(o=window.crypto),typeof self<"u"&&self.crypto&&(o=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(o=globalThis.crypto),!o&&typeof window<"u"&&window.msCrypto&&(o=window.msCrypto),!o&&typeof cn<"u"&&cn.crypto&&(o=cn.crypto),!o&&typeof Jv=="function")try{o=Qv}catch{}var s=function(){if(o){if(typeof o.getRandomValues=="function")try{return o.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof o.randomBytes=="function")try{return o.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},a=Object.create||function(){function x(){}return function(v){var b;return x.prototype=v,b=new x,x.prototype=null,b}}(),u={},l=u.lib={},c=l.Base=function(){return{extend:function(x){var v=a(this);return x&&v.mixIn(x),(!v.hasOwnProperty("init")||this.init===v.init)&&(v.init=function(){v.$super.init.apply(this,arguments)}),v.init.prototype=v,v.$super=this,v},create:function(){var x=this.extend();return x.init.apply(x,arguments),x},init:function(){},mixIn:function(x){for(var v in x)x.hasOwnProperty(v)&&(this[v]=x[v]);x.hasOwnProperty("toString")&&(this.toString=x.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),d=l.WordArray=c.extend({init:function(x,v){x=this.words=x||[],v!=i?this.sigBytes=v:this.sigBytes=x.length*4},toString:function(x){return(x||h).stringify(this)},concat:function(x){var v=this.words,b=x.words,w=this.sigBytes,k=x.sigBytes;if(this.clamp(),w%4)for(var C=0;C<k;C++){var E=b[C>>>2]>>>24-C%4*8&255;v[w+C>>>2]|=E<<24-(w+C)%4*8}else for(var A=0;A<k;A+=4)v[w+A>>>2]=b[A>>>2];return this.sigBytes+=k,this},clamp:function(){var x=this.words,v=this.sigBytes;x[v>>>2]&=4294967295<<32-v%4*8,x.length=r.ceil(v/4)},clone:function(){var x=c.clone.call(this);return x.words=this.words.slice(0),x},random:function(x){for(var v=[],b=0;b<x;b+=4)v.push(s());return new d.init(v,x)}}),f=u.enc={},h=f.Hex={stringify:function(x){for(var v=x.words,b=x.sigBytes,w=[],k=0;k<b;k++){var C=v[k>>>2]>>>24-k%4*8&255;w.push((C>>>4).toString(16)),w.push((C&15).toString(16))}return w.join("")},parse:function(x){for(var v=x.length,b=[],w=0;w<v;w+=2)b[w>>>3]|=parseInt(x.substr(w,2),16)<<24-w%8*4;return new d.init(b,v/2)}},p=f.Latin1={stringify:function(x){for(var v=x.words,b=x.sigBytes,w=[],k=0;k<b;k++){var C=v[k>>>2]>>>24-k%4*8&255;w.push(String.fromCharCode(C))}return w.join("")},parse:function(x){for(var v=x.length,b=[],w=0;w<v;w++)b[w>>>2]|=(x.charCodeAt(w)&255)<<24-w%4*8;return new d.init(b,v)}},m=f.Utf8={stringify:function(x){try{return decodeURIComponent(escape(p.stringify(x)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(x){return p.parse(unescape(encodeURIComponent(x)))}},g=l.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(x){typeof x=="string"&&(x=m.parse(x)),this._data.concat(x),this._nDataBytes+=x.sigBytes},_process:function(x){var v,b=this._data,w=b.words,k=b.sigBytes,C=this.blockSize,E=C*4,A=k/E;x?A=r.ceil(A):A=r.max((A|0)-this._minBufferSize,0);var T=A*C,I=r.min(T*4,k);if(T){for(var V=0;V<T;V+=C)this._doProcessBlock(w,V);v=w.splice(0,T),b.sigBytes-=I}return new d.init(v,I)},clone:function(){var x=c.clone.call(this);return x._data=this._data.clone(),x},_minBufferSize:0});l.Hasher=g.extend({cfg:c.extend(),init:function(x){this.cfg=this.cfg.extend(x),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(x){return this._append(x),this._process(),this},finalize:function(x){x&&this._append(x);var v=this._doFinalize();return v},blockSize:16,_createHelper:function(x){return function(v,b){return new x.init(b).finalize(v)}},_createHmacHelper:function(x){return function(v,b){return new y.HMAC.init(x,b).finalize(v)}}});var y=u.algo={};return u}(Math);return t})}(za)),za.exports}var Va={exports:{}},tf;function ek(){return tf||(tf=1,function(n,e){(function(t,r){n.exports=r(Zs())})(cn,function(t){return function(r){var i=t,o=i.lib,s=o.WordArray,a=o.Hasher,u=i.algo,l=[],c=[];(function(){function h(y){for(var x=r.sqrt(y),v=2;v<=x;v++)if(!(y%v))return!1;return!0}function p(y){return(y-(y|0))*4294967296|0}for(var m=2,g=0;g<64;)h(m)&&(g<8&&(l[g]=p(r.pow(m,1/2))),c[g]=p(r.pow(m,1/3)),g++),m++})();var d=[],f=u.SHA256=a.extend({_doReset:function(){this._hash=new s.init(l.slice(0))},_doProcessBlock:function(h,p){for(var m=this._hash.words,g=m[0],y=m[1],x=m[2],v=m[3],b=m[4],w=m[5],k=m[6],C=m[7],E=0;E<64;E++){if(E<16)d[E]=h[p+E]|0;else{var A=d[E-15],T=(A<<25|A>>>7)^(A<<14|A>>>18)^A>>>3,I=d[E-2],V=(I<<15|I>>>17)^(I<<13|I>>>19)^I>>>10;d[E]=T+d[E-7]+V+d[E-16]}var U=b&w^~b&k,M=g&y^g&x^y&x,R=(g<<30|g>>>2)^(g<<19|g>>>13)^(g<<10|g>>>22),D=(b<<26|b>>>6)^(b<<21|b>>>11)^(b<<7|b>>>25),P=C+D+U+c[E]+d[E],G=R+M;C=k,k=w,w=b,b=v+P|0,v=x,x=y,y=g,g=P+G|0}m[0]=m[0]+g|0,m[1]=m[1]+y|0,m[2]=m[2]+x|0,m[3]=m[3]+v|0,m[4]=m[4]+b|0,m[5]=m[5]+w|0,m[6]=m[6]+k|0,m[7]=m[7]+C|0},_doFinalize:function(){var h=this._data,p=h.words,m=this._nDataBytes*8,g=h.sigBytes*8;return p[g>>>5]|=128<<24-g%32,p[(g+64>>>9<<4)+14]=r.floor(m/4294967296),p[(g+64>>>9<<4)+15]=m,h.sigBytes=p.length*4,this._process(),this._hash},clone:function(){var h=a.clone.call(this);return h._hash=this._hash.clone(),h}});i.SHA256=a._createHelper(f),i.HmacSHA256=a._createHmacHelper(f)}(Math),t.SHA256})}(Va)),Va.exports}var qa={exports:{}},nf;function tk(){return nf||(nf=1,function(n,e){(function(t,r){n.exports=r(Zs())})(cn,function(t){(function(){var r=t,i=r.lib,o=i.Base,s=r.enc,a=s.Utf8,u=r.algo;u.HMAC=o.extend({init:function(l,c){l=this._hasher=new l.init,typeof c=="string"&&(c=a.parse(c));var d=l.blockSize,f=d*4;c.sigBytes>f&&(c=l.finalize(c)),c.clamp();for(var h=this._oKey=c.clone(),p=this._iKey=c.clone(),m=h.words,g=p.words,y=0;y<d;y++)m[y]^=1549556828,g[y]^=909522486;h.sigBytes=p.sigBytes=f,this.reset()},reset:function(){var l=this._hasher;l.reset(),l.update(this._iKey)},update:function(l){return this._hasher.update(l),this},finalize:function(l){var c=this._hasher,d=c.finalize(l);c.reset();var f=c.finalize(this._oKey.clone().concat(d));return f}})})()})}(qa)),qa.exports}(function(n,e){(function(t,r,i){n.exports=r(Zs(),ek(),tk())})(cn,function(t){return t.HmacSHA256})})(B0);var nk=B0.exports;const rk=Ni(nk);var $0={exports:{}};(function(n,e){(function(t,r){n.exports=r(Zs())})(cn,function(t){return function(){var r=t,i=r.lib,o=i.WordArray,s=r.enc;s.Base64={stringify:function(u){var l=u.words,c=u.sigBytes,d=this._map;u.clamp();for(var f=[],h=0;h<c;h+=3)for(var p=l[h>>>2]>>>24-h%4*8&255,m=l[h+1>>>2]>>>24-(h+1)%4*8&255,g=l[h+2>>>2]>>>24-(h+2)%4*8&255,y=p<<16|m<<8|g,x=0;x<4&&h+x*.75<c;x++)f.push(d.charAt(y>>>6*(3-x)&63));var v=d.charAt(64);if(v)for(;f.length%4;)f.push(v);return f.join("")},parse:function(u){var l=u.length,c=this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var f=0;f<c.length;f++)d[c.charCodeAt(f)]=f}var h=c.charAt(64);if(h){var p=u.indexOf(h);p!==-1&&(l=p)}return a(u,l,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function a(u,l,c){for(var d=[],f=0,h=0;h<l;h++)if(h%4){var p=c[u.charCodeAt(h-1)]<<h%4*2,m=c[u.charCodeAt(h)]>>>6-h%4*2,g=p|m;d[f>>>2]|=g<<24-f%4*8,f++}return o.create(d,f)}}(),t.enc.Base64})})($0);var ik=$0.exports;const ok=Ni(ik),Ks=()=>"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(n^crypto.getRandomValues(new Uint8Array(1))[0]&15>>n/4).toString(16));class sk extends Kv{constructor(e,t){super(e,t,"spark"),this.aiModelConfig={version:"v3.1",protocol:"wss",...t.models.spark}}createAiClient(e,t){return new Gv(e,{onStart:t.onStart,onStop:t.onStop,onMessage:r=>{var o,s,a,u,l;const i=JSON.parse(r);i.payload&&((s=(o=i.payload.usage)==null?void 0:o.text)!=null&&s.total_tokens&&this.globalConfig.onTokenConsume&&this.globalConfig.onTokenConsume(this.aiModelName,this.aiModelConfig,(u=(a=i.payload.usage)==null?void 0:a.text)==null?void 0:u.total_tokens),(l=i.payload.choices)!=null&&l.text&&i.payload.choices.text[0]&&t.onMessage({...i.payload.choices.text[0],status:i.payload.choices.status}))}})}wrapMessage(e){const t=this.aiModelConfig,r={header:{app_id:t.appId,uid:Ks()},parameter:{chat:{domain:this.getDomain(t),temperature:.5,max_tokens:2048}},payload:{message:{text:[]}}};return r.payload.message.text.push({role:"user",content:e}),JSON.stringify(r)}getDomain(e){switch(e.version){case"v3.1":return"generalv3";case"v2.1":return"generalv2";default:return"general"}}createAiClientUrl(){const e=this.aiModelConfig,t=new Date().toUTCString().replace("GMT","+0000");let r=`host: spark-api.xf-yun.com
`;r+="date: "+t+`
`,r+=`GET /${e.version}/chat HTTP/1.1`;const i=rk(r,e.apiSecret),o=ok.stringify(i),s=`api_key="${e.apiKey}", algorithm="hmac-sha256", headers="host date request-line", signature="${o}"`,a=btoa(s);return`${e.protocol}://spark-api.xf-yun.com/${e.version}/chat?authorization=${a}&date=${encodeURIComponent(t)}&host=spark-api.xf-yun.com`}}class Gs{static init(e,t){if(t&&t.models)for(let r of Object.keys(t.models))switch(r){case"spark":this.models[r]=new sk(e,t)}}static get(e){return this.models[e]}}N(Gs,"models",{});const ak=n=>{let e="";return n.descendants(t=>{t.text&&(e+=t.text)}),e};class uk{constructor(e,t){N(this,"editor");N(this,"from");N(this,"options");this.editor=e,this.from=e.view.state.selection.from,this.options=t||{markdownParseEnable:!0}}onStart(){}onStop(){}onMessage(e){const{state:{tr:t},view:r}=this.editor;if(r.dispatch(t.insertText(e.content)),e.status==2&&this.options.markdownParseEnable){const i=this.editor.state.selection.to,o=this.editor.state.doc.textBetween(this.from,i),{state:{tr:s},view:a}=this.editor,u=this.editor.parseMarkdown(o);if(this.options.useMarkdownTextOnly){const l=ak(u),c=this.editor.schema.text(l);a.dispatch(s.replaceWith(this.from,i,c).scrollIntoView())}else a.dispatch(s.replaceWith(this.from,i,u).scrollIntoView())}this.editor.commands.scrollIntoView()}}const lk=[];class ck extends Tr{constructor(){super(),this.dropDivHeight="auto",this.dropDivWith="94px",this.width="36px",this.menuTextWidth="20px"}onCreate(e,t){var r;super.onCreate(e,t),this.menuData=((r=t.ai)==null?void 0:r.menus)||lk}renderTemplate(){this.template=`
         <div style="width: ${this.width};">
         <div id="tippy" class="menu-ai" id="text">
             <span> AI </span>
             <div style="width: 18px;height: 18px;display: inline-block" >
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 14L8 10H16L12 14Z"></path></svg>
             </div>
         </div>
         </div>
        `}createMenuElement(){const e=document.createElement("div");e.style.height=this.dropDivHeight,e.style.width=this.dropDivWith,e.classList.add("aie-dropdown-container");for(let t=0;t<this.menuData.length;t++){const r=document.createElement("div");r.classList.add("aie-dropdown-item"),r.innerHTML=`
            <div class="text" style="display: flex;padding-left: 5px">${this.onDropdownItemRender(t)}</div>
            `,r.addEventListener("click",()=>{this.onDropdownItemClick(t),this.tippyInstance.hide()}),e.appendChild(r)}return this.tippyEl=e,e}onTransaction(e){}onDropdownActive(e,t){return!1}getSelectedText(e){if(e==="selected"){const{selection:t,doc:r}=this.editor.state;return r.textBetween(t.from,t.to)}else return this.editor.state.selection.$head.parent.textContent}onDropdownItemClick(e){const t=this.menuData[e],r=this.getSelectedText(t.text);if(r){const i=Gs.get(t.model);i?i==null||i.chat(r,t.prompt,new uk(this.editor)):console.error("Ai model config error.")}else console.error("Can not get selected text.")}onDropdownItemRender(e){return`<div style="width:18px;height: 18px;">${this.menuData[e].icon}</div><div style="margin-left: 10px">${this.menuData[e].name}</div>`}onMenuTextRender(e){return this.menuData[e].icon}}class dk extends X{constructor(){super();const e=`
        <div>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M21 3C21.5523 3 22 3.44772 22 4V20C22 20.5523 21.5523 21 21 21H3C2.44772 21 2 20.5523 2 20V4C2 3.44772 2.44772 3 3 3H21ZM20 5H4V19H20V5ZM18 15V17H6V15H18Z"></path></svg>
        </div>
        `;this.template=e,this.registerClickListener()}onClick(e){var t;(t=this.editor)!=null&&t.isActive("container")?e.unsetContainer():e.setContainer("warning"),e.focus()}}class fk extends X{constructor(){super();N(this,"config")}onConfig(t){this.config=t,t.html?this.template=t.html:t.icon&&(this.template=`<div style="height: 16px">${t.icon}</div>`),this.addEventListener("click",r=>{this.config&&this.config.onClick&&this.config.onClick(r,this.editor.aiEditor)})}}window.customElements.define("aie-undo",ox);window.customElements.define("aie-redo",sx);window.customElements.define("aie-brush",Zv);window.customElements.define("aie-container",dk);window.customElements.define("aie-custom",fk);window.customElements.define("aie-eraser",Pv);window.customElements.define("aie-heading",av);window.customElements.define("aie-font-family",lv);window.customElements.define("aie-font-size",dv);window.customElements.define("aie-bold",fv);window.customElements.define("aie-italic",hv);window.customElements.define("aie-underline",pv);window.customElements.define("aie-strike",mv);window.customElements.define("aie-link",Tv);window.customElements.define("aie-code",Iv);window.customElements.define("aie-subscript",gv);window.customElements.define("aie-superscript",bv);window.customElements.define("aie-highlight",vv);window.customElements.define("aie-font-color",kv);window.customElements.define("aie-divider",wv);window.customElements.define("aie-bullet-list",Cv);window.customElements.define("aie-ordered-list",Sv);window.customElements.define("aie-indent-decrease",Ev);window.customElements.define("aie-indent-increase",Av);window.customElements.define("aie-align",Mv);window.customElements.define("aie-todo",Dv);window.customElements.define("aie-line-height",Ov);window.customElements.define("aie-break",zv);window.customElements.define("aie-quote",Rv);window.customElements.define("aie-image",Nv);window.customElements.define("aie-video",Hv);window.customElements.define("aie-code-block",Fv);window.customElements.define("aie-hr",Bv);window.customElements.define("aie-table",$v);window.customElements.define("aie-attachment",Vv);window.customElements.define("aie-fullscreen",qv);window.customElements.define("aie-printer",jv);window.customElements.define("aie-emoji",Wv);window.customElements.define("aie-ai",ck);const hk=["undo","redo","brush","eraser","divider","heading","font-family","font-size","divider","bold","italic","underline","strike","link","code","subscript","superscript","hr","todo","emoji","divider","highlight","font-color","divider","align","line-height","divider","bullet-list","ordered-list","indent-decrease","indent-increase","break","divider","image","video","attachment","quote","container","code-block","table","divider","printer","fullscreen","ai"];class pk extends HTMLElement{constructor(){super();N(this,"menuButtons",[])}connectedCallback(){const t=document.createElement("div");for(let r of this.menuButtons)t.appendChild(r);t.style.display="flex",t.style.flexWrap="wrap",this.appendChild(t)}onCreate(t,r){let i=r.toolbarKeys||hk;for(let o of i)if(o)try{if(typeof o=="string"){o=o.trim(),o==="|"&&(o="divider");const s=document.createElement("aie-"+o);if(s.classList.add("aie-menu-item"),s.onCreate(t,r),o!=="divider"){const a=j(o);a&&Ae(s,{appendTo:()=>t.editor.view.dom.closest(".aie-container"),content:a,theme:"aietip",arrow:!0})}this.menuButtons.push(s)}else{const s=o,a=document.createElement("aie-custom");if(a.classList.add("aie-menu-item"),s.id&&a.setAttribute("id",s.id),s.className&&a.classList.add(s.className),a.onCreate(t,r),a.onConfig(s),s.tip){const u=j(s.tip);u&&Ae(a,{appendTo:()=>t.editor.view.dom.closest(".aie-container"),content:u,theme:"aietip",arrow:!0})}s.onCreate&&s.onCreate(a,t.editor.aiEditor),this.menuButtons.push(a)}}catch{console.error("Can not create toolbar by key: "+o)}}onTransaction(t){for(let r of this.menuButtons)r.onTransaction(t)}}class mk extends HTMLElement{constructor(){super();N(this,"count",0);let t,r,i=300,o=300,s,a,u;const l=d=>{d.preventDefault(),document.removeEventListener("mouseup",l),document.removeEventListener("mousemove",c)},c=d=>{const f=d.clientX-t,h=d.clientY-r;if(f==0&&h==0)return;let p=s+f,m=a+h;p<i&&(p=i),m<o&&(m=o),u.style.width=`${p}px`,u.style.height=`${m}px`};this.addEventListener("mousedown",d=>{var h;d.target.closest("svg")&&(d.preventDefault(),document.addEventListener("mouseup",l),document.addEventListener("mousemove",c),u=(h=d.target.closest(".aie-container"))==null?void 0:h.parentElement,s=u.clientWidth,a=u.clientHeight,t=d.clientX,r=d.clientY)}),this.addEventListener("mouseup",l)}updateCharacters(){this.innerHTML=`
        <div style="display: flex"> 
            <span> : ${this.count} </span>
            <div style="width: 20px;height: 20px;overflow: hidden">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 16L6 10H18L12 16Z"></path></svg>
            </div>
        </div>
        `}onCreate(t,r){this.count=t.editor.storage.characterCount.characters(),this.updateCharacters()}onTransaction(t){const r=t.editor.storage.characterCount.characters();r!=this.count&&(this.count=r,this.updateCharacters())}}const gk=/^\s*>\s$/,bk=K.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",J(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[qn({find:gk,type:this.type})]}}),yk=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,xk=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,vk=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,kk=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,wk=de.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",J(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Vn({find:yk,type:this.type}),Vn({find:vk,type:this.type})]},addPasteRules(){return[bn({find:xk,type:this.type}),bn({find:kk,type:this.type})]}}),Ck=K.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",J(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),rf=de.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",J(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=Li(n,this.type);return Object.entries(t).some(([,i])=>!!i)?!0:e.unsetMark(this.name)}}}}),of=/^\s*([-+*])\s$/,Sk=K.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",J(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Ck.name,this.editor.getAttributes(rf.name)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=qn({find:of,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=qn({find:of,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(rf.name),editor:this.editor})),[n]}}),Ek=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,Ak=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,_k=de.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",J(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Vn({find:Ek,type:this.type})]},addPasteRules(){return[bn({find:Ak,type:this.type})]}}),Mk=/^```([a-z]+)?[\s\n]$/,Tk=/^~~~([a-z]+)?[\s\n]$/,Dk=K.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,o=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(s=>s.startsWith(t)).map(s=>s.replace(t,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",J(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:i}=t;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!o||!s?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:i,empty:o}=t;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const a=i.after();return a===void 0||r.nodeAt(a)?!1:n.commands.exitCode()}}},addInputRules(){return[$u({find:Mk,type:this.type,getAttributes:n=>({language:n[1]})}),$u({find:Tk,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new oe({key:new ae("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=i==null?void 0:i.mode;if(!t||!o)return!1;const{tr:s}=n.state;return s.replaceSelectionWith(this.type.create({language:o})),s.setSelection(B.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.insertText(t.replace(/\r\n?/g,`
`)),s.setMeta("paste",!0),n.dispatch(s),!0}}})]}}),Lk=K.create({name:"doc",topNode:!0,content:"block+"});function Ok(n={}){return new oe({view(e){return new Rk(e,n)}})}class Rk{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=s=>{this[i](s)};return e.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r;if(t){let a=e.nodeBefore,u=e.nodeAfter;if(a||u){let l=this.editorView.nodeDOM(this.cursorPos-(a?a.nodeSize:0));if(l){let c=l.getBoundingClientRect(),d=a?c.bottom:c.top;a&&u&&(d=(d+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:c.left,right:c.right,top:d-this.width/2,bottom:d+this.width/2}}}}if(!r){let a=this.editorView.coordsAtPos(this.cursorPos);r={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}let i=this.editorView.dom.offsetParent;this.element||(this.element=i.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let o,s;if(!i||i==document.body&&getComputedStyle(i).position=="static")o=-pageXOffset,s=-pageYOffset;else{let a=i.getBoundingClientRect();o=a.left-i.scrollLeft,s=a.top-i.scrollTop}this.element.style.left=r.left-o+"px",this.element.style.top=r.top-s+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),i=r&&r.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,t,e):i;if(t&&!o){let s=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=fp(this.editorView.state.doc,s,this.editorView.dragging.slice);a!=null&&(s=a)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const Nk=re.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Ok(this.options)]}});class ce extends z{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return ce.valid(r)?new ce(r):z.near(r)}content(){return O.empty}eq(e){return e instanceof ce&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new ce(e.resolve(t.pos))}getBookmark(){return new Ul(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!Hk(e)||!Ik(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&ce.valid(e))return e;let i=e.pos,o=null;for(let s=e.depth;;s--){let a=e.node(s);if(t>0?e.indexAfter(s)<a.childCount:e.index(s)>0){o=a.child(t>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=t;let u=e.doc.resolve(i);if(ce.valid(u))return u}for(;;){let s=t>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!$.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*t),r=!1;continue e}break}o=s,i+=t;let a=e.doc.resolve(i);if(ce.valid(a))return a}return null}}}ce.prototype.visible=!1;ce.findFrom=ce.findGapCursorFrom;z.jsonID("gapcursor",ce);class Ul{constructor(e){this.pos=e}map(e){return new Ul(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return ce.valid(t)?new ce(t):z.near(t)}}function Hk(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function Ik(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function Fk(){return new oe({props:{decorations:zk,createSelectionBetween(n,e,t){return e.pos==t.pos&&ce.valid(t)?new ce(t):null},handleClick:Bk,handleKeyDown:Pk,handleDOMEvents:{beforeinput:$k}}})}const Pk=Al({ArrowLeft:ro("horiz",-1),ArrowRight:ro("horiz",1),ArrowUp:ro("vert",-1),ArrowDown:ro("vert",1)});function ro(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let s=r.selection,a=e>0?s.$to:s.$from,u=s.empty;if(s instanceof B){if(!o.endOfTextblock(t)||a.depth==0)return!1;u=!1,a=r.doc.resolve(e>0?a.after():a.before())}let l=ce.findGapCursorFrom(a,e,u);return l?(i&&i(r.tr.setSelection(new ce(l))),!0):!1}}function Bk(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!ce.valid(r))return!1;let i=n.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&$.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new ce(r))),!0)}function $k(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof ce))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=_.empty;for(let s=r.length-1;s>=0;s--)i=_.from(r[s].createAndFill(null,i));let o=n.state.tr.replace(t.pos,t.pos,new O(i,0,0));return o.setSelection(B.near(o.doc.resolve(t.pos+1))),n.dispatch(o),!1}function zk(n){if(!(n.selection instanceof ce))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",ne.create(n.doc,[pe.widget(n.selection.head,e,{key:"gapcursor"})])}const Vk=re.create({name:"gapCursor",addProseMirrorPlugins(){return[Fk()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=W(H(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),qk=K.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",J(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:i,storedMarks:o}=t;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:a}=r.extensionManager,u=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:l,dispatch:c})=>{if(c&&u&&s){const d=u.filter(f=>a.includes(f.type.name));l.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),z0=K.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,J(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>$u({find:new RegExp(`^(#{1,${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var Ko=200,ye=function(){};ye.prototype.append=function(e){return e.length?(e=ye.from(e),!this.length&&e||e.length<Ko&&this.leafAppend(e)||this.length<Ko&&e.leafPrepend(this)||this.appendInner(e)):this};ye.prototype.prepend=function(e){return e.length?ye.from(e).append(this):this};ye.prototype.appendInner=function(e){return new jk(this,e)};ye.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?ye.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};ye.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};ye.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};ye.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(o,s){return i.push(e(o,s))},t,r),i};ye.from=function(e){return e instanceof ye?e:e&&e.length?new V0(e):ye.empty};var V0=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new e(this.values.slice(i,o))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,o,s,a){for(var u=o;u<s;u++)if(i(this.values[u],a+u)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,s,a){for(var u=o-1;u>=s;u--)if(i(this.values[u],a+u)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=Ko)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=Ko)return new e(i.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(ye);ye.empty=new V0([]);var jk=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,o,s){var a=this.left.length;if(i<a&&this.left.forEachInner(r,i,Math.min(o,a),s)===!1||o>a&&this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,o)-a,s+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,s){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(r,i-a,Math.max(o,a)-a,s+a)===!1||o<a&&this.left.forEachInvertedInner(r,Math.min(i,a),o,s)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(ye);const Uk=500;class st{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,o;t&&(i=this.remapping(r,this.items.length),o=i.maps.length);let s=e.tr,a,u,l=[],c=[];return this.items.forEach((d,f)=>{if(!d.step){i||(i=this.remapping(r,f+1),o=i.maps.length),o--,c.push(d);return}if(i){c.push(new ht(d.map));let h=d.step.map(i.slice(o)),p;h&&s.maybeStep(h).doc&&(p=s.mapping.maps[s.mapping.maps.length-1],l.push(new ht(p,void 0,void 0,l.length+c.length))),o--,p&&i.appendMap(p,o)}else s.maybeStep(d.step);if(d.selection)return a=i?d.selection.map(i.slice(o)):d.selection,u=new st(this.items.slice(0,r).append(c.reverse().concat(l)),this.eventCount-1),!1},this.items.length,0),{remaining:u,transform:s,selection:a}}addTransform(e,t,r,i){let o=[],s=this.eventCount,a=this.items,u=!i&&a.length?a.get(a.length-1):null;for(let c=0;c<e.steps.length;c++){let d=e.steps[c].invert(e.docs[c]),f=new ht(e.mapping.maps[c],d,t),h;(h=u&&u.merge(f))&&(f=h,c?o.pop():a=a.slice(0,a.length-1)),o.push(f),t&&(s++,t=void 0),i||(u=f)}let l=s-r.depth;return l>Zk&&(a=Wk(a,l),s-=l),new st(a.append(o),s)}remapping(e,t){let r=new fr;return this.items.forEach((i,o)=>{let s=i.mirrorOffset!=null&&o-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,s)},e,t),r}addMaps(e){return this.eventCount==0?this:new st(this.items.append(e.map(t=>new ht(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-t),o=e.mapping,s=e.steps.length,a=this.eventCount;this.items.forEach(f=>{f.selection&&a--},i);let u=t;this.items.forEach(f=>{let h=o.getMirror(--u);if(h==null)return;s=Math.min(s,h);let p=o.maps[h];if(f.step){let m=e.steps[h].invert(e.docs[h]),g=f.selection&&f.selection.map(o.slice(u+1,h));g&&a++,r.push(new ht(p,m,g))}else r.push(new ht(p))},i);let l=[];for(let f=t;f<s;f++)l.push(new ht(o.maps[f]));let c=this.items.slice(0,i).append(l).append(r),d=new st(c,a);return d.emptyItemCount()>Uk&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,i=[],o=0;return this.items.forEach((s,a)=>{if(a>=e)i.push(s),s.selection&&o++;else if(s.step){let u=s.step.map(t.slice(r)),l=u&&u.getMap();if(r--,l&&t.appendMap(l,r),u){let c=s.selection&&s.selection.map(t.slice(r));c&&o++;let d=new ht(l.invert(),u,c),f,h=i.length-1;(f=i.length&&i[h].merge(d))?i[h]=f:i.push(d)}}else s.map&&r--},this.items.length,0),new st(ye.from(i.reverse()),o)}}st.empty=new st(ye.empty,0);function Wk(n,e){let t;return n.forEach((r,i)=>{if(r.selection&&e--==0)return t=i,!1}),n.slice(t)}class ht{constructor(e,t,r,i){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new ht(t.getMap().invert(),t,this.selection)}}}class Xt{constructor(e,t,r,i,o){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=i,this.prevComposition=o}}const Zk=20;function Kk(n,e,t,r){let i=t.getMeta(mn),o;if(i)return i.historyState;t.getMeta(Jk)&&(n=new Xt(n.done,n.undone,null,0,-1));let s=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(s&&s.getMeta(mn))return s.getMeta(mn).redo?new Xt(n.done.addTransform(t,void 0,r,wo(e)),n.undone,sf(t.mapping.maps[t.steps.length-1]),n.prevTime,n.prevComposition):new Xt(n.done,n.undone.addTransform(t,void 0,r,wo(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),u=n.prevTime==0||!s&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!Gk(t,n.prevRanges)),l=s?ja(n.prevRanges,t.mapping):sf(t.mapping.maps[t.steps.length-1]);return new Xt(n.done.addTransform(t,u?e.selection.getBookmark():void 0,r,wo(e)),st.empty,l,t.time,a??n.prevComposition)}else return(o=t.getMeta("rebased"))?new Xt(n.done.rebased(t,o),n.undone.rebased(t,o),ja(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new Xt(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),ja(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function Gk(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,i)=>{for(let o=0;o<e.length;o+=2)r<=e[o+1]&&i>=e[o]&&(t=!0)}),t}function sf(n){let e=[];return n.forEach((t,r,i,o)=>e.push(i,o)),e}function ja(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let i=e.map(n[r],1),o=e.map(n[r+1],-1);i<=o&&t.push(i,o)}return t}function q0(n,e,t,r){let i=wo(e),o=mn.get(e).spec.config,s=(r?n.undone:n.done).popEvent(e,i);if(!s)return;let a=s.selection.resolve(s.transform.doc),u=(r?n.done:n.undone).addTransform(s.transform,e.selection.getBookmark(),o,i),l=new Xt(r?u:s.remaining,r?s.remaining:u,null,0,-1);t(s.transform.setSelection(a).setMeta(mn,{redo:r,historyState:l}).scrollIntoView())}let Ua=!1,af=null;function wo(n){let e=n.plugins;if(af!=e){Ua=!1,af=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Ua=!0;break}}return Ua}const mn=new ae("history"),Jk=new ae("closeHistory");function Yk(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new oe({key:mn,state:{init(){return new Xt(st.empty,st.empty,null,0,-1)},apply(e,t,r){return Kk(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,i=r=="historyUndo"?j0:r=="historyRedo"?U0:null;return i?(t.preventDefault(),i(e.state,e.dispatch)):!1}}}})}const j0=(n,e)=>{let t=mn.getState(n);return!t||t.done.eventCount==0?!1:(e&&q0(t,n,e,!1),!0)},U0=(n,e)=>{let t=mn.getState(n);return!t||t.undone.eventCount==0?!1:(e&&q0(t,n,e,!0),!0)},Xk=re.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>j0(n,e),redo:()=>({state:n,dispatch:e})=>U0(n,e)}},addProseMirrorPlugins(){return[Yk(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-Z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-Y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Shift-Mod-Z":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),Qk=K.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",J(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{const{$to:t}=e.selection,r=n();return t.parentOffset===0?r.insertContentAt(Math.max(t.pos-2,0),{type:this.name}):r.insertContent({type:this.name}),r.command(({tr:i,dispatch:o})=>{var s;if(o){const{$to:a}=i.selection,u=a.end();if(a.nodeAfter)a.nodeAfter.isTextblock?i.setSelection(B.create(i.doc,a.pos+1)):a.nodeAfter.isBlock?i.setSelection($.create(i.doc,a.pos)):i.setSelection(B.create(i.doc,a.pos));else{const l=(s=a.parent.type.contentMatch.defaultType)===null||s===void 0?void 0:s.create();l&&(i.insert(u,l),i.setSelection(B.create(i.doc,u+1)))}i.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Hl({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),ew=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,tw=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,nw=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,rw=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,iw=de.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",J(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Vn({find:ew,type:this.type}),Vn({find:nw,type:this.type})]},addPasteRules(){return[bn({find:tw,type:this.type}),bn({find:rw,type:this.type})]}}),ow=K.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",J(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),sw=K.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",J(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),uf=de.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",J(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=Li(n,this.type);return Object.entries(t).some(([,i])=>!!i)?!0:e.unsetMark(this.name)}}}}),lf=/^(\d+)\.\s$/,aw=K.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",J(this.options.HTMLAttributes,t),0]:["ol",J(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(sw.name,this.editor.getAttributes(uf.name)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=qn({find:lf,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=qn({find:lf,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(uf.name)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),uw=K.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",J(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),lw=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,cw=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,dw=de.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",J(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){const n={};return Ll()?n["Mod-Shift-s"]=()=>this.editor.commands.toggleStrike():n["Ctrl-Shift-s"]=()=>this.editor.commands.toggleStrike(),n},addInputRules(){return[Vn({find:lw,type:this.type})]},addPasteRules(){return[bn({find:cw,type:this.type})]}}),fw=K.create({name:"text",group:"inline"}),cf=re.create({name:"starterKit",addExtensions(){var n,e,t,r,i,o,s,a,u,l,c,d,f,h,p,m,g,y;const x=[];return this.options.blockquote!==!1&&x.push(bk.configure((n=this.options)===null||n===void 0?void 0:n.blockquote)),this.options.bold!==!1&&x.push(wk.configure((e=this.options)===null||e===void 0?void 0:e.bold)),this.options.bulletList!==!1&&x.push(Sk.configure((t=this.options)===null||t===void 0?void 0:t.bulletList)),this.options.code!==!1&&x.push(_k.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&x.push(Dk.configure((i=this.options)===null||i===void 0?void 0:i.codeBlock)),this.options.document!==!1&&x.push(Lk.configure((o=this.options)===null||o===void 0?void 0:o.document)),this.options.dropcursor!==!1&&x.push(Nk.configure((s=this.options)===null||s===void 0?void 0:s.dropcursor)),this.options.gapcursor!==!1&&x.push(Vk.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&x.push(qk.configure((u=this.options)===null||u===void 0?void 0:u.hardBreak)),this.options.heading!==!1&&x.push(z0.configure((l=this.options)===null||l===void 0?void 0:l.heading)),this.options.history!==!1&&x.push(Xk.configure((c=this.options)===null||c===void 0?void 0:c.history)),this.options.horizontalRule!==!1&&x.push(Qk.configure((d=this.options)===null||d===void 0?void 0:d.horizontalRule)),this.options.italic!==!1&&x.push(iw.configure((f=this.options)===null||f===void 0?void 0:f.italic)),this.options.listItem!==!1&&x.push(ow.configure((h=this.options)===null||h===void 0?void 0:h.listItem)),this.options.orderedList!==!1&&x.push(aw.configure((p=this.options)===null||p===void 0?void 0:p.orderedList)),this.options.paragraph!==!1&&x.push(uw.configure((m=this.options)===null||m===void 0?void 0:m.paragraph)),this.options.strike!==!1&&x.push(dw.configure((g=this.options)===null||g===void 0?void 0:g.strike)),this.options.text!==!1&&x.push(fw.configure((y=this.options)===null||y===void 0?void 0:y.text)),x}}),hw=de.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",J(this.options.HTMLAttributes,n),0]},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),pw=de.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",J(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=Li(n,this.type);return Object.entries(t).some(([,i])=>!!i)?!0:e.unsetMark(this.name)}}}}),mw=re.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:n=>{var e;return(e=n.style.fontFamily)===null||e===void 0?void 0:e.replace(/['"]+/g,"")},renderHTML:n=>n.fontFamily?{style:`font-family: ${n.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:n=>({chain:e})=>e().setMark("textStyle",{fontFamily:n}).run(),unsetFontFamily:()=>({chain:n})=>n().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),W0=n=>{const e=document.createElement("div");return e.classList.add("aie-loader-placeholder"),e.innerHTML=`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 3C16.9706 3 21 7.02944 21 12H19C19 8.13401 15.866 5 12 5V3Z"></path></svg>
    `,pe.widget(n.pos,e,{id:n.id})},gw=n=>{const e=document.createElement("div");return e.classList.add("aie-loader-placeholder"),e.style.height="20px",e.style.display="inline-block",e.innerHTML=`
    <svg style="width: 16px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 3C16.9706 3 21 7.02944 21 12H19C19 8.13401 15.866 5 12 5V3Z"></path></svg>
   ${n.text}
    `,pe.widget(n.pos,e,{id:n.id})},bw=(n,e,t,r)=>{const i=new FormData;return i.append(r,n),new Promise((o,s)=>{fetch(e,{method:"post",headers:{Accept:"application/json",...t},body:i}).then(a=>a.json()).then(a=>{o(a)}).catch(a=>{s(a)})})},yw=(n,e,t,r)=>{let i=new FileReader;return new Promise((o,s)=>{i.onload=()=>o({errorCode:0,data:{src:i.result,href:n.name}}),i.onerror=()=>s(i.error),setTimeout(()=>i.readAsDataURL(n),5e3*Math.random())})},Wl=n=>n?bw:yw,df=new ae("aie-attachment-plugin"),qr="attachment_action",xw=re.create({name:"attachment",addOptions(){return{uploadUrl:"",uploadHeaders:{},HTMLAttributes:{}}},addCommands(){return{uploadAttachment:n=>()=>{const e=Ks(),{state:{tr:t},view:r,schema:i}=this.editor;return t.selection.empty||t.deleteSelection(),r.dispatch(t.setMeta(qr,{type:"add",id:e,pos:t.selection.from,text:n.name})),this.options.uploaderEvent&&this.options.uploaderEvent.onUploadBefore&&this.options.uploaderEvent.onUploadBefore(n,this.options.uploadUrl,this.options.uploadHeaders),(this.options.uploader||Wl(this.options.uploadUrl))(n,this.options.uploadUrl,this.options.uploadHeaders,"attachment").then(s=>{if(this.options.uploaderEvent&&this.options.uploaderEvent.onSuccess){const a=this.options.uploaderEvent.onSuccess(n,s);if(typeof a=="boolean"&&!a)return;typeof a=="object"&&(s=a)}if(s.errorCode===0&&s.data&&s.data.href){let u=df.getState(this.editor.state).find(void 0,void 0,c=>c.id==e);const l=s.data.fileName||n.name;r.dispatch(r.state.tr.insertText(` ${l} `,u[0].from).addMark(u[0].from+1,l.length+u[0].from+1,i.marks.link.create({href:s.data.href,target:"_blank"})).setMeta(qr,{type:"remove",id:e}))}else r.dispatch(t.setMeta(qr,{type:"remove",id:e})),this.options.uploaderEvent&&this.options.uploaderEvent.onFailed&&this.options.uploaderEvent.onFailed(n,s)}).catch(s=>{const{state:{tr:a},view:u}=this.editor;u.dispatch(a.setMeta(qr,{type:"remove",id:e})),this.options.uploaderEvent&&this.options.uploaderEvent.onError&&this.options.uploaderEvent.onError(n,s)}),!0}}},addProseMirrorPlugins(){const n=this.editor;return[new oe({key:df,state:{init:()=>ne.empty,apply:(e,t)=>{const r=e.getMeta(qr);return t=t.map(e.mapping,e.doc),r&&r.type==="add"?t=t.add(e.doc,[gw(r)]):r&&r.type==="remove"&&(t=t.remove(t.find(void 0,void 0,i=>i.id==r.id))),t}},props:{decorations(e){return this.getState(e)},handleDOMEvents:{drop(e,t){if(!(t.dataTransfer&&t.dataTransfer.files&&t.dataTransfer.files.length))return!1;const i=Array.from(t.dataTransfer.files).filter(o=>!/video/i.test(o.type)&&!/image/i.test(o.type));return t.preventDefault(),i.forEach(o=>{n.commands.uploadAttachment(o)}),!0}}}})]}}),vw=re.create({name:"painter",addCommands(){return{setPainter:n=>({view:{dispatch:e,state:{tr:t},dom:r}})=>(r.style.cursor="context-menu",e(t.setMeta("painterAction",{type:"start",marks:n})),!0)}},addProseMirrorPlugins(){return[new oe({key:new ae("aie-painter"),state:{init:()=>[],apply:(n,e)=>{const t=n.getMeta("painterAction");return t&&t.type==="start"?e=t.marks:t&&t.type==="end"&&(e=[]),e}},props:{handleDOMEvents:{mousedown(n,e){const t=this.getState(n.state);if(!t||t.length==0)return!1;const r=()=>{document.removeEventListener("mouseup",r);let{dispatch:i,state:{tr:o,selection:s},dom:a}=n;a.style.cursor="",o=o.removeMark(s.from,s.to);for(let u of t)u.type.name!="link"&&(o=o.addMark(s.from,s.to,u));i(o.setMeta("painterAction",{type:"end"}))};return document.addEventListener("mouseup",r),!0}}}})]}}),kw=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))$/,ww=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))/g,Cw=de.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:n=>n.getAttribute("data-color")||n.style.backgroundColor,renderHTML:n=>n.color?{"data-color":n.color,style:`background-color: ${n.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:n}){return["mark",J(this.options.HTMLAttributes,n),0]},addCommands(){return{setHighlight:n=>({commands:e})=>e.setMark(this.name,n),toggleHighlight:n=>({commands:e})=>e.toggleMark(this.name,n),unsetHighlight:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[Vn({find:kw,type:this.type})]},addPasteRules(){return[bn({find:ww,type:this.type})]}}),Sw=re.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:n=>{var e;return(e=n.style.color)===null||e===void 0?void 0:e.replace(/['"]+/g,"")},renderHTML:n=>n.color?{style:`color: ${n.color}`}:{}}}}]},addCommands(){return{setColor:n=>({chain:e})=>e().setMark("textStyle",{color:n}).run(),unsetColor:()=>({chain:n})=>n().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),Ew=re.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:n=>{var e;return(e=n.style.fontSize)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:n=>n.fontSize?{style:`font-size: ${n.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:n=>({chain:e})=>e().setMark("textStyle",{fontSize:n}).run(),unsetFontSize:()=>({chain:n})=>n().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),Aw=re.create({name:"lineHeight",addOptions(){return{types:["heading","paragraph"],heights:["100%","125%","150%","200%","250%","300%"],defaultHeight:"100%"}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:this.options.defaultHeight,parseHTML:n=>n.style.lineHeight||this.options.defaultHeight,renderHTML:n=>n.lineHeight===this.options.defaultHeight?{}:{style:`line-height: ${n.lineHeight}`}}}}]},addCommands(){return{setLineHeight:n=>({commands:e})=>this.options.heights.includes(n)?this.options.types.every(t=>e.updateAttributes(t,{lineHeight:n})):!1,unsetLineHeight:()=>({commands:n})=>this.options.types.every(e=>n.resetAttributes(e,"lineHeight"))}}}),_w=re.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:"left"}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:n=>n.style.textAlign||this.options.defaultAlignment,renderHTML:n=>n.textAlign===this.options.defaultAlignment?{}:{style:`text-align: ${n.textAlign}`}}}}]},addCommands(){return{setTextAlign:n=>({commands:e})=>this.options.alignments.includes(n)?this.options.types.every(t=>e.updateAttributes(t,{textAlign:n})):!1,unsetTextAlign:()=>({commands:n})=>this.options.types.every(e=>n.resetAttributes(e,"textAlign"))}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),Mw=re.create({name:"indent",addOptions(){return{types:["listItem","paragraph"],minLevel:0,maxLevel:8}},addGlobalAttributes(){return[{types:this.options.types,attributes:{indent:{default:0,parseHTML:n=>{const e=Number(n.getAttribute("data-indent"));return e&&e>this.options.minLevel?e:null},renderHTML:n=>n.indent?{style:`text-indent: ${(n==null?void 0:n.indent)*10}px`,"data-indent":n==null?void 0:n.indent}:{}}}}]},addCommands(){const n=(r,i,o)=>{var a;const s=(a=r==null?void 0:r.doc)==null?void 0:a.nodeAt(i);if(s){const u=(s.attrs.indent||0)+o,{minLevel:l,maxLevel:c}=this.options,d=u<l?l:u>c?c:u;if(d!==s.attrs.indent){const{indent:f,...h}=s.attrs,p=d>l?{...h,indent:d}:h;return r.setNodeMarkup(i,s.type,p,s.marks)}}return r},e=(r,i)=>{const{doc:o,selection:s}=r;if(o&&s&&(s instanceof B||s instanceof Je)){const{from:a,to:u}=s;o.nodesBetween(a,u,(l,c)=>this.options.types.includes(l.type.name)?(r=n(r,c,i),!1):!0)}return r},t=r=>()=>({tr:i,state:o,dispatch:s})=>{const{selection:a}=o;return i=i.setSelection(a),i=e(i,r),i.docChanged?(s==null||s(i),!0):!1};return{indent:t(1),outdent:t(-1)}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.indent(),"Shift-Tab":()=>this.editor.commands.outdent()}}}),Tw=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,Dw=K.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:n}){return["img",J(this.options.HTMLAttributes,n)]},addCommands(){return{setImage:n=>({commands:e})=>e.insertContent({type:this.name,attrs:n})}},addInputRules(){return[Hl({find:Tw,type:this.type,getAttributes:n=>{const[,,e,t,r]=n;return{src:t,alt:e,title:r}}})]}}),Z0=(n,e,t)=>{const r=n.querySelector(".resize-obj"),i=10;let o,s,a,u;const l=f=>{f.preventDefault(),e.addEventListener("mousemove",c),e.addEventListener("mouseup",d),e.addEventListener("mouseleave",d),o=f.clientX,s=Number(r.getAttribute("data-with"))||r.clientWidth,a=f.target.getAttribute("data-position"),u=e.clientWidth-100},c=f=>{const h=f.clientX-o;if(h==0)return;const p=a==="right"?h>0:h<0;let m=s+Math.abs(h)*(p?1:-1);m>=u&&(m=u),m<i&&(m=i),r.style.width=`${m}px`,r.setAttribute("data-width",m.toString())},d=()=>{e.removeEventListener("mousemove",c),e.removeEventListener("mouseup",d),e.removeEventListener("mouseleave",d);const f={width:Number(r.getAttribute("data-width"))};t(f)};for(let f of n.querySelector(".aie-resize").children)f.addEventListener("mousedown",l)},ff=new ae("aie-image-plugin"),jr="image_action",Lw=Dw.extend({name:"image",draggable:!0,selectable:!0,addOptions(){var n;return{...(n=this.parent)==null?void 0:n.call(this),uploadUrl:"",uploadHeaders:{},uploader:void 0,defaultSize:350}},allowGapCursor(){return!this.options.inline},addAttributes(){return{src:{default:"",parseHTML:n=>`${n.getAttribute("src")??""}`},alt:{default:""},title:{default:""},width:{default:this.options.defaultSize},height:{default:"auto"},align:{default:"left"}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:n}){return["img",J(this.options.HTMLAttributes,n)]},addCommands(){var n;return{...(n=this.parent)==null?void 0:n.call(this),uploadImage:e=>()=>{const t=Ks(),{state:{tr:r},view:i,schema:o}=this.editor;return r.selection.empty||r.deleteSelection(),i.dispatch(r.setMeta(jr,{type:"add",id:t,pos:r.selection.from})),this.options.uploaderEvent&&this.options.uploaderEvent.onUploadBefore&&this.options.uploaderEvent.onUploadBefore(e,this.options.uploadUrl,this.options.uploadHeaders),(this.options.uploader||Wl(this.options.uploadUrl))(e,this.options.uploadUrl,this.options.uploadHeaders,"image").then(a=>{if(this.options.uploaderEvent&&this.options.uploaderEvent.onSuccess){const u=this.options.uploaderEvent.onSuccess(e,a);if(typeof u=="boolean"&&!u)return;typeof u=="object"&&(a=u)}if(a.errorCode===0&&a.data&&a.data.src){let l=ff.getState(this.editor.state).find(void 0,void 0,c=>c.id==t);i.dispatch(i.state.tr.insert(l[0].from,o.nodes.image.create({src:a.data.src,alt:a.data.alt})).setMeta(jr,{type:"remove",id:t}))}else i.dispatch(r.setMeta(jr,{type:"remove",id:t})),this.options.uploaderEvent&&this.options.uploaderEvent.onFailed&&this.options.uploaderEvent.onFailed(e,a)}).catch(a=>{const{state:{tr:u},view:l}=this.editor;l.dispatch(u.setMeta(jr,{type:"remove",id:t})),this.options.uploaderEvent&&this.options.uploaderEvent.onError&&this.options.uploaderEvent.onError(e,a)}),!0}}},addNodeView(){return n=>{if(!this.editor.isEditable)return{};const e=document.createElement("div"),{src:t,width:r,height:i,align:o}=n.node.attrs;return e.classList.add(`align-${o}`),e.innerHTML=`
                <div class="aie-resize-wrapper">
                    <div class="aie-resize">
                        <div class="aie-resize-btn-top-left" data-position="left" draggable="true"></div>
                        <div class="aie-resize-btn-top-right" data-position="right" draggable="true"></div>
                        <div class="aie-resize-btn-bottom-left" data-position="left" draggable="true"></div>
                        <div class="aie-resize-btn-bottom-right" data-position="right" draggable="true"></div>
                    </div>
                    <img src="${t}" style="width: ${r}px; height: ${i}" class="align-${o} resize-obj">
                </div>
                `,Z0(e,n.editor.view.dom,s=>n.editor.commands.updateAttributes("image",s)),{dom:e}}},addProseMirrorPlugins(){const n=this.editor;return[new oe({key:ff,state:{init:()=>ne.empty,apply:(e,t)=>{const r=e.getMeta(jr);if(r){let i=!1;const o=t.map(e.mapping,e.doc,{onRemove:s=>{i=!0}});i||(t=o),r.type==="add"?t=t.add(e.doc,[W0(r)]):r.type==="remove"&&(t=t.remove(t.find(void 0,void 0,s=>s.id==r.id)))}return t}},props:{decorations(e){return this.getState(e)},handlePaste:(e,t)=>{var i;const r=Array.from(((i=t.clipboardData)==null?void 0:i.items)||[]);for(const o of r)if(o.type.indexOf("image")===0){t.preventDefault();const s=o.getAsFile();s&&this.editor.commands.uploadImage(s)}},handleDOMEvents:{drop(e,t){if(!(t.dataTransfer&&t.dataTransfer.files&&t.dataTransfer.files.length))return!1;const i=Array.from(t.dataTransfer.files).filter(l=>/image/i.test(l.type));if(i.length===0)return!1;t.preventDefault();const{state:{tr:o,doc:s},dispatch:a}=e,u=e.posAtCoords({left:t.clientX,top:t.clientY});return a(o.setSelection(B.create(s,u.pos)).scrollIntoView()),i.forEach(l=>{n.commands.uploadImage(l)}),!0}},transformPastedHTML(e){const r=new DOMParser().parseFromString(e,"text/html"),i=r.documentElement.querySelector("body");if(i!=null&&i.children){const o=r.documentElement.querySelectorAll("p > img");for(const s of o){const a=s.parentNode,u=Array.prototype.indexOf.call(i.children,a);s.parentElement.prepend(s),i.insertBefore(s,i.children[u])}return i.innerHTML}return e}}})]}});var Zu,Ku;if(typeof WeakMap<"u"){let n=new WeakMap;Zu=e=>n.get(e),Ku=(e,t)=>(n.set(e,t),t)}else{const n=[];let t=0;Zu=r=>{for(let i=0;i<n.length;i+=2)if(n[i]==r)return n[i+1]},Ku=(r,i)=>(t==10&&(t=0),n[t++]=r,n[t++]=i)}var le=class{constructor(n,e,t,r){this.width=n,this.height=e,this.map=t,this.problems=r}findCell(n){for(let e=0;e<this.map.length;e++){const t=this.map[e];if(t!=n)continue;const r=e%this.width,i=e/this.width|0;let o=r+1,s=i+1;for(let a=1;o<this.width&&this.map[e+a]==t;a++)o++;for(let a=1;s<this.height&&this.map[e+this.width*a]==t;a++)s++;return{left:r,top:i,right:o,bottom:s}}throw new RangeError(`No cell with offset ${n} found`)}colCount(n){for(let e=0;e<this.map.length;e++)if(this.map[e]==n)return e%this.width;throw new RangeError(`No cell with offset ${n} found`)}nextCell(n,e,t){const{left:r,right:i,top:o,bottom:s}=this.findCell(n);return e=="horiz"?(t<0?r==0:i==this.width)?null:this.map[o*this.width+(t<0?r-1:i)]:(t<0?o==0:s==this.height)?null:this.map[r+this.width*(t<0?o-1:s)]}rectBetween(n,e){const{left:t,right:r,top:i,bottom:o}=this.findCell(n),{left:s,right:a,top:u,bottom:l}=this.findCell(e);return{left:Math.min(t,s),top:Math.min(i,u),right:Math.max(r,a),bottom:Math.max(o,l)}}cellsInRect(n){const e=[],t={};for(let r=n.top;r<n.bottom;r++)for(let i=n.left;i<n.right;i++){const o=r*this.width+i,s=this.map[o];t[s]||(t[s]=!0,!(i==n.left&&i&&this.map[o-1]==s||r==n.top&&r&&this.map[o-this.width]==s)&&e.push(s))}return e}positionAt(n,e,t){for(let r=0,i=0;;r++){const o=i+t.child(r).nodeSize;if(r==n){let s=e+n*this.width;const a=(n+1)*this.width;for(;s<a&&this.map[s]<i;)s++;return s==a?o-1:this.map[s]}i=o}}static get(n){return Zu(n)||Ku(n,Ow(n))}};function Ow(n){if(n.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+n.type.name);const e=Rw(n),t=n.childCount,r=[];let i=0,o=null;const s=[];for(let l=0,c=e*t;l<c;l++)r[l]=0;for(let l=0,c=0;l<t;l++){const d=n.child(l);c++;for(let p=0;;p++){for(;i<r.length&&r[i]!=0;)i++;if(p==d.childCount)break;const m=d.child(p),{colspan:g,rowspan:y,colwidth:x}=m.attrs;for(let v=0;v<y;v++){if(v+l>=t){(o||(o=[])).push({type:"overlong_rowspan",pos:c,n:y-v});break}const b=i+v*e;for(let w=0;w<g;w++){r[b+w]==0?r[b+w]=c:(o||(o=[])).push({type:"collision",row:l,pos:c,n:g-w});const k=x&&x[w];if(k){const C=(b+w)%e*2,E=s[C];E==null||E!=k&&s[C+1]==1?(s[C]=k,s[C+1]=1):E==k&&s[C+1]++}}}i+=g,c+=m.nodeSize}const f=(l+1)*e;let h=0;for(;i<f;)r[i++]==0&&h++;h&&(o||(o=[])).push({type:"missing",row:l,n:h}),c++}const a=new le(e,t,r,o);let u=!1;for(let l=0;!u&&l<s.length;l+=2)s[l]!=null&&s[l+1]<t&&(u=!0);return u&&Nw(a,s,n),a}function Rw(n){let e=-1,t=!1;for(let r=0;r<n.childCount;r++){const i=n.child(r);let o=0;if(t)for(let s=0;s<r;s++){const a=n.child(s);for(let u=0;u<a.childCount;u++){const l=a.child(u);s+l.attrs.rowspan>r&&(o+=l.attrs.colspan)}}for(let s=0;s<i.childCount;s++){const a=i.child(s);o+=a.attrs.colspan,a.attrs.rowspan>1&&(t=!0)}e==-1?e=o:e!=o&&(e=Math.max(e,o))}return e}function Nw(n,e,t){n.problems||(n.problems=[]);const r={};for(let i=0;i<n.map.length;i++){const o=n.map[i];if(r[o])continue;r[o]=!0;const s=t.nodeAt(o);if(!s)throw new RangeError(`No cell with offset ${o} found`);let a=null;const u=s.attrs;for(let l=0;l<u.colspan;l++){const c=(i+l)%n.width,d=e[c*2];d!=null&&(!u.colwidth||u.colwidth[l]!=d)&&((a||(a=Hw(u)))[l]=d)}a&&n.problems.unshift({type:"colwidth mismatch",pos:o,colwidth:a})}}function Hw(n){if(n.colwidth)return n.colwidth.slice();const e=[];for(let t=0;t<n.colspan;t++)e.push(0);return e}function _e(n){let e=n.cached.tableNodeTypes;if(!e){e=n.cached.tableNodeTypes={};for(const t in n.nodes){const r=n.nodes[t],i=r.spec.tableRole;i&&(e[i]=r)}}return e}var rn=new ae("selectingCells");function Dr(n){for(let e=n.depth-1;e>0;e--)if(n.node(e).type.spec.tableRole=="row")return n.node(0).resolve(n.before(e+1));return null}function Iw(n){for(let e=n.depth;e>0;e--){const t=n.node(e).type.spec.tableRole;if(t==="cell"||t==="header_cell")return n.node(e)}return null}function ut(n){const e=n.selection.$head;for(let t=e.depth;t>0;t--)if(e.node(t).type.spec.tableRole=="row")return!0;return!1}function Js(n){const e=n.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const t=Dr(e.$head)||Fw(e.$head);if(t)return t;throw new RangeError(`No cell found around position ${e.head}`)}function Fw(n){for(let e=n.nodeAfter,t=n.pos;e;e=e.firstChild,t++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t)}for(let e=n.nodeBefore,t=n.pos;e;e=e.lastChild,t--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t-e.nodeSize)}}function Gu(n){return n.parent.type.spec.tableRole=="row"&&!!n.nodeAfter}function Pw(n){return n.node(0).resolve(n.pos+n.nodeAfter.nodeSize)}function Zl(n,e){return n.depth==e.depth&&n.pos>=e.start(-1)&&n.pos<=e.end(-1)}function K0(n,e,t){const r=n.node(-1),i=le.get(r),o=n.start(-1),s=i.nextCell(n.pos-o,e,t);return s==null?null:n.node(0).resolve(o+s)}function Un(n,e,t=1){const r={...n,colspan:n.colspan-t};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,t),r.colwidth.some(i=>i>0)||(r.colwidth=null)),r}function G0(n,e,t=1){const r={...n,colspan:n.colspan+t};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let i=0;i<t;i++)r.colwidth.splice(e,0,0)}return r}function Bw(n,e,t){const r=_e(e.type.schema).header_cell;for(let i=0;i<n.height;i++)if(e.nodeAt(n.map[t+i*n.width]).type!=r)return!1;return!0}var ie=class $t extends z{constructor(e,t=e){const r=e.node(-1),i=le.get(r),o=e.start(-1),s=i.rectBetween(e.pos-o,t.pos-o),a=e.node(0),u=i.cellsInRect(s).filter(c=>c!=t.pos-o);u.unshift(t.pos-o);const l=u.map(c=>{const d=r.nodeAt(c);if(!d)throw RangeError(`No cell with offset ${c} found`);const f=o+c+1;return new bp(a.resolve(f),a.resolve(f+d.content.size))});super(l[0].$from,l[0].$to,l),this.$anchorCell=e,this.$headCell=t}map(e,t){const r=e.resolve(t.map(this.$anchorCell.pos)),i=e.resolve(t.map(this.$headCell.pos));if(Gu(r)&&Gu(i)&&Zl(r,i)){const o=this.$anchorCell.node(-1)!=r.node(-1);return o&&this.isRowSelection()?$t.rowSelection(r,i):o&&this.isColSelection()?$t.colSelection(r,i):new $t(r,i)}return B.between(r,i)}content(){const e=this.$anchorCell.node(-1),t=le.get(e),r=this.$anchorCell.start(-1),i=t.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),o={},s=[];for(let u=i.top;u<i.bottom;u++){const l=[];for(let c=u*t.width+i.left,d=i.left;d<i.right;d++,c++){const f=t.map[c];if(o[f])continue;o[f]=!0;const h=t.findCell(f);let p=e.nodeAt(f);if(!p)throw RangeError(`No cell with offset ${f} found`);const m=i.left-h.left,g=h.right-i.right;if(m>0||g>0){let y=p.attrs;if(m>0&&(y=Un(y,0,m)),g>0&&(y=Un(y,y.colspan-g,g)),h.left<i.left){if(p=p.type.createAndFill(y),!p)throw RangeError(`Could not create cell with attrs ${JSON.stringify(y)}`)}else p=p.type.create(y,p.content)}if(h.top<i.top||h.bottom>i.bottom){const y={...p.attrs,rowspan:Math.min(h.bottom,i.bottom)-Math.max(h.top,i.top)};h.top<i.top?p=p.type.createAndFill(y):p=p.type.create(y,p.content)}l.push(p)}s.push(e.child(u).copy(_.from(l)))}const a=this.isColSelection()&&this.isRowSelection()?e:s;return new O(_.from(a),1,1)}replace(e,t=O.empty){const r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){const{$from:a,$to:u}=i[s],l=e.mapping.slice(r);e.replace(l.map(a.pos),l.map(u.pos),s?O.empty:t)}const o=z.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);o&&e.setSelection(o)}replaceWith(e,t){this.replace(e,new O(_.from(t),0,0))}forEachCell(e){const t=this.$anchorCell.node(-1),r=le.get(t),i=this.$anchorCell.start(-1),o=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i));for(let s=0;s<o.length;s++)e(t.nodeAt(o[s]),i+o[s])}isColSelection(){const e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,i=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,i)==this.$headCell.node(-1).childCount}static colSelection(e,t=e){const r=e.node(-1),i=le.get(r),o=e.start(-1),s=i.findCell(e.pos-o),a=i.findCell(t.pos-o),u=e.node(0);return s.top<=a.top?(s.top>0&&(e=u.resolve(o+i.map[s.left])),a.bottom<i.height&&(t=u.resolve(o+i.map[i.width*(i.height-1)+a.right-1]))):(a.top>0&&(t=u.resolve(o+i.map[a.left])),s.bottom<i.height&&(e=u.resolve(o+i.map[i.width*(i.height-1)+s.right-1]))),new $t(e,t)}isRowSelection(){const e=this.$anchorCell.node(-1),t=le.get(e),r=this.$anchorCell.start(-1),i=t.colCount(this.$anchorCell.pos-r),o=t.colCount(this.$headCell.pos-r);if(Math.min(i,o)>0)return!1;const s=i+this.$anchorCell.nodeAfter.attrs.colspan,a=o+this.$headCell.nodeAfter.attrs.colspan;return Math.max(s,a)==t.width}eq(e){return e instanceof $t&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,t=e){const r=e.node(-1),i=le.get(r),o=e.start(-1),s=i.findCell(e.pos-o),a=i.findCell(t.pos-o),u=e.node(0);return s.left<=a.left?(s.left>0&&(e=u.resolve(o+i.map[s.top*i.width])),a.right<i.width&&(t=u.resolve(o+i.map[i.width*(a.top+1)-1]))):(a.left>0&&(t=u.resolve(o+i.map[a.top*i.width])),s.right<i.width&&(e=u.resolve(o+i.map[i.width*(s.top+1)-1]))),new $t(e,t)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,t){return new $t(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){return new $t(e.resolve(t),e.resolve(r))}getBookmark(){return new $w(this.$anchorCell.pos,this.$headCell.pos)}};ie.prototype.visible=!1;z.jsonID("cell",ie);var $w=class J0{constructor(e,t){this.anchor=e,this.head=t}map(e){return new J0(e.map(this.anchor),e.map(this.head))}resolve(e){const t=e.resolve(this.anchor),r=e.resolve(this.head);return t.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&t.index()<t.parent.childCount&&r.index()<r.parent.childCount&&Zl(t,r)?new ie(t,r):z.near(r,1)}};function zw(n){if(!(n.selection instanceof ie))return null;const e=[];return n.selection.forEachCell((t,r)=>{e.push(pe.node(r,r+t.nodeSize,{class:"selectedCell"}))}),ne.create(n.doc,e)}function Vw({$from:n,$to:e}){if(n.pos==e.pos||n.pos<n.pos-6)return!1;let t=n.pos,r=e.pos,i=n.depth;for(;i>=0&&!(n.after(i+1)<n.end(i));i--,t++);for(let o=e.depth;o>=0&&!(e.before(o+1)>e.start(o));o--,r--);return t==r&&/row|table/.test(n.node(i).type.spec.tableRole)}function qw({$from:n,$to:e}){let t,r;for(let i=n.depth;i>0;i--){const o=n.node(i);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){t=o;break}}for(let i=e.depth;i>0;i--){const o=e.node(i);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){r=o;break}}return t!==r&&e.parentOffset===0}function jw(n,e,t){const r=(e||n).selection,i=(e||n).doc;let o,s;if(r instanceof $&&(s=r.node.type.spec.tableRole)){if(s=="cell"||s=="header_cell")o=ie.create(i,r.from);else if(s=="row"){const a=i.resolve(r.from+1);o=ie.rowSelection(a,a)}else if(!t){const a=le.get(r.node),u=r.from+1,l=u+a.map[a.width*a.height-1];o=ie.create(i,u+1,l)}}else r instanceof B&&Vw(r)?o=B.create(i,r.from):r instanceof B&&qw(r)&&(o=B.create(i,r.$from.start(),r.$from.end()));return o&&(e||(e=n.tr)).setSelection(o),e}var Uw=new ae("fix-tables");function Y0(n,e,t,r){const i=n.childCount,o=e.childCount;e:for(let s=0,a=0;s<o;s++){const u=e.child(s);for(let l=a,c=Math.min(i,s+3);l<c;l++)if(n.child(l)==u){a=l+1,t+=u.nodeSize;continue e}r(u,t),a<i&&n.child(a).sameMarkup(u)?Y0(n.child(a),u,t+1,r):u.nodesBetween(0,u.content.size,r,t+1),t+=u.nodeSize}}function X0(n,e){let t;const r=(i,o)=>{i.type.spec.tableRole=="table"&&(t=Ww(n,i,o,t))};return e?e.doc!=n.doc&&Y0(e.doc,n.doc,0,r):n.doc.descendants(r),t}function Ww(n,e,t,r){const i=le.get(e);if(!i.problems)return r;r||(r=n.tr);const o=[];for(let u=0;u<i.height;u++)o.push(0);for(let u=0;u<i.problems.length;u++){const l=i.problems[u];if(l.type=="collision"){const c=e.nodeAt(l.pos);if(!c)continue;const d=c.attrs;for(let f=0;f<d.rowspan;f++)o[l.row+f]+=l.n;r.setNodeMarkup(r.mapping.map(t+1+l.pos),null,Un(d,d.colspan-l.n,l.n))}else if(l.type=="missing")o[l.row]+=l.n;else if(l.type=="overlong_rowspan"){const c=e.nodeAt(l.pos);if(!c)continue;r.setNodeMarkup(r.mapping.map(t+1+l.pos),null,{...c.attrs,rowspan:c.attrs.rowspan-l.n})}else if(l.type=="colwidth mismatch"){const c=e.nodeAt(l.pos);if(!c)continue;r.setNodeMarkup(r.mapping.map(t+1+l.pos),null,{...c.attrs,colwidth:l.colwidth})}}let s,a;for(let u=0;u<o.length;u++)o[u]&&(s==null&&(s=u),a=u);for(let u=0,l=t+1;u<i.height;u++){const c=e.child(u),d=l+c.nodeSize,f=o[u];if(f>0){let h="cell";c.firstChild&&(h=c.firstChild.type.spec.tableRole);const p=[];for(let g=0;g<f;g++){const y=_e(n.schema)[h].createAndFill();y&&p.push(y)}const m=(u==0||s==u-1)&&a==u?l+1:d-1;r.insert(r.mapping.map(m),p)}l=d}return r.setMeta(Uw,{fixTables:!0})}function Zw(n){if(!n.size)return null;let{content:e,openStart:t,openEnd:r}=n;for(;e.childCount==1&&(t>0&&r>0||e.child(0).type.spec.tableRole=="table");)t--,r--,e=e.child(0).content;const i=e.child(0),o=i.type.spec.tableRole,s=i.type.schema,a=[];if(o=="row")for(let u=0;u<e.childCount;u++){let l=e.child(u).content;const c=u?0:Math.max(0,t-1),d=u<e.childCount-1?0:Math.max(0,r-1);(c||d)&&(l=Ju(_e(s).row,new O(l,c,d)).content),a.push(l)}else if(o=="cell"||o=="header_cell")a.push(t||r?Ju(_e(s).row,new O(e,t,r)).content:e);else return null;return Kw(s,a)}function Kw(n,e){const t=[];for(let i=0;i<e.length;i++){const o=e[i];for(let s=o.childCount-1;s>=0;s--){const{rowspan:a,colspan:u}=o.child(s).attrs;for(let l=i;l<i+a;l++)t[l]=(t[l]||0)+u}}let r=0;for(let i=0;i<t.length;i++)r=Math.max(r,t[i]);for(let i=0;i<t.length;i++)if(i>=e.length&&e.push(_.empty),t[i]<r){const o=_e(n).cell.createAndFill(),s=[];for(let a=t[i];a<r;a++)s.push(o);e[i]=e[i].append(_.from(s))}return{height:e.length,width:r,rows:e}}function Ju(n,e){const t=n.createAndFill();return new ml(t).replace(0,t.content.size,e).doc}function Gw({width:n,height:e,rows:t},r,i){if(n!=r){const o=[],s=[];for(let a=0;a<t.length;a++){const u=t[a],l=[];for(let c=o[a]||0,d=0;c<r;d++){let f=u.child(d%u.childCount);c+f.attrs.colspan>r&&(f=f.type.createChecked(Un(f.attrs,f.attrs.colspan,c+f.attrs.colspan-r),f.content)),l.push(f),c+=f.attrs.colspan;for(let h=1;h<f.attrs.rowspan;h++)o[a+h]=(o[a+h]||0)+f.attrs.colspan}s.push(_.from(l))}t=s,n=r}if(e!=i){const o=[];for(let s=0,a=0;s<i;s++,a++){const u=[],l=t[a%e];for(let c=0;c<l.childCount;c++){let d=l.child(c);s+d.attrs.rowspan>i&&(d=d.type.create({...d.attrs,rowspan:Math.max(1,i-d.attrs.rowspan)},d.content)),u.push(d)}o.push(_.from(u))}t=o,e=i}return{width:n,height:e,rows:t}}function Jw(n,e,t,r,i,o,s){const a=n.doc.type.schema,u=_e(a);let l,c;if(i>e.width)for(let d=0,f=0;d<e.height;d++){const h=t.child(d);f+=h.nodeSize;const p=[];let m;h.lastChild==null||h.lastChild.type==u.cell?m=l||(l=u.cell.createAndFill()):m=c||(c=u.header_cell.createAndFill());for(let g=e.width;g<i;g++)p.push(m);n.insert(n.mapping.slice(s).map(f-1+r),p)}if(o>e.height){const d=[];for(let p=0,m=(e.height-1)*e.width;p<Math.max(e.width,i);p++){const g=p>=e.width?!1:t.nodeAt(e.map[m+p]).type==u.header_cell;d.push(g?c||(c=u.header_cell.createAndFill()):l||(l=u.cell.createAndFill()))}const f=u.row.create(null,_.from(d)),h=[];for(let p=e.height;p<o;p++)h.push(f);n.insert(n.mapping.slice(s).map(r+t.nodeSize-2),h)}return!!(l||c)}function hf(n,e,t,r,i,o,s,a){if(s==0||s==e.height)return!1;let u=!1;for(let l=i;l<o;l++){const c=s*e.width+l,d=e.map[c];if(e.map[c-e.width]==d){u=!0;const f=t.nodeAt(d),{top:h,left:p}=e.findCell(d);n.setNodeMarkup(n.mapping.slice(a).map(d+r),null,{...f.attrs,rowspan:s-h}),n.insert(n.mapping.slice(a).map(e.positionAt(s,p,t)),f.type.createAndFill({...f.attrs,rowspan:h+f.attrs.rowspan-s})),l+=f.attrs.colspan-1}}return u}function pf(n,e,t,r,i,o,s,a){if(s==0||s==e.width)return!1;let u=!1;for(let l=i;l<o;l++){const c=l*e.width+s,d=e.map[c];if(e.map[c-1]==d){u=!0;const f=t.nodeAt(d),h=e.colCount(d),p=n.mapping.slice(a).map(d+r);n.setNodeMarkup(p,null,Un(f.attrs,s-h,f.attrs.colspan-(s-h))),n.insert(p+f.nodeSize,f.type.createAndFill(Un(f.attrs,0,s-h))),l+=f.attrs.rowspan-1}}return u}function mf(n,e,t,r,i){let o=t?n.doc.nodeAt(t-1):n.doc;if(!o)throw new Error("No table found");let s=le.get(o);const{top:a,left:u}=r,l=u+i.width,c=a+i.height,d=n.tr;let f=0;function h(){if(o=t?d.doc.nodeAt(t-1):d.doc,!o)throw new Error("No table found");s=le.get(o),f=d.mapping.maps.length}Jw(d,s,o,t,l,c,f)&&h(),hf(d,s,o,t,u,l,a,f)&&h(),hf(d,s,o,t,u,l,c,f)&&h(),pf(d,s,o,t,a,c,u,f)&&h(),pf(d,s,o,t,a,c,l,f)&&h();for(let p=a;p<c;p++){const m=s.positionAt(p,u,o),g=s.positionAt(p,l,o);d.replace(d.mapping.slice(f).map(m+t),d.mapping.slice(f).map(g+t),new O(i.rows[p-a],0,0))}h(),d.setSelection(new ie(d.doc.resolve(t+s.positionAt(a,u,o)),d.doc.resolve(t+s.positionAt(c-1,l-1,o)))),e(d)}var Yw=Al({ArrowLeft:io("horiz",-1),ArrowRight:io("horiz",1),ArrowUp:io("vert",-1),ArrowDown:io("vert",1),"Shift-ArrowLeft":oo("horiz",-1),"Shift-ArrowRight":oo("horiz",1),"Shift-ArrowUp":oo("vert",-1),"Shift-ArrowDown":oo("vert",1),Backspace:so,"Mod-Backspace":so,Delete:so,"Mod-Delete":so});function Co(n,e,t){return t.eq(n.selection)?!1:(e&&e(n.tr.setSelection(t).scrollIntoView()),!0)}function io(n,e){return(t,r,i)=>{if(!i)return!1;const o=t.selection;if(o instanceof ie)return Co(t,r,z.near(o.$headCell,e));if(n!="horiz"&&!o.empty)return!1;const s=Q0(i,n,e);if(s==null)return!1;if(n=="horiz")return Co(t,r,z.near(t.doc.resolve(o.head+e),e));{const a=t.doc.resolve(s),u=K0(a,n,e);let l;return u?l=z.near(u,1):e<0?l=z.near(t.doc.resolve(a.before(-1)),-1):l=z.near(t.doc.resolve(a.after(-1)),1),Co(t,r,l)}}}function oo(n,e){return(t,r,i)=>{if(!i)return!1;const o=t.selection;let s;if(o instanceof ie)s=o;else{const u=Q0(i,n,e);if(u==null)return!1;s=new ie(t.doc.resolve(u))}const a=K0(s.$headCell,n,e);return a?Co(t,r,new ie(s.$anchorCell,a)):!1}}function so(n,e){const t=n.selection;if(!(t instanceof ie))return!1;if(e){const r=n.tr,i=_e(n.schema).cell.createAndFill().content;t.forEachCell((o,s)=>{o.content.eq(i)||r.replace(r.mapping.map(s+1),r.mapping.map(s+o.nodeSize-1),new O(i,0,0))}),r.docChanged&&e(r)}return!0}function Xw(n,e){const t=n.state.doc,r=Dr(t.resolve(e));return r?(n.dispatch(n.state.tr.setSelection(new ie(r))),!0):!1}function Qw(n,e,t){if(!ut(n.state))return!1;let r=Zw(t);const i=n.state.selection;if(i instanceof ie){r||(r={width:1,height:1,rows:[_.from(Ju(_e(n.state.schema).cell,t))]});const o=i.$anchorCell.node(-1),s=i.$anchorCell.start(-1),a=le.get(o).rectBetween(i.$anchorCell.pos-s,i.$headCell.pos-s);return r=Gw(r,a.right-a.left,a.bottom-a.top),mf(n.state,n.dispatch,s,a,r),!0}else if(r){const o=Js(n.state),s=o.start(-1);return mf(n.state,n.dispatch,s,le.get(o.node(-1)).findCell(o.pos-s),r),!0}else return!1}function e4(n,e){var t;if(e.ctrlKey||e.metaKey)return;const r=gf(n,e.target);let i;if(e.shiftKey&&n.state.selection instanceof ie)o(n.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(i=Dr(n.state.selection.$anchor))!=null&&((t=Wa(n,e))==null?void 0:t.pos)!=i.pos)o(i,e),e.preventDefault();else if(!r)return;function o(u,l){let c=Wa(n,l);const d=rn.getState(n.state)==null;if(!c||!Zl(u,c))if(d)c=u;else return;const f=new ie(u,c);if(d||!n.state.selection.eq(f)){const h=n.state.tr.setSelection(f);d&&h.setMeta(rn,u.pos),n.dispatch(h)}}function s(){n.root.removeEventListener("mouseup",s),n.root.removeEventListener("dragstart",s),n.root.removeEventListener("mousemove",a),rn.getState(n.state)!=null&&n.dispatch(n.state.tr.setMeta(rn,-1))}function a(u){const l=u,c=rn.getState(n.state);let d;if(c!=null)d=n.state.doc.resolve(c);else if(gf(n,l.target)!=r&&(d=Wa(n,e),!d))return s();d&&o(d,l)}n.root.addEventListener("mouseup",s),n.root.addEventListener("dragstart",s),n.root.addEventListener("mousemove",a)}function Q0(n,e,t){if(!(n.state.selection instanceof B))return null;const{$head:r}=n.state.selection;for(let i=r.depth-1;i>=0;i--){const o=r.node(i);if((t<0?r.index(i):r.indexAfter(i))!=(t<0?0:o.childCount))return null;if(o.type.spec.tableRole=="cell"||o.type.spec.tableRole=="header_cell"){const a=r.before(i),u=e=="vert"?t>0?"down":"up":t>0?"right":"left";return n.endOfTextblock(u)?a:null}}return null}function gf(n,e){for(;e&&e!=n.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function Wa(n,e){const t=n.posAtCoords({left:e.clientX,top:e.clientY});return t&&t?Dr(n.state.doc.resolve(t.pos)):null}var t4=class{constructor(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Yu(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!=this.node.type?!1:(this.node=e,Yu(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return e.type=="attributes"&&(e.target==this.table||this.colgroup.contains(e.target))}};function Yu(n,e,t,r,i,o){var s;let a=0,u=!0,l=e.firstChild;const c=n.firstChild;if(c){for(let d=0,f=0;d<c.childCount;d++){const{colspan:h,colwidth:p}=c.child(d).attrs;for(let m=0;m<h;m++,f++){const g=i==f?o:p&&p[m],y=g?g+"px":"";a+=g||r,g||(u=!1),l?(l.style.width!=y&&(l.style.width=y),l=l.nextSibling):e.appendChild(document.createElement("col")).style.width=y}}for(;l;){const d=l.nextSibling;(s=l.parentNode)==null||s.removeChild(l),l=d}u?(t.style.width=a+"px",t.style.minWidth=""):(t.style.width="",t.style.minWidth=a+"px")}}var Ge=new ae("tableColumnResizing");function n4({handleWidth:n=5,cellMinWidth:e=25,View:t=t4,lastColumnResizable:r=!0}={}){const i=new oe({key:Ge,state:{init(o,s){return i.spec.props.nodeViews[_e(s.schema).table.name]=(a,u)=>new t(a,e,u),new r4(-1,!1)},apply(o,s){return s.apply(o)}},props:{attributes:o=>{const s=Ge.getState(o);return s&&s.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(o,s)=>{i4(o,s,n,e,r)},mouseleave:o=>{o4(o)},mousedown:(o,s)=>{s4(o,s,e)}},decorations:o=>{const s=Ge.getState(o);if(s&&s.activeHandle>-1)return f4(o,s.activeHandle)},nodeViews:{}}});return i}var r4=class So{constructor(e,t){this.activeHandle=e,this.dragging=t}apply(e){const t=this,r=e.getMeta(Ge);if(r&&r.setHandle!=null)return new So(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new So(t.activeHandle,r.setDragging);if(t.activeHandle>-1&&e.docChanged){let i=e.mapping.map(t.activeHandle,-1);return Gu(e.doc.resolve(i))||(i=-1),new So(i,t.dragging)}return t}};function i4(n,e,t,r,i){const o=Ge.getState(n.state);if(o&&!o.dragging){const s=u4(e.target);let a=-1;if(s){const{left:u,right:l}=s.getBoundingClientRect();e.clientX-u<=t?a=bf(n,e,"left",t):l-e.clientX<=t&&(a=bf(n,e,"right",t))}if(a!=o.activeHandle){if(!i&&a!==-1){const u=n.state.doc.resolve(a),l=u.node(-1),c=le.get(l),d=u.start(-1);if(c.colCount(u.pos-d)+u.nodeAfter.attrs.colspan-1==c.width-1)return}e1(n,a)}}}function o4(n){const e=Ge.getState(n.state);e&&e.activeHandle>-1&&!e.dragging&&e1(n,-1)}function s4(n,e,t){const r=Ge.getState(n.state);if(!r||r.activeHandle==-1||r.dragging)return!1;const i=n.state.doc.nodeAt(r.activeHandle),o=a4(n,r.activeHandle,i.attrs);n.dispatch(n.state.tr.setMeta(Ge,{setDragging:{startX:e.clientX,startWidth:o}}));function s(u){window.removeEventListener("mouseup",s),window.removeEventListener("mousemove",a);const l=Ge.getState(n.state);l!=null&&l.dragging&&(l4(n,l.activeHandle,yf(l.dragging,u,t)),n.dispatch(n.state.tr.setMeta(Ge,{setDragging:null})))}function a(u){if(!u.which)return s(u);const l=Ge.getState(n.state);if(l&&l.dragging){const c=yf(l.dragging,u,t);c4(n,l.activeHandle,c,t)}}return window.addEventListener("mouseup",s),window.addEventListener("mousemove",a),e.preventDefault(),!0}function a4(n,e,{colspan:t,colwidth:r}){const i=r&&r[r.length-1];if(i)return i;const o=n.domAtPos(e);let a=o.node.childNodes[o.offset].offsetWidth,u=t;if(r)for(let l=0;l<t;l++)r[l]&&(a-=r[l],u--);return a/u}function u4(n){for(;n&&n.nodeName!="TD"&&n.nodeName!="TH";)n=n.classList&&n.classList.contains("ProseMirror")?null:n.parentNode;return n}function bf(n,e,t,r){const i=t=="right"?-r:r,o=n.posAtCoords({left:e.clientX+i,top:e.clientY});if(!o)return-1;const{pos:s}=o,a=Dr(n.state.doc.resolve(s));if(!a)return-1;if(t=="right")return a.pos;const u=le.get(a.node(-1)),l=a.start(-1),c=u.map.indexOf(a.pos-l);return c%u.width==0?-1:l+u.map[c-1]}function yf(n,e,t){const r=e.clientX-n.startX;return Math.max(t,n.startWidth+r)}function e1(n,e){n.dispatch(n.state.tr.setMeta(Ge,{setHandle:e}))}function l4(n,e,t){const r=n.state.doc.resolve(e),i=r.node(-1),o=le.get(i),s=r.start(-1),a=o.colCount(r.pos-s)+r.nodeAfter.attrs.colspan-1,u=n.state.tr;for(let l=0;l<o.height;l++){const c=l*o.width+a;if(l&&o.map[c]==o.map[c-o.width])continue;const d=o.map[c],f=i.nodeAt(d).attrs,h=f.colspan==1?0:a-o.colCount(d);if(f.colwidth&&f.colwidth[h]==t)continue;const p=f.colwidth?f.colwidth.slice():d4(f.colspan);p[h]=t,u.setNodeMarkup(s+d,null,{...f,colwidth:p})}u.docChanged&&n.dispatch(u)}function c4(n,e,t,r){const i=n.state.doc.resolve(e),o=i.node(-1),s=i.start(-1),a=le.get(o).colCount(i.pos-s)+i.nodeAfter.attrs.colspan-1;let u=n.domAtPos(i.start(-1)).node;for(;u&&u.nodeName!="TABLE";)u=u.parentNode;u&&Yu(o,u.firstChild,u,r,a,t)}function d4(n){return Array(n).fill(0)}function f4(n,e){const t=[],r=n.doc.resolve(e),i=r.node(-1);if(!i)return ne.empty;const o=le.get(i),s=r.start(-1),a=o.colCount(r.pos-s)+r.nodeAfter.attrs.colspan;for(let u=0;u<o.height;u++){const l=a+u*o.width-1;if((a==o.width||o.map[l]!=o.map[l+1])&&(u==0||o.map[l]!=o.map[l-o.width])){const c=o.map[l],d=s+c+i.nodeAt(c).nodeSize-1,f=document.createElement("div");f.className="column-resize-handle",t.push(pe.widget(d,f))}}return ne.create(n.doc,t)}function Dt(n){const e=n.selection,t=Js(n),r=t.node(-1),i=t.start(-1),o=le.get(r);return{...e instanceof ie?o.rectBetween(e.$anchorCell.pos-i,e.$headCell.pos-i):o.findCell(t.pos-i),tableStart:i,map:o,table:r}}function t1(n,{map:e,tableStart:t,table:r},i){let o=i>0?-1:0;Bw(e,r,i+o)&&(o=i==0||i==e.width?null:0);for(let s=0;s<e.height;s++){const a=s*e.width+i;if(i>0&&i<e.width&&e.map[a-1]==e.map[a]){const u=e.map[a],l=r.nodeAt(u);n.setNodeMarkup(n.mapping.map(t+u),null,G0(l.attrs,i-e.colCount(u))),s+=l.attrs.rowspan-1}else{const u=o==null?_e(r.type.schema).cell:r.nodeAt(e.map[a+o]).type,l=e.positionAt(s,i,r);n.insert(n.mapping.map(t+l),u.createAndFill())}}return n}function h4(n,e){if(!ut(n))return!1;if(e){const t=Dt(n);e(t1(n.tr,t,t.left))}return!0}function p4(n,e){if(!ut(n))return!1;if(e){const t=Dt(n);e(t1(n.tr,t,t.right))}return!0}function m4(n,{map:e,table:t,tableStart:r},i){const o=n.mapping.maps.length;for(let s=0;s<e.height;){const a=s*e.width+i,u=e.map[a],l=t.nodeAt(u),c=l.attrs;if(i>0&&e.map[a-1]==u||i<e.width-1&&e.map[a+1]==u)n.setNodeMarkup(n.mapping.slice(o).map(r+u),null,Un(c,i-e.colCount(u)));else{const d=n.mapping.slice(o).map(r+u);n.delete(d,d+l.nodeSize)}s+=c.rowspan}}function g4(n,e){if(!ut(n))return!1;if(e){const t=Dt(n),r=n.tr;if(t.left==0&&t.right==t.map.width)return!1;for(let i=t.right-1;m4(r,t,i),i!=t.left;i--){const o=t.tableStart?r.doc.nodeAt(t.tableStart-1):r.doc;if(!o)throw RangeError("No table found");t.table=o,t.map=le.get(o)}e(r)}return!0}function b4(n,e,t){var r;const i=_e(e.type.schema).header_cell;for(let o=0;o<n.width;o++)if(((r=e.nodeAt(n.map[o+t*n.width]))==null?void 0:r.type)!=i)return!1;return!0}function n1(n,{map:e,tableStart:t,table:r},i){var o;let s=t;for(let l=0;l<i;l++)s+=r.child(l).nodeSize;const a=[];let u=i>0?-1:0;b4(e,r,i+u)&&(u=i==0||i==e.height?null:0);for(let l=0,c=e.width*i;l<e.width;l++,c++)if(i>0&&i<e.height&&e.map[c]==e.map[c-e.width]){const d=e.map[c],f=r.nodeAt(d).attrs;n.setNodeMarkup(t+d,null,{...f,rowspan:f.rowspan+1}),l+=f.colspan-1}else{const d=u==null?_e(r.type.schema).cell:(o=r.nodeAt(e.map[c+u*e.width]))==null?void 0:o.type,f=d==null?void 0:d.createAndFill();f&&a.push(f)}return n.insert(s,_e(r.type.schema).row.create(null,a)),n}function y4(n,e){if(!ut(n))return!1;if(e){const t=Dt(n);e(n1(n.tr,t,t.top))}return!0}function x4(n,e){if(!ut(n))return!1;if(e){const t=Dt(n);e(n1(n.tr,t,t.bottom))}return!0}function v4(n,{map:e,table:t,tableStart:r},i){let o=0;for(let l=0;l<i;l++)o+=t.child(l).nodeSize;const s=o+t.child(i).nodeSize,a=n.mapping.maps.length;n.delete(o+r,s+r);const u=new Set;for(let l=0,c=i*e.width;l<e.width;l++,c++){const d=e.map[c];if(!u.has(d)){if(u.add(d),i>0&&d==e.map[c-e.width]){const f=t.nodeAt(d).attrs;n.setNodeMarkup(n.mapping.slice(a).map(d+r),null,{...f,rowspan:f.rowspan-1}),l+=f.colspan-1}else if(i<e.height&&d==e.map[c+e.width]){const f=t.nodeAt(d),h=f.attrs,p=f.type.create({...h,rowspan:f.attrs.rowspan-1},f.content),m=e.positionAt(i+1,l,t);n.insert(n.mapping.slice(a).map(r+m),p),l+=h.colspan-1}}}}function k4(n,e){if(!ut(n))return!1;if(e){const t=Dt(n),r=n.tr;if(t.top==0&&t.bottom==t.map.height)return!1;for(let i=t.bottom-1;v4(r,t,i),i!=t.top;i--){const o=t.tableStart?r.doc.nodeAt(t.tableStart-1):r.doc;if(!o)throw RangeError("No table found");t.table=o,t.map=le.get(t.table)}e(r)}return!0}function xf(n){const e=n.content;return e.childCount==1&&e.child(0).isTextblock&&e.child(0).childCount==0}function w4({width:n,height:e,map:t},r){let i=r.top*n+r.left,o=i,s=(r.bottom-1)*n+r.left,a=i+(r.right-r.left-1);for(let u=r.top;u<r.bottom;u++){if(r.left>0&&t[o]==t[o-1]||r.right<n&&t[a]==t[a+1])return!0;o+=n,a+=n}for(let u=r.left;u<r.right;u++){if(r.top>0&&t[i]==t[i-n]||r.bottom<e&&t[s]==t[s+n])return!0;i++,s++}return!1}function vf(n,e){const t=n.selection;if(!(t instanceof ie)||t.$anchorCell.pos==t.$headCell.pos)return!1;const r=Dt(n),{map:i}=r;if(w4(i,r))return!1;if(e){const o=n.tr,s={};let a=_.empty,u,l;for(let c=r.top;c<r.bottom;c++)for(let d=r.left;d<r.right;d++){const f=i.map[c*i.width+d],h=r.table.nodeAt(f);if(!(s[f]||!h))if(s[f]=!0,u==null)u=f,l=h;else{xf(h)||(a=a.append(h.content));const p=o.mapping.map(f+r.tableStart);o.delete(p,p+h.nodeSize)}}if(u==null||l==null)return!0;if(o.setNodeMarkup(u+r.tableStart,null,{...G0(l.attrs,l.attrs.colspan,r.right-r.left-l.attrs.colspan),rowspan:r.bottom-r.top}),a.size){const c=u+1+l.content.size,d=xf(l)?u+1:c;o.replaceWith(d+r.tableStart,c+r.tableStart,a)}o.setSelection(new ie(o.doc.resolve(u+r.tableStart))),e(o)}return!0}function kf(n,e){const t=_e(n.schema);return C4(({node:r})=>t[r.type.spec.tableRole])(n,e)}function C4(n){return(e,t)=>{var r;const i=e.selection;let o,s;if(i instanceof ie){if(i.$anchorCell.pos!=i.$headCell.pos)return!1;o=i.$anchorCell.nodeAfter,s=i.$anchorCell.pos}else{if(o=Iw(i.$from),!o)return!1;s=(r=Dr(i.$from))==null?void 0:r.pos}if(o==null||s==null||o.attrs.colspan==1&&o.attrs.rowspan==1)return!1;if(t){let a=o.attrs;const u=[],l=a.colwidth;a.rowspan>1&&(a={...a,rowspan:1}),a.colspan>1&&(a={...a,colspan:1});const c=Dt(e),d=e.tr;for(let h=0;h<c.right-c.left;h++)u.push(l?{...a,colwidth:l&&l[h]?[l[h]]:null}:a);let f;for(let h=c.top;h<c.bottom;h++){let p=c.map.positionAt(h,c.left,c.table);h==c.top&&(p+=o.nodeSize);for(let m=c.left,g=0;m<c.right;m++,g++)m==c.left&&h==c.top||d.insert(f=d.mapping.map(p+c.tableStart,1),n({node:o,row:h,col:m}).createAndFill(u[g]))}d.setNodeMarkup(s,n({node:o,row:c.top,col:c.left}),u[0]),i instanceof ie&&d.setSelection(new ie(d.doc.resolve(i.$anchorCell.pos),f?d.doc.resolve(f):void 0)),t(d)}return!0}}function S4(n,e){return function(t,r){if(!ut(t))return!1;const i=Js(t);if(i.nodeAfter.attrs[n]===e)return!1;if(r){const o=t.tr;t.selection instanceof ie?t.selection.forEachCell((s,a)=>{s.attrs[n]!==e&&o.setNodeMarkup(a,null,{...s.attrs,[n]:e})}):o.setNodeMarkup(i.pos,null,{...i.nodeAfter.attrs,[n]:e}),r(o)}return!0}}function E4(n){return function(e,t){if(!ut(e))return!1;if(t){const r=_e(e.schema),i=Dt(e),o=e.tr,s=i.map.cellsInRect(n=="column"?{left:i.left,top:0,right:i.right,bottom:i.map.height}:n=="row"?{left:0,top:i.top,right:i.map.width,bottom:i.bottom}:i),a=s.map(u=>i.table.nodeAt(u));for(let u=0;u<s.length;u++)a[u].type==r.header_cell&&o.setNodeMarkup(i.tableStart+s[u],r.cell,a[u].attrs);if(o.steps.length==0)for(let u=0;u<s.length;u++)o.setNodeMarkup(i.tableStart+s[u],r.header_cell,a[u].attrs);t(o)}return!0}}function wf(n,e,t){const r=e.map.cellsInRect({left:0,top:0,right:n=="row"?e.map.width:1,bottom:n=="column"?e.map.height:1});for(let i=0;i<r.length;i++){const o=e.table.nodeAt(r[i]);if(o&&o.type!==t.header_cell)return!1}return!0}function xi(n,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?E4(n):function(t,r){if(!ut(t))return!1;if(r){const i=_e(t.schema),o=Dt(t),s=t.tr,a=wf("row",o,i),u=wf("column",o,i),c=(n==="column"?a:n==="row"?u:!1)?1:0,d=n=="column"?{left:0,top:c,right:1,bottom:o.map.height}:n=="row"?{left:c,top:0,right:o.map.width,bottom:1}:o,f=n=="column"?u?i.cell:i.header_cell:n=="row"?a?i.cell:i.header_cell:i.cell;o.map.cellsInRect(d).forEach(h=>{const p=h+o.tableStart,m=s.doc.nodeAt(p);m&&s.setNodeMarkup(p,f,m.attrs)}),r(s)}return!0}}xi("row",{useDeprecatedLogic:!0});xi("column",{useDeprecatedLogic:!0});var A4=xi("cell",{useDeprecatedLogic:!0});function _4(n,e){if(e<0){const t=n.nodeBefore;if(t)return n.pos-t.nodeSize;for(let r=n.index(-1)-1,i=n.before();r>=0;r--){const o=n.node(-1).child(r),s=o.lastChild;if(s)return i-1-s.nodeSize;i-=o.nodeSize}}else{if(n.index()<n.parent.childCount-1)return n.pos+n.nodeAfter.nodeSize;const t=n.node(-1);for(let r=n.indexAfter(-1),i=n.after();r<t.childCount;r++){const o=t.child(r);if(o.childCount)return i+1;i+=o.nodeSize}}return null}function Cf(n){return function(e,t){if(!ut(e))return!1;const r=_4(Js(e),n);if(r==null)return!1;if(t){const i=e.doc.resolve(r);t(e.tr.setSelection(B.between(i,Pw(i))).scrollIntoView())}return!0}}function M4(n,e){const t=n.selection.$anchor;for(let r=t.depth;r>0;r--)if(t.node(r).type.spec.tableRole=="table")return e&&e(n.tr.delete(t.before(r),t.after(r)).scrollIntoView()),!0;return!1}function T4({allowTableNodeSelection:n=!1}={}){return new oe({key:rn,state:{init(){return null},apply(e,t){const r=e.getMeta(rn);if(r!=null)return r==-1?null:r;if(t==null||!e.docChanged)return t;const{deleted:i,pos:o}=e.mapping.mapResult(t);return i?null:o}},props:{decorations:zw,handleDOMEvents:{mousedown:e4},createSelectionBetween(e){return rn.getState(e.state)!=null?e.state.selection:null},handleTripleClick:Xw,handleKeyDown:Yw,handlePaste:Qw},appendTransaction(e,t,r){return jw(r,X0(r,t),n)}})}function Sf(n,e,t,r,i,o){let s=0,a=!0,u=e.firstChild;const l=n.firstChild;for(let c=0,d=0;c<l.childCount;c+=1){const{colspan:f,colwidth:h}=l.child(c).attrs;for(let p=0;p<f;p+=1,d+=1){const m=i===d?o:h&&h[p],g=m?`${m}px`:"";s+=m||r,m||(a=!1),u?(u.style.width!==g&&(u.style.width=g),u=u.nextSibling):e.appendChild(document.createElement("col")).style.width=g}}for(;u;){const c=u.nextSibling;u.parentNode.removeChild(u),u=c}a?(t.style.width=`${s}px`,t.style.minWidth=""):(t.style.width="",t.style.minWidth=`${s}px`)}class D4{constructor(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Sf(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!==this.node.type?!1:(this.node=e,Sf(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return e.type==="attributes"&&(e.target===this.table||this.colgroup.contains(e.target))}}function Ef(n,e){return e?n.createChecked(null,e):n.createAndFill()}function L4(n){if(n.cached.tableNodeTypes)return n.cached.tableNodeTypes;const e={};return Object.keys(n.nodes).forEach(t=>{const r=n.nodes[t];r.spec.tableRole&&(e[r.spec.tableRole]=r)}),n.cached.tableNodeTypes=e,e}function O4(n,e,t,r,i){const o=L4(n),s=[],a=[];for(let l=0;l<t;l+=1){const c=Ef(o.cell,i);if(c&&a.push(c),r){const d=Ef(o.header_cell,i);d&&s.push(d)}}const u=[];for(let l=0;l<e;l+=1)u.push(o.row.createChecked(null,r&&l===0?s:a));return o.table.createChecked(null,u)}function R4(n){return n instanceof ie}const ao=({editor:n})=>{const{selection:e}=n.state;if(!R4(e))return!1;let t=0;const r=l0(e.ranges[0].$from,o=>o.type.name==="table");return r==null||r.node.descendants(o=>{if(o.type.name==="table")return!1;["tableCell","tableHeader"].includes(o.type.name)&&(t+=1)}),t===e.ranges.length?(n.commands.deleteTable(),!0):!1},N4=K.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:D4,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({HTMLAttributes:n}){return["table",J(this.options.HTMLAttributes,n),["tbody",0]]},addCommands(){return{insertTable:({rows:n=3,cols:e=3,withHeaderRow:t=!0}={})=>({tr:r,dispatch:i,editor:o})=>{const s=O4(o.schema,n,e,t);if(i){const a=r.selection.anchor+1;r.replaceSelectionWith(s).scrollIntoView().setSelection(B.near(r.doc.resolve(a)))}return!0},addColumnBefore:()=>({state:n,dispatch:e})=>h4(n,e),addColumnAfter:()=>({state:n,dispatch:e})=>p4(n,e),deleteColumn:()=>({state:n,dispatch:e})=>g4(n,e),addRowBefore:()=>({state:n,dispatch:e})=>y4(n,e),addRowAfter:()=>({state:n,dispatch:e})=>x4(n,e),deleteRow:()=>({state:n,dispatch:e})=>k4(n,e),deleteTable:()=>({state:n,dispatch:e})=>M4(n,e),mergeCells:()=>({state:n,dispatch:e})=>vf(n,e),splitCell:()=>({state:n,dispatch:e})=>kf(n,e),toggleHeaderColumn:()=>({state:n,dispatch:e})=>xi("column")(n,e),toggleHeaderRow:()=>({state:n,dispatch:e})=>xi("row")(n,e),toggleHeaderCell:()=>({state:n,dispatch:e})=>A4(n,e),mergeOrSplit:()=>({state:n,dispatch:e})=>vf(n,e)?!0:kf(n,e),setCellAttribute:(n,e)=>({state:t,dispatch:r})=>S4(n,e)(t,r),goToNextCell:()=>({state:n,dispatch:e})=>Cf(1)(n,e),goToPreviousCell:()=>({state:n,dispatch:e})=>Cf(-1)(n,e),fixTables:()=>({state:n,dispatch:e})=>(e&&X0(n),!0),setCellSelection:n=>({tr:e,dispatch:t})=>{if(t){const r=ie.create(e.doc,n.anchorCell,n.headCell);e.setSelection(r)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:ao,"Mod-Backspace":ao,Delete:ao,"Mod-Delete":ao}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[n4({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],T4({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(n){const e={name:n.name,options:n.options,storage:n.storage};return{tableRole:W(H(n,"tableRole",e))}}}),H4=K.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:n}){return["tr",J(this.options.HTMLAttributes,n),0]}}),I4=K.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:n=>{const e=n.getAttribute("colwidth");return e?[parseInt(e,10)]:null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:n}){return["th",J(this.options.HTMLAttributes,n),0]}}),F4=K.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:n=>{const e=n.getAttribute("colwidth");return e?[parseInt(e,10)]:null}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:n}){return["td",J(this.options.HTMLAttributes,n),0]}}),P4=re.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize"}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=n=>{const e=(n==null?void 0:n.node)||this.editor.state.doc;return((n==null?void 0:n.mode)||this.options.mode)==="textSize"?e.textBetween(0,e.content.size,void 0," ").length:e.nodeSize},this.storage.words=n=>{const e=(n==null?void 0:n.node)||this.editor.state.doc;return e.textBetween(0,e.content.size," "," ").split(" ").filter(i=>i!=="").length}},addProseMirrorPlugins(){return[new oe({key:new ae("characterCount"),filterTransaction:(n,e)=>{const t=this.options.limit;if(!n.docChanged||t===0||t===null||t===void 0)return!0;const r=this.storage.characters({node:e.doc}),i=this.storage.characters({node:n.doc});if(i<=t||r>t&&i>t&&i<=r)return!0;if(r>t&&i>t&&i>r||!n.getMeta("paste"))return!1;const s=n.selection.$head.pos,a=i-t,u=s-a,l=s;return n.deleteRange(u,l),!(this.storage.characters({node:n.doc})>t)}})]}}),B4="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4vianca6w0s2x0a2z0ure5ba0by2idu3namex3narepublic11d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2ntley5rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0cast4mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dabur3d1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0ardian6cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6logistics9properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3ncaster6d0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2psy3ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2tura4vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9dnavy5lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0america6xi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0a1b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp2w2ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4finity6ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",$4="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",Ar=(n,e)=>{for(const t in e)n[t]=e[t];return n},Xu="numeric",Qu="ascii",el="alpha",Eo="asciinumeric",uo="alphanumeric",tl="domain",r1="emoji",z4="scheme",V4="slashscheme",Af="whitespace";function q4(n,e){return n in e||(e[n]=[]),e[n]}function Ln(n,e,t){e[Xu]&&(e[Eo]=!0,e[uo]=!0),e[Qu]&&(e[Eo]=!0,e[el]=!0),e[Eo]&&(e[uo]=!0),e[el]&&(e[uo]=!0),e[uo]&&(e[tl]=!0),e[r1]&&(e[tl]=!0);for(const r in e){const i=q4(r,t);i.indexOf(n)<0&&i.push(n)}}function j4(n,e){const t={};for(const r in e)e[r].indexOf(n)>=0&&(t[r]=!0);return t}function He(n){n===void 0&&(n=null),this.j={},this.jr=[],this.jd=null,this.t=n}He.groups={};He.prototype={accepts(){return!!this.t},go(n){const e=this,t=e.j[n];if(t)return t;for(let r=0;r<e.jr.length;r++){const i=e.jr[r][0],o=e.jr[r][1];if(o&&i.test(n))return o}return e.jd},has(n,e){return e===void 0&&(e=!1),e?n in this.j:!!this.go(n)},ta(n,e,t,r){for(let i=0;i<n.length;i++)this.tt(n[i],e,t,r)},tr(n,e,t,r){r=r||He.groups;let i;return e&&e.j?i=e:(i=new He(e),t&&r&&Ln(e,t,r)),this.jr.push([n,i]),i},ts(n,e,t,r){let i=this;const o=n.length;if(!o)return i;for(let s=0;s<o-1;s++)i=i.tt(n[s]);return i.tt(n[o-1],e,t,r)},tt(n,e,t,r){r=r||He.groups;const i=this;if(e&&e.j)return i.j[n]=e,e;const o=e;let s,a=i.go(n);if(a?(s=new He,Ar(s.j,a.j),s.jr.push.apply(s.jr,a.jr),s.jd=a.jd,s.t=a.t):s=new He,o){if(r)if(s.t&&typeof s.t=="string"){const u=Ar(j4(s.t,r),t);Ln(o,u,r)}else t&&Ln(o,t,r);s.t=o}return i.j[n]=s,s}};const Z=(n,e,t,r,i)=>n.ta(e,t,r,i),We=(n,e,t,r,i)=>n.tr(e,t,r,i),_f=(n,e,t,r,i)=>n.ts(e,t,r,i),L=(n,e,t,r,i)=>n.tt(e,t,r,i),zt="WORD",nl="UWORD",vi="LOCALHOST",rl="TLD",il="UTLD",Ao="SCHEME",lr="SLASH_SCHEME",Kl="NUM",i1="WS",Gl="NL",ri="OPENBRACE",ii="CLOSEBRACE",Go="OPENBRACKET",Jo="CLOSEBRACKET",Yo="OPENPAREN",Xo="CLOSEPAREN",Qo="OPENANGLEBRACKET",es="CLOSEANGLEBRACKET",ts="FULLWIDTHLEFTPAREN",ns="FULLWIDTHRIGHTPAREN",rs="LEFTCORNERBRACKET",is="RIGHTCORNERBRACKET",ss="LEFTWHITECORNERBRACKET",as="RIGHTWHITECORNERBRACKET",us="FULLWIDTHLESSTHAN",ls="FULLWIDTHGREATERTHAN",cs="AMPERSAND",ds="APOSTROPHE",fs="ASTERISK",Qt="AT",hs="BACKSLASH",ps="BACKTICK",ms="CARET",on="COLON",Jl="COMMA",gs="DOLLAR",pt="DOT",bs="EQUALS",Yl="EXCLAMATION",mt="HYPHEN",ys="PERCENT",xs="PIPE",vs="PLUS",ks="POUND",ws="QUERY",Xl="QUOTE",Ql="SEMI",gt="SLASH",oi="TILDE",Cs="UNDERSCORE",o1="EMOJI",Ss="SYM";var s1=Object.freeze({__proto__:null,WORD:zt,UWORD:nl,LOCALHOST:vi,TLD:rl,UTLD:il,SCHEME:Ao,SLASH_SCHEME:lr,NUM:Kl,WS:i1,NL:Gl,OPENBRACE:ri,CLOSEBRACE:ii,OPENBRACKET:Go,CLOSEBRACKET:Jo,OPENPAREN:Yo,CLOSEPAREN:Xo,OPENANGLEBRACKET:Qo,CLOSEANGLEBRACKET:es,FULLWIDTHLEFTPAREN:ts,FULLWIDTHRIGHTPAREN:ns,LEFTCORNERBRACKET:rs,RIGHTCORNERBRACKET:is,LEFTWHITECORNERBRACKET:ss,RIGHTWHITECORNERBRACKET:as,FULLWIDTHLESSTHAN:us,FULLWIDTHGREATERTHAN:ls,AMPERSAND:cs,APOSTROPHE:ds,ASTERISK:fs,AT:Qt,BACKSLASH:hs,BACKTICK:ps,CARET:ms,COLON:on,COMMA:Jl,DOLLAR:gs,DOT:pt,EQUALS:bs,EXCLAMATION:Yl,HYPHEN:mt,PERCENT:ys,PIPE:xs,PLUS:vs,POUND:ks,QUERY:ws,QUOTE:Xl,SEMI:Ql,SLASH:gt,TILDE:oi,UNDERSCORE:Cs,EMOJI:o1,SYM:Ss});const rr=/[a-z]/,Za=/\p{L}/u,Ka=/\p{Emoji}/u,Ga=/\d/,Mf=/\s/,Tf=`
`,U4="",W4="";let lo=null,co=null;function Z4(n){n===void 0&&(n=[]);const e={};He.groups=e;const t=new He;lo==null&&(lo=Df(B4)),co==null&&(co=Df($4)),L(t,"'",ds),L(t,"{",ri),L(t,"}",ii),L(t,"[",Go),L(t,"]",Jo),L(t,"(",Yo),L(t,")",Xo),L(t,"<",Qo),L(t,">",es),L(t,"",ts),L(t,"",ns),L(t,"",rs),L(t,"",is),L(t,"",ss),L(t,"",as),L(t,"",us),L(t,"",ls),L(t,"&",cs),L(t,"*",fs),L(t,"@",Qt),L(t,"`",ps),L(t,"^",ms),L(t,":",on),L(t,",",Jl),L(t,"$",gs),L(t,".",pt),L(t,"=",bs),L(t,"!",Yl),L(t,"-",mt),L(t,"%",ys),L(t,"|",xs),L(t,"+",vs),L(t,"#",ks),L(t,"?",ws),L(t,'"',Xl),L(t,"/",gt),L(t,";",Ql),L(t,"~",oi),L(t,"_",Cs),L(t,"\\",hs);const r=We(t,Ga,Kl,{[Xu]:!0});We(r,Ga,r);const i=We(t,rr,zt,{[Qu]:!0});We(i,rr,i);const o=We(t,Za,nl,{[el]:!0});We(o,rr),We(o,Za,o);const s=We(t,Mf,i1,{[Af]:!0});L(t,Tf,Gl,{[Af]:!0}),L(s,Tf),We(s,Mf,s);const a=We(t,Ka,o1,{[r1]:!0});We(a,Ka,a),L(a,U4,a);const u=L(a,W4);We(u,Ka,a);const l=[[rr,i]],c=[[rr,null],[Za,o]];for(let d=0;d<lo.length;d++)Gt(t,lo[d],rl,zt,l);for(let d=0;d<co.length;d++)Gt(t,co[d],il,nl,c);Ln(rl,{tld:!0,ascii:!0},e),Ln(il,{utld:!0,alpha:!0},e),Gt(t,"file",Ao,zt,l),Gt(t,"mailto",Ao,zt,l),Gt(t,"http",lr,zt,l),Gt(t,"https",lr,zt,l),Gt(t,"ftp",lr,zt,l),Gt(t,"ftps",lr,zt,l),Ln(Ao,{scheme:!0,ascii:!0},e),Ln(lr,{slashscheme:!0,ascii:!0},e),n=n.sort((d,f)=>d[0]>f[0]?1:-1);for(let d=0;d<n.length;d++){const f=n[d][0],p=n[d][1]?{[z4]:!0}:{[V4]:!0};f.indexOf("-")>=0?p[tl]=!0:rr.test(f)?Ga.test(f)?p[Eo]=!0:p[Qu]=!0:p[Xu]=!0,_f(t,f,f,p)}return _f(t,"localhost",vi,{ascii:!0}),t.jd=new He(Ss),{start:t,tokens:Ar({groups:e},s1)}}function K4(n,e){const t=G4(e.replace(/[A-Z]/g,a=>a.toLowerCase())),r=t.length,i=[];let o=0,s=0;for(;s<r;){let a=n,u=null,l=0,c=null,d=-1,f=-1;for(;s<r&&(u=a.go(t[s]));)a=u,a.accepts()?(d=0,f=0,c=a):d>=0&&(d+=t[s].length,f++),l+=t[s].length,o+=t[s].length,s++;o-=d,s-=f,l-=d,i.push({t:c.t,v:e.slice(o-l,o),s:o-l,e:o})}return i}function G4(n){const e=[],t=n.length;let r=0;for(;r<t;){let i=n.charCodeAt(r),o,s=i<55296||i>56319||r+1===t||(o=n.charCodeAt(r+1))<56320||o>57343?n[r]:n.slice(r,r+2);e.push(s),r+=s.length}return e}function Gt(n,e,t,r,i){let o;const s=e.length;for(let a=0;a<s-1;a++){const u=e[a];n.j[u]?o=n.j[u]:(o=new He(r),o.jr=i.slice(),n.j[u]=o),n=o}return o=new He(t),o.jr=i.slice(),n.j[e[s-1]]=o,o}function Df(n){const e=[],t=[];let r=0,i="0123456789";for(;r<n.length;){let o=0;for(;i.indexOf(n[r+o])>=0;)o++;if(o>0){e.push(t.join(""));for(let s=parseInt(n.substring(r,r+o),10);s>0;s--)t.pop();r+=o}else t.push(n[r]),r++}return e}const ki={defaultProtocol:"http",events:null,format:Lf,formatHref:Lf,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function ec(n,e){e===void 0&&(e=null);let t=Ar({},ki);n&&(t=Ar(t,n instanceof ec?n.o:n));const r=t.ignoreTags,i=[];for(let o=0;o<r.length;o++)i.push(r[o].toUpperCase());this.o=t,e&&(this.defaultRender=e),this.ignoreTags=i}ec.prototype={o:ki,ignoreTags:[],defaultRender(n){return n},check(n){return this.get("validate",n.toString(),n)},get(n,e,t){const r=e!=null;let i=this.o[n];return i&&(typeof i=="object"?(i=t.t in i?i[t.t]:ki[n],typeof i=="function"&&r&&(i=i(e,t))):typeof i=="function"&&r&&(i=i(e,t.t,t)),i)},getObj(n,e,t){let r=this.o[n];return typeof r=="function"&&e!=null&&(r=r(e,t.t,t)),r},render(n){const e=n.render(this);return(this.get("render",null,n)||this.defaultRender)(e,n.t,n)}};function Lf(n){return n}function a1(n,e){this.t="token",this.v=n,this.tk=e}a1.prototype={isLink:!1,toString(){return this.v},toHref(n){return this.toString()},toFormattedString(n){const e=this.toString(),t=n.get("truncate",e,this),r=n.get("format",e,this);return t&&r.length>t?r.substring(0,t)+"":r},toFormattedHref(n){return n.get("formatHref",this.toHref(n.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(n){return n===void 0&&(n=ki.defaultProtocol),{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(n),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(n){return{type:this.t,value:this.toFormattedString(n),isLink:this.isLink,href:this.toFormattedHref(n),start:this.startIndex(),end:this.endIndex()}},validate(n){return n.get("validate",this.toString(),this)},render(n){const e=this,t=this.toHref(n.get("defaultProtocol")),r=n.get("formatHref",t,this),i=n.get("tagName",t,e),o=this.toFormattedString(n),s={},a=n.get("className",t,e),u=n.get("target",t,e),l=n.get("rel",t,e),c=n.getObj("attributes",t,e),d=n.getObj("events",t,e);return s.href=r,a&&(s.class=a),u&&(s.target=u),l&&(s.rel=l),c&&Ar(s,c),{tagName:i,attributes:s,content:o,eventListeners:d}}};function Ys(n,e){class t extends a1{constructor(i,o){super(i,o),this.t=n}}for(const r in e)t.prototype[r]=e[r];return t.t=n,t}const Of=Ys("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Rf=Ys("text"),J4=Ys("nl"),fo=Ys("url",{isLink:!0,toHref(n){return n===void 0&&(n=ki.defaultProtocol),this.hasProtocol()?this.v:`${n}://${this.v}`},hasProtocol(){const n=this.tk;return n.length>=2&&n[0].t!==vi&&n[1].t===on}}),Ze=n=>new He(n);function Y4(n){let{groups:e}=n;const t=e.domain.concat([cs,fs,Qt,hs,ps,ms,gs,bs,mt,Kl,ys,xs,vs,ks,gt,Ss,oi,Cs]),r=[ds,on,Jl,pt,Yl,ws,Xl,Ql,Qo,es,ri,ii,Jo,Go,Yo,Xo,ts,ns,rs,is,ss,as,us,ls],i=[cs,ds,fs,hs,ps,ms,gs,bs,mt,ri,ii,ys,xs,vs,ks,ws,gt,Ss,oi,Cs],o=Ze(),s=L(o,oi);Z(s,i,s),Z(s,e.domain,s);const a=Ze(),u=Ze(),l=Ze();Z(o,e.domain,a),Z(o,e.scheme,u),Z(o,e.slashscheme,l),Z(a,i,s),Z(a,e.domain,a);const c=L(a,Qt);L(s,Qt,c),L(u,Qt,c),L(l,Qt,c);const d=L(s,pt);Z(d,i,s),Z(d,e.domain,s);const f=Ze();Z(c,e.domain,f),Z(f,e.domain,f);const h=L(f,pt);Z(h,e.domain,f);const p=Ze(Of);Z(h,e.tld,p),Z(h,e.utld,p),L(c,vi,p);const m=L(f,mt);Z(m,e.domain,f),Z(p,e.domain,f),L(p,pt,h),L(p,mt,m);const g=L(p,on);Z(g,e.numeric,Of);const y=L(a,mt),x=L(a,pt);Z(y,e.domain,a),Z(x,i,s),Z(x,e.domain,a);const v=Ze(fo);Z(x,e.tld,v),Z(x,e.utld,v),Z(v,e.domain,a),Z(v,i,s),L(v,pt,x),L(v,mt,y),L(v,Qt,c);const b=L(v,on),w=Ze(fo);Z(b,e.numeric,w);const k=Ze(fo),C=Ze();Z(k,t,k),Z(k,r,C),Z(C,t,k),Z(C,r,C),L(v,gt,k),L(w,gt,k);const E=L(u,on),A=L(l,on),T=L(A,gt),I=L(T,gt);Z(u,e.domain,a),L(u,pt,x),L(u,mt,y),Z(l,e.domain,a),L(l,pt,x),L(l,mt,y),Z(E,e.domain,k),L(E,gt,k),Z(I,e.domain,k),Z(I,t,k),L(I,gt,k);const V=[[ri,ii],[Go,Jo],[Yo,Xo],[Qo,es],[ts,ns],[rs,is],[ss,as],[us,ls]];for(let U=0;U<V.length;U++){const[M,R]=V[U],D=L(k,M);L(C,M,D),L(D,R,k);const P=Ze(fo);Z(D,t,P);const G=Ze();Z(D,r),Z(P,t,P),Z(P,r,G),Z(G,t,P),Z(G,r,G),L(P,R,k),L(G,R,k)}return L(o,vi,v),L(o,Gl,J4),{start:o,tokens:s1}}function X4(n,e,t){let r=t.length,i=0,o=[],s=[];for(;i<r;){let a=n,u=null,l=null,c=0,d=null,f=-1;for(;i<r&&!(u=a.go(t[i].t));)s.push(t[i++]);for(;i<r&&(l=u||a.go(t[i].t));)u=null,a=l,a.accepts()?(f=0,d=a):f>=0&&f++,i++,c++;if(f<0)i-=c,i<r&&(s.push(t[i]),i++);else{s.length>0&&(o.push(Ja(Rf,e,s)),s=[]),i-=f,c-=f;const h=d.t,p=t.slice(i-c,i);o.push(Ja(h,e,p))}}return s.length>0&&o.push(Ja(Rf,e,s)),o}function Ja(n,e,t){const r=t[0].s,i=t[t.length-1].e,o=e.slice(r,i);return new n(o,t)}const Q4=typeof console<"u"&&console&&console.warn||(()=>{}),e6="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",ue={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function t6(){He.groups={},ue.scanner=null,ue.parser=null,ue.tokenQueue=[],ue.pluginQueue=[],ue.customSchemes=[],ue.initialized=!1}function Nf(n,e){if(e===void 0&&(e=!1),ue.initialized&&Q4(`linkifyjs: already initialized - will not register custom scheme "${n}" ${e6}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(n))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);ue.customSchemes.push([n,e])}function n6(){ue.scanner=Z4(ue.customSchemes);for(let n=0;n<ue.tokenQueue.length;n++)ue.tokenQueue[n][1]({scanner:ue.scanner});ue.parser=Y4(ue.scanner.tokens);for(let n=0;n<ue.pluginQueue.length;n++)ue.pluginQueue[n][1]({scanner:ue.scanner,parser:ue.parser});ue.initialized=!0}function r6(n){return ue.initialized||n6(),X4(ue.parser.start,n,K4(ue.scanner.start,n))}function tc(n,e,t){if(e===void 0&&(e=null),t===void 0&&(t=null),e&&typeof e=="object"){if(t)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);t=e,e=null}const r=new ec(t),i=r6(n),o=[];for(let s=0;s<i.length;s++){const a=i[s];a.isLink&&(!e||a.t===e)&&r.check(a)&&o.push(a.toFormattedObject(r))}return o}function i6(n){return new oe({key:new ae("autolink"),appendTransaction:(e,t,r)=>{const i=e.some(l=>l.docChanged)&&!t.doc.eq(r.doc),o=e.some(l=>l.getMeta("preventAutolink"));if(!i||o)return;const{tr:s}=r,a=vy(t.doc,[...e]);if(_y(a).forEach(({newRange:l})=>{const c=wy(r.doc,l,h=>h.isTextblock);let d,f;if(c.length>1?(d=c[0],f=r.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ")):c.length&&r.doc.textBetween(l.from,l.to," "," ").endsWith(" ")&&(d=c[0],f=r.doc.textBetween(d.pos,l.to,void 0," ")),d&&f){const h=f.split(" ").filter(g=>g!=="");if(h.length<=0)return!1;const p=h[h.length-1],m=d.pos+f.lastIndexOf(p);if(!p)return!1;tc(p).filter(g=>g.isLink).map(g=>({...g,from:m+g.start+1,to:m+g.end+1})).filter(g=>r.schema.marks.code?!r.doc.rangeHasMark(g.from,g.to,r.schema.marks.code):!0).filter(g=>n.validate?n.validate(g.value):!0).forEach(g=>{Nl(g.from,g.to,r.doc).some(y=>y.mark.type===n.type)||s.addMark(g.from,g.to,n.type.create({href:g.href}))})}}),!!s.steps.length)return s}})}function o6(n){return new oe({key:new ae("handleClickLink"),props:{handleClick:(e,t,r)=>{var i,o;if(r.button!==0||r.target.nodeName!=="A")return!1;const a=c0(e.state,n.type.name),u=r.target,l=(i=u==null?void 0:u.href)!==null&&i!==void 0?i:a.href,c=(o=u==null?void 0:u.target)!==null&&o!==void 0?o:a.target;return u&&l?(e.editable&&window.open(l,c),!0):!1}}})}function s6(n){return new oe({key:new ae("handlePasteLink"),props:{handlePaste:(e,t,r)=>{var i;const{state:o}=e,{selection:s}=o,{empty:a}=s;if(a)return!1;let u="";r.content.forEach(p=>{u+=p.textContent});const l=tc(u).find(p=>p.isLink&&p.value===u);if(!u||!l)return!1;const c=(i=t.clipboardData)===null||i===void 0?void 0:i.getData("text/html"),d=/href="([^"]*)"/,f=c==null?void 0:c.match(d),h=f?f[1]:l.href;return n.editor.commands.setMark(n.type,{href:h}),!0}}})}const a6=de.create({name:"link",priority:1e3,keepOnSplit:!1,onCreate(){this.options.protocols.forEach(n=>{if(typeof n=="string"){Nf(n);return}Nf(n.scheme,n.optionalSlashes)})},onDestroy(){t6()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:void 0}},addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:'a[href]:not([href *= "javascript:" i])'}]},renderHTML({HTMLAttributes:n}){var e;return!((e=n.href)===null||e===void 0)&&e.startsWith("javascript:")?["a",J(this.options.HTMLAttributes,{...n,href:""}),0]:["a",J(this.options.HTMLAttributes,n),0]},addCommands(){return{setLink:n=>({chain:e})=>e().setMark(this.name,n).setMeta("preventAutolink",!0).run(),toggleLink:n=>({chain:e})=>e().toggleMark(this.name,n,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:n})=>n().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[bn({find:n=>tc(n).filter(e=>this.options.validate?this.options.validate(e.value):!0).filter(e=>e.isLink).map(e=>({text:e.value,index:e.start,data:e})),type:this.type,getAttributes:(n,e)=>{var t,r;const i=(t=e==null?void 0:e.clipboardData)===null||t===void 0?void 0:t.getData("text/html"),o=/href="([^"]*)"/,s=i==null?void 0:i.match(o);return s?{href:s[1]}:{href:(r=n.data)===null||r===void 0?void 0:r.href}}})]},addProseMirrorPlugins(){const n=[];return this.options.autolink&&n.push(i6({type:this.type,validate:this.options.validate})),this.options.openOnClick&&n.push(o6({type:this.type})),this.options.linkOnPaste&&n.push(s6({editor:this.editor,type:this.type})),n}}),u6=de.create({name:"superscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sup"},{style:"vertical-align",getAttrs(n){return n!=="super"?!1:null}}]},renderHTML({HTMLAttributes:n}){return["sup",J(this.options.HTMLAttributes,n),0]},addCommands(){return{setSuperscript:()=>({commands:n})=>n.setMark(this.name),toggleSuperscript:()=>({commands:n})=>n.toggleMark(this.name),unsetSuperscript:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-.":()=>this.editor.commands.toggleSuperscript()}}}),l6=de.create({name:"subscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sub"},{style:"vertical-align",getAttrs(n){return n!=="sub"?!1:null}}]},renderHTML({HTMLAttributes:n}){return["sub",J(this.options.HTMLAttributes,n),0]},addCommands(){return{setSubscript:()=>({commands:n})=>n.setMark(this.name),toggleSubscript:()=>({commands:n})=>n.toggleMark(this.name),unsetSubscript:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-,":()=>this.editor.commands.toggleSubscript()}}}),c6=K.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:n}){return["ul",J(this.options.HTMLAttributes,n,{"data-type":this.name}),0]},addCommands(){return{toggleTaskList:()=>({commands:n})=>n.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),d6=/^\s*(\[([( |x])?\])\s$/,f6=K.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList"}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:n=>n.getAttribute("data-checked")==="true",renderHTML:n=>({"data-checked":n.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:n,HTMLAttributes:e}){return["li",J(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:n.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts(){const n={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...n,Tab:()=>this.editor.commands.sinkListItem(this.name)}:n},addNodeView(){return({node:n,HTMLAttributes:e,getPos:t,editor:r})=>{const i=document.createElement("li"),o=document.createElement("label"),s=document.createElement("span"),a=document.createElement("input"),u=document.createElement("div");return o.contentEditable="false",a.type="checkbox",a.addEventListener("change",l=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}const{checked:c}=l.target;r.isEditable&&typeof t=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:d})=>{const f=t(),h=d.doc.nodeAt(f);return d.setNodeMarkup(f,void 0,{...h==null?void 0:h.attrs,checked:c}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(n,c)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([l,c])=>{i.setAttribute(l,c)}),i.dataset.checked=n.attrs.checked,n.attrs.checked&&a.setAttribute("checked","checked"),o.append(a,s),i.append(o,u),Object.entries(e).forEach(([l,c])=>{i.setAttribute(l,c)}),{dom:i,contentDOM:u,update:l=>l.type!==this.type?!1:(i.dataset.checked=l.attrs.checked,l.attrs.checked?a.setAttribute("checked","checked"):a.removeAttribute("checked"),!0)}}},addInputRules(){return[qn({find:d6,type:this.type,getAttributes:n=>({checked:n[n.length-1]==="x"})})]}}),h6=/!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\)/,Hf=new ae("aie-video-plugin"),Ur="video_action",p6=K.create({name:"video",group:"block",addAttributes(){return{src:{default:null,parseHTML:n=>{const e=n.getAttribute("src");if(e)return e;const t=n.querySelector("source");return t?t.getAttribute("src"):null},renderHTML:n=>({src:n.src})},poster:{default:null,parseHTML:n=>n.getAttribute("poster"),renderHTML:n=>({poster:n.poster})},width:{default:350},controls:{default:!0}}},parseHTML(){return[{tag:"video",getAttrs:n=>({src:n.getAttribute("src"),poster:n.getAttribute("poster")})}]},renderHTML({HTMLAttributes:n}){return["video",{controls:"true",...n,src:null},["source",{src:n.src}]]},addCommands(){return{setVideo:n=>({commands:e})=>e.insertContent(`<video controls="true" style="width: 100%" src="${n}" />`),toggleVideo:()=>({commands:n})=>n.toggleNode(this.name,"paragraph"),uploadVideo:n=>()=>{const e=Ks(),{state:{tr:t},view:r,schema:i}=this.editor;return t.selection.empty||t.deleteSelection(),r.dispatch(t.setMeta(Ur,{type:"add",id:e,pos:t.selection.from})),this.options.uploaderEvent&&this.options.uploaderEvent.onUploadBefore&&this.options.uploaderEvent.onUploadBefore(n,this.options.uploadUrl,this.options.uploadHeaders),(this.options.uploader||Wl(this.options.uploadUrl))(n,this.options.uploadUrl,this.options.uploadHeaders,"video").then(s=>{if(this.options.uploaderEvent&&this.options.uploaderEvent.onSuccess){const a=this.options.uploaderEvent.onSuccess(n,s);if(typeof a=="boolean"&&!a)return;typeof a=="object"&&(s=a)}if(s.errorCode===0&&s.data&&s.data.src){let u=Hf.getState(this.editor.state).find(void 0,void 0,l=>l.id==e);r.dispatch(r.state.tr.insert(u[0].from,i.nodes.video.create({src:s.data.src,poster:s.data.poster})).setMeta(Ur,{type:"remove",id:e}))}else r.dispatch(t.setMeta(Ur,{type:"remove",id:e})),this.options.uploaderEvent&&this.options.uploaderEvent.onFailed&&this.options.uploaderEvent.onFailed(n,s)}).catch(s=>{const{state:{tr:a},view:u}=this.editor;u.dispatch(a.setMeta(Ur,{type:"remove",id:e})),this.options.uploaderEvent&&this.options.uploaderEvent.onError&&this.options.uploaderEvent.onError(n,s)}),!0}}},addNodeView(){return n=>{if(!this.editor.isEditable)return{};const e=document.createElement("div"),{src:t,width:r,align:i}=n.node.attrs;return e.classList.add(`align-${i}`),e.innerHTML=`
                  <div class="aie-resize-wrapper">
                      <div class="aie-resize">
                          <div class="aie-resize-btn-top-left" data-position="left" draggable="true"></div>
                          <div class="aie-resize-btn-top-right" data-position="right" draggable="true"></div>
                          <div class="aie-resize-btn-bottom-left" data-position="left" draggable="true"></div>
                          <div class="aie-resize-btn-bottom-right" data-position="right" draggable="true"></div>
                      </div>
                      <video controls="true" width="${r}" class="resize-obj">
                          <source src="${t}">
                      </video>
                  </div>
                `,Z0(e,n.editor.view.dom,o=>n.editor.commands.updateAttributes("video",o)),{dom:e}}},addInputRules(){return[Hl({find:h6,type:this.type,getAttributes:n=>{const[,,e]=n;return{src:e}}})]},addProseMirrorPlugins(){const n=this.editor;return[new oe({key:Hf,state:{init:()=>ne.empty,apply:(e,t)=>{const r=e.getMeta(Ur);return t=t.map(e.mapping,e.doc),r&&r.type==="add"?t=t.add(e.doc,[W0(r)]):r&&r.type==="remove"&&(t=t.remove(t.find(void 0,void 0,i=>i.id==r.id))),t}},props:{decorations(e){return this.getState(e)},handleDOMEvents:{drop(e,t){if(!(t.dataTransfer&&t.dataTransfer.files&&t.dataTransfer.files.length))return!1;const i=Array.from(t.dataTransfer.files).filter(l=>/video/i.test(l.type));if(i.length===0)return!1;t.preventDefault();const{state:{tr:o,doc:s},dispatch:a}=e,u=e.posAtCoords({left:t.clientX,top:t.clientY});return a(o.setSelection(B.create(s,u.pos)).scrollIntoView()),i.forEach(l=>{n.commands.uploadVideo(l)}),!0}}}})]}}),m6=K.create({name:"iframe",group:"block",atom:!0,addOptions(){return{allowFullscreen:!0,HTMLAttributes:{class:"iframe-wrapper"}}},addAttributes(){return{src:{default:null},width:{default:"100%"},frameborder:{default:0},allowfullscreen:{default:this.options.allowFullscreen,parseHTML:()=>this.options.allowFullscreen}}},parseHTML(){return[{tag:"iframe"}]},renderHTML({HTMLAttributes:n}){return["div",this.options.HTMLAttributes,["iframe",n]]},addCommands(){return{setIframe:n=>({tr:e,dispatch:t})=>{const{selection:r}=e,i=this.type.create(n);return t&&e.replaceRangeWith(r.from,r.to,i),!0}}}});class g6{constructor({editor:e,element:t,view:r,tippyOptions:i={},updateDelay:o=250,shouldShow:s}){this.preventHide=!1,this.shouldShow=({view:a,state:u,from:l,to:c})=>{const{doc:d,selection:f}=u,{empty:h}=f,p=!d.textBetween(l,c).length&&Tl(u.selection),m=this.element.contains(document.activeElement);return!(!(a.hasFocus()||m)||h||p||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:a})=>{var u;if(this.preventHide){this.preventHide=!1;return}a!=null&&a.relatedTarget&&(!((u=this.element.parentNode)===null||u===void 0)&&u.contains(a.relatedTarget))||this.hide()},this.tippyBlurHandler=a=>{this.blurHandler({event:a})},this.handleDebouncedUpdate=(a,u)=>{const l=!(u!=null&&u.selection.eq(a.state.selection)),c=!(u!=null&&u.doc.eq(a.state.doc));!l&&!c||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(a,l,c,u)},this.updateDelay))},this.updateHandler=(a,u,l,c)=>{var d,f,h;const{state:p,composing:m}=a,{selection:g}=p;if(m||!u&&!l)return;this.createTooltip();const{ranges:x}=g,v=Math.min(...x.map(k=>k.$from.pos)),b=Math.max(...x.map(k=>k.$to.pos));if(!((d=this.shouldShow)===null||d===void 0?void 0:d.call(this,{editor:this.editor,view:a,state:p,oldState:c,from:v,to:b}))){this.hide();return}(f=this.tippy)===null||f===void 0||f.setProps({getReferenceClientRect:((h=this.tippyOptions)===null||h===void 0?void 0:h.getReferenceClientRect)||(()=>{if(d0(p.selection)){let k=a.nodeDOM(v);const C=k.dataset.nodeViewWrapper?k:k.querySelector("[data-node-view-wrapper]");if(C&&(k=C.firstChild),k)return k.getBoundingClientRect()}return js(a,v,b)})}),this.show()},this.editor=e,this.element=t,this.view=r,this.updateDelay=o,s&&(this.shouldShow=s),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,t=!!e.parentElement;this.tippy||!t||(this.tippy=Ae(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,t){const{state:r}=e,i=r.selection.$from.pos!==r.selection.$to.pos;if(this.updateDelay>0&&i){this.handleDebouncedUpdate(e,t);return}const o=!(t!=null&&t.selection.eq(e.state.selection)),s=!(t!=null&&t.doc.eq(e.state.doc));this.updateHandler(e,o,s,t)}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e,t;!((e=this.tippy)===null||e===void 0)&&e.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(t=this.tippy)===null||t===void 0||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const u1=n=>new oe({key:typeof n.pluginKey=="string"?new ae(n.pluginKey):n.pluginKey,view:e=>new g6({view:e,...n})});re.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[u1({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});class Xs extends HTMLElement{constructor(){super();N(this,"editor");N(this,"items",[])}connectedCallback(){this.innerHTML=`
            <div class="aie-bubble-menu">
               ${this.items.map(t=>`<div class="aie-bubble-menu-item" id="${t.id}">${t.content}</div>`).join("")}
            </div>
        `,this.querySelector("div").addEventListener("click",t=>{this.items.forEach(r=>{t.target.closest(`#${r.id}`)&&this.onItemClick(r.id)})}),this.querySelectorAll(".aie-bubble-menu-item").forEach((t,r)=>{const i=this.items[r].title;i&&Ae(t,{appendTo:this.closest(".aie-container"),content:i,theme:"aietip",arrow:!0})})}onCreate(t,r){this.editor=t.editor}}class b6 extends Xs{constructor(){super(),this.items=[{id:"edit",title:j("edit-link"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.41421 15.89L16.5563 5.74786L15.1421 4.33365L5 14.4758V15.89H6.41421ZM7.24264 17.89H3V13.6474L14.435 2.21233C14.8256 1.8218 15.4587 1.8218 15.8492 2.21233L18.6777 5.04075C19.0682 5.43128 19.0682 6.06444 18.6777 6.45497L7.24264 17.89ZM3 19.89H21V21.89H3V19.89Z"></path></svg>'},{id:"unlink",title:j("unlink"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 17H22V19H19V22H17V17ZM7 7H2V5H5V2H7V7ZM18.364 15.5355L16.9497 14.1213L18.364 12.7071C20.3166 10.7545 20.3166 7.58866 18.364 5.63604C16.4113 3.68342 13.2455 3.68342 11.2929 5.63604L9.87868 7.05025L8.46447 5.63604L9.87868 4.22183C12.6123 1.48816 17.0445 1.48816 19.7782 4.22183C22.5118 6.9555 22.5118 11.3877 19.7782 14.1213L18.364 15.5355ZM15.5355 18.364L14.1213 19.7782C11.3877 22.5118 6.9555 22.5118 4.22183 19.7782C1.48816 17.0445 1.48816 12.6123 4.22183 9.87868L5.63604 8.46447L7.05025 9.87868L5.63604 11.2929C3.68342 13.2455 3.68342 16.4113 5.63604 18.364C7.58866 20.3166 10.7545 20.3166 12.7071 18.364L14.1213 16.9497L15.5355 18.364ZM14.8284 7.75736L16.2426 9.17157L9.17157 16.2426L7.75736 14.8284L14.8284 7.75736Z"></path></svg>'},{id:"visit",title:j("visit-link"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 6V8H5V19H16V14H18V20C18 20.5523 17.5523 21 17 21H4C3.44772 21 3 20.5523 3 20V7C3 6.44772 3.44772 6 4 6H10ZM21 3V11H19L18.9999 6.413L11.2071 14.2071L9.79289 12.7929L17.5849 5H13V3H21Z"></path></svg>'}]}connectedCallback(){super.connectedCallback();const e=new F0;e.setContent(`
            <div style="width: 250px">${j("link-address")} </div>
             <div style="width: 250px">
             <input type="text" id="href" style="width: 250px">
            </div>
            
            <div style="margin-top: 10px">${j("link-open-type")}</div>
            <div>
            <select id="target" style="width: 250px">
                <option value="">${j("default")}</option>
                <option value="_blank">${j("link-open-blank")}</option>
            </select>
            </div>
        `),e.onConfirmClick(t=>{var o,s;const r=t.popper.querySelector("#href").value;if(r.trim()===""){(o=this.editor)==null||o.chain().focus().extendMarkRange("link").unsetLink().run();return}let i=t.popper.querySelector("#target").value;i.trim()===""&&(i=null),(s=this.editor)==null||s.chain().focus().extendMarkRange("link").setLink({href:r,target:i,rel:null}).run()}),e.onShow(t=>{var i;const r=(i=this.editor)==null?void 0:i.getAttributes("link");r&&r.href&&(t.popper.querySelector("#href").value=r.href),r&&r.target&&(t.popper.querySelector("#target").value=r.target)}),e.setTrigger(this.querySelector("#edit"),"right")}onItemClick(e){var t,r;e==="unlink"?(t=this.editor)==null||t.chain().focus().unsetLink().run():e==="visit"&&window.open((r=this.editor)==null?void 0:r.getAttributes("link").href,"_blank")}onTransaction(e){}}class y6 extends Xs{constructor(){super(),this.items=[{id:"left",title:j("align-left"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 4H21V6H3V4ZM3 19H17V21H3V19ZM3 14H21V16H3V14ZM3 9H17V11H3V9Z"></path></svg>'},{id:"center",title:j("align-center"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 4H21V6H3V4ZM5 19H19V21H5V19ZM3 14H21V16H3V14ZM5 9H19V11H5V9Z"></path></svg>'},{id:"right",title:j("align-right"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 4H21V6H3V4ZM7 19H21V21H7V19ZM3 14H21V16H3V14ZM7 9H21V11H7V9Z"></path></svg>'},{id:"delete",title:j("delete"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 4V2H17V4H22V6H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V6H2V4H7ZM6 6V20H18V6H6ZM9 9H11V17H9V9ZM13 9H15V17H13V9Z"></path></svg>'}]}onItemClick(e){var t,r,i;if(e!="delete"){const o=(t=this.editor)==null?void 0:t.getAttributes("image");o.align=e,(r=this.editor)==null||r.chain().setImage(o).run()}else(i=this.editor)==null||i.commands.deleteSelection()}onTransaction(e){}}class x6 extends Xs{constructor(){super(),this.items=[{id:"insert-column-left",title:j("insert-column-left"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M20 3C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H14C13.4477 21 13 20.5523 13 20V4C13 3.44772 13.4477 3 14 3H20ZM19 5H15V19H19V5ZM6 7C8.76142 7 11 9.23858 11 12C11 14.7614 8.76142 17 6 17C3.23858 17 1 14.7614 1 12C1 9.23858 3.23858 7 6 7ZM7 9H5V10.999L3 11V13L5 12.999V15H7V12.999L9 13V11L7 10.999V9Z"></path></svg>'},{id:"insert-column-right",title:j("insert-column-right"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M10 3C10.5523 3 11 3.44772 11 4V20C11 20.5523 10.5523 21 10 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3H10ZM9 5H5V19H9V5ZM18 7C20.7614 7 23 9.23858 23 12C23 14.7614 20.7614 17 18 17C15.2386 17 13 14.7614 13 12C13 9.23858 15.2386 7 18 7ZM19 9H17V10.999L15 11V13L17 12.999V15H19V12.999L21 13V11L19 10.999V9Z"></path></svg>'},{id:"insert-row-top",title:j("insert-row-top"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M20 13C20.5523 13 21 13.4477 21 14V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V14C3 13.4477 3.44772 13 4 13H20ZM19 15H5V19H19V15ZM12 1C14.7614 1 17 3.23858 17 6C17 8.76142 14.7614 11 12 11C9.23858 11 7 8.76142 7 6C7 3.23858 9.23858 1 12 1ZM13 3H11V4.999L9 5V7L11 6.999V9H13V6.999L15 7V5L13 4.999V3Z"></path></svg>'},{id:"insert-row-bottom",title:j("insert-row-bottom"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 13C14.7614 13 17 15.2386 17 18C17 20.7614 14.7614 23 12 23C9.23858 23 7 20.7614 7 18C7 15.2386 9.23858 13 12 13ZM13 15H11V16.999L9 17V19L11 18.999V21H13V18.999L15 19V17L13 16.999V15ZM20 3C20.5523 3 21 3.44772 21 4V10C21 10.5523 20.5523 11 20 11H4C3.44772 11 3 10.5523 3 10V4C3 3.44772 3.44772 3 4 3H20ZM5 5V9H19V5H5Z"></path></svg>'},{id:"delete-column",title:j("delete-column"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 3C12.5523 3 13 3.44772 13 4L12.9998 11.9998C13.8355 11.372 14.8743 11 16 11C18.7614 11 21 13.2386 21 16C21 18.7614 18.7614 21 16 21C14.9681 21 14.0092 20.6874 13.2129 20.1518L13 20C13 20.5523 12.5523 21 12 21H6C5.44772 21 5 20.5523 5 20V4C5 3.44772 5.44772 3 6 3H12ZM11 5H7V19H11V5ZM19 15H13V17H19V15Z"></path></svg>'},{id:"delete-row",title:j("delete-row"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M20 5C20.5523 5 21 5.44772 21 6V12C21 12.5523 20.5523 13 20 13C20.628 13.8355 21 14.8743 21 16C21 18.7614 18.7614 21 16 21C13.2386 21 11 18.7614 11 16C11 14.8743 11.372 13.8355 11.9998 12.9998L4 13C3.44772 13 3 12.5523 3 12V6C3 5.44772 3.44772 5 4 5H20ZM13 15V17H19V15H13ZM19 7H5V11H19V7Z"></path></svg>'},{id:"merge-cells-horizontal",title:j("merge-cells-horizontal"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M20 3C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3H20ZM11 5H5V10.999H7V9L10 12L7 15V13H5V19H11V17H13V19H19V13H17V15L14 12L17 9V10.999H19V5H13V7H11V5ZM13 13V15H11V13H13ZM13 9V11H11V9H13Z"></path></svg>'},{id:"merge-cells-vertical",title:j("merge-cells-vertical"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M21 20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3H20C20.5523 3 21 3.44772 21 4V20ZM19 11V5H13.001V7H15L12 10L9 7H11V5H5V11H7V13H5V19H11V17H9L12 14L15 17H13.001V19H19V13H17V11H19ZM11 13H9V11H11V13ZM15 13H13V11H15V13Z"></path></svg>'},{id:"split-cells-horizontal",title:j("split-cells-horizontal"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M20 3C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3H20ZM11 5H5V19H11V15H13V19H19V5H13V9H11V5ZM15 9L18 12L15 15V13H9V15L6 12L9 9V11H15V9Z"></path></svg>'},{id:"split-cells-vertical",title:j("split-cells-vertical"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M20 3C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3H20ZM19 5H5V10.999L9 11V13H5V19H19V13H15V11L19 10.999V5ZM12 6L15 9H13V15H15L12 18L9 15H11V9H9L12 6Z"></path></svg>'},{id:"delete",title:j("delete-table"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 4V2H17V4H22V6H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V6H2V4H7ZM6 6V20H18V6H6ZM9 9H11V17H9V9ZM13 9H15V17H13V9Z"></path></svg>'}]}onItemClick(e){var t,r,i,o,s,a,u,l,c;e==="insert-column-left"?(t=this.editor)==null||t.chain().focus().addColumnBefore().run():e==="insert-column-right"?(r=this.editor)==null||r.chain().focus().addColumnAfter().run():e==="insert-row-top"?(i=this.editor)==null||i.chain().focus().addRowBefore().run():e==="insert-row-bottom"?(o=this.editor)==null||o.chain().focus().addRowAfter().run():e==="delete-column"?(s=this.editor)==null||s.chain().focus().deleteColumn().run():e==="delete-row"?(a=this.editor)==null||a.chain().focus().deleteRow().run():e==="merge-cells-horizontal"||e==="merge-cells-vertical"?(u=this.editor)==null||u.chain().focus().mergeCells().run():e==="split-cells-horizontal"||e==="split-cells-vertical"?(l=this.editor)==null||l.chain().focus().splitCell().run():e==="delete"&&((c=this.editor)==null||c.chain().focus().deleteTable().run())}show(e){!e||e.length==0?this.style.display="none":this.style.display="",this.querySelectorAll(".aie-bubble-menu-item").forEach(t=>{t.style.display="none"}),e.forEach(t=>{const r=this.querySelector(`#${t}`);r.style.display=""})}onTransaction(e){if(!e.editor.isActive("table"))return;const{state:{selection:t},view:r}=e.editor;if(t instanceof ie)if(this.isOneCellSelected(t)){const i=["insert-column-left","insert-column-right","delete-column","insert-row-top","insert-row-bottom","delete-row"];if(e.editor.can().splitCell()){const o=r.nodeDOM(t.$anchorCell.pos),s=o.getAttribute("colspan"),a=o.getAttribute("rowspan");s&&Number(s)>1?i.push("split-cells-horizontal"):a&&Number(a)>1&&i.push("split-cells-vertical")}this.show(i)}else this.isAllTableSelected(t)?this.show(["delete"]):this.isColumnSelected(t,r)?this.show(["insert-column-left","insert-column-right","delete-column","merge-cells-vertical"]):this.isRowSelected(t,r)?this.show(["insert-row-top","insert-row-bottom","delete-row","merge-cells-horizontal"]):this.show(["merge-cells-horizontal"]);else this.show(["insert-column-left","insert-column-right","delete-column","insert-row-top","insert-row-bottom","delete-row"])}isAllTableSelected(e){const t=le.get(e.$anchorCell.node(-1)),r=t.cellsInRect({top:0,left:0,right:t.width,bottom:t.height});return e.ranges.length==r.length}isOneCellSelected(e){return e.ranges.length==1}isColumnSelected(e,t){let r=-1;for(let i of e.ranges)if(r==-1)r=t.coordsAtPos(i.$from.pos).left;else if(r!=t.coordsAtPos(i.$from.pos).left)return!1;return!0}isRowSelected(e,t){let r=-1;for(let i of e.ranges)if(r==-1)r=t.coordsAtPos(i.$from.pos).bottom;else if(r!=t.coordsAtPos(i.$from.pos).bottom)return!1;return!0}}const ho={check:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z"></path></svg>',refresh:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.46257 4.43262C7.21556 2.91688 9.5007 2 12 2C17.5228 2 22 6.47715 22 12C22 14.1361 21.3302 16.1158 20.1892 17.7406L17 12H20C20 7.58172 16.4183 4 12 4C9.84982 4 7.89777 4.84827 6.46023 6.22842L5.46257 4.43262ZM18.5374 19.5674C16.7844 21.0831 14.4993 22 12 22C6.47715 22 2 17.5228 2 12C2 9.86386 2.66979 7.88416 3.8108 6.25944L7 12H4C4 16.4183 7.58172 20 12 20C14.1502 20 16.1022 19.1517 17.5398 17.7716L18.5374 19.5674Z" fill="currentColor"></path></svg>',aiPanelStart:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"></path></svg>',aiPanelStop:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 7V17C6 17.5523 6.44772 18 7 18H17C17.5523 18 18 17.5523 18 17V7C18 6.44772 17.5523 6 17 6H7C6.44772 6 6 6.44772 6 7Z"></path></svg>'};class v6 extends Xs{constructor(){super();N(this,"_instance");N(this,"aiBubbleInstance");N(this,"bubblePanelEnable",!0);N(this,"aiClient");this.items=[{id:"ai",title:j("ai"),content:`
                <div style="display: flex;height: 20px">
                     <div style="line-height: 20px"> AI </div>
                     <div style="width: 18px;height: 18px;display: inline-block" >
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 14L8 10H16L12 14Z"></path></svg>
                     </div>
                 </div>
                `},{id:"bold",title:j("bold"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 11H12.5C13.8807 11 15 9.88071 15 8.5C15 7.11929 13.8807 6 12.5 6H8V11ZM18 15.5C18 17.9853 15.9853 20 13.5 20H6V4H12.5C14.9853 4 17 6.01472 17 8.5C17 9.70431 16.5269 10.7981 15.7564 11.6058C17.0979 12.3847 18 13.837 18 15.5ZM8 13V18H13.5C14.8807 18 16 16.8807 16 15.5C16 14.1193 14.8807 13 13.5 13H8Z"></path></svg>'},{id:"italic",title:j("italic"),content:' <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 20H7V18H9.92661L12.0425 6H9V4H17V6H14.0734L11.9575 18H15V20Z"></path></svg>'},{id:"underline",title:j("underline"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 3V12C8 14.2091 9.79086 16 12 16C14.2091 16 16 14.2091 16 12V3H18V12C18 15.3137 15.3137 18 12 18C8.68629 18 6 15.3137 6 12V3H8ZM4 20H20V22H4V20Z"></path></svg>'},{id:"strike",title:j("strike"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.1538 14C17.3846 14.5161 17.5 15.0893 17.5 15.7196C17.5 17.0625 16.9762 18.1116 15.9286 18.867C14.8809 19.6223 13.4335 20 11.5862 20C9.94674 20 8.32335 19.6185 6.71592 18.8555V16.6009C8.23538 17.4783 9.7908 17.917 11.3822 17.917C13.9333 17.917 15.2128 17.1846 15.2208 15.7196C15.2208 15.0939 15.0049 14.5598 14.5731 14.1173C14.5339 14.0772 14.4939 14.0381 14.4531 14H3V12H21V14H17.1538ZM13.076 11H7.62908C7.4566 10.8433 7.29616 10.6692 7.14776 10.4778C6.71592 9.92084 6.5 9.24559 6.5 8.45207C6.5 7.21602 6.96583 6.165 7.89749 5.299C8.82916 4.43299 10.2706 4 12.2219 4C13.6934 4 15.1009 4.32808 16.4444 4.98426V7.13591C15.2448 6.44921 13.9293 6.10587 12.4978 6.10587C10.0187 6.10587 8.77917 6.88793 8.77917 8.45207C8.77917 8.87172 8.99709 9.23796 9.43293 9.55079C9.86878 9.86362 10.4066 10.1135 11.0463 10.3004C11.6665 10.4816 12.3431 10.7148 13.076 11H13.076Z"></path></svg>'},{id:"code",title:j("code"),content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23 11.9998L15.9289 19.0708L14.5147 17.6566L20.1716 11.9998L14.5147 6.34292L15.9289 4.92871L23 11.9998ZM3.82843 11.9998L9.48528 17.6566L8.07107 19.0708L1 11.9998L8.07107 4.92871L9.48528 6.34292L3.82843 11.9998Z"></path></svg>'}]}connectedCallback(){super.connectedCallback(),this.bubblePanelEnable&&(this.aiBubbleInstance=Ae(this.querySelector("#ai"),{content:this.createAiPanelElement(),appendTo:this.editor.view.dom.closest(".aie-container"),placement:"bottom",trigger:"click",interactive:!0,arrow:!1,getReferenceClientRect:()=>{const{state:t,view:r}=this.editor,{ranges:i}=t.selection,o=Math.min(...i.map(a=>a.$from.pos)),s=Math.max(...i.map(a=>a.$to.pos));if(d0(t.selection)){let a=r.nodeDOM(o);const u=a.dataset.nodeViewWrapper?a:a.querySelector("[data-node-view-wrapper]");if(u&&(a=u.firstChild),a)return a.getBoundingClientRect()}return js(r,o,s)},onShow:t=>{window.setTimeout(()=>{var r;return(r=t.popper.querySelector("#prompt"))==null?void 0:r.focus()},0)}}))}onCreate(t,r){super.onCreate(t,r);const i=this.editor.userOptions;i.ai&&i.ai.bubblePanelEnable===!1&&(this.bubblePanelEnable=!1,this.items=this.items.filter(o=>o.id!=="ai"))}set instance(t){this._instance=t}onItemClick(t){var r,i,o,s,a,u;switch(t){case"ai":(r=this._instance)==null||r.hide();break;case"bold":(i=this.editor)==null||i.chain().toggleBold().run();break;case"italic":(o=this.editor)==null||o.chain().toggleItalic().run();break;case"underline":(s=this.editor)==null||s.chain().toggleUnderline().run();break;case"strike":(a=this.editor)==null||a.chain().toggleStrike().run();break;case"code":(u=this.editor)==null||u.chain().toggleCode().run();break}}onTransaction(t){}createAiPanelElement(){const t=document.createElement("div");return t.classList.add("aie-ai-panel"),t.innerHTML=`
        <div class="aie-ai-panel-body">
            <div class="aie-ai-panel-body-content" style="display: none"><div class="loader">${ho.refresh}</div><textarea readonly></textarea></div>
            <div class="aie-ai-panel-body-input"><input id="prompt" placeholder=" AI " type="text" />
            <button type="button" id="go" style="width: 30px;height: 30px">${ho.aiPanelStart}</button></div>
            <div class="aie-ai-panel-body-tips"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 17C9 17 16 18 19 21H20C20.5523 21 21 20.5523 21 20V13.937C21.8626 13.715 22.5 12.9319 22.5 12C22.5 11.0681 21.8626 10.285 21 10.063V4C21 3.44772 20.5523 3 20 3H19C16 6 9 7 9 7H5C3.89543 7 3 7.89543 3 9V15C3 16.1046 3.89543 17 5 17H6L7 22H9V17ZM11 8.6612C11.6833 8.5146 12.5275 8.31193 13.4393 8.04373C15.1175 7.55014 17.25 6.77262 19 5.57458V18.4254C17.25 17.2274 15.1175 16.4499 13.4393 15.9563C12.5275 15.6881 11.6833 15.4854 11 15.3388V8.6612ZM5 9H9V15H5V9Z" fill="currentColor"></path></svg>
            </div>
        </div>
        <div class="aie-ai-panel-footer" style="display: none">
        <div class="aie-ai-panel-footer-tips">:</div>
        <p id="insert"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2 18H12V20H2V18ZM2 11H22V13H2V11ZM2 4H22V6H2V4ZM18 18V15H20V18H23V20H20V23H18V20H15V18H18Z" fill="currentColor"></path></svg> </p>
        <p id="replace"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.071 4.92902L11.4852 6.34323L6.82834 11.0001L16.0002 11.0002L16.0002 13.0002L6.82839 13.0001L11.4852 17.6569L10.071 19.0712L2.99994 12.0001L10.071 4.92902ZM18.0001 19V5.00003H20.0001V19H18.0001Z" fill="currentColor"></path></svg> </p>
        <hr/>
        <p id="hide"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6ZM18 8H6V20H18V8ZM9 4V6H15V4H9Z" fill="currentColor"></path></svg> </p>
        </div>
        `,t.querySelector("#replace").addEventListener("click",()=>{const r=t.querySelector("textarea");if(r.value){const{state:{selection:i,tr:o},view:{dispatch:s},schema:a}=this.editor,u=a.text(r.value);s(o.replaceRangeWith(i.from,i.to,u))}}),t.querySelector("#insert").addEventListener("click",()=>{const r=t.querySelector("textarea");if(r.value){const{state:{selection:i,tr:o},view:{dispatch:s}}=this.editor;s(o.insertText(r.value,i.to))}}),t.querySelector("#hide").addEventListener("click",()=>{var r,i;(r=this.aiBubbleInstance)==null||r.hide(),(i=this._instance)==null||i.show()}),t.querySelector("#go").addEventListener("click",()=>{var r;if(this.aiClient)this.aiClient.stop();else{const i=t.querySelector("textarea");i.value="";const{selection:o,doc:s}=this.editor.state,a=s.textBetween(o.from,o.to),u=this.editor.userOptions,l=Gs.get(((r=u.ai)==null?void 0:r.bubblePanelModel)||"spark");if(l){const c=t.querySelector("#prompt").value,d=this;l.chat(a,c,{onStart(f){d.aiClient=f,t.querySelector(".loader").style.display="block",t.querySelector(".aie-ai-panel-body-content").style.display="block",t.querySelector("#go").innerHTML=ho.aiPanelStop},onStop(){d.aiClient=null,t.querySelector("#go").innerHTML=ho.aiPanelStart,t.querySelector(".loader").style.display="none",t.querySelector(".aie-ai-panel-footer").style.display="block"},onMessage(f){i.value=(i==null?void 0:i.value)+f.content}})}else console.error("Ai model config error.")}}),t}}window.customElements.define("aie-bubble-link",b6);window.customElements.define("aie-bubble-image",y6);window.customElements.define("aie-bubble-table",x6);window.customElements.define("aie-bubble-text",v6);function Qs(n,e){return re.create({name:n,addOptions(){return{...e}},addProseMirrorPlugins(){return this.options.element?[u1({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}})}const k6=n=>{const e=document.createElement("aie-bubble-text");return n.eventComponents.push(e),Qs("textSelectionBubble",{pluginKey:"textSelectionBubble",element:e,tippyOptions:{appendTo:n.container,placement:"top",arrow:!1,onCreate(t){e.instance=t}},shouldShow:({editor:t})=>{if(!t.isEditable)return!1;const{state:{selection:r}}=t;return!r.empty&&Vs(t.state.doc,{from:r.from,to:r.to}).length>0&&!t.isActive("link")&&!t.isActive("image")}})},w6=n=>{const e=document.createElement("aie-bubble-link");return n.eventComponents.push(e),Qs("linkBubble",{pluginKey:"textSelectionBubble",element:e,tippyOptions:{appendTo:n.container,placement:"bottom",arrow:!1},shouldShow:({editor:t})=>t.isEditable?t.isActive("link"):!1})},C6=n=>{const e=document.createElement("aie-bubble-image");return n.eventComponents.push(e),Qs("imageBubble",{pluginKey:"imageBubble",element:e,tippyOptions:{appendTo:n.container,placement:"top-start",arrow:!1,getReferenceClientRect:()=>{const{ranges:t}=n.innerEditor.state.selection,r=Math.min(...t.map(c=>c.$from.pos)),i=Math.max(...t.map(c=>c.$to.pos)),o=n.innerEditor.view,a=o.nodeDOM(r).querySelector("img"),u=js(o,r,i),l=a.getBoundingClientRect();return{...u,left:l.left+l.width*.25}}},shouldShow:({editor:t})=>t.isEditable?t.isActive("image"):!1})},S6=n=>{const e=document.createElement("aie-bubble-table");return n.eventComponents.push(e),Qs("tableBubble",{pluginKey:"tableBubble",element:e,tippyOptions:{placement:"top",appendTo:n.container,arrow:!1,getReferenceClientRect:()=>{const t=n.innerEditor.state.selection,{ranges:r}=t,i=Math.min(...r.map(c=>c.$from.pos)),o=Math.max(...r.map(c=>c.$to.pos)),s=n.innerEditor.view,a=js(s,i,o),u=n.innerEditor.state.selection.$from.posAtIndex(0,1),l=n.innerEditor.view.coordsAtPos(u);return{...a,top:l.top}}},shouldShow:({editor:t})=>{const{state:{selection:r}}=t;return t.isActive("table")&&r.empty}})},E6=n=>{const e=[];return e.push(k6(n)),e.push(w6(n)),e.push(C6(n)),e.push(S6(n)),e},A6=re.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new oe({key:new ae("placeholder"),props:{decorations:({doc:n,selection:e})=>{const t=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,i=[];if(!t)return null;const o=n.type.createAndFill(),s=(o==null?void 0:o.sameMarkup(n))&&o.content.findDiffStart(n.content)===null;return n.descendants((a,u)=>{const l=r>=u&&r<=u+a.nodeSize,c=!a.isLeaf&&!a.childCount;if((l||!this.options.showOnlyCurrent)&&c){const d=[this.options.emptyNodeClass];s&&d.push(this.options.emptyEditorClass);const f=pe.node(u,u+a.nodeSize,{class:d.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:a,pos:u,hasAnchor:l}):this.options.placeholder});i.push(f)}return this.options.includeChildren}),ne.create(n,i)}}})]}});function _6(n){var e;const{char:t,allowSpaces:r,allowedPrefixes:i,startOfLine:o,$position:s}=n,a=ix(t),u=new RegExp(`\\s${a}$`),l=o?"^":"",c=r?new RegExp(`${l}${a}.*?(?=\\s${a}|$)`,"gm"):new RegExp(`${l}(?:^)?${a}[^\\s${a}]*`,"gm"),d=((e=s.nodeBefore)===null||e===void 0?void 0:e.isText)&&s.nodeBefore.text;if(!d)return null;const f=s.pos-d.length,h=Array.from(d.matchAll(c)).pop();if(!h||h.input===void 0||h.index===void 0)return null;const p=h.input.slice(Math.max(0,h.index-1),h.index),m=new RegExp(`^[${i==null?void 0:i.join("")}\0]?$`).test(p);if(i!==null&&!m)return null;const g=f+h.index;let y=g+h[0].length;return r&&u.test(d.slice(y-1,y+1))&&(h[0]+=" ",y+=1),g<s.pos&&y>=s.pos?{range:{from:g,to:y},query:h[0].slice(t.length),text:h[0]}:null}const M6=new ae("suggestion");function T6({pluginKey:n=M6,editor:e,char:t="@",allowSpaces:r=!1,allowedPrefixes:i=[" "],startOfLine:o=!1,decorationTag:s="span",decorationClass:a="suggestion",command:u=()=>null,items:l=()=>[],render:c=()=>({}),allow:d=()=>!0}){let f;const h=c==null?void 0:c(),p=new oe({key:n,view(){return{update:async(m,g)=>{var y,x,v,b,w,k,C;const E=(y=this.key)===null||y===void 0?void 0:y.getState(g),A=(x=this.key)===null||x===void 0?void 0:x.getState(m.state),T=E.active&&A.active&&E.range.from!==A.range.from,I=!E.active&&A.active,V=E.active&&!A.active,U=!I&&!V&&E.query!==A.query,M=I||T,R=U&&!T,D=V||T;if(!M&&!R&&!D)return;const P=D&&!M?E:A,G=m.dom.querySelector(`[data-decoration-id="${P.decorationId}"]`);f={editor:e,range:P.range,query:P.query,text:P.text,items:[],command:he=>{u({editor:e,range:P.range,props:he})},decorationNode:G,clientRect:G?()=>{var he;const{decorationId:Te}=(he=this.key)===null||he===void 0?void 0:he.getState(e.state),rt=m.dom.querySelector(`[data-decoration-id="${Te}"]`);return(rt==null?void 0:rt.getBoundingClientRect())||null}:null},M&&((v=h==null?void 0:h.onBeforeStart)===null||v===void 0||v.call(h,f)),R&&((b=h==null?void 0:h.onBeforeUpdate)===null||b===void 0||b.call(h,f)),(R||M)&&(f.items=await l({editor:e,query:P.query})),D&&((w=h==null?void 0:h.onExit)===null||w===void 0||w.call(h,f)),R&&((k=h==null?void 0:h.onUpdate)===null||k===void 0||k.call(h,f)),M&&((C=h==null?void 0:h.onStart)===null||C===void 0||C.call(h,f))},destroy:()=>{var m;f&&((m=h==null?void 0:h.onExit)===null||m===void 0||m.call(h,f))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(m,g,y,x){const{isEditable:v}=e,{composing:b}=e.view,{selection:w}=m,{empty:k,from:C}=w,E={...g};if(E.composing=b,v&&(k||e.view.composing)){(C<g.range.from||C>g.range.to)&&!b&&!g.composing&&(E.active=!1);const A=_6({char:t,allowSpaces:r,allowedPrefixes:i,startOfLine:o,$position:w.$from}),T=`id_${Math.floor(Math.random()*4294967295)}`;A&&d({editor:e,state:x,range:A.range})?(E.active=!0,E.decorationId=g.decorationId?g.decorationId:T,E.range=A.range,E.query=A.query,E.text=A.text):E.active=!1}else E.active=!1;return E.active||(E.decorationId=null,E.range={from:0,to:0},E.query=null,E.text=null),E}},props:{handleKeyDown(m,g){var y;const{active:x,range:v}=p.getState(m.state);return x&&((y=h==null?void 0:h.onKeyDown)===null||y===void 0?void 0:y.call(h,{view:m,event:g,range:v}))||!1},decorations(m){const{active:g,range:y,decorationId:x}=p.getState(m);return g?ne.create(m.doc,[pe.inline(y.from,y.to,{nodeName:s,class:a,"data-decoration-id":x})]):null}}});return p}const D6=new ae("mention"),L6=K.create({name:"mention",addOptions(){return{HTMLAttributes:{},renderLabel({options:n,node:e}){var t;return`${n.suggestion.char}${(t=e.attrs.label)!==null&&t!==void 0?t:e.attrs.id}`},suggestion:{char:"@",pluginKey:D6,command:({editor:n,range:e,props:t})=>{var r,i;const o=n.view.state.selection.$to.nodeAfter;((r=o==null?void 0:o.text)===null||r===void 0?void 0:r.startsWith(" "))&&(e.to+=1),n.chain().focus().insertContentAt(e,[{type:this.name,attrs:t},{type:"text",text:" "}]).run(),(i=window.getSelection())===null||i===void 0||i.collapseToEnd()},allow:({state:n,range:e})=>{const t=n.doc.resolve(e.from),r=n.schema.nodes[this.name];return!!t.parent.type.contentMatch.matchType(r)}}}},group:"inline",inline:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:n=>n.getAttribute("data-id"),renderHTML:n=>n.id?{"data-id":n.id}:{}},label:{default:null,parseHTML:n=>n.getAttribute("data-label"),renderHTML:n=>n.label?{"data-label":n.label}:{}}}},parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({node:n,HTMLAttributes:e}){return["span",J({"data-type":this.name},this.options.HTMLAttributes,e),this.options.renderLabel({options:this.options,node:n})]},renderText({node:n}){return this.options.renderLabel({options:this.options,node:n})},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:n,state:e})=>{let t=!1;const{selection:r}=e,{empty:i,anchor:o}=r;return i?(e.doc.nodesBetween(o-1,o,(s,a)=>{if(s.type.name===this.name)return t=!0,n.insertText(this.options.suggestion.char||"",a,a+s.nodeSize),!1}),t):!1})}},addProseMirrorPlugins(){return[T6({editor:this.editor,...this.options.suggestion})]}}),O6=n=>L6.configure({HTMLAttributes:{class:"mention"},suggestion:{items:({query:e})=>n(e),render:()=>{let e,t,r=0,i;const o=()=>{e.innerHTML=`
                            <div class="items">
                             ${i.items.map((s,a)=>`<button type="button" class="item ${a===r?"item-selected":""}" data-index="${a}"> @${s.name?s.name:s}</button>`).join("")}
                            </div>
                            `,e.addEventListener("click",s=>{const a=s.target.closest(".item");if(a){const u=Number(a.getAttribute("data-index")),l=i.items[u];l&&l.id?i.command(l):i.command({id:l})}})};return{onStart:s=>{e=document.createElement("div"),e.classList.add("suggestion"),i=s,s.clientRect&&(o(),t=Ae("body",{getReferenceClientRect:s.clientRect,appendTo:()=>s.editor.view.dom.closest(".aie-container"),content:e,showOnCreate:!0,interactive:!0,allowHTML:!0,trigger:"manual",placement:"bottom-start",arrow:!1}))},onUpdate(s){i=s,s.clientRect&&(o(),t[0].setProps({getReferenceClientRect:s.clientRect}))},onKeyDown(s){if(s.event.key==="Escape")return t[0].hide(),!0;if(s.event.key==="ArrowUp")return r=(r+i.items.length-1)%i.items.length,o(),!0;if(s.event.key==="ArrowDown")return r=(r+1)%i.items.length,o(),!0;if(s.event.key==="Enter"){const a=i.items[r];return a&&a.id?i.command(a):i.command({id:a}),!0}return!1},onExit(){t[0].destroy(),e.remove()}}}}}),R6=re.create({addProseMirrorPlugins(){return[new oe({key:new ae("selection-marker"),state:{init:()=>ne.empty,apply:(n,e,t)=>{const{selection:r}=n;if(r){const i=[pe.inline(r.$from.pos,r.$to.pos,{class:"selection-marker"},{inclusiveLeft:!0,inclusiveRight:!0})];return ne.create(t.doc,i)}return e}},props:{decorations(n){return this.getState(n)}}})]}}),If={};function N6(n){let e=If[n];if(e)return e;e=If[n]=[];for(let t=0;t<128;t++){const r=String.fromCharCode(t);e.push(r)}for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);e[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return e}function _r(n,e){typeof e!="string"&&(e=_r.defaultChars);const t=N6(e);return n.replace(/(%[a-f0-9]{2})+/gi,function(r){let i="";for(let o=0,s=r.length;o<s;o+=3){const a=parseInt(r.slice(o+1,o+3),16);if(a<128){i+=t[a];continue}if((a&224)===192&&o+3<s){const u=parseInt(r.slice(o+4,o+6),16);if((u&192)===128){const l=a<<6&1984|u&63;l<128?i+="":i+=String.fromCharCode(l),o+=3;continue}}if((a&240)===224&&o+6<s){const u=parseInt(r.slice(o+4,o+6),16),l=parseInt(r.slice(o+7,o+9),16);if((u&192)===128&&(l&192)===128){const c=a<<12&61440|u<<6&4032|l&63;c<2048||c>=55296&&c<=57343?i+="":i+=String.fromCharCode(c),o+=6;continue}}if((a&248)===240&&o+9<s){const u=parseInt(r.slice(o+4,o+6),16),l=parseInt(r.slice(o+7,o+9),16),c=parseInt(r.slice(o+10,o+12),16);if((u&192)===128&&(l&192)===128&&(c&192)===128){let d=a<<18&1835008|u<<12&258048|l<<6&4032|c&63;d<65536||d>1114111?i+="":(d-=65536,i+=String.fromCharCode(55296+(d>>10),56320+(d&1023))),o+=9;continue}}i+=""}return i})}_r.defaultChars=";/?:@&=+$,#";_r.componentChars="";const Ff={};function H6(n){let e=Ff[n];if(e)return e;e=Ff[n]=[];for(let t=0;t<128;t++){const r=String.fromCharCode(t);/^[0-9a-z]$/i.test(r)?e.push(r):e.push("%"+("0"+t.toString(16).toUpperCase()).slice(-2))}for(let t=0;t<n.length;t++)e[n.charCodeAt(t)]=n[t];return e}function Hi(n,e,t){typeof e!="string"&&(t=e,e=Hi.defaultChars),typeof t>"u"&&(t=!0);const r=H6(e);let i="";for(let o=0,s=n.length;o<s;o++){const a=n.charCodeAt(o);if(t&&a===37&&o+2<s&&/^[0-9a-f]{2}$/i.test(n.slice(o+1,o+3))){i+=n.slice(o,o+3),o+=2;continue}if(a<128){i+=r[a];continue}if(a>=55296&&a<=57343){if(a>=55296&&a<=56319&&o+1<s){const u=n.charCodeAt(o+1);if(u>=56320&&u<=57343){i+=encodeURIComponent(n[o]+n[o+1]),o++;continue}}i+="%EF%BF%BD";continue}i+=encodeURIComponent(n[o])}return i}Hi.defaultChars=";/?:@&=+$,-_.!~*'()#";Hi.componentChars="-_.!~*'()";function nc(n){let e="";return e+=n.protocol||"",e+=n.slashes?"//":"",e+=n.auth?n.auth+"@":"",n.hostname&&n.hostname.indexOf(":")!==-1?e+="["+n.hostname+"]":e+=n.hostname||"",e+=n.port?":"+n.port:"",e+=n.pathname||"",e+=n.search||"",e+=n.hash||"",e}function Es(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const I6=/^([a-z0-9.+-]+:)/i,F6=/:[0-9]*$/,P6=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,B6=["<",">",'"',"`"," ","\r",`
`,"	"],$6=["{","}","|","\\","^","`"].concat(B6),z6=["'"].concat($6),Pf=["%","/","?",";","#"].concat(z6),Bf=["/","?","#"],V6=255,$f=/^[+a-z0-9A-Z_-]{0,63}$/,q6=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,zf={javascript:!0,"javascript:":!0},Vf={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function rc(n,e){if(n&&n instanceof Es)return n;const t=new Es;return t.parse(n,e),t}Es.prototype.parse=function(n,e){let t,r,i,o=n;if(o=o.trim(),!e&&n.split("#").length===1){const l=P6.exec(o);if(l)return this.pathname=l[1],l[2]&&(this.search=l[2]),this}let s=I6.exec(o);if(s&&(s=s[0],t=s.toLowerCase(),this.protocol=s,o=o.substr(s.length)),(e||s||o.match(/^\/\/[^@\/]+@[^@\/]+/))&&(i=o.substr(0,2)==="//",i&&!(s&&zf[s])&&(o=o.substr(2),this.slashes=!0)),!zf[s]&&(i||s&&!Vf[s])){let l=-1;for(let p=0;p<Bf.length;p++)r=o.indexOf(Bf[p]),r!==-1&&(l===-1||r<l)&&(l=r);let c,d;l===-1?d=o.lastIndexOf("@"):d=o.lastIndexOf("@",l),d!==-1&&(c=o.slice(0,d),o=o.slice(d+1),this.auth=c),l=-1;for(let p=0;p<Pf.length;p++)r=o.indexOf(Pf[p]),r!==-1&&(l===-1||r<l)&&(l=r);l===-1&&(l=o.length),o[l-1]===":"&&l--;const f=o.slice(0,l);o=o.slice(l),this.parseHost(f),this.hostname=this.hostname||"";const h=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!h){const p=this.hostname.split(/\./);for(let m=0,g=p.length;m<g;m++){const y=p[m];if(y&&!y.match($f)){let x="";for(let v=0,b=y.length;v<b;v++)y.charCodeAt(v)>127?x+="x":x+=y[v];if(!x.match($f)){const v=p.slice(0,m),b=p.slice(m+1),w=y.match(q6);w&&(v.push(w[1]),b.unshift(w[2])),b.length&&(o=b.join(".")+o),this.hostname=v.join(".");break}}}}this.hostname.length>V6&&(this.hostname=""),h&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const a=o.indexOf("#");a!==-1&&(this.hash=o.substr(a),o=o.slice(0,a));const u=o.indexOf("?");return u!==-1&&(this.search=o.substr(u),o=o.slice(0,u)),o&&(this.pathname=o),Vf[t]&&this.hostname&&!this.pathname&&(this.pathname=""),this};Es.prototype.parseHost=function(n){let e=F6.exec(n);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),n=n.substr(0,n.length-e.length)),n&&(this.hostname=n)};const j6=Object.freeze(Object.defineProperty({__proto__:null,decode:_r,encode:Hi,format:nc,parse:rc},Symbol.toStringTag,{value:"Module"})),l1=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,c1=/[\0-\x1F\x7F-\x9F]/,U6=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,ic=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,d1=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,W6=Object.freeze(Object.defineProperty({__proto__:null,Any:l1,Cc:c1,Cf:U6,P:ic,Z:d1},Symbol.toStringTag,{value:"Module"})),Z6=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(n=>n.charCodeAt(0))),K6=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(n=>n.charCodeAt(0)));var Ya;const G6=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),J6=(Ya=String.fromCodePoint)!==null&&Ya!==void 0?Ya:function(n){let e="";return n>65535&&(n-=65536,e+=String.fromCharCode(n>>>10&1023|55296),n=56320|n&1023),e+=String.fromCharCode(n),e};function Y6(n){var e;return n>=55296&&n<=57343||n>1114111?65533:(e=G6.get(n))!==null&&e!==void 0?e:n}var ge;(function(n){n[n.NUM=35]="NUM",n[n.SEMI=59]="SEMI",n[n.EQUALS=61]="EQUALS",n[n.ZERO=48]="ZERO",n[n.NINE=57]="NINE",n[n.LOWER_A=97]="LOWER_A",n[n.LOWER_F=102]="LOWER_F",n[n.LOWER_X=120]="LOWER_X",n[n.LOWER_Z=122]="LOWER_Z",n[n.UPPER_A=65]="UPPER_A",n[n.UPPER_F=70]="UPPER_F",n[n.UPPER_Z=90]="UPPER_Z"})(ge||(ge={}));const X6=32;var dn;(function(n){n[n.VALUE_LENGTH=49152]="VALUE_LENGTH",n[n.BRANCH_LENGTH=16256]="BRANCH_LENGTH",n[n.JUMP_TABLE=127]="JUMP_TABLE"})(dn||(dn={}));function ol(n){return n>=ge.ZERO&&n<=ge.NINE}function Q6(n){return n>=ge.UPPER_A&&n<=ge.UPPER_F||n>=ge.LOWER_A&&n<=ge.LOWER_F}function eC(n){return n>=ge.UPPER_A&&n<=ge.UPPER_Z||n>=ge.LOWER_A&&n<=ge.LOWER_Z||ol(n)}function tC(n){return n===ge.EQUALS||eC(n)}var me;(function(n){n[n.EntityStart=0]="EntityStart",n[n.NumericStart=1]="NumericStart",n[n.NumericDecimal=2]="NumericDecimal",n[n.NumericHex=3]="NumericHex",n[n.NamedEntity=4]="NamedEntity"})(me||(me={}));var sn;(function(n){n[n.Legacy=0]="Legacy",n[n.Strict=1]="Strict",n[n.Attribute=2]="Attribute"})(sn||(sn={}));class nC{constructor(e,t,r){this.decodeTree=e,this.emitCodePoint=t,this.errors=r,this.state=me.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=sn.Strict}startEntity(e){this.decodeMode=e,this.state=me.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,t){switch(this.state){case me.EntityStart:return e.charCodeAt(t)===ge.NUM?(this.state=me.NumericStart,this.consumed+=1,this.stateNumericStart(e,t+1)):(this.state=me.NamedEntity,this.stateNamedEntity(e,t));case me.NumericStart:return this.stateNumericStart(e,t);case me.NumericDecimal:return this.stateNumericDecimal(e,t);case me.NumericHex:return this.stateNumericHex(e,t);case me.NamedEntity:return this.stateNamedEntity(e,t)}}stateNumericStart(e,t){return t>=e.length?-1:(e.charCodeAt(t)|X6)===ge.LOWER_X?(this.state=me.NumericHex,this.consumed+=1,this.stateNumericHex(e,t+1)):(this.state=me.NumericDecimal,this.stateNumericDecimal(e,t))}addToNumericResult(e,t,r,i){if(t!==r){const o=r-t;this.result=this.result*Math.pow(i,o)+parseInt(e.substr(t,o),i),this.consumed+=o}}stateNumericHex(e,t){const r=t;for(;t<e.length;){const i=e.charCodeAt(t);if(ol(i)||Q6(i))t+=1;else return this.addToNumericResult(e,r,t,16),this.emitNumericEntity(i,3)}return this.addToNumericResult(e,r,t,16),-1}stateNumericDecimal(e,t){const r=t;for(;t<e.length;){const i=e.charCodeAt(t);if(ol(i))t+=1;else return this.addToNumericResult(e,r,t,10),this.emitNumericEntity(i,2)}return this.addToNumericResult(e,r,t,10),-1}emitNumericEntity(e,t){var r;if(this.consumed<=t)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===ge.SEMI)this.consumed+=1;else if(this.decodeMode===sn.Strict)return 0;return this.emitCodePoint(Y6(this.result),this.consumed),this.errors&&(e!==ge.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,t){const{decodeTree:r}=this;let i=r[this.treeIndex],o=(i&dn.VALUE_LENGTH)>>14;for(;t<e.length;t++,this.excess++){const s=e.charCodeAt(t);if(this.treeIndex=rC(r,i,this.treeIndex+Math.max(1,o),s),this.treeIndex<0)return this.result===0||this.decodeMode===sn.Attribute&&(o===0||tC(s))?0:this.emitNotTerminatedNamedEntity();if(i=r[this.treeIndex],o=(i&dn.VALUE_LENGTH)>>14,o!==0){if(s===ge.SEMI)return this.emitNamedEntityData(this.treeIndex,o,this.consumed+this.excess);this.decodeMode!==sn.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:t,decodeTree:r}=this,i=(r[t]&dn.VALUE_LENGTH)>>14;return this.emitNamedEntityData(t,i,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,t,r){const{decodeTree:i}=this;return this.emitCodePoint(t===1?i[e]&~dn.VALUE_LENGTH:i[e+1],r),t===3&&this.emitCodePoint(i[e+2],r),r}end(){var e;switch(this.state){case me.NamedEntity:return this.result!==0&&(this.decodeMode!==sn.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case me.NumericDecimal:return this.emitNumericEntity(0,2);case me.NumericHex:return this.emitNumericEntity(0,3);case me.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case me.EntityStart:return 0}}}function f1(n){let e="";const t=new nC(n,r=>e+=J6(r));return function(i,o){let s=0,a=0;for(;(a=i.indexOf("&",a))>=0;){e+=i.slice(s,a),t.startEntity(o);const l=t.write(i,a+1);if(l<0){s=a+t.end();break}s=a+l,a=l===0?s+1:s}const u=e+i.slice(s);return e="",u}}function rC(n,e,t,r){const i=(e&dn.BRANCH_LENGTH)>>7,o=e&dn.JUMP_TABLE;if(i===0)return o!==0&&r===o?t:-1;if(o){const u=r-o;return u<0||u>=i?-1:n[t+u]-1}let s=t,a=s+i-1;for(;s<=a;){const u=s+a>>>1,l=n[u];if(l<r)s=u+1;else if(l>r)a=u-1;else return n[u+i]}return-1}const iC=f1(Z6);f1(K6);function h1(n,e=sn.Legacy){return iC(n,e)}function oC(n){return Object.prototype.toString.call(n)}function oc(n){return oC(n)==="[object String]"}const sC=Object.prototype.hasOwnProperty;function aC(n,e){return sC.call(n,e)}function ea(n){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(t){if(typeof t!="object")throw new TypeError(t+"must be object");Object.keys(t).forEach(function(r){n[r]=t[r]})}}),n}function p1(n,e,t){return[].concat(n.slice(0,e),t,n.slice(e+1))}function sc(n){return!(n>=55296&&n<=57343||n>=64976&&n<=65007||(n&65535)===65535||(n&65535)===65534||n>=0&&n<=8||n===11||n>=14&&n<=31||n>=127&&n<=159||n>1114111)}function As(n){if(n>65535){n-=65536;const e=55296+(n>>10),t=56320+(n&1023);return String.fromCharCode(e,t)}return String.fromCharCode(n)}const m1=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,uC=/&([a-z#][a-z0-9]{1,31});/gi,lC=new RegExp(m1.source+"|"+uC.source,"gi"),cC=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function dC(n,e){if(e.charCodeAt(0)===35&&cC.test(e)){const r=e[1].toLowerCase()==="x"?parseInt(e.slice(2),16):parseInt(e.slice(1),10);return sc(r)?As(r):n}const t=h1(n);return t!==n?t:n}function fC(n){return n.indexOf("\\")<0?n:n.replace(m1,"$1")}function wi(n){return n.indexOf("\\")<0&&n.indexOf("&")<0?n:n.replace(lC,function(e,t,r){return t||dC(e,r)})}const hC=/[&<>"]/,pC=/[&<>"]/g,mC={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function gC(n){return mC[n]}function yn(n){return hC.test(n)?n.replace(pC,gC):n}const bC=/[.?*+^$[\]\\(){}|-]/g;function yC(n){return n.replace(bC,"\\$&")}function se(n){switch(n){case 9:case 32:return!0}return!1}function Ci(n){if(n>=8192&&n<=8202)return!0;switch(n){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function Si(n){return ic.test(n)}function Ei(n){switch(n){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function ta(n){return n=n.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(n=n.replace(//g,"")),n.toLowerCase().toUpperCase()}const xC={mdurl:j6,ucmicro:W6},vC=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:p1,assign:ea,escapeHtml:yn,escapeRE:yC,fromCodePoint:As,has:aC,isMdAsciiPunct:Ei,isPunctChar:Si,isSpace:se,isString:oc,isValidEntityCode:sc,isWhiteSpace:Ci,lib:xC,normalizeReference:ta,unescapeAll:wi,unescapeMd:fC},Symbol.toStringTag,{value:"Module"}));function kC(n,e,t){let r,i,o,s;const a=n.posMax,u=n.pos;for(n.pos=e+1,r=1;n.pos<a;){if(o=n.src.charCodeAt(n.pos),o===93&&(r--,r===0)){i=!0;break}if(s=n.pos,n.md.inline.skipToken(n),o===91){if(s===n.pos-1)r++;else if(t)return n.pos=u,-1}}let l=-1;return i&&(l=n.pos),n.pos=u,l}function wC(n,e,t){let r,i=e;const o={ok:!1,pos:0,lines:0,str:""};if(n.charCodeAt(i)===60){for(i++;i<t;){if(r=n.charCodeAt(i),r===10||r===60)return o;if(r===62)return o.pos=i+1,o.str=wi(n.slice(e+1,i)),o.ok=!0,o;if(r===92&&i+1<t){i+=2;continue}i++}return o}let s=0;for(;i<t&&(r=n.charCodeAt(i),!(r===32||r<32||r===127));){if(r===92&&i+1<t){if(n.charCodeAt(i+1)===32)break;i+=2;continue}if(r===40&&(s++,s>32))return o;if(r===41){if(s===0)break;s--}i++}return e===i||s!==0||(o.str=wi(n.slice(e,i)),o.pos=i,o.ok=!0),o}function CC(n,e,t){let r,i,o=0,s=e;const a={ok:!1,pos:0,lines:0,str:""};if(s>=t||(i=n.charCodeAt(s),i!==34&&i!==39&&i!==40))return a;for(s++,i===40&&(i=41);s<t;){if(r=n.charCodeAt(s),r===i)return a.pos=s+1,a.lines=o,a.str=wi(n.slice(e+1,s)),a.ok=!0,a;if(r===40&&i===41)return a;r===10?o++:r===92&&s+1<t&&(s++,n.charCodeAt(s)===10&&o++),s++}return a}const SC=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:wC,parseLinkLabel:kC,parseLinkTitle:CC},Symbol.toStringTag,{value:"Module"})),Lt={};Lt.code_inline=function(n,e,t,r,i){const o=n[e];return"<code"+i.renderAttrs(o)+">"+yn(o.content)+"</code>"};Lt.code_block=function(n,e,t,r,i){const o=n[e];return"<pre"+i.renderAttrs(o)+"><code>"+yn(n[e].content)+`</code></pre>
`};Lt.fence=function(n,e,t,r,i){const o=n[e],s=o.info?wi(o.info).trim():"";let a="",u="";if(s){const c=s.split(/(\s+)/g);a=c[0],u=c.slice(2).join("")}let l;if(t.highlight?l=t.highlight(o.content,a,u)||yn(o.content):l=yn(o.content),l.indexOf("<pre")===0)return l+`
`;if(s){const c=o.attrIndex("class"),d=o.attrs?o.attrs.slice():[];c<0?d.push(["class",t.langPrefix+a]):(d[c]=d[c].slice(),d[c][1]+=" "+t.langPrefix+a);const f={attrs:d};return`<pre><code${i.renderAttrs(f)}>${l}</code></pre>
`}return`<pre><code${i.renderAttrs(o)}>${l}</code></pre>
`};Lt.image=function(n,e,t,r,i){const o=n[e];return o.attrs[o.attrIndex("alt")][1]=i.renderInlineAsText(o.children,t,r),i.renderToken(n,e,t)};Lt.hardbreak=function(n,e,t){return t.xhtmlOut?`<br />
`:`<br>
`};Lt.softbreak=function(n,e,t){return t.breaks?t.xhtmlOut?`<br />
`:`<br>
`:`
`};Lt.text=function(n,e){return yn(n[e].content)};Lt.html_block=function(n,e){return n[e].content};Lt.html_inline=function(n,e){return n[e].content};function Lr(){this.rules=ea({},Lt)}Lr.prototype.renderAttrs=function(e){let t,r,i;if(!e.attrs)return"";for(i="",t=0,r=e.attrs.length;t<r;t++)i+=" "+yn(e.attrs[t][0])+'="'+yn(e.attrs[t][1])+'"';return i};Lr.prototype.renderToken=function(e,t,r){const i=e[t];let o="";if(i.hidden)return"";i.block&&i.nesting!==-1&&t&&e[t-1].hidden&&(o+=`
`),o+=(i.nesting===-1?"</":"<")+i.tag,o+=this.renderAttrs(i),i.nesting===0&&r.xhtmlOut&&(o+=" /");let s=!1;if(i.block&&(s=!0,i.nesting===1&&t+1<e.length)){const a=e[t+1];(a.type==="inline"||a.hidden||a.nesting===-1&&a.tag===i.tag)&&(s=!1)}return o+=s?`>
`:">",o};Lr.prototype.renderInline=function(n,e,t){let r="";const i=this.rules;for(let o=0,s=n.length;o<s;o++){const a=n[o].type;typeof i[a]<"u"?r+=i[a](n,o,e,t,this):r+=this.renderToken(n,o,e)}return r};Lr.prototype.renderInlineAsText=function(n,e,t){let r="";for(let i=0,o=n.length;i<o;i++)switch(n[i].type){case"text":r+=n[i].content;break;case"image":r+=this.renderInlineAsText(n[i].children,e,t);break;case"html_inline":case"html_block":r+=n[i].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};Lr.prototype.render=function(n,e,t){let r="";const i=this.rules;for(let o=0,s=n.length;o<s;o++){const a=n[o].type;a==="inline"?r+=this.renderInline(n[o].children,e,t):typeof i[a]<"u"?r+=i[a](n,o,e,t,this):r+=this.renderToken(n,o,e,t)}return r};function Be(){this.__rules__=[],this.__cache__=null}Be.prototype.__find__=function(n){for(let e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===n)return e;return-1};Be.prototype.__compile__=function(){const n=this,e=[""];n.__rules__.forEach(function(t){t.enabled&&t.alt.forEach(function(r){e.indexOf(r)<0&&e.push(r)})}),n.__cache__={},e.forEach(function(t){n.__cache__[t]=[],n.__rules__.forEach(function(r){r.enabled&&(t&&r.alt.indexOf(t)<0||n.__cache__[t].push(r.fn))})})};Be.prototype.at=function(n,e,t){const r=this.__find__(n),i=t||{};if(r===-1)throw new Error("Parser rule not found: "+n);this.__rules__[r].fn=e,this.__rules__[r].alt=i.alt||[],this.__cache__=null};Be.prototype.before=function(n,e,t,r){const i=this.__find__(n),o=r||{};if(i===-1)throw new Error("Parser rule not found: "+n);this.__rules__.splice(i,0,{name:e,enabled:!0,fn:t,alt:o.alt||[]}),this.__cache__=null};Be.prototype.after=function(n,e,t,r){const i=this.__find__(n),o=r||{};if(i===-1)throw new Error("Parser rule not found: "+n);this.__rules__.splice(i+1,0,{name:e,enabled:!0,fn:t,alt:o.alt||[]}),this.__cache__=null};Be.prototype.push=function(n,e,t){const r=t||{};this.__rules__.push({name:n,enabled:!0,fn:e,alt:r.alt||[]}),this.__cache__=null};Be.prototype.enable=function(n,e){Array.isArray(n)||(n=[n]);const t=[];return n.forEach(function(r){const i=this.__find__(r);if(i<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[i].enabled=!0,t.push(r)},this),this.__cache__=null,t};Be.prototype.enableOnly=function(n,e){Array.isArray(n)||(n=[n]),this.__rules__.forEach(function(t){t.enabled=!1}),this.enable(n,e)};Be.prototype.disable=function(n,e){Array.isArray(n)||(n=[n]);const t=[];return n.forEach(function(r){const i=this.__find__(r);if(i<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[i].enabled=!1,t.push(r)},this),this.__cache__=null,t};Be.prototype.getRules=function(n){return this.__cache__===null&&this.__compile__(),this.__cache__[n]||[]};function lt(n,e,t){this.type=n,this.tag=e,this.attrs=null,this.map=null,this.nesting=t,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}lt.prototype.attrIndex=function(e){if(!this.attrs)return-1;const t=this.attrs;for(let r=0,i=t.length;r<i;r++)if(t[r][0]===e)return r;return-1};lt.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]};lt.prototype.attrSet=function(e,t){const r=this.attrIndex(e),i=[e,t];r<0?this.attrPush(i):this.attrs[r]=i};lt.prototype.attrGet=function(e){const t=this.attrIndex(e);let r=null;return t>=0&&(r=this.attrs[t][1]),r};lt.prototype.attrJoin=function(e,t){const r=this.attrIndex(e);r<0?this.attrPush([e,t]):this.attrs[r][1]=this.attrs[r][1]+" "+t};function g1(n,e,t){this.src=n,this.env=t,this.tokens=[],this.inlineMode=!1,this.md=e}g1.prototype.Token=lt;const EC=/\r\n?|\n/g,AC=/\0/g;function _C(n){let e;e=n.src.replace(EC,`
`),e=e.replace(AC,""),n.src=e}function MC(n){let e;n.inlineMode?(e=new n.Token("inline","",0),e.content=n.src,e.map=[0,1],e.children=[],n.tokens.push(e)):n.md.block.parse(n.src,n.md,n.env,n.tokens)}function TC(n){const e=n.tokens;for(let t=0,r=e.length;t<r;t++){const i=e[t];i.type==="inline"&&n.md.inline.parse(i.content,n.md,n.env,i.children)}}function DC(n){return/^<a[>\s]/i.test(n)}function LC(n){return/^<\/a\s*>/i.test(n)}function OC(n){const e=n.tokens;if(n.md.options.linkify)for(let t=0,r=e.length;t<r;t++){if(e[t].type!=="inline"||!n.md.linkify.pretest(e[t].content))continue;let i=e[t].children,o=0;for(let s=i.length-1;s>=0;s--){const a=i[s];if(a.type==="link_close"){for(s--;i[s].level!==a.level&&i[s].type!=="link_open";)s--;continue}if(a.type==="html_inline"&&(DC(a.content)&&o>0&&o--,LC(a.content)&&o++),!(o>0)&&a.type==="text"&&n.md.linkify.test(a.content)){const u=a.content;let l=n.md.linkify.match(u);const c=[];let d=a.level,f=0;l.length>0&&l[0].index===0&&s>0&&i[s-1].type==="text_special"&&(l=l.slice(1));for(let h=0;h<l.length;h++){const p=l[h].url,m=n.md.normalizeLink(p);if(!n.md.validateLink(m))continue;let g=l[h].text;l[h].schema?l[h].schema==="mailto:"&&!/^mailto:/i.test(g)?g=n.md.normalizeLinkText("mailto:"+g).replace(/^mailto:/,""):g=n.md.normalizeLinkText(g):g=n.md.normalizeLinkText("http://"+g).replace(/^http:\/\//,"");const y=l[h].index;if(y>f){const w=new n.Token("text","",0);w.content=u.slice(f,y),w.level=d,c.push(w)}const x=new n.Token("link_open","a",1);x.attrs=[["href",m]],x.level=d++,x.markup="linkify",x.info="auto",c.push(x);const v=new n.Token("text","",0);v.content=g,v.level=d,c.push(v);const b=new n.Token("link_close","a",-1);b.level=--d,b.markup="linkify",b.info="auto",c.push(b),f=l[h].lastIndex}if(f<u.length){const h=new n.Token("text","",0);h.content=u.slice(f),h.level=d,c.push(h)}e[t].children=i=p1(i,s,c)}}}}const b1=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,RC=/\((c|tm|r)\)/i,NC=/\((c|tm|r)\)/ig,HC={c:"",r:"",tm:""};function IC(n,e){return HC[e.toLowerCase()]}function FC(n){let e=0;for(let t=n.length-1;t>=0;t--){const r=n[t];r.type==="text"&&!e&&(r.content=r.content.replace(NC,IC)),r.type==="link_open"&&r.info==="auto"&&e--,r.type==="link_close"&&r.info==="auto"&&e++}}function PC(n){let e=0;for(let t=n.length-1;t>=0;t--){const r=n[t];r.type==="text"&&!e&&b1.test(r.content)&&(r.content=r.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),r.type==="link_open"&&r.info==="auto"&&e--,r.type==="link_close"&&r.info==="auto"&&e++}}function BC(n){let e;if(n.md.options.typographer)for(e=n.tokens.length-1;e>=0;e--)n.tokens[e].type==="inline"&&(RC.test(n.tokens[e].content)&&FC(n.tokens[e].children),b1.test(n.tokens[e].content)&&PC(n.tokens[e].children))}const $C=/['"]/,qf=/['"]/g,jf="";function po(n,e,t){return n.slice(0,e)+t+n.slice(e+1)}function zC(n,e){let t;const r=[];for(let i=0;i<n.length;i++){const o=n[i],s=n[i].level;for(t=r.length-1;t>=0&&!(r[t].level<=s);t--);if(r.length=t+1,o.type!=="text")continue;let a=o.content,u=0,l=a.length;e:for(;u<l;){qf.lastIndex=u;const c=qf.exec(a);if(!c)break;let d=!0,f=!0;u=c.index+1;const h=c[0]==="'";let p=32;if(c.index-1>=0)p=a.charCodeAt(c.index-1);else for(t=i-1;t>=0&&!(n[t].type==="softbreak"||n[t].type==="hardbreak");t--)if(n[t].content){p=n[t].content.charCodeAt(n[t].content.length-1);break}let m=32;if(u<l)m=a.charCodeAt(u);else for(t=i+1;t<n.length&&!(n[t].type==="softbreak"||n[t].type==="hardbreak");t++)if(n[t].content){m=n[t].content.charCodeAt(0);break}const g=Ei(p)||Si(String.fromCharCode(p)),y=Ei(m)||Si(String.fromCharCode(m)),x=Ci(p),v=Ci(m);if(v?d=!1:y&&(x||g||(d=!1)),x?f=!1:g&&(v||y||(f=!1)),m===34&&c[0]==='"'&&p>=48&&p<=57&&(f=d=!1),d&&f&&(d=g,f=y),!d&&!f){h&&(o.content=po(o.content,c.index,jf));continue}if(f)for(t=r.length-1;t>=0;t--){let b=r[t];if(r[t].level<s)break;if(b.single===h&&r[t].level===s){b=r[t];let w,k;h?(w=e.md.options.quotes[2],k=e.md.options.quotes[3]):(w=e.md.options.quotes[0],k=e.md.options.quotes[1]),o.content=po(o.content,c.index,k),n[b.token].content=po(n[b.token].content,b.pos,w),u+=k.length-1,b.token===i&&(u+=w.length-1),a=o.content,l=a.length,r.length=t;continue e}}d?r.push({token:i,pos:c.index,single:h,level:s}):f&&h&&(o.content=po(o.content,c.index,jf))}}}function VC(n){if(n.md.options.typographer)for(let e=n.tokens.length-1;e>=0;e--)n.tokens[e].type!=="inline"||!$C.test(n.tokens[e].content)||zC(n.tokens[e].children,n)}function qC(n){let e,t;const r=n.tokens,i=r.length;for(let o=0;o<i;o++){if(r[o].type!=="inline")continue;const s=r[o].children,a=s.length;for(e=0;e<a;e++)s[e].type==="text_special"&&(s[e].type="text");for(e=t=0;e<a;e++)s[e].type==="text"&&e+1<a&&s[e+1].type==="text"?s[e+1].content=s[e].content+s[e+1].content:(e!==t&&(s[t]=s[e]),t++);e!==t&&(s.length=t)}}const Xa=[["normalize",_C],["block",MC],["inline",TC],["linkify",OC],["replacements",BC],["smartquotes",VC],["text_join",qC]];function ac(){this.ruler=new Be;for(let n=0;n<Xa.length;n++)this.ruler.push(Xa[n][0],Xa[n][1])}ac.prototype.process=function(n){const e=this.ruler.getRules("");for(let t=0,r=e.length;t<r;t++)e[t](n)};ac.prototype.State=g1;function Ot(n,e,t,r){this.src=n,this.md=e,this.env=t,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const i=this.src;for(let o=0,s=0,a=0,u=0,l=i.length,c=!1;s<l;s++){const d=i.charCodeAt(s);if(!c)if(se(d)){a++,d===9?u+=4-u%4:u++;continue}else c=!0;(d===10||s===l-1)&&(d!==10&&s++,this.bMarks.push(o),this.eMarks.push(s),this.tShift.push(a),this.sCount.push(u),this.bsCount.push(0),c=!1,a=0,u=0,o=s+1)}this.bMarks.push(i.length),this.eMarks.push(i.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}Ot.prototype.push=function(n,e,t){const r=new lt(n,e,t);return r.block=!0,t<0&&this.level--,r.level=this.level,t>0&&this.level++,this.tokens.push(r),r};Ot.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};Ot.prototype.skipEmptyLines=function(e){for(let t=this.lineMax;e<t&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};Ot.prototype.skipSpaces=function(e){for(let t=this.src.length;e<t;e++){const r=this.src.charCodeAt(e);if(!se(r))break}return e};Ot.prototype.skipSpacesBack=function(e,t){if(e<=t)return e;for(;e>t;)if(!se(this.src.charCodeAt(--e)))return e+1;return e};Ot.prototype.skipChars=function(e,t){for(let r=this.src.length;e<r&&this.src.charCodeAt(e)===t;e++);return e};Ot.prototype.skipCharsBack=function(e,t,r){if(e<=r)return e;for(;e>r;)if(t!==this.src.charCodeAt(--e))return e+1;return e};Ot.prototype.getLines=function(e,t,r,i){if(e>=t)return"";const o=new Array(t-e);for(let s=0,a=e;a<t;a++,s++){let u=0;const l=this.bMarks[a];let c=l,d;for(a+1<t||i?d=this.eMarks[a]+1:d=this.eMarks[a];c<d&&u<r;){const f=this.src.charCodeAt(c);if(se(f))f===9?u+=4-(u+this.bsCount[a])%4:u++;else if(c-l<this.tShift[a])u++;else break;c++}u>r?o[s]=new Array(u-r+1).join(" ")+this.src.slice(c,d):o[s]=this.src.slice(c,d)}return o.join("")};Ot.prototype.Token=lt;function Qa(n,e){const t=n.bMarks[e]+n.tShift[e],r=n.eMarks[e];return n.src.slice(t,r)}function Uf(n){const e=[],t=n.length;let r=0,i=n.charCodeAt(r),o=!1,s=0,a="";for(;r<t;)i===124&&(o?(a+=n.substring(s,r-1),s=r):(e.push(a+n.substring(s,r)),a="",s=r+1)),o=i===92,r++,i=n.charCodeAt(r);return e.push(a+n.substring(s)),e}function jC(n,e,t,r){if(e+2>t)return!1;let i=e+1;if(n.sCount[i]<n.blkIndent||n.sCount[i]-n.blkIndent>=4)return!1;let o=n.bMarks[i]+n.tShift[i];if(o>=n.eMarks[i])return!1;const s=n.src.charCodeAt(o++);if(s!==124&&s!==45&&s!==58||o>=n.eMarks[i])return!1;const a=n.src.charCodeAt(o++);if(a!==124&&a!==45&&a!==58&&!se(a)||s===45&&se(a))return!1;for(;o<n.eMarks[i];){const v=n.src.charCodeAt(o);if(v!==124&&v!==45&&v!==58&&!se(v))return!1;o++}let u=Qa(n,e+1),l=u.split("|");const c=[];for(let v=0;v<l.length;v++){const b=l[v].trim();if(!b){if(v===0||v===l.length-1)continue;return!1}if(!/^:?-+:?$/.test(b))return!1;b.charCodeAt(b.length-1)===58?c.push(b.charCodeAt(0)===58?"center":"right"):b.charCodeAt(0)===58?c.push("left"):c.push("")}if(u=Qa(n,e).trim(),u.indexOf("|")===-1||n.sCount[e]-n.blkIndent>=4)return!1;l=Uf(u),l.length&&l[0]===""&&l.shift(),l.length&&l[l.length-1]===""&&l.pop();const d=l.length;if(d===0||d!==c.length)return!1;if(r)return!0;const f=n.parentType;n.parentType="table";const h=n.md.block.ruler.getRules("blockquote"),p=n.push("table_open","table",1),m=[e,0];p.map=m;const g=n.push("thead_open","thead",1);g.map=[e,e+1];const y=n.push("tr_open","tr",1);y.map=[e,e+1];for(let v=0;v<l.length;v++){const b=n.push("th_open","th",1);c[v]&&(b.attrs=[["style","text-align:"+c[v]]]);const w=n.push("inline","",0);w.content=l[v].trim(),w.children=[],n.push("th_close","th",-1)}n.push("tr_close","tr",-1),n.push("thead_close","thead",-1);let x;for(i=e+2;i<t&&!(n.sCount[i]<n.blkIndent);i++){let v=!1;for(let w=0,k=h.length;w<k;w++)if(h[w](n,i,t,!0)){v=!0;break}if(v||(u=Qa(n,i).trim(),!u)||n.sCount[i]-n.blkIndent>=4)break;if(l=Uf(u),l.length&&l[0]===""&&l.shift(),l.length&&l[l.length-1]===""&&l.pop(),i===e+2){const w=n.push("tbody_open","tbody",1);w.map=x=[e+2,0]}const b=n.push("tr_open","tr",1);b.map=[i,i+1];for(let w=0;w<d;w++){const k=n.push("td_open","td",1);c[w]&&(k.attrs=[["style","text-align:"+c[w]]]);const C=n.push("inline","",0);C.content=l[w]?l[w].trim():"",C.children=[],n.push("td_close","td",-1)}n.push("tr_close","tr",-1)}return x&&(n.push("tbody_close","tbody",-1),x[1]=i),n.push("table_close","table",-1),m[1]=i,n.parentType=f,n.line=i,!0}function UC(n,e,t){if(n.sCount[e]-n.blkIndent<4)return!1;let r=e+1,i=r;for(;r<t;){if(n.isEmpty(r)){r++;continue}if(n.sCount[r]-n.blkIndent>=4){r++,i=r;continue}break}n.line=i;const o=n.push("code_block","code",0);return o.content=n.getLines(e,i,4+n.blkIndent,!1)+`
`,o.map=[e,n.line],!0}function WC(n,e,t,r){let i=n.bMarks[e]+n.tShift[e],o=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4||i+3>o)return!1;const s=n.src.charCodeAt(i);if(s!==126&&s!==96)return!1;let a=i;i=n.skipChars(i,s);let u=i-a;if(u<3)return!1;const l=n.src.slice(a,i),c=n.src.slice(i,o);if(s===96&&c.indexOf(String.fromCharCode(s))>=0)return!1;if(r)return!0;let d=e,f=!1;for(;d++,!(d>=t||(i=a=n.bMarks[d]+n.tShift[d],o=n.eMarks[d],i<o&&n.sCount[d]<n.blkIndent));)if(n.src.charCodeAt(i)===s&&!(n.sCount[d]-n.blkIndent>=4)&&(i=n.skipChars(i,s),!(i-a<u)&&(i=n.skipSpaces(i),!(i<o)))){f=!0;break}u=n.sCount[e],n.line=d+(f?1:0);const h=n.push("fence","code",0);return h.info=c,h.content=n.getLines(e+1,d,u,!0),h.markup=l,h.map=[e,n.line],!0}function ZC(n,e,t,r){let i=n.bMarks[e]+n.tShift[e],o=n.eMarks[e];const s=n.lineMax;if(n.sCount[e]-n.blkIndent>=4||n.src.charCodeAt(i)!==62)return!1;if(r)return!0;const a=[],u=[],l=[],c=[],d=n.md.block.ruler.getRules("blockquote"),f=n.parentType;n.parentType="blockquote";let h=!1,p;for(p=e;p<t;p++){const v=n.sCount[p]<n.blkIndent;if(i=n.bMarks[p]+n.tShift[p],o=n.eMarks[p],i>=o)break;if(n.src.charCodeAt(i++)===62&&!v){let w=n.sCount[p]+1,k,C;n.src.charCodeAt(i)===32?(i++,w++,C=!1,k=!0):n.src.charCodeAt(i)===9?(k=!0,(n.bsCount[p]+w)%4===3?(i++,w++,C=!1):C=!0):k=!1;let E=w;for(a.push(n.bMarks[p]),n.bMarks[p]=i;i<o;){const A=n.src.charCodeAt(i);if(se(A))A===9?E+=4-(E+n.bsCount[p]+(C?1:0))%4:E++;else break;i++}h=i>=o,u.push(n.bsCount[p]),n.bsCount[p]=n.sCount[p]+1+(k?1:0),l.push(n.sCount[p]),n.sCount[p]=E-w,c.push(n.tShift[p]),n.tShift[p]=i-n.bMarks[p];continue}if(h)break;let b=!1;for(let w=0,k=d.length;w<k;w++)if(d[w](n,p,t,!0)){b=!0;break}if(b){n.lineMax=p,n.blkIndent!==0&&(a.push(n.bMarks[p]),u.push(n.bsCount[p]),c.push(n.tShift[p]),l.push(n.sCount[p]),n.sCount[p]-=n.blkIndent);break}a.push(n.bMarks[p]),u.push(n.bsCount[p]),c.push(n.tShift[p]),l.push(n.sCount[p]),n.sCount[p]=-1}const m=n.blkIndent;n.blkIndent=0;const g=n.push("blockquote_open","blockquote",1);g.markup=">";const y=[e,0];g.map=y,n.md.block.tokenize(n,e,p);const x=n.push("blockquote_close","blockquote",-1);x.markup=">",n.lineMax=s,n.parentType=f,y[1]=n.line;for(let v=0;v<c.length;v++)n.bMarks[v+e]=a[v],n.tShift[v+e]=c[v],n.sCount[v+e]=l[v],n.bsCount[v+e]=u[v];return n.blkIndent=m,!0}function KC(n,e,t,r){const i=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4)return!1;let o=n.bMarks[e]+n.tShift[e];const s=n.src.charCodeAt(o++);if(s!==42&&s!==45&&s!==95)return!1;let a=1;for(;o<i;){const l=n.src.charCodeAt(o++);if(l!==s&&!se(l))return!1;l===s&&a++}if(a<3)return!1;if(r)return!0;n.line=e+1;const u=n.push("hr","hr",0);return u.map=[e,n.line],u.markup=Array(a+1).join(String.fromCharCode(s)),!0}function Wf(n,e){const t=n.eMarks[e];let r=n.bMarks[e]+n.tShift[e];const i=n.src.charCodeAt(r++);if(i!==42&&i!==45&&i!==43)return-1;if(r<t){const o=n.src.charCodeAt(r);if(!se(o))return-1}return r}function Zf(n,e){const t=n.bMarks[e]+n.tShift[e],r=n.eMarks[e];let i=t;if(i+1>=r)return-1;let o=n.src.charCodeAt(i++);if(o<48||o>57)return-1;for(;;){if(i>=r)return-1;if(o=n.src.charCodeAt(i++),o>=48&&o<=57){if(i-t>=10)return-1;continue}if(o===41||o===46)break;return-1}return i<r&&(o=n.src.charCodeAt(i),!se(o))?-1:i}function GC(n,e){const t=n.level+2;for(let r=e+2,i=n.tokens.length-2;r<i;r++)n.tokens[r].level===t&&n.tokens[r].type==="paragraph_open"&&(n.tokens[r+2].hidden=!0,n.tokens[r].hidden=!0,r+=2)}function JC(n,e,t,r){let i,o,s,a,u=e,l=!0;if(n.sCount[u]-n.blkIndent>=4||n.listIndent>=0&&n.sCount[u]-n.listIndent>=4&&n.sCount[u]<n.blkIndent)return!1;let c=!1;r&&n.parentType==="paragraph"&&n.sCount[u]>=n.blkIndent&&(c=!0);let d,f,h;if((h=Zf(n,u))>=0){if(d=!0,s=n.bMarks[u]+n.tShift[u],f=Number(n.src.slice(s,h-1)),c&&f!==1)return!1}else if((h=Wf(n,u))>=0)d=!1;else return!1;if(c&&n.skipSpaces(h)>=n.eMarks[u])return!1;if(r)return!0;const p=n.src.charCodeAt(h-1),m=n.tokens.length;d?(a=n.push("ordered_list_open","ol",1),f!==1&&(a.attrs=[["start",f]])):a=n.push("bullet_list_open","ul",1);const g=[u,0];a.map=g,a.markup=String.fromCharCode(p);let y=!1;const x=n.md.block.ruler.getRules("list"),v=n.parentType;for(n.parentType="list";u<t;){o=h,i=n.eMarks[u];const b=n.sCount[u]+h-(n.bMarks[u]+n.tShift[u]);let w=b;for(;o<i;){const R=n.src.charCodeAt(o);if(R===9)w+=4-(w+n.bsCount[u])%4;else if(R===32)w++;else break;o++}const k=o;let C;k>=i?C=1:C=w-b,C>4&&(C=1);const E=b+C;a=n.push("list_item_open","li",1),a.markup=String.fromCharCode(p);const A=[u,0];a.map=A,d&&(a.info=n.src.slice(s,h-1));const T=n.tight,I=n.tShift[u],V=n.sCount[u],U=n.listIndent;if(n.listIndent=n.blkIndent,n.blkIndent=E,n.tight=!0,n.tShift[u]=k-n.bMarks[u],n.sCount[u]=w,k>=i&&n.isEmpty(u+1)?n.line=Math.min(n.line+2,t):n.md.block.tokenize(n,u,t,!0),(!n.tight||y)&&(l=!1),y=n.line-u>1&&n.isEmpty(n.line-1),n.blkIndent=n.listIndent,n.listIndent=U,n.tShift[u]=I,n.sCount[u]=V,n.tight=T,a=n.push("list_item_close","li",-1),a.markup=String.fromCharCode(p),u=n.line,A[1]=u,u>=t||n.sCount[u]<n.blkIndent||n.sCount[u]-n.blkIndent>=4)break;let M=!1;for(let R=0,D=x.length;R<D;R++)if(x[R](n,u,t,!0)){M=!0;break}if(M)break;if(d){if(h=Zf(n,u),h<0)break;s=n.bMarks[u]+n.tShift[u]}else if(h=Wf(n,u),h<0)break;if(p!==n.src.charCodeAt(h-1))break}return d?a=n.push("ordered_list_close","ol",-1):a=n.push("bullet_list_close","ul",-1),a.markup=String.fromCharCode(p),g[1]=u,n.line=u,n.parentType=v,l&&GC(n,m),!0}function YC(n,e,t,r){let i=0,o=n.bMarks[e]+n.tShift[e],s=n.eMarks[e],a=e+1;if(n.sCount[e]-n.blkIndent>=4||n.src.charCodeAt(o)!==91)return!1;for(;++o<s;)if(n.src.charCodeAt(o)===93&&n.src.charCodeAt(o-1)!==92){if(o+1===s||n.src.charCodeAt(o+1)!==58)return!1;break}const u=n.lineMax,l=n.md.block.ruler.getRules("reference"),c=n.parentType;for(n.parentType="reference";a<u&&!n.isEmpty(a);a++){if(n.sCount[a]-n.blkIndent>3||n.sCount[a]<0)continue;let w=!1;for(let k=0,C=l.length;k<C;k++)if(l[k](n,a,u,!0)){w=!0;break}if(w)break}const d=n.getLines(e,a,n.blkIndent,!1).trim();s=d.length;let f=-1;for(o=1;o<s;o++){const w=d.charCodeAt(o);if(w===91)return!1;if(w===93){f=o;break}else w===10?i++:w===92&&(o++,o<s&&d.charCodeAt(o)===10&&i++)}if(f<0||d.charCodeAt(f+1)!==58)return!1;for(o=f+2;o<s;o++){const w=d.charCodeAt(o);if(w===10)i++;else if(!se(w))break}const h=n.md.helpers.parseLinkDestination(d,o,s);if(!h.ok)return!1;const p=n.md.normalizeLink(h.str);if(!n.md.validateLink(p))return!1;o=h.pos,i+=h.lines;const m=o,g=i,y=o;for(;o<s;o++){const w=d.charCodeAt(o);if(w===10)i++;else if(!se(w))break}const x=n.md.helpers.parseLinkTitle(d,o,s);let v;for(o<s&&y!==o&&x.ok?(v=x.str,o=x.pos,i+=x.lines):(v="",o=m,i=g);o<s;){const w=d.charCodeAt(o);if(!se(w))break;o++}if(o<s&&d.charCodeAt(o)!==10&&v)for(v="",o=m,i=g;o<s;){const w=d.charCodeAt(o);if(!se(w))break;o++}if(o<s&&d.charCodeAt(o)!==10)return!1;const b=ta(d.slice(1,f));return b?(r||(typeof n.env.references>"u"&&(n.env.references={}),typeof n.env.references[b]>"u"&&(n.env.references[b]={title:v,href:p}),n.parentType=c,n.line=e+i+1),!0):!1}const XC=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],QC="[a-zA-Z_:][a-zA-Z0-9:._-]*",e5="[^\"'=<>`\\x00-\\x20]+",t5="'[^']*'",n5='"[^"]*"',r5="(?:"+e5+"|"+t5+"|"+n5+")",i5="(?:\\s+"+QC+"(?:\\s*=\\s*"+r5+")?)",y1="<[A-Za-z][A-Za-z0-9\\-]*"+i5+"*\\s*\\/?>",x1="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",o5="<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->",s5="<[?][\\s\\S]*?[?]>",a5="<![A-Z]+\\s+[^>]*>",u5="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",l5=new RegExp("^(?:"+y1+"|"+x1+"|"+o5+"|"+s5+"|"+a5+"|"+u5+")"),c5=new RegExp("^(?:"+y1+"|"+x1+")"),ir=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+XC.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(c5.source+"\\s*$"),/^$/,!1]];function d5(n,e,t,r){let i=n.bMarks[e]+n.tShift[e],o=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4||!n.md.options.html||n.src.charCodeAt(i)!==60)return!1;let s=n.src.slice(i,o),a=0;for(;a<ir.length&&!ir[a][0].test(s);a++);if(a===ir.length)return!1;if(r)return ir[a][2];let u=e+1;if(!ir[a][1].test(s)){for(;u<t&&!(n.sCount[u]<n.blkIndent);u++)if(i=n.bMarks[u]+n.tShift[u],o=n.eMarks[u],s=n.src.slice(i,o),ir[a][1].test(s)){s.length!==0&&u++;break}}n.line=u;const l=n.push("html_block","",0);return l.map=[e,u],l.content=n.getLines(e,u,n.blkIndent,!0),!0}function f5(n,e,t,r){let i=n.bMarks[e]+n.tShift[e],o=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4)return!1;let s=n.src.charCodeAt(i);if(s!==35||i>=o)return!1;let a=1;for(s=n.src.charCodeAt(++i);s===35&&i<o&&a<=6;)a++,s=n.src.charCodeAt(++i);if(a>6||i<o&&!se(s))return!1;if(r)return!0;o=n.skipSpacesBack(o,i);const u=n.skipCharsBack(o,35,i);u>i&&se(n.src.charCodeAt(u-1))&&(o=u),n.line=e+1;const l=n.push("heading_open","h"+String(a),1);l.markup="########".slice(0,a),l.map=[e,n.line];const c=n.push("inline","",0);c.content=n.src.slice(i,o).trim(),c.map=[e,n.line],c.children=[];const d=n.push("heading_close","h"+String(a),-1);return d.markup="########".slice(0,a),!0}function h5(n,e,t){const r=n.md.block.ruler.getRules("paragraph");if(n.sCount[e]-n.blkIndent>=4)return!1;const i=n.parentType;n.parentType="paragraph";let o=0,s,a=e+1;for(;a<t&&!n.isEmpty(a);a++){if(n.sCount[a]-n.blkIndent>3)continue;if(n.sCount[a]>=n.blkIndent){let h=n.bMarks[a]+n.tShift[a];const p=n.eMarks[a];if(h<p&&(s=n.src.charCodeAt(h),(s===45||s===61)&&(h=n.skipChars(h,s),h=n.skipSpaces(h),h>=p))){o=s===61?1:2;break}}if(n.sCount[a]<0)continue;let f=!1;for(let h=0,p=r.length;h<p;h++)if(r[h](n,a,t,!0)){f=!0;break}if(f)break}if(!o)return!1;const u=n.getLines(e,a,n.blkIndent,!1).trim();n.line=a+1;const l=n.push("heading_open","h"+String(o),1);l.markup=String.fromCharCode(s),l.map=[e,n.line];const c=n.push("inline","",0);c.content=u,c.map=[e,n.line-1],c.children=[];const d=n.push("heading_close","h"+String(o),-1);return d.markup=String.fromCharCode(s),n.parentType=i,!0}function p5(n,e,t){const r=n.md.block.ruler.getRules("paragraph"),i=n.parentType;let o=e+1;for(n.parentType="paragraph";o<t&&!n.isEmpty(o);o++){if(n.sCount[o]-n.blkIndent>3||n.sCount[o]<0)continue;let l=!1;for(let c=0,d=r.length;c<d;c++)if(r[c](n,o,t,!0)){l=!0;break}if(l)break}const s=n.getLines(e,o,n.blkIndent,!1).trim();n.line=o;const a=n.push("paragraph_open","p",1);a.map=[e,n.line];const u=n.push("inline","",0);return u.content=s,u.map=[e,n.line],u.children=[],n.push("paragraph_close","p",-1),n.parentType=i,!0}const mo=[["table",jC,["paragraph","reference"]],["code",UC],["fence",WC,["paragraph","reference","blockquote","list"]],["blockquote",ZC,["paragraph","reference","blockquote","list"]],["hr",KC,["paragraph","reference","blockquote","list"]],["list",JC,["paragraph","reference","blockquote"]],["reference",YC],["html_block",d5,["paragraph","reference","blockquote"]],["heading",f5,["paragraph","reference","blockquote"]],["lheading",h5],["paragraph",p5]];function na(){this.ruler=new Be;for(let n=0;n<mo.length;n++)this.ruler.push(mo[n][0],mo[n][1],{alt:(mo[n][2]||[]).slice()})}na.prototype.tokenize=function(n,e,t){const r=this.ruler.getRules(""),i=r.length,o=n.md.options.maxNesting;let s=e,a=!1;for(;s<t&&(n.line=s=n.skipEmptyLines(s),!(s>=t||n.sCount[s]<n.blkIndent));){if(n.level>=o){n.line=t;break}const u=n.line;let l=!1;for(let c=0;c<i;c++)if(l=r[c](n,s,t,!1),l){if(u>=n.line)throw new Error("block rule didn't increment state.line");break}if(!l)throw new Error("none of the block rules matched");n.tight=!a,n.isEmpty(n.line-1)&&(a=!0),s=n.line,s<t&&n.isEmpty(s)&&(a=!0,s++,n.line=s)}};na.prototype.parse=function(n,e,t,r){if(!n)return;const i=new this.State(n,e,t,r);this.tokenize(i,i.line,i.lineMax)};na.prototype.State=Ot;function Ii(n,e,t,r){this.src=n,this.env=t,this.md=e,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}Ii.prototype.pushPending=function(){const n=new lt("text","",0);return n.content=this.pending,n.level=this.pendingLevel,this.tokens.push(n),this.pending="",n};Ii.prototype.push=function(n,e,t){this.pending&&this.pushPending();const r=new lt(n,e,t);let i=null;return t<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,t>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],i={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(i),r};Ii.prototype.scanDelims=function(n,e){let t,r,i=!0,o=!0;const s=this.posMax,a=this.src.charCodeAt(n),u=n>0?this.src.charCodeAt(n-1):32;let l=n;for(;l<s&&this.src.charCodeAt(l)===a;)l++;const c=l-n,d=l<s?this.src.charCodeAt(l):32,f=Ei(u)||Si(String.fromCharCode(u)),h=Ei(d)||Si(String.fromCharCode(d)),p=Ci(u),m=Ci(d);return m?i=!1:h&&(p||f||(i=!1)),p?o=!1:f&&(m||h||(o=!1)),e?(t=i,r=o):(t=i&&(!o||f),r=o&&(!i||h)),{can_open:t,can_close:r,length:c}};Ii.prototype.Token=lt;function m5(n){switch(n){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function g5(n,e){let t=n.pos;for(;t<n.posMax&&!m5(n.src.charCodeAt(t));)t++;return t===n.pos?!1:(e||(n.pending+=n.src.slice(n.pos,t)),n.pos=t,!0)}const b5=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function y5(n,e){if(!n.md.options.linkify||n.linkLevel>0)return!1;const t=n.pos,r=n.posMax;if(t+3>r||n.src.charCodeAt(t)!==58||n.src.charCodeAt(t+1)!==47||n.src.charCodeAt(t+2)!==47)return!1;const i=n.pending.match(b5);if(!i)return!1;const o=i[1],s=n.md.linkify.matchAtStart(n.src.slice(t-o.length));if(!s)return!1;let a=s.url;if(a.length<=o.length)return!1;a=a.replace(/\*+$/,"");const u=n.md.normalizeLink(a);if(!n.md.validateLink(u))return!1;if(!e){n.pending=n.pending.slice(0,-o.length);const l=n.push("link_open","a",1);l.attrs=[["href",u]],l.markup="linkify",l.info="auto";const c=n.push("text","",0);c.content=n.md.normalizeLinkText(a);const d=n.push("link_close","a",-1);d.markup="linkify",d.info="auto"}return n.pos+=a.length-o.length,!0}function x5(n,e){let t=n.pos;if(n.src.charCodeAt(t)!==10)return!1;const r=n.pending.length-1,i=n.posMax;if(!e)if(r>=0&&n.pending.charCodeAt(r)===32)if(r>=1&&n.pending.charCodeAt(r-1)===32){let o=r-1;for(;o>=1&&n.pending.charCodeAt(o-1)===32;)o--;n.pending=n.pending.slice(0,o),n.push("hardbreak","br",0)}else n.pending=n.pending.slice(0,-1),n.push("softbreak","br",0);else n.push("softbreak","br",0);for(t++;t<i&&se(n.src.charCodeAt(t));)t++;return n.pos=t,!0}const uc=[];for(let n=0;n<256;n++)uc.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(n){uc[n.charCodeAt(0)]=1});function v5(n,e){let t=n.pos;const r=n.posMax;if(n.src.charCodeAt(t)!==92||(t++,t>=r))return!1;let i=n.src.charCodeAt(t);if(i===10){for(e||n.push("hardbreak","br",0),t++;t<r&&(i=n.src.charCodeAt(t),!!se(i));)t++;return n.pos=t,!0}let o=n.src[t];if(i>=55296&&i<=56319&&t+1<r){const a=n.src.charCodeAt(t+1);a>=56320&&a<=57343&&(o+=n.src[t+1],t++)}const s="\\"+o;if(!e){const a=n.push("text_special","",0);i<256&&uc[i]!==0?a.content=o:a.content=s,a.markup=s,a.info="escape"}return n.pos=t+1,!0}function k5(n,e){let t=n.pos;if(n.src.charCodeAt(t)!==96)return!1;const i=t;t++;const o=n.posMax;for(;t<o&&n.src.charCodeAt(t)===96;)t++;const s=n.src.slice(i,t),a=s.length;if(n.backticksScanned&&(n.backticks[a]||0)<=i)return e||(n.pending+=s),n.pos+=a,!0;let u=t,l;for(;(l=n.src.indexOf("`",u))!==-1;){for(u=l+1;u<o&&n.src.charCodeAt(u)===96;)u++;const c=u-l;if(c===a){if(!e){const d=n.push("code_inline","code",0);d.markup=s,d.content=n.src.slice(t,l).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return n.pos=u,!0}n.backticks[c]=l}return n.backticksScanned=!0,e||(n.pending+=s),n.pos+=a,!0}function w5(n,e){const t=n.pos,r=n.src.charCodeAt(t);if(e||r!==126)return!1;const i=n.scanDelims(n.pos,!0);let o=i.length;const s=String.fromCharCode(r);if(o<2)return!1;let a;o%2&&(a=n.push("text","",0),a.content=s,o--);for(let u=0;u<o;u+=2)a=n.push("text","",0),a.content=s+s,n.delimiters.push({marker:r,length:0,token:n.tokens.length-1,end:-1,open:i.can_open,close:i.can_close});return n.pos+=i.length,!0}function Kf(n,e){let t;const r=[],i=e.length;for(let o=0;o<i;o++){const s=e[o];if(s.marker!==126||s.end===-1)continue;const a=e[s.end];t=n.tokens[s.token],t.type="s_open",t.tag="s",t.nesting=1,t.markup="~~",t.content="",t=n.tokens[a.token],t.type="s_close",t.tag="s",t.nesting=-1,t.markup="~~",t.content="",n.tokens[a.token-1].type==="text"&&n.tokens[a.token-1].content==="~"&&r.push(a.token-1)}for(;r.length;){const o=r.pop();let s=o+1;for(;s<n.tokens.length&&n.tokens[s].type==="s_close";)s++;s--,o!==s&&(t=n.tokens[s],n.tokens[s]=n.tokens[o],n.tokens[o]=t)}}function C5(n){const e=n.tokens_meta,t=n.tokens_meta.length;Kf(n,n.delimiters);for(let r=0;r<t;r++)e[r]&&e[r].delimiters&&Kf(n,e[r].delimiters)}const v1={tokenize:w5,postProcess:C5};function S5(n,e){const t=n.pos,r=n.src.charCodeAt(t);if(e||r!==95&&r!==42)return!1;const i=n.scanDelims(n.pos,r===42);for(let o=0;o<i.length;o++){const s=n.push("text","",0);s.content=String.fromCharCode(r),n.delimiters.push({marker:r,length:i.length,token:n.tokens.length-1,end:-1,open:i.can_open,close:i.can_close})}return n.pos+=i.length,!0}function Gf(n,e){const t=e.length;for(let r=t-1;r>=0;r--){const i=e[r];if(i.marker!==95&&i.marker!==42||i.end===-1)continue;const o=e[i.end],s=r>0&&e[r-1].end===i.end+1&&e[r-1].marker===i.marker&&e[r-1].token===i.token-1&&e[i.end+1].token===o.token+1,a=String.fromCharCode(i.marker),u=n.tokens[i.token];u.type=s?"strong_open":"em_open",u.tag=s?"strong":"em",u.nesting=1,u.markup=s?a+a:a,u.content="";const l=n.tokens[o.token];l.type=s?"strong_close":"em_close",l.tag=s?"strong":"em",l.nesting=-1,l.markup=s?a+a:a,l.content="",s&&(n.tokens[e[r-1].token].content="",n.tokens[e[i.end+1].token].content="",r--)}}function E5(n){const e=n.tokens_meta,t=n.tokens_meta.length;Gf(n,n.delimiters);for(let r=0;r<t;r++)e[r]&&e[r].delimiters&&Gf(n,e[r].delimiters)}const k1={tokenize:S5,postProcess:E5};function A5(n,e){let t,r,i,o,s="",a="",u=n.pos,l=!0;if(n.src.charCodeAt(n.pos)!==91)return!1;const c=n.pos,d=n.posMax,f=n.pos+1,h=n.md.helpers.parseLinkLabel(n,n.pos,!0);if(h<0)return!1;let p=h+1;if(p<d&&n.src.charCodeAt(p)===40){for(l=!1,p++;p<d&&(t=n.src.charCodeAt(p),!(!se(t)&&t!==10));p++);if(p>=d)return!1;if(u=p,i=n.md.helpers.parseLinkDestination(n.src,p,n.posMax),i.ok){for(s=n.md.normalizeLink(i.str),n.md.validateLink(s)?p=i.pos:s="",u=p;p<d&&(t=n.src.charCodeAt(p),!(!se(t)&&t!==10));p++);if(i=n.md.helpers.parseLinkTitle(n.src,p,n.posMax),p<d&&u!==p&&i.ok)for(a=i.str,p=i.pos;p<d&&(t=n.src.charCodeAt(p),!(!se(t)&&t!==10));p++);}(p>=d||n.src.charCodeAt(p)!==41)&&(l=!0),p++}if(l){if(typeof n.env.references>"u")return!1;if(p<d&&n.src.charCodeAt(p)===91?(u=p+1,p=n.md.helpers.parseLinkLabel(n,p),p>=0?r=n.src.slice(u,p++):p=h+1):p=h+1,r||(r=n.src.slice(f,h)),o=n.env.references[ta(r)],!o)return n.pos=c,!1;s=o.href,a=o.title}if(!e){n.pos=f,n.posMax=h;const m=n.push("link_open","a",1),g=[["href",s]];m.attrs=g,a&&g.push(["title",a]),n.linkLevel++,n.md.inline.tokenize(n),n.linkLevel--,n.push("link_close","a",-1)}return n.pos=p,n.posMax=d,!0}function _5(n,e){let t,r,i,o,s,a,u,l,c="";const d=n.pos,f=n.posMax;if(n.src.charCodeAt(n.pos)!==33||n.src.charCodeAt(n.pos+1)!==91)return!1;const h=n.pos+2,p=n.md.helpers.parseLinkLabel(n,n.pos+1,!1);if(p<0)return!1;if(o=p+1,o<f&&n.src.charCodeAt(o)===40){for(o++;o<f&&(t=n.src.charCodeAt(o),!(!se(t)&&t!==10));o++);if(o>=f)return!1;for(l=o,a=n.md.helpers.parseLinkDestination(n.src,o,n.posMax),a.ok&&(c=n.md.normalizeLink(a.str),n.md.validateLink(c)?o=a.pos:c=""),l=o;o<f&&(t=n.src.charCodeAt(o),!(!se(t)&&t!==10));o++);if(a=n.md.helpers.parseLinkTitle(n.src,o,n.posMax),o<f&&l!==o&&a.ok)for(u=a.str,o=a.pos;o<f&&(t=n.src.charCodeAt(o),!(!se(t)&&t!==10));o++);else u="";if(o>=f||n.src.charCodeAt(o)!==41)return n.pos=d,!1;o++}else{if(typeof n.env.references>"u")return!1;if(o<f&&n.src.charCodeAt(o)===91?(l=o+1,o=n.md.helpers.parseLinkLabel(n,o),o>=0?i=n.src.slice(l,o++):o=p+1):o=p+1,i||(i=n.src.slice(h,p)),s=n.env.references[ta(i)],!s)return n.pos=d,!1;c=s.href,u=s.title}if(!e){r=n.src.slice(h,p);const m=[];n.md.inline.parse(r,n.md,n.env,m);const g=n.push("image","img",0),y=[["src",c],["alt",""]];g.attrs=y,g.children=m,g.content=r,u&&y.push(["title",u])}return n.pos=o,n.posMax=f,!0}const M5=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,T5=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function D5(n,e){let t=n.pos;if(n.src.charCodeAt(t)!==60)return!1;const r=n.pos,i=n.posMax;for(;;){if(++t>=i)return!1;const s=n.src.charCodeAt(t);if(s===60)return!1;if(s===62)break}const o=n.src.slice(r+1,t);if(T5.test(o)){const s=n.md.normalizeLink(o);if(!n.md.validateLink(s))return!1;if(!e){const a=n.push("link_open","a",1);a.attrs=[["href",s]],a.markup="autolink",a.info="auto";const u=n.push("text","",0);u.content=n.md.normalizeLinkText(o);const l=n.push("link_close","a",-1);l.markup="autolink",l.info="auto"}return n.pos+=o.length+2,!0}if(M5.test(o)){const s=n.md.normalizeLink("mailto:"+o);if(!n.md.validateLink(s))return!1;if(!e){const a=n.push("link_open","a",1);a.attrs=[["href",s]],a.markup="autolink",a.info="auto";const u=n.push("text","",0);u.content=n.md.normalizeLinkText(o);const l=n.push("link_close","a",-1);l.markup="autolink",l.info="auto"}return n.pos+=o.length+2,!0}return!1}function L5(n){return/^<a[>\s]/i.test(n)}function O5(n){return/^<\/a\s*>/i.test(n)}function R5(n){const e=n|32;return e>=97&&e<=122}function N5(n,e){if(!n.md.options.html)return!1;const t=n.posMax,r=n.pos;if(n.src.charCodeAt(r)!==60||r+2>=t)return!1;const i=n.src.charCodeAt(r+1);if(i!==33&&i!==63&&i!==47&&!R5(i))return!1;const o=n.src.slice(r).match(l5);if(!o)return!1;if(!e){const s=n.push("html_inline","",0);s.content=o[0],L5(s.content)&&n.linkLevel++,O5(s.content)&&n.linkLevel--}return n.pos+=o[0].length,!0}const H5=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,I5=/^&([a-z][a-z0-9]{1,31});/i;function F5(n,e){const t=n.pos,r=n.posMax;if(n.src.charCodeAt(t)!==38||t+1>=r)return!1;if(n.src.charCodeAt(t+1)===35){const o=n.src.slice(t).match(H5);if(o){if(!e){const s=o[1][0].toLowerCase()==="x"?parseInt(o[1].slice(1),16):parseInt(o[1],10),a=n.push("text_special","",0);a.content=sc(s)?As(s):As(65533),a.markup=o[0],a.info="entity"}return n.pos+=o[0].length,!0}}else{const o=n.src.slice(t).match(I5);if(o){const s=h1(o[0]);if(s!==o[0]){if(!e){const a=n.push("text_special","",0);a.content=s,a.markup=o[0],a.info="entity"}return n.pos+=o[0].length,!0}}}return!1}function Jf(n){const e={},t=n.length;if(!t)return;let r=0,i=-2;const o=[];for(let s=0;s<t;s++){const a=n[s];if(o.push(0),(n[r].marker!==a.marker||i!==a.token-1)&&(r=s),i=a.token,a.length=a.length||0,!a.close)continue;e.hasOwnProperty(a.marker)||(e[a.marker]=[-1,-1,-1,-1,-1,-1]);const u=e[a.marker][(a.open?3:0)+a.length%3];let l=r-o[r]-1,c=l;for(;l>u;l-=o[l]+1){const d=n[l];if(d.marker===a.marker&&d.open&&d.end<0){let f=!1;if((d.close||a.open)&&(d.length+a.length)%3===0&&(d.length%3!==0||a.length%3!==0)&&(f=!0),!f){const h=l>0&&!n[l-1].open?o[l-1]+1:0;o[s]=s-l+h,o[l]=h,a.open=!1,d.end=s,d.close=!1,c=-1,i=-2;break}}}c!==-1&&(e[a.marker][(a.open?3:0)+(a.length||0)%3]=c)}}function P5(n){const e=n.tokens_meta,t=n.tokens_meta.length;Jf(n.delimiters);for(let r=0;r<t;r++)e[r]&&e[r].delimiters&&Jf(e[r].delimiters)}function B5(n){let e,t,r=0;const i=n.tokens,o=n.tokens.length;for(e=t=0;e<o;e++)i[e].nesting<0&&r--,i[e].level=r,i[e].nesting>0&&r++,i[e].type==="text"&&e+1<o&&i[e+1].type==="text"?i[e+1].content=i[e].content+i[e+1].content:(e!==t&&(i[t]=i[e]),t++);e!==t&&(i.length=t)}const eu=[["text",g5],["linkify",y5],["newline",x5],["escape",v5],["backticks",k5],["strikethrough",v1.tokenize],["emphasis",k1.tokenize],["link",A5],["image",_5],["autolink",D5],["html_inline",N5],["entity",F5]],tu=[["balance_pairs",P5],["strikethrough",v1.postProcess],["emphasis",k1.postProcess],["fragments_join",B5]];function Fi(){this.ruler=new Be;for(let n=0;n<eu.length;n++)this.ruler.push(eu[n][0],eu[n][1]);this.ruler2=new Be;for(let n=0;n<tu.length;n++)this.ruler2.push(tu[n][0],tu[n][1])}Fi.prototype.skipToken=function(n){const e=n.pos,t=this.ruler.getRules(""),r=t.length,i=n.md.options.maxNesting,o=n.cache;if(typeof o[e]<"u"){n.pos=o[e];return}let s=!1;if(n.level<i){for(let a=0;a<r;a++)if(n.level++,s=t[a](n,!0),n.level--,s){if(e>=n.pos)throw new Error("inline rule didn't increment state.pos");break}}else n.pos=n.posMax;s||n.pos++,o[e]=n.pos};Fi.prototype.tokenize=function(n){const e=this.ruler.getRules(""),t=e.length,r=n.posMax,i=n.md.options.maxNesting;for(;n.pos<r;){const o=n.pos;let s=!1;if(n.level<i){for(let a=0;a<t;a++)if(s=e[a](n,!1),s){if(o>=n.pos)throw new Error("inline rule didn't increment state.pos");break}}if(s){if(n.pos>=r)break;continue}n.pending+=n.src[n.pos++]}n.pending&&n.pushPending()};Fi.prototype.parse=function(n,e,t,r){const i=new this.State(n,e,t,r);this.tokenize(i);const o=this.ruler2.getRules(""),s=o.length;for(let a=0;a<s;a++)o[a](i)};Fi.prototype.State=Ii;function $5(n){const e={};n=n||{},e.src_Any=l1.source,e.src_Cc=c1.source,e.src_Z=d1.source,e.src_P=ic.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");const t="[><]";return e.src_pseudo_letter="(?:(?!"+t+"|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|"+t+"|"+e.src_ZPCc+")(?!"+(n["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|"+t+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(n["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy="(^|"+t+'|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}function sl(n){return Array.prototype.slice.call(arguments,1).forEach(function(t){t&&Object.keys(t).forEach(function(r){n[r]=t[r]})}),n}function ra(n){return Object.prototype.toString.call(n)}function z5(n){return ra(n)==="[object String]"}function V5(n){return ra(n)==="[object Object]"}function q5(n){return ra(n)==="[object RegExp]"}function Yf(n){return ra(n)==="[object Function]"}function j5(n){return n.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const w1={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function U5(n){return Object.keys(n||{}).reduce(function(e,t){return e||w1.hasOwnProperty(t)},!1)}const W5={"http:":{validate:function(n,e,t){const r=n.slice(e);return t.re.http||(t.re.http=new RegExp("^\\/\\/"+t.re.src_auth+t.re.src_host_port_strict+t.re.src_path,"i")),t.re.http.test(r)?r.match(t.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(n,e,t){const r=n.slice(e);return t.re.no_http||(t.re.no_http=new RegExp("^"+t.re.src_auth+"(?:localhost|(?:(?:"+t.re.src_domain+")\\.)+"+t.re.src_domain_root+")"+t.re.src_port+t.re.src_host_terminator+t.re.src_path,"i")),t.re.no_http.test(r)?e>=3&&n[e-3]===":"||e>=3&&n[e-3]==="/"?0:r.match(t.re.no_http)[0].length:0}},"mailto:":{validate:function(n,e,t){const r=n.slice(e);return t.re.mailto||(t.re.mailto=new RegExp("^"+t.re.src_email_name+"@"+t.re.src_host_strict,"i")),t.re.mailto.test(r)?r.match(t.re.mailto)[0].length:0}}},Z5="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",K5="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function G5(n){n.__index__=-1,n.__text_cache__=""}function J5(n){return function(e,t){const r=e.slice(t);return n.test(r)?r.match(n)[0].length:0}}function Xf(){return function(n,e){e.normalize(n)}}function _s(n){const e=n.re=$5(n.__opts__),t=n.__tlds__.slice();n.onCompile(),n.__tlds_replaced__||t.push(Z5),t.push(e.src_xn),e.src_tlds=t.join("|");function r(a){return a.replace("%TLDS%",e.src_tlds)}e.email_fuzzy=RegExp(r(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(r(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(r(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(r(e.tpl_host_fuzzy_test),"i");const i=[];n.__compiled__={};function o(a,u){throw new Error('(LinkifyIt) Invalid schema "'+a+'": '+u)}Object.keys(n.__schemas__).forEach(function(a){const u=n.__schemas__[a];if(u===null)return;const l={validate:null,link:null};if(n.__compiled__[a]=l,V5(u)){q5(u.validate)?l.validate=J5(u.validate):Yf(u.validate)?l.validate=u.validate:o(a,u),Yf(u.normalize)?l.normalize=u.normalize:u.normalize?o(a,u):l.normalize=Xf();return}if(z5(u)){i.push(a);return}o(a,u)}),i.forEach(function(a){n.__compiled__[n.__schemas__[a]]&&(n.__compiled__[a].validate=n.__compiled__[n.__schemas__[a]].validate,n.__compiled__[a].normalize=n.__compiled__[n.__schemas__[a]].normalize)}),n.__compiled__[""]={validate:null,normalize:Xf()};const s=Object.keys(n.__compiled__).filter(function(a){return a.length>0&&n.__compiled__[a]}).map(j5).join("|");n.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+s+")","i"),n.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+s+")","ig"),n.re.schema_at_start=RegExp("^"+n.re.schema_search.source,"i"),n.re.pretest=RegExp("("+n.re.schema_test.source+")|("+n.re.host_fuzzy_test.source+")|@","i"),G5(n)}function Y5(n,e){const t=n.__index__,r=n.__last_index__,i=n.__text_cache__.slice(t,r);this.schema=n.__schema__.toLowerCase(),this.index=t+e,this.lastIndex=r+e,this.raw=i,this.text=i,this.url=i}function al(n,e){const t=new Y5(n,e);return n.__compiled__[t.schema].normalize(t,n),t}function qe(n,e){if(!(this instanceof qe))return new qe(n,e);e||U5(n)&&(e=n,n={}),this.__opts__=sl({},w1,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=sl({},W5,n),this.__compiled__={},this.__tlds__=K5,this.__tlds_replaced__=!1,this.re={},_s(this)}qe.prototype.add=function(e,t){return this.__schemas__[e]=t,_s(this),this};qe.prototype.set=function(e){return this.__opts__=sl(this.__opts__,e),this};qe.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;let t,r,i,o,s,a,u,l,c;if(this.re.schema_test.test(e)){for(u=this.re.schema_search,u.lastIndex=0;(t=u.exec(e))!==null;)if(o=this.testSchemaAt(e,t[2],u.lastIndex),o){this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+o;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=e.search(this.re.host_fuzzy_test),l>=0&&(this.__index__<0||l<this.__index__)&&(r=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(s=r.index+r[1].length,(this.__index__<0||s<this.__index__)&&(this.__schema__="",this.__index__=s,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(c=e.indexOf("@"),c>=0&&(i=e.match(this.re.email_fuzzy))!==null&&(s=i.index+i[1].length,a=i.index+i[0].length,(this.__index__<0||s<this.__index__||s===this.__index__&&a>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=s,this.__last_index__=a))),this.__index__>=0};qe.prototype.pretest=function(e){return this.re.pretest.test(e)};qe.prototype.testSchemaAt=function(e,t,r){return this.__compiled__[t.toLowerCase()]?this.__compiled__[t.toLowerCase()].validate(e,r,this):0};qe.prototype.match=function(e){const t=[];let r=0;this.__index__>=0&&this.__text_cache__===e&&(t.push(al(this,r)),r=this.__last_index__);let i=r?e.slice(r):e;for(;this.test(i);)t.push(al(this,r)),i=i.slice(this.__last_index__),r+=this.__last_index__;return t.length?t:null};qe.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;const t=this.re.schema_at_start.exec(e);if(!t)return null;const r=this.testSchemaAt(e,t[2],t[0].length);return r?(this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+r,al(this,0)):null};qe.prototype.tlds=function(e,t){return e=Array.isArray(e)?e:[e],t?(this.__tlds__=this.__tlds__.concat(e).sort().filter(function(r,i,o){return r!==o[i-1]}).reverse(),_s(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,_s(this),this)};qe.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),e.schema==="mailto:"&&!/^mailto:/i.test(e.url)&&(e.url="mailto:"+e.url)};qe.prototype.onCompile=function(){};const gr=2147483647,wt=36,lc=1,Ai=26,X5=38,Q5=700,C1=72,S1=128,E1="-",e8=/^xn--/,t8=/[^\0-\x7F]/,n8=/[\x2E\u3002\uFF0E\uFF61]/g,r8={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},nu=wt-lc,Ct=Math.floor,ru=String.fromCharCode;function en(n){throw new RangeError(r8[n])}function i8(n,e){const t=[];let r=n.length;for(;r--;)t[r]=e(n[r]);return t}function A1(n,e){const t=n.split("@");let r="";t.length>1&&(r=t[0]+"@",n=t[1]),n=n.replace(n8,".");const i=n.split("."),o=i8(i,e).join(".");return r+o}function _1(n){const e=[];let t=0;const r=n.length;for(;t<r;){const i=n.charCodeAt(t++);if(i>=55296&&i<=56319&&t<r){const o=n.charCodeAt(t++);(o&64512)==56320?e.push(((i&1023)<<10)+(o&1023)+65536):(e.push(i),t--)}else e.push(i)}return e}const o8=n=>String.fromCodePoint(...n),s8=function(n){return n>=48&&n<58?26+(n-48):n>=65&&n<91?n-65:n>=97&&n<123?n-97:wt},Qf=function(n,e){return n+22+75*(n<26)-((e!=0)<<5)},M1=function(n,e,t){let r=0;for(n=t?Ct(n/Q5):n>>1,n+=Ct(n/e);n>nu*Ai>>1;r+=wt)n=Ct(n/nu);return Ct(r+(nu+1)*n/(n+X5))},T1=function(n){const e=[],t=n.length;let r=0,i=S1,o=C1,s=n.lastIndexOf(E1);s<0&&(s=0);for(let a=0;a<s;++a)n.charCodeAt(a)>=128&&en("not-basic"),e.push(n.charCodeAt(a));for(let a=s>0?s+1:0;a<t;){const u=r;for(let c=1,d=wt;;d+=wt){a>=t&&en("invalid-input");const f=s8(n.charCodeAt(a++));f>=wt&&en("invalid-input"),f>Ct((gr-r)/c)&&en("overflow"),r+=f*c;const h=d<=o?lc:d>=o+Ai?Ai:d-o;if(f<h)break;const p=wt-h;c>Ct(gr/p)&&en("overflow"),c*=p}const l=e.length+1;o=M1(r-u,l,u==0),Ct(r/l)>gr-i&&en("overflow"),i+=Ct(r/l),r%=l,e.splice(r++,0,i)}return String.fromCodePoint(...e)},D1=function(n){const e=[];n=_1(n);const t=n.length;let r=S1,i=0,o=C1;for(const u of n)u<128&&e.push(ru(u));const s=e.length;let a=s;for(s&&e.push(E1);a<t;){let u=gr;for(const c of n)c>=r&&c<u&&(u=c);const l=a+1;u-r>Ct((gr-i)/l)&&en("overflow"),i+=(u-r)*l,r=u;for(const c of n)if(c<r&&++i>gr&&en("overflow"),c===r){let d=i;for(let f=wt;;f+=wt){const h=f<=o?lc:f>=o+Ai?Ai:f-o;if(d<h)break;const p=d-h,m=wt-h;e.push(ru(Qf(h+p%m,0))),d=Ct(p/m)}e.push(ru(Qf(d,0))),o=M1(i,l,a===s),i=0,++a}++i,++r}return e.join("")},a8=function(n){return A1(n,function(e){return e8.test(e)?T1(e.slice(4).toLowerCase()):e})},u8=function(n){return A1(n,function(e){return t8.test(e)?"xn--"+D1(e):e})},L1={version:"2.3.1",ucs2:{decode:_1,encode:o8},decode:T1,encode:D1,toASCII:u8,toUnicode:a8},l8={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},c8={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},d8={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},f8={default:l8,zero:c8,commonmark:d8},h8=/^(vbscript|javascript|file|data):/,p8=/^data:image\/(gif|png|jpeg|webp);/;function m8(n){const e=n.trim().toLowerCase();return h8.test(e)?p8.test(e):!0}const O1=["http:","https:","mailto:"];function g8(n){const e=rc(n,!0);if(e.hostname&&(!e.protocol||O1.indexOf(e.protocol)>=0))try{e.hostname=L1.toASCII(e.hostname)}catch{}return Hi(nc(e))}function b8(n){const e=rc(n,!0);if(e.hostname&&(!e.protocol||O1.indexOf(e.protocol)>=0))try{e.hostname=L1.toUnicode(e.hostname)}catch{}return _r(nc(e),_r.defaultChars+"%")}function tt(n,e){if(!(this instanceof tt))return new tt(n,e);e||oc(n)||(e=n||{},n="default"),this.inline=new Fi,this.block=new na,this.core=new ac,this.renderer=new Lr,this.linkify=new qe,this.validateLink=m8,this.normalizeLink=g8,this.normalizeLinkText=b8,this.utils=vC,this.helpers=ea({},SC),this.options={},this.configure(n),e&&this.set(e)}tt.prototype.set=function(n){return ea(this.options,n),this};tt.prototype.configure=function(n){const e=this;if(oc(n)){const t=n;if(n=f8[t],!n)throw new Error('Wrong `markdown-it` preset "'+t+'", check name')}if(!n)throw new Error("Wrong `markdown-it` preset, can't be empty");return n.options&&e.set(n.options),n.components&&Object.keys(n.components).forEach(function(t){n.components[t].rules&&e[t].ruler.enableOnly(n.components[t].rules),n.components[t].rules2&&e[t].ruler2.enableOnly(n.components[t].rules2)}),this};tt.prototype.enable=function(n,e){let t=[];Array.isArray(n)||(n=[n]),["core","block","inline"].forEach(function(i){t=t.concat(this[i].ruler.enable(n,!0))},this),t=t.concat(this.inline.ruler2.enable(n,!0));const r=n.filter(function(i){return t.indexOf(i)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};tt.prototype.disable=function(n,e){let t=[];Array.isArray(n)||(n=[n]),["core","block","inline"].forEach(function(i){t=t.concat(this[i].ruler.disable(n,!0))},this),t=t.concat(this.inline.ruler2.disable(n,!0));const r=n.filter(function(i){return t.indexOf(i)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};tt.prototype.use=function(n){const e=[this].concat(Array.prototype.slice.call(arguments,1));return n.apply(n,e),this};tt.prototype.parse=function(n,e){if(typeof n!="string")throw new Error("Input data should be a String");const t=new this.core.State(n,this,e);return this.core.process(t),t.tokens};tt.prototype.render=function(n,e){return e=e||{},this.renderer.render(this.parse(n,e),this.options,e)};tt.prototype.parseInline=function(n,e){const t=new this.core.State(n,this,e);return t.inlineMode=!0,this.core.process(t),t.tokens};tt.prototype.renderInline=function(n,e){return e=e||{},this.renderer.render(this.parseInline(n,e),this.options,e)};const y8=new rp({nodes:{doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM(){return["p",0]}},blockquote:{content:"block+",group:"block",parseDOM:[{tag:"blockquote"}],toDOM(){return["blockquote",0]}},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM(){return["div",["hr"]]}},heading:{attrs:{level:{default:1}},content:"(text | image)*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM(n){return["h"+n.attrs.level,0]}},code_block:{content:"text*",group:"block",code:!0,defining:!0,marks:"",attrs:{params:{default:""}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:n=>({params:n.getAttribute("data-params")||""})}],toDOM(n){return["pre",n.attrs.params?{"data-params":n.attrs.params}:{},["code",0]]}},ordered_list:{content:"list_item+",group:"block",attrs:{order:{default:1},tight:{default:!1}},parseDOM:[{tag:"ol",getAttrs(n){return{order:n.hasAttribute("start")?+n.getAttribute("start"):1,tight:n.hasAttribute("data-tight")}}}],toDOM(n){return["ol",{start:n.attrs.order==1?null:n.attrs.order,"data-tight":n.attrs.tight?"true":null},0]}},bullet_list:{content:"list_item+",group:"block",attrs:{tight:{default:!1}},parseDOM:[{tag:"ul",getAttrs:n=>({tight:n.hasAttribute("data-tight")})}],toDOM(n){return["ul",{"data-tight":n.attrs.tight?"true":null},0]}},list_item:{content:"block+",defining:!0,parseDOM:[{tag:"li"}],toDOM(){return["li",0]}},text:{group:"inline"},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs(n){return{src:n.getAttribute("src"),title:n.getAttribute("title"),alt:n.getAttribute("alt")}}}],toDOM(n){return["img",n.attrs]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM(){return["br"]}}},marks:{em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"},{style:"font-style=normal",clearMark:n=>n.type.name=="em"}],toDOM(){return["em"]}},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name=="strong"},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}],toDOM(){return["strong"]}},link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs(n){return{href:n.getAttribute("href"),title:n.getAttribute("title")}}}],toDOM(n){return["a",n.attrs]}},code:{parseDOM:[{tag:"code"}],toDOM(){return["code"]}}}});function x8(n,e){if(n.isText&&e.isText&&Q.sameSet(n.marks,e.marks))return n.withText(n.text+e.text)}class v8{constructor(e,t){this.schema=e,this.tokenHandlers=t,this.stack=[{type:e.topNodeType,attrs:null,content:[],marks:Q.none}]}top(){return this.stack[this.stack.length-1]}push(e){this.stack.length&&this.top().content.push(e)}addText(e){if(!e)return;let t=this.top(),r=t.content,i=r[r.length-1],o=this.schema.text(e,t.marks),s;i&&(s=x8(i,o))?r[r.length-1]=s:r.push(o)}openMark(e){let t=this.top();t.marks=e.addToSet(t.marks)}closeMark(e){let t=this.top();t.marks=e.removeFromSet(t.marks)}parseTokens(e){for(let t=0;t<e.length;t++){let r=e[t],i=this.tokenHandlers[r.type];if(!i)throw new Error("Token type `"+r.type+"` not supported by Markdown parser");i(this,r,e,t)}}addNode(e,t,r){let i=this.top(),o=e.createAndFill(t,r,i?i.marks:[]);return o?(this.push(o),o):null}openNode(e,t){this.stack.push({type:e,attrs:t,content:[],marks:Q.none})}closeNode(){let e=this.stack.pop();return this.addNode(e.type,e.attrs,e.content)}}function Wr(n,e,t,r){return n.getAttrs?n.getAttrs(e,t,r):n.attrs instanceof Function?n.attrs(e):n.attrs}function iu(n,e){return n.noCloseToken||e=="code_inline"||e=="code_block"||e=="fence"}function eh(n){return n[n.length-1]==`
`?n.slice(0,n.length-1):n}function ou(){}function k8(n,e){let t=Object.create(null);for(let r in e){let i=e[r];if(i.block){let o=n.nodeType(i.block);iu(i,r)?t[r]=(s,a,u,l)=>{s.openNode(o,Wr(i,a,u,l)),s.addText(eh(a.content)),s.closeNode()}:(t[r+"_open"]=(s,a,u,l)=>s.openNode(o,Wr(i,a,u,l)),t[r+"_close"]=s=>s.closeNode())}else if(i.node){let o=n.nodeType(i.node);t[r]=(s,a,u,l)=>s.addNode(o,Wr(i,a,u,l))}else if(i.mark){let o=n.marks[i.mark];iu(i,r)?t[r]=(s,a,u,l)=>{s.openMark(o.create(Wr(i,a,u,l))),s.addText(eh(a.content)),s.closeMark(o)}:(t[r+"_open"]=(s,a,u,l)=>s.openMark(o.create(Wr(i,a,u,l))),t[r+"_close"]=s=>s.closeMark(o))}else if(i.ignore)iu(i,r)?t[r]=ou:(t[r+"_open"]=ou,t[r+"_close"]=ou);else throw new RangeError("Unrecognized parsing spec "+JSON.stringify(i))}return t.text=(r,i)=>r.addText(i.content),t.inline=(r,i)=>r.parseTokens(i.children),t.softbreak=t.softbreak||(r=>r.addText(" ")),t}let w8=class{constructor(e,t,r){this.schema=e,this.tokenizer=t,this.tokens=r,this.tokenHandlers=k8(e,r)}parse(e,t={}){let r=new v8(this.schema,this.tokenHandlers),i;r.parseTokens(this.tokenizer.parse(e,t));do i=r.closeNode();while(r.stack.length);return i||this.schema.topNodeType.createAndFill()}};function th(n,e){for(;++e<n.length;)if(n[e].type!="list_item_open")return n[e].hidden;return!1}new w8(y8,tt("commonmark",{html:!1}),{blockquote:{block:"blockquote"},paragraph:{block:"paragraph"},list_item:{block:"list_item"},bullet_list:{block:"bullet_list",getAttrs:(n,e,t)=>({tight:th(e,t)})},ordered_list:{block:"ordered_list",getAttrs:(n,e,t)=>({order:+n.attrGet("start")||1,tight:th(e,t)})},heading:{block:"heading",getAttrs:n=>({level:+n.tag.slice(1)})},code_block:{block:"code_block",noCloseToken:!0},fence:{block:"code_block",getAttrs:n=>({params:n.info||""}),noCloseToken:!0},hr:{node:"horizontal_rule"},image:{node:"image",getAttrs:n=>({src:n.attrGet("src"),title:n.attrGet("title")||null,alt:n.children[0]&&n.children[0].content||null})},hardbreak:{node:"hard_break"},em:{mark:"em"},strong:{mark:"strong"},link:{mark:"link",getAttrs:n=>({href:n.attrGet("href"),title:n.attrGet("title")||null})},code_inline:{mark:"code",noCloseToken:!0}});let C8=class{constructor(e,t,r={}){this.nodes=e,this.marks=t,this.options=r}serialize(e,t={}){t=Object.assign({},this.options,t);let r=new R1(this.nodes,this.marks,t);return r.renderContent(e),r.out}};const ct=new C8({blockquote(n,e){n.wrapBlock("> ",null,e,()=>n.renderContent(e))},code_block(n,e){const t=e.textContent.match(/`{3,}/gm),r=t?t.sort().slice(-1)[0]+"`":"```";n.write(r+(e.attrs.params||"")+`
`),n.text(e.textContent,!1),n.write(`
`),n.write(r),n.closeBlock(e)},heading(n,e){n.write(n.repeat("#",e.attrs.level)+" "),n.renderInline(e,!1),n.closeBlock(e)},horizontal_rule(n,e){n.write(e.attrs.markup||"---"),n.closeBlock(e)},bullet_list(n,e){n.renderList(e,"  ",()=>(e.attrs.bullet||"*")+" ")},ordered_list(n,e){let t=e.attrs.order||1,r=String(t+e.childCount-1).length,i=n.repeat(" ",r+2);n.renderList(e,i,o=>{let s=String(t+o);return n.repeat(" ",r-s.length)+s+". "})},list_item(n,e){n.renderContent(e)},paragraph(n,e){n.renderInline(e),n.closeBlock(e)},image(n,e){n.write("!["+n.esc(e.attrs.alt||"")+"]("+e.attrs.src.replace(/[\(\)]/g,"\\$&")+(e.attrs.title?' "'+e.attrs.title.replace(/"/g,'\\"')+'"':"")+")")},hard_break(n,e,t,r){for(let i=r+1;i<t.childCount;i++)if(t.child(i).type!=e.type){n.write(`\\
`);return}},text(n,e){n.text(e.text,!n.inAutolink)}},{em:{open:"*",close:"*",mixable:!0,expelEnclosingWhitespace:!0},strong:{open:"**",close:"**",mixable:!0,expelEnclosingWhitespace:!0},link:{open(n,e,t,r){return n.inAutolink=S8(e,t,r),n.inAutolink?"<":"["},close(n,e,t,r){let{inAutolink:i}=n;return n.inAutolink=void 0,i?">":"]("+e.attrs.href.replace(/[\(\)"]/g,"\\$&")+(e.attrs.title?` "${e.attrs.title.replace(/"/g,'\\"')}"`:"")+")"},mixable:!0},code:{open(n,e,t,r){return nh(t.child(r),-1)},close(n,e,t,r){return nh(t.child(r-1),1)},escape:!1}});function nh(n,e){let t=/`+/g,r,i=0;if(n.isText)for(;r=t.exec(n.text);)i=Math.max(i,r[0].length);let o=i>0&&e>0?" `":"`";for(let s=0;s<i;s++)o+="`";return i>0&&e<0&&(o+=" "),o}function S8(n,e,t){if(n.attrs.title||!/^\w+:/.test(n.attrs.href))return!1;let r=e.child(t);return!r.isText||r.text!=n.attrs.href||r.marks[r.marks.length-1]!=n?!1:t==e.childCount-1||!n.isInSet(e.child(t+1).marks)}let R1=class{constructor(e,t,r){this.nodes=e,this.marks=t,this.options=r,this.delim="",this.out="",this.closed=null,this.inAutolink=void 0,this.atBlockStart=!1,this.inTightList=!1,typeof this.options.tightLists>"u"&&(this.options.tightLists=!1),typeof this.options.hardBreakNodeName>"u"&&(this.options.hardBreakNodeName="hard_break")}flushClose(e=2){if(this.closed){if(this.atBlank()||(this.out+=`
`),e>1){let t=this.delim,r=/\s+$/.exec(t);r&&(t=t.slice(0,t.length-r[0].length));for(let i=1;i<e;i++)this.out+=t+`
`}this.closed=null}}wrapBlock(e,t,r,i){let o=this.delim;this.write(t??e),this.delim+=e,i(),this.delim=o,this.closeBlock(r)}atBlank(){return/(^|\n)$/.test(this.out)}ensureNewLine(){this.atBlank()||(this.out+=`
`)}write(e){this.flushClose(),this.delim&&this.atBlank()&&(this.out+=this.delim),e&&(this.out+=e)}closeBlock(e){this.closed=e}text(e,t=!0){let r=e.split(`
`);for(let i=0;i<r.length;i++)this.write(),!t&&r[i][0]=="["&&/(^|[^\\])\!$/.test(this.out)&&(this.out=this.out.slice(0,this.out.length-1)+"\\!"),this.out+=t?this.esc(r[i],this.atBlockStart):r[i],i!=r.length-1&&(this.out+=`
`)}render(e,t,r){if(!this.nodes[e.type.name])throw new Error("Token type `"+e.type.name+"` not supported by Markdown renderer");this.nodes[e.type.name](this,e,t,r)}renderContent(e){e.forEach((t,r,i)=>this.render(t,e,i))}renderInline(e,t=!0){this.atBlockStart=t;let r=[],i="",o=(s,a,u)=>{let l=s?s.marks:[];s&&s.type.name===this.options.hardBreakNodeName&&(l=l.filter(m=>{if(u+1==e.childCount)return!1;let g=e.child(u+1);return m.isInSet(g.marks)&&(!g.isText||/\S/.test(g.text))}));let c=i;if(i="",s&&s.isText&&l.some(m=>{let g=this.marks[m.type.name];return g&&g.expelEnclosingWhitespace&&!m.isInSet(r)})){let[m,g,y]=/^(\s*)(.*)$/m.exec(s.text);g&&(c+=g,s=y?s.withText(y):null,s||(l=r))}if(s&&s.isText&&l.some(m=>{let g=this.marks[m.type.name];return g&&g.expelEnclosingWhitespace&&(u==e.childCount-1||!m.isInSet(e.child(u+1).marks))})){let[m,g,y]=/^(.*?)(\s*)$/m.exec(s.text);y&&(i=y,s=g?s.withText(g):null,s||(l=r))}let d=l.length?l[l.length-1]:null,f=d&&this.marks[d.type.name].escape===!1,h=l.length-(f?1:0);e:for(let m=0;m<h;m++){let g=l[m];if(!this.marks[g.type.name].mixable)break;for(let y=0;y<r.length;y++){let x=r[y];if(!this.marks[x.type.name].mixable)break;if(g.eq(x)){m>y?l=l.slice(0,y).concat(g).concat(l.slice(y,m)).concat(l.slice(m+1,h)):y>m&&(l=l.slice(0,m).concat(l.slice(m+1,y)).concat(g).concat(l.slice(y,h)));continue e}}}let p=0;for(;p<Math.min(r.length,h)&&l[p].eq(r[p]);)++p;for(;p<r.length;)this.text(this.markString(r.pop(),!1,e,u),!1);if(c&&this.text(c),s){for(;r.length<h;){let m=l[r.length];r.push(m),this.text(this.markString(m,!0,e,u),!1),this.atBlockStart=!1}f&&s.isText?this.text(this.markString(d,!0,e,u)+s.text+this.markString(d,!1,e,u+1),!1):this.render(s,e,u),this.atBlockStart=!1}s!=null&&s.isText&&s.nodeSize>0&&(this.atBlockStart=!1)};e.forEach(o),o(null,0,e.childCount),this.atBlockStart=!1}renderList(e,t,r){this.closed&&this.closed.type==e.type?this.flushClose(3):this.inTightList&&this.flushClose(1);let i=typeof e.attrs.tight<"u"?e.attrs.tight:this.options.tightLists,o=this.inTightList;this.inTightList=i,e.forEach((s,a,u)=>{u&&i&&this.flushClose(1),this.wrapBlock(t,r(u),e,()=>this.render(s,e,u))}),this.inTightList=o}esc(e,t=!1){return e=e.replace(/[`*\\~\[\]_]/g,(r,i)=>r=="_"&&i>0&&i+1<e.length&&e[i-1].match(/\w/)&&e[i+1].match(/\w/)?r:"\\"+r),t&&(e=e.replace(/^(\+[ ]|[\-*>])/,"\\$&").replace(/^(\s*)(#{1,6})(\s|$)/,"$1\\$2$3").replace(/^(\s*\d+)\.\s/,"$1\\. ")),this.options.escapeExtraCharacters&&(e=e.replace(this.options.escapeExtraCharacters,"\\$&")),e}quote(e){let t=e.indexOf('"')==-1?'""':e.indexOf("'")==-1?"''":"()";return t[0]+e+t[1]}repeat(e,t){let r="";for(let i=0;i<t;i++)r+=e;return r}markString(e,t,r,i){let o=this.marks[e.type.name],s=t?o.open:o.close;return typeof s=="string"?s:s(this,e,r,i)}getEnclosingWhitespace(e){return{leading:(e.match(/^(\s+)/)||[void 0])[0],trailing:(e.match(/(\s+)$/)||[void 0])[0]}}};var ee={};const E8="",A8="",_8="",M8="",T8="",D8="",L8="",O8="",R8="",N8="",H8="",I8="",F8="",P8="",B8="",$8="",z8="",V8="",q8="",j8="",U8="",W8="",Z8="",K8="",G8="",J8="",Y8="&",X8="&",Q8="",eS="",tS="",nS="",rS="",iS="",oS="",sS="",aS="",uS="",lS="",cS="",dS="",fS="",hS="",pS="",mS="",gS="",bS="",yS="",xS="",vS="",kS="",wS="",CS="",SS="",ES="",AS="",_S="",MS="",TS="",DS="",LS="",OS="'",RS="",NS="",HS="",IS="",FS="",PS="",BS="",$S="",zS="*",VS="",qS="",jS="",US="",WS="",ZS="",KS="",GS="",JS="",YS="",XS="",QS="",e9="",t9="",n9="",r9="",i9="",o9="",s9="",a9="",u9="",l9="",c9="",d9="",f9="",h9="",p9="",m9="",g9="",b9="",y9="",x9="",v9="",k9="",w9="",C9="",S9="",E9="",A9="",_9="",M9="",T9="",D9="",L9="",O9="",R9="",N9="",H9="",I9="",F9="",P9="",B9="",$9="",z9="",V9="",q9="",j9="",U9="",W9="",Z9="",K9="",G9="",J9="",Y9="=",X9="",Q9="",eE="",tE="",nE="",rE="",iE="",oE="",sE="",aE="",uE="",lE="",cE="",dE="",fE="",hE="",pE="",mE="",gE="",bE="",yE="",xE="",vE="",kE="",wE="",CE="",SE="",EE="",AE="",_E="",ME="",TE="",DE="",LE="",OE="",RE="",NE="",HE="",IE="",FE="",PE="",BE="",$E="",zE="",VE="",qE="",jE="",UE="",WE="",ZE="",KE="",GE="",JE="",YE="",XE="",QE="",eA="",tA="",nA="",rA="",iA="",oA="",sA="\\",aA="",uA="",lA="",cA="",dA="",fA="",hA="",pA="",mA="",gA="",bA="",yA="",xA="",vA="",kA="",wA="",CA="",SA="",EA="",AA="",_A="",MA="",TA="",DA="",LA="",OA="",RA="",NA="",HA="",IA="",FA="",PA="",BA="",$A="",zA="",VA="",qA="",jA="",UA="",WA="",ZA="",KA="",GA="",JA="",YA="",XA="",QA="",e7="",t7="",n7="",r7="",i7="",o7="",s7="",a7="",u7="",l7="",c7="",d7="",f7="",h7="",p7="",m7="",g7="",b7="",y7="",x7="",v7="",k7="",w7="",C7="",S7="",E7=":",A7="",_7="",M7="",T7="",D7=",",L7="@",O7="",R7="",N7="",H7="",I7="",F7="",P7="",B7="",$7="",z7="",V7="",q7="",j7="",U7="",W7="",Z7="",K7="",G7="",J7="",Y7="",X7="",Q7="",e_="",t_="",n_="",r_="",i_="",o_="",s_="",a_="",u_="",l_="",c_="",d_="",f_="",h_="",p_="",m_="",g_="",b_="",y_="",x_="",v_="",k_="",w_="",C_="",S_="",E_="",A_="",__="",M_="",T_="",D_="",L_="",O_="",R_="",N_="",H_="",I_="",F_="",P_="",B_="",$_="",z_="",V_="",q_="",j_="",U_="",W_="",Z_="",K_="",G_="",J_="",Y_="",X_="",Q_="",eM="",tM="",nM="",rM="",iM="",oM="",sM="",aM="",uM="",lM="",cM="",dM="",fM="",hM="",pM="",mM="",gM="`",bM="",yM="",xM="",vM="",kM="",wM="",CM="",SM="",EM="",AM="",_M="",MM="",TM="",DM="",LM="",OM="",RM="",NM="",HM="$",IM="",FM="",PM="",BM="",$M="",zM="",VM="",qM="",jM="",UM="",WM="",ZM="",KM="",GM="",JM="",YM="",XM="",QM="",eT="",tT="",nT="",rT="",iT="",oT="",sT="",aT="",uT="",lT="",cT="",dT="",fT="",hT="",pT="",mT="",gT="",bT="",yT="",xT="",vT="",kT="",wT="",CT="",ST="",ET="",AT="",_T="",MT="",TT="",DT="",LT="",OT="",RT="",NT="",HT="",IT="",FT="",PT="",BT="",$T="",zT="",VT="",qT="",jT="",UT="",WT="",ZT="",KT="",GT="",JT="",YT="",XT="",QT="",eD="",tD="",nD="",rD="",iD="",oD="",sD="",aD="",uD="",lD="",cD="",dD="",fD="",hD="",pD="",mD="",gD="",bD="",yD="",xD="",vD="",kD="",wD="",CD="",SD="",ED="",AD="",_D="",MD="",TD="",DD="",LD="",OD="",RD="",ND="",HD="",ID="",FD="",PD="",BD="",$D="",zD="",VD="",qD="",jD="",UD="",WD="",ZD="",KD="",GD="",JD="",YD="=",XD="",QD="",eL="",tL="",nL="",rL="",iL="",oL="",sL="",aL="",uL="",lL="",cL="",dL="",fL="",hL="",pL="",mL="",gL="",bL="",yL="!",xL="",vL="",kL="",wL="",CL="",SL="",EL="",AL="",_L="",ML="",TL="",DL="",LL="",OL="",RL="",NL="",HL="",IL="fj",FL="",PL="",BL="",$L="",zL="",VL="",qL="",jL="",UL="",WL="",ZL="",KL="",GL="",JL="",YL="",XL="",QL="",eO="",tO="",nO="",rO="",iO="",oO="",sO="",aO="",uO="",lO="",cO="",dO="",fO="",hO="",pO="",mO="",gO="",bO="",yO="",xO="",vO="",kO="",wO="",CO="",SO="",EO="",AO="",_O="",MO="",TO="",DO="",LO="",OO="",RO="",NO="",HO="",IO="",FO="",PO="",BO="",$O="",zO="",VO="",qO="",jO="",UO="",WO="",ZO="",KO="",GO="",JO="",YO="",XO="",QO="",eR="",tR="",nR="",rR="",iR="",oR="",sR="",aR="",uR="",lR="",cR="`",dR="",fR="",hR="",pR="",mR="",gR="",bR="",yR="",xR="",vR="",kR="",wR="",CR="",SR="",ER=">",AR=">",_R="",MR="",TR="",DR="",LR="",OR="",RR="",NR="",HR="",IR="",FR="",PR="",BR="",$R="",zR="",VR="",qR="",jR="",UR="",WR="",ZR="",KR="",GR="",JR="^",YR="",XR="",QR="",eN="",tN="",nN="",rN="",iN="",oN="",sN="",aN="",uN="",lN="",cN="",dN="",fN="",hN="",pN="",mN="",gN="",bN="",yN="",xN="",vN="",kN="",wN="",CN="",SN="",EN="",AN="",_N="",MN="",TN="",DN="",LN="",ON="",RN="",NN="",HN="",IN="",FN="",PN="",BN="",$N="",zN="",VN="",qN="",jN="",UN="",WN="",ZN="",KN="",GN="",JN="",YN="",XN="",QN="",eH="",tH="",nH="",rH="",iH="",oH="",sH="",aH="",uH="",lH="",cH="",dH="",fH="",hH="",pH="",mH="",gH="",bH="",yH="",xH="",vH="",kH="",wH="",CH="",SH="",EH="",AH="",_H="",MH="",TH="",DH="",LH="",OH="",RH="",NH="",HH="",IH="",FH="",PH="",BH="",$H="",zH="",VH="",qH="",jH="",UH="",WH="",ZH="",KH="",GH="",JH="",YH="",XH="",QH="",eI="",tI="",nI="",rI="",iI="",oI="",sI="",aI="",uI="",lI="",cI="",dI="",fI="",hI="",pI="",mI="",gI="",bI="",yI="",xI="",vI="",kI="",wI="",CI="",SI="",EI="",AI="",_I="",MI="",TI="",DI="",LI="",OI="",RI="",NI="",HI="",II="",FI="",PI="",BI="",$I="",zI="",VI="",qI="",jI="",UI="",WI="",ZI="",KI="",GI="",JI="",YI="",XI="",QI="",eF="",tF="",nF="",rF="",iF="{",oF="[",sF="",aF="",uF="",lF="",cF="",dF="",fF="",hF="",pF="{",mF="",gF="",bF="",yF="",xF="",vF="",kF="",wF="",CF="",SF="",EF="",AF="",_F="",MF="",TF="",DF="",LF="",OF="",RF="",NF="",HF="",IF="",FF="",PF="",BF="",$F="",zF="",VF="",qF="",jF="",UF="",WF="",ZF="",KF="",GF="",JF="",YF="",XF="",QF="",eP="",tP="",nP="",rP="",iP="",oP="",sP="",aP="",uP="",lP="",cP="",dP="",fP="",hP="",pP="",mP="",gP="",bP="",yP="",xP="",vP="",kP="",wP="",CP="",SP="",EP="",AP="",_P="",MP="",TP="",DP="",LP="",OP="",RP="",NP="",HP="",IP="",FP="",PP="",BP="",$P="",zP="",VP="",qP="",jP="",UP="",WP="",ZP="",KP="",GP="",JP="",YP="",XP="",QP="",eB="",tB="",nB="",rB="",iB="",oB="",sB="",aB="",uB="",lB="",cB="",dB="",fB="",hB="",pB="",mB="",gB="",bB="",yB="",xB="",vB="",kB="",wB="",CB="",SB="",EB="",AB="",_B="",MB="",TB="_",DB="",LB="",OB="",RB="",NB="",HB="(",IB="",FB="",PB="",BB="",$B="",zB="",VB="",qB="",jB="",UB="",WB="",ZB="",KB="",GB="",JB="",YB="[",XB="",QB="",e$="",t$="",n$="",r$="",i$="<",o$="<",s$="",a$="",u$="",l$="",c$="",d$="",f$="",h$="",p$="",m$="",g$="",b$="",y$="",x$="",v$="",k$="",w$="",C$="",S$="",E$="",A$="",_$="",M$="",T$="",D$="",L$="",O$="",R$="",N$="",H$="",I$="",F$="",P$="",B$="",$$="",z$="",V$="*",q$="",j$="",U$="",W$="",Z$="",K$="",G$="",J$="",Y$="",X$="",Q$="",ez="",tz="",nz="",rz="",iz="",oz="",sz="",az="",uz="",lz="",cz="",dz="",fz="",hz="",pz="",mz="",gz="",bz="",yz="",xz="",vz="",kz="",wz="",Cz="",Sz="",Ez="",Az="",_z="",Mz="",Tz="",Dz="",Lz="",Oz="",Rz="",Nz="",Hz="",Iz="",Fz="",Pz="",Bz="",$z="",zz="",Vz="",qz="",jz="",Uz="",Wz="",Zz="",Kz="",Gz="",Jz="",Yz="",Xz=`
`,Qz="",eV="",tV="",nV="",rV="",iV="",oV="",sV="",aV="",uV="",lV="",cV="",dV="",fV="",hV="",pV="",mV="",gV="",bV="",yV="",xV="",vV="",kV="",wV="",CV="",SV="",EV="",AV="",_V="",MV="",TV="",DV="",LV="",OV="",RV="",NV="",HV="",IV="",FV="",PV="",BV="",$V="",zV="",VV="",qV="",jV="",UV="",WV="",ZV="",KV="",GV="",JV="",YV="",XV="",QV="",eq="",tq="",nq="",rq="",iq="",oq="",sq="",aq="",uq="",lq="",cq="",dq="",fq="",hq="",pq="",mq="",gq="",bq="",yq="",xq="",vq="",kq="",wq="",Cq="",Sq="",Eq="",Aq="",_q="",Mq="",Tq="",Dq="",Lq="",Oq="",Rq="",Nq="",Hq="",Iq="",Fq="",Pq="",Bq="",$q="",zq="",Vq="",qq="",jq="",Uq="",Wq="",Zq="",Kq="",Gq="",Jq="",Yq="",Xq="",Qq="",ej="",tj="",nj="",rj="",ij="",oj="",sj="",aj="",uj="",lj="",cj="",dj="",fj="",hj="",pj="",mj="",gj="",bj="",yj="",xj="",vj="",kj="",wj="",Cj="",Sj="",Ej="",Aj="",_j="",Mj="",Tj="",Dj="",Lj="",Oj="",Rj="",Nj="",Hj="",Ij="",Fj="",Pj="",Bj="",$j="",zj="",Vj="",qj="",jj="",Uj="",Wj="",Zj="",Kj="",Gj="",Jj="",Yj="",Xj="",Qj="",eU="",tU="",nU="",rU="",iU="",oU="",sU="",aU="#",uU="",lU="",cU="",dU="",fU="",hU="",pU="",mU="",gU=">",bU="",yU="",xU="",vU="",kU="<",wU="",CU="",SU="",EU="",AU="",_U="",MU="",TU="",DU="",LU="",OU="",RU="",NU="",HU="",IU="",FU="",PU="",BU="",$U="",zU="",VU="",qU="",jU="",UU="",WU="",ZU="",KU="",GU="",JU="",YU="",XU="",QU="",eW="",tW="",nW="",rW="",iW="",oW="",sW="",aW="",uW="",lW="",cW="",dW="",fW="",hW="",pW="",mW="",gW="",bW="",yW="",xW="",vW="",kW="",wW="",CW="",SW="",EW="",AW="",_W="",MW="",TW="",DW="",LW="",OW="",RW="",NW="",HW="",IW="",FW="",PW="",BW="",$W="",zW="",VW="",qW="",jW="",UW="",WW="",ZW="",KW="",GW="",JW="",YW="",XW="",QW="",eZ="",tZ="",nZ="",rZ="",iZ="",oZ="",sZ="",aZ="",uZ="%",lZ=".",cZ="",dZ="",fZ="",hZ="",pZ="",mZ="",gZ="",bZ="",yZ="",xZ="",vZ="",kZ="",wZ="",CZ="",SZ="",EZ="",AZ="",_Z="",MZ="",TZ="",DZ="+",LZ="",OZ="",RZ="",NZ="",HZ="",IZ="",FZ="",PZ="",BZ="",$Z="",zZ="",VZ="",qZ="",jZ="",UZ="",WZ="",ZZ="",KZ="",GZ="",JZ="",YZ="",XZ="",QZ="",eK="",tK="",nK="",rK="",iK="",oK="",sK="",aK="",uK="",lK="",cK="",dK="",fK="",hK="",pK="",mK="",gK="",bK="",yK="",xK="",vK="",kK="",wK="",CK="",SK="",EK="",AK="",_K="",MK="",TK="",DK="",LK="",OK="",RK="",NK="",HK="",IK="",FK="",PK="",BK="",$K="?",zK="",VK='"',qK='"',jK="",UK="",WK="",ZK="",KK="",GK="",JK="",YK="",XK="",QK="",eG="",tG="",nG="",rG="",iG="",oG="",sG="",aG="",uG="",lG="",cG="",dG="",fG="",hG="",pG="",mG="",gG="",bG="",yG="",xG="",vG="",kG="",wG="",CG="",SG="",EG="}",AG="]",_G="",MG="",TG="",DG="",LG="",OG="",RG="",NG="",HG="}",IG="",FG="",PG="",BG="",$G="",zG="",VG="",qG="",jG="",UG="",WG="",ZG="",KG="",GG="",JG="",YG="",XG="",QG="",eJ="",tJ="",nJ="",rJ="",iJ="",oJ="",sJ="",aJ="",uJ="",lJ="",cJ="",dJ="",fJ="",hJ="",pJ="",mJ="",gJ="",bJ="",yJ="",xJ="",vJ="",kJ="",wJ="",CJ="",SJ="",EJ="",AJ="",_J="",MJ="",TJ="",DJ="",LJ="",OJ="",RJ="",NJ="",HJ="",IJ="",FJ="",PJ="",BJ="",$J="",zJ="",VJ="",qJ="",jJ="",UJ="",WJ="",ZJ="",KJ="",GJ="",JJ="",YJ="",XJ="",QJ="",eY="",tY="",nY="",rY="",iY="",oY="",sY=")",aY="",uY="",lY="",cY="",dY="",fY="",hY="",pY="",mY="",gY="]",bY="",yY="",xY="",vY="",kY="",wY="",CY="",SY="",EY="",AY="",_Y="",MY="",TY="",DY="",LY="",OY="",RY="",NY="",HY="",IY="",FY="",PY="",BY="",$Y="",zY="",VY="",qY="",jY="",UY="",WY="",ZY="",KY="",GY="",JY="",YY="",XY="",QY="",eX="",tX="",nX="",rX="",iX=";",oX="",sX="",aX="",uX="",lX="",cX="",dX="",fX="",hX="",pX="",mX="",gX="",bX="",yX="",xX="",vX="",kX="",wX="",CX="",SX="",EX="",AX="",_X="",MX="",TX="",DX="",LX="",OX="",RX="",NX="",HX="",IX="",FX="",PX="",BX="",$X="",zX="",VX="",qX="",jX="",UX="",WX="",ZX="",KX="",GX="",JX="",YX="",XX="",QX="/",eQ="",tQ="",nQ="",rQ="",iQ="",oQ="",sQ="",aQ="",uQ="",lQ="",cQ="",dQ="",fQ="",hQ="",pQ="",mQ="",gQ="",bQ="",yQ="",xQ="",vQ="",kQ="",wQ="",CQ="",SQ="",EQ="",AQ="",_Q="",MQ="",TQ="",DQ="",LQ="",OQ="",RQ="",NQ="",HQ="",IQ="",FQ="",PQ="",BQ="",$Q="",zQ="",VQ="",qQ="",jQ="",UQ="",WQ="",ZQ="",KQ="",GQ="",JQ="",YQ="",XQ="",QQ="",eee="",tee="",nee="",ree="",iee="",oee="",see="",aee="",uee="",lee="",cee="",dee="",fee="",hee="",pee="",mee="",gee="",bee="",yee="",xee="",vee="",kee="",wee="",Cee="",See="",Eee="",Aee="",_ee="",Mee="",Tee="",Dee="",Lee="",Oee="",Ree="",Nee="",Hee="",Iee="",Fee="",Pee="",Bee="",$ee="",zee="",Vee="",qee="",jee="",Uee="",Wee="",Zee="",Kee="",Gee="",Jee="",Yee="",Xee="",Qee="",ete="",tte="",nte="",rte="",ite="	",ote="",ste="",ate="",ute="",lte="",cte="",dte="",fte="",hte="",pte="",mte="",gte="",bte="",yte="",xte="",vte="",kte="",wte="",Cte="",Ste="",Ete="",Ate="",_te="",Mte="",Tte="",Dte="",Lte="",Ote="",Rte="",Nte="",Hte="",Ite="",Fte="",Pte="",Bte="",$te="",zte="",Vte="",qte="",jte="",Ute="",Wte="",Zte="",Kte="",Gte="",Jte="",Yte="",Xte="",Qte="",ene="",tne="",nne="",rne="",ine="",one="",sne="",ane="",une="",lne="",cne="",dne="",fne="",hne="",pne="",mne="",gne="",bne="",yne="",xne="",vne="",kne="",wne="",Cne="",Sne="",Ene="",Ane="",_ne="",Mne="",Tne="",Dne="",Lne="",One="",Rne="",Nne="",Hne="",Ine="",Fne="",Pne="",Bne="",$ne="",zne="",Vne="",qne="",jne="",Une="",Wne="",Zne="",Kne="",Gne="",Jne="",Yne="",Xne="",Qne="",ere="",tre="",nre="",rre="",ire="",ore="",sre="",are="",ure="_",lre="",cre="",dre="",fre="",hre="",pre="",mre="",gre="",bre="",yre="",xre="",vre="",kre="",wre="",Cre="",Sre="",Ere="",Are="",_re="",Mre="",Tre="",Dre="",Lre="",Ore="",Rre="",Nre="",Hre="",Ire="",Fre="",Pre="",Bre="",$re="",zre="",Vre="",qre="",jre="",Ure="",Wre="",Zre="",Kre="",Gre="",Jre="",Yre="",Xre="",Qre="",eie="",tie="",nie="",rie="",iie="",oie="",sie="",aie="",uie="",lie="",cie="",die="",fie="",hie="",pie="",mie="",gie="",bie="",yie="",xie="",vie="",kie="",wie="",Cie="",Sie="",Eie="",Aie="",_ie="",Mie="",Tie="",Die="",Lie="",Oie="",Rie="",Nie="",Hie="",Iie="|",Fie="",Pie="|",Bie="",$ie="",zie="|",Vie="",qie="",jie="",Uie="",Wie="",Zie="",Kie="",Gie="",Jie="",Yie="",Xie="",Qie="",eoe="",toe="",noe="",roe="",ioe="",ooe="",soe="",aoe="",uoe="",loe="",coe="",doe="",foe="",hoe="",poe="",moe="",goe="",boe="",yoe="",xoe="",voe="",koe="",woe="",Coe="",Soe="",Eoe="",Aoe="",_oe="",Moe="",Toe="",Doe="",Loe="",Ooe="",Roe="",Noe="",Hoe="",Ioe="",Foe="",Poe="",Boe="",$oe="",zoe="",Voe="",qoe="",joe="",Uoe="",Woe="",Zoe="",Koe="",Goe="",Joe="",Yoe="",Xoe="",Qoe="",ese="",tse="",nse="",rse="",ise="",ose="",sse="",ase="",use="",lse="",cse="",dse="",fse="",hse="",pse="",mse="",gse="",bse="",yse="",xse="",vse="",kse="",wse="",Cse="",Sse="",Ese="",Ase="",_se="",Mse="",Tse="",Dse="",Lse="",Ose="",Rse="",Nse="",Hse="",Ise="",Fse="",Pse="",Bse="",$se="",zse="",Vse={Aacute:E8,aacute:A8,Abreve:_8,abreve:M8,ac:T8,acd:D8,acE:L8,Acirc:O8,acirc:R8,acute:N8,Acy:H8,acy:I8,AElig:F8,aelig:P8,af:B8,Afr:$8,afr:z8,Agrave:V8,agrave:q8,alefsym:j8,aleph:U8,Alpha:W8,alpha:Z8,Amacr:K8,amacr:G8,amalg:J8,amp:Y8,AMP:X8,andand:Q8,And:eS,and:tS,andd:nS,andslope:rS,andv:iS,ang:oS,ange:sS,angle:aS,angmsdaa:uS,angmsdab:lS,angmsdac:cS,angmsdad:dS,angmsdae:fS,angmsdaf:hS,angmsdag:pS,angmsdah:mS,angmsd:gS,angrt:bS,angrtvb:yS,angrtvbd:xS,angsph:vS,angst:kS,angzarr:wS,Aogon:CS,aogon:SS,Aopf:ES,aopf:AS,apacir:_S,ap:MS,apE:TS,ape:DS,apid:LS,apos:OS,ApplyFunction:RS,approx:NS,approxeq:HS,Aring:IS,aring:FS,Ascr:PS,ascr:BS,Assign:$S,ast:zS,asymp:VS,asympeq:qS,Atilde:jS,atilde:US,Auml:WS,auml:ZS,awconint:KS,awint:GS,backcong:JS,backepsilon:YS,backprime:XS,backsim:QS,backsimeq:e9,Backslash:t9,Barv:n9,barvee:r9,barwed:i9,Barwed:o9,barwedge:s9,bbrk:a9,bbrktbrk:u9,bcong:l9,Bcy:c9,bcy:d9,bdquo:f9,becaus:h9,because:p9,Because:m9,bemptyv:g9,bepsi:b9,bernou:y9,Bernoullis:x9,Beta:v9,beta:k9,beth:w9,between:C9,Bfr:S9,bfr:E9,bigcap:A9,bigcirc:_9,bigcup:M9,bigodot:T9,bigoplus:D9,bigotimes:L9,bigsqcup:O9,bigstar:R9,bigtriangledown:N9,bigtriangleup:H9,biguplus:I9,bigvee:F9,bigwedge:P9,bkarow:B9,blacklozenge:$9,blacksquare:z9,blacktriangle:V9,blacktriangledown:q9,blacktriangleleft:j9,blacktriangleright:U9,blank:W9,blk12:Z9,blk14:K9,blk34:G9,block:J9,bne:Y9,bnequiv:X9,bNot:Q9,bnot:eE,Bopf:tE,bopf:nE,bot:rE,bottom:iE,bowtie:oE,boxbox:sE,boxdl:aE,boxdL:uE,boxDl:lE,boxDL:cE,boxdr:dE,boxdR:fE,boxDr:hE,boxDR:pE,boxh:mE,boxH:gE,boxhd:bE,boxHd:yE,boxhD:xE,boxHD:vE,boxhu:kE,boxHu:wE,boxhU:CE,boxHU:SE,boxminus:EE,boxplus:AE,boxtimes:_E,boxul:ME,boxuL:TE,boxUl:DE,boxUL:LE,boxur:OE,boxuR:RE,boxUr:NE,boxUR:HE,boxv:IE,boxV:FE,boxvh:PE,boxvH:BE,boxVh:$E,boxVH:zE,boxvl:VE,boxvL:qE,boxVl:jE,boxVL:UE,boxvr:WE,boxvR:ZE,boxVr:KE,boxVR:GE,bprime:JE,breve:YE,Breve:XE,brvbar:QE,bscr:eA,Bscr:tA,bsemi:nA,bsim:rA,bsime:iA,bsolb:oA,bsol:sA,bsolhsub:aA,bull:uA,bullet:lA,bump:cA,bumpE:dA,bumpe:fA,Bumpeq:hA,bumpeq:pA,Cacute:mA,cacute:gA,capand:bA,capbrcup:yA,capcap:xA,cap:vA,Cap:kA,capcup:wA,capdot:CA,CapitalDifferentialD:SA,caps:EA,caret:AA,caron:_A,Cayleys:MA,ccaps:TA,Ccaron:DA,ccaron:LA,Ccedil:OA,ccedil:RA,Ccirc:NA,ccirc:HA,Cconint:IA,ccups:FA,ccupssm:PA,Cdot:BA,cdot:$A,cedil:zA,Cedilla:VA,cemptyv:qA,cent:jA,centerdot:UA,CenterDot:WA,cfr:ZA,Cfr:KA,CHcy:GA,chcy:JA,check:YA,checkmark:XA,Chi:QA,chi:e7,circ:t7,circeq:n7,circlearrowleft:r7,circlearrowright:i7,circledast:o7,circledcirc:s7,circleddash:a7,CircleDot:u7,circledR:l7,circledS:c7,CircleMinus:d7,CirclePlus:f7,CircleTimes:h7,cir:p7,cirE:m7,cire:g7,cirfnint:b7,cirmid:y7,cirscir:x7,ClockwiseContourIntegral:v7,CloseCurlyDoubleQuote:k7,CloseCurlyQuote:w7,clubs:C7,clubsuit:S7,colon:E7,Colon:A7,Colone:_7,colone:M7,coloneq:T7,comma:D7,commat:L7,comp:O7,compfn:R7,complement:N7,complexes:H7,cong:I7,congdot:F7,Congruent:P7,conint:B7,Conint:$7,ContourIntegral:z7,copf:V7,Copf:q7,coprod:j7,Coproduct:U7,copy:W7,COPY:Z7,copysr:K7,CounterClockwiseContourIntegral:G7,crarr:J7,cross:Y7,Cross:X7,Cscr:Q7,cscr:e_,csub:t_,csube:n_,csup:r_,csupe:i_,ctdot:o_,cudarrl:s_,cudarrr:a_,cuepr:u_,cuesc:l_,cularr:c_,cularrp:d_,cupbrcap:f_,cupcap:h_,CupCap:p_,cup:m_,Cup:g_,cupcup:b_,cupdot:y_,cupor:x_,cups:v_,curarr:k_,curarrm:w_,curlyeqprec:C_,curlyeqsucc:S_,curlyvee:E_,curlywedge:A_,curren:__,curvearrowleft:M_,curvearrowright:T_,cuvee:D_,cuwed:L_,cwconint:O_,cwint:R_,cylcty:N_,dagger:H_,Dagger:I_,daleth:F_,darr:P_,Darr:B_,dArr:$_,dash:z_,Dashv:V_,dashv:q_,dbkarow:j_,dblac:U_,Dcaron:W_,dcaron:Z_,Dcy:K_,dcy:G_,ddagger:J_,ddarr:Y_,DD:X_,dd:Q_,DDotrahd:eM,ddotseq:tM,deg:nM,Del:rM,Delta:iM,delta:oM,demptyv:sM,dfisht:aM,Dfr:uM,dfr:lM,dHar:cM,dharl:dM,dharr:fM,DiacriticalAcute:hM,DiacriticalDot:pM,DiacriticalDoubleAcute:mM,DiacriticalGrave:gM,DiacriticalTilde:bM,diam:yM,diamond:xM,Diamond:vM,diamondsuit:kM,diams:wM,die:CM,DifferentialD:SM,digamma:EM,disin:AM,div:_M,divide:MM,divideontimes:TM,divonx:DM,DJcy:LM,djcy:OM,dlcorn:RM,dlcrop:NM,dollar:HM,Dopf:IM,dopf:FM,Dot:PM,dot:BM,DotDot:$M,doteq:zM,doteqdot:VM,DotEqual:qM,dotminus:jM,dotplus:UM,dotsquare:WM,doublebarwedge:ZM,DoubleContourIntegral:KM,DoubleDot:GM,DoubleDownArrow:JM,DoubleLeftArrow:YM,DoubleLeftRightArrow:XM,DoubleLeftTee:QM,DoubleLongLeftArrow:eT,DoubleLongLeftRightArrow:tT,DoubleLongRightArrow:nT,DoubleRightArrow:rT,DoubleRightTee:iT,DoubleUpArrow:oT,DoubleUpDownArrow:sT,DoubleVerticalBar:aT,DownArrowBar:uT,downarrow:lT,DownArrow:cT,Downarrow:dT,DownArrowUpArrow:fT,DownBreve:hT,downdownarrows:pT,downharpoonleft:mT,downharpoonright:gT,DownLeftRightVector:bT,DownLeftTeeVector:yT,DownLeftVectorBar:xT,DownLeftVector:vT,DownRightTeeVector:kT,DownRightVectorBar:wT,DownRightVector:CT,DownTeeArrow:ST,DownTee:ET,drbkarow:AT,drcorn:_T,drcrop:MT,Dscr:TT,dscr:DT,DScy:LT,dscy:OT,dsol:RT,Dstrok:NT,dstrok:HT,dtdot:IT,dtri:FT,dtrif:PT,duarr:BT,duhar:$T,dwangle:zT,DZcy:VT,dzcy:qT,dzigrarr:jT,Eacute:UT,eacute:WT,easter:ZT,Ecaron:KT,ecaron:GT,Ecirc:JT,ecirc:YT,ecir:XT,ecolon:QT,Ecy:eD,ecy:tD,eDDot:nD,Edot:rD,edot:iD,eDot:oD,ee:sD,efDot:aD,Efr:uD,efr:lD,eg:cD,Egrave:dD,egrave:fD,egs:hD,egsdot:pD,el:mD,Element:gD,elinters:bD,ell:yD,els:xD,elsdot:vD,Emacr:kD,emacr:wD,empty:CD,emptyset:SD,EmptySmallSquare:ED,emptyv:AD,EmptyVerySmallSquare:_D,emsp13:MD,emsp14:TD,emsp:DD,ENG:LD,eng:OD,ensp:RD,Eogon:ND,eogon:HD,Eopf:ID,eopf:FD,epar:PD,eparsl:BD,eplus:$D,epsi:zD,Epsilon:VD,epsilon:qD,epsiv:jD,eqcirc:UD,eqcolon:WD,eqsim:ZD,eqslantgtr:KD,eqslantless:GD,Equal:JD,equals:YD,EqualTilde:XD,equest:QD,Equilibrium:eL,equiv:tL,equivDD:nL,eqvparsl:rL,erarr:iL,erDot:oL,escr:sL,Escr:aL,esdot:uL,Esim:lL,esim:cL,Eta:dL,eta:fL,ETH:hL,eth:pL,Euml:mL,euml:gL,euro:bL,excl:yL,exist:xL,Exists:vL,expectation:kL,exponentiale:wL,ExponentialE:CL,fallingdotseq:SL,Fcy:EL,fcy:AL,female:_L,ffilig:ML,fflig:TL,ffllig:DL,Ffr:LL,ffr:OL,filig:RL,FilledSmallSquare:NL,FilledVerySmallSquare:HL,fjlig:IL,flat:FL,fllig:PL,fltns:BL,fnof:$L,Fopf:zL,fopf:VL,forall:qL,ForAll:jL,fork:UL,forkv:WL,Fouriertrf:ZL,fpartint:KL,frac12:GL,frac13:JL,frac14:YL,frac15:XL,frac16:QL,frac18:eO,frac23:tO,frac25:nO,frac34:rO,frac35:iO,frac38:oO,frac45:sO,frac56:aO,frac58:uO,frac78:lO,frasl:cO,frown:dO,fscr:fO,Fscr:hO,gacute:pO,Gamma:mO,gamma:gO,Gammad:bO,gammad:yO,gap:xO,Gbreve:vO,gbreve:kO,Gcedil:wO,Gcirc:CO,gcirc:SO,Gcy:EO,gcy:AO,Gdot:_O,gdot:MO,ge:TO,gE:DO,gEl:LO,gel:OO,geq:RO,geqq:NO,geqslant:HO,gescc:IO,ges:FO,gesdot:PO,gesdoto:BO,gesdotol:$O,gesl:zO,gesles:VO,Gfr:qO,gfr:jO,gg:UO,Gg:WO,ggg:ZO,gimel:KO,GJcy:GO,gjcy:JO,gla:YO,gl:XO,glE:QO,glj:eR,gnap:tR,gnapprox:nR,gne:rR,gnE:iR,gneq:oR,gneqq:sR,gnsim:aR,Gopf:uR,gopf:lR,grave:cR,GreaterEqual:dR,GreaterEqualLess:fR,GreaterFullEqual:hR,GreaterGreater:pR,GreaterLess:mR,GreaterSlantEqual:gR,GreaterTilde:bR,Gscr:yR,gscr:xR,gsim:vR,gsime:kR,gsiml:wR,gtcc:CR,gtcir:SR,gt:ER,GT:AR,Gt:_R,gtdot:MR,gtlPar:TR,gtquest:DR,gtrapprox:LR,gtrarr:OR,gtrdot:RR,gtreqless:NR,gtreqqless:HR,gtrless:IR,gtrsim:FR,gvertneqq:PR,gvnE:BR,Hacek:$R,hairsp:zR,half:VR,hamilt:qR,HARDcy:jR,hardcy:UR,harrcir:WR,harr:ZR,hArr:KR,harrw:GR,Hat:JR,hbar:YR,Hcirc:XR,hcirc:QR,hearts:eN,heartsuit:tN,hellip:nN,hercon:rN,hfr:iN,Hfr:oN,HilbertSpace:sN,hksearow:aN,hkswarow:uN,hoarr:lN,homtht:cN,hookleftarrow:dN,hookrightarrow:fN,hopf:hN,Hopf:pN,horbar:mN,HorizontalLine:gN,hscr:bN,Hscr:yN,hslash:xN,Hstrok:vN,hstrok:kN,HumpDownHump:wN,HumpEqual:CN,hybull:SN,hyphen:EN,Iacute:AN,iacute:_N,ic:MN,Icirc:TN,icirc:DN,Icy:LN,icy:ON,Idot:RN,IEcy:NN,iecy:HN,iexcl:IN,iff:FN,ifr:PN,Ifr:BN,Igrave:$N,igrave:zN,ii:VN,iiiint:qN,iiint:jN,iinfin:UN,iiota:WN,IJlig:ZN,ijlig:KN,Imacr:GN,imacr:JN,image:YN,ImaginaryI:XN,imagline:QN,imagpart:eH,imath:tH,Im:nH,imof:rH,imped:iH,Implies:oH,incare:sH,in:"",infin:aH,infintie:uH,inodot:lH,intcal:cH,int:dH,Int:fH,integers:hH,Integral:pH,intercal:mH,Intersection:gH,intlarhk:bH,intprod:yH,InvisibleComma:xH,InvisibleTimes:vH,IOcy:kH,iocy:wH,Iogon:CH,iogon:SH,Iopf:EH,iopf:AH,Iota:_H,iota:MH,iprod:TH,iquest:DH,iscr:LH,Iscr:OH,isin:RH,isindot:NH,isinE:HH,isins:IH,isinsv:FH,isinv:PH,it:BH,Itilde:$H,itilde:zH,Iukcy:VH,iukcy:qH,Iuml:jH,iuml:UH,Jcirc:WH,jcirc:ZH,Jcy:KH,jcy:GH,Jfr:JH,jfr:YH,jmath:XH,Jopf:QH,jopf:eI,Jscr:tI,jscr:nI,Jsercy:rI,jsercy:iI,Jukcy:oI,jukcy:sI,Kappa:aI,kappa:uI,kappav:lI,Kcedil:cI,kcedil:dI,Kcy:fI,kcy:hI,Kfr:pI,kfr:mI,kgreen:gI,KHcy:bI,khcy:yI,KJcy:xI,kjcy:vI,Kopf:kI,kopf:wI,Kscr:CI,kscr:SI,lAarr:EI,Lacute:AI,lacute:_I,laemptyv:MI,lagran:TI,Lambda:DI,lambda:LI,lang:OI,Lang:RI,langd:NI,langle:HI,lap:II,Laplacetrf:FI,laquo:PI,larrb:BI,larrbfs:$I,larr:zI,Larr:VI,lArr:qI,larrfs:jI,larrhk:UI,larrlp:WI,larrpl:ZI,larrsim:KI,larrtl:GI,latail:JI,lAtail:YI,lat:XI,late:QI,lates:eF,lbarr:tF,lBarr:nF,lbbrk:rF,lbrace:iF,lbrack:oF,lbrke:sF,lbrksld:aF,lbrkslu:uF,Lcaron:lF,lcaron:cF,Lcedil:dF,lcedil:fF,lceil:hF,lcub:pF,Lcy:mF,lcy:gF,ldca:bF,ldquo:yF,ldquor:xF,ldrdhar:vF,ldrushar:kF,ldsh:wF,le:CF,lE:SF,LeftAngleBracket:EF,LeftArrowBar:AF,leftarrow:_F,LeftArrow:MF,Leftarrow:TF,LeftArrowRightArrow:DF,leftarrowtail:LF,LeftCeiling:OF,LeftDoubleBracket:RF,LeftDownTeeVector:NF,LeftDownVectorBar:HF,LeftDownVector:IF,LeftFloor:FF,leftharpoondown:PF,leftharpoonup:BF,leftleftarrows:$F,leftrightarrow:zF,LeftRightArrow:VF,Leftrightarrow:qF,leftrightarrows:jF,leftrightharpoons:UF,leftrightsquigarrow:WF,LeftRightVector:ZF,LeftTeeArrow:KF,LeftTee:GF,LeftTeeVector:JF,leftthreetimes:YF,LeftTriangleBar:XF,LeftTriangle:QF,LeftTriangleEqual:eP,LeftUpDownVector:tP,LeftUpTeeVector:nP,LeftUpVectorBar:rP,LeftUpVector:iP,LeftVectorBar:oP,LeftVector:sP,lEg:aP,leg:uP,leq:lP,leqq:cP,leqslant:dP,lescc:fP,les:hP,lesdot:pP,lesdoto:mP,lesdotor:gP,lesg:bP,lesges:yP,lessapprox:xP,lessdot:vP,lesseqgtr:kP,lesseqqgtr:wP,LessEqualGreater:CP,LessFullEqual:SP,LessGreater:EP,lessgtr:AP,LessLess:_P,lesssim:MP,LessSlantEqual:TP,LessTilde:DP,lfisht:LP,lfloor:OP,Lfr:RP,lfr:NP,lg:HP,lgE:IP,lHar:FP,lhard:PP,lharu:BP,lharul:$P,lhblk:zP,LJcy:VP,ljcy:qP,llarr:jP,ll:UP,Ll:WP,llcorner:ZP,Lleftarrow:KP,llhard:GP,lltri:JP,Lmidot:YP,lmidot:XP,lmoustache:QP,lmoust:eB,lnap:tB,lnapprox:nB,lne:rB,lnE:iB,lneq:oB,lneqq:sB,lnsim:aB,loang:uB,loarr:lB,lobrk:cB,longleftarrow:dB,LongLeftArrow:fB,Longleftarrow:hB,longleftrightarrow:pB,LongLeftRightArrow:mB,Longleftrightarrow:gB,longmapsto:bB,longrightarrow:yB,LongRightArrow:xB,Longrightarrow:vB,looparrowleft:kB,looparrowright:wB,lopar:CB,Lopf:SB,lopf:EB,loplus:AB,lotimes:_B,lowast:MB,lowbar:TB,LowerLeftArrow:DB,LowerRightArrow:LB,loz:OB,lozenge:RB,lozf:NB,lpar:HB,lparlt:IB,lrarr:FB,lrcorner:PB,lrhar:BB,lrhard:$B,lrm:zB,lrtri:VB,lsaquo:qB,lscr:jB,Lscr:UB,lsh:WB,Lsh:ZB,lsim:KB,lsime:GB,lsimg:JB,lsqb:YB,lsquo:XB,lsquor:QB,Lstrok:e$,lstrok:t$,ltcc:n$,ltcir:r$,lt:i$,LT:o$,Lt:s$,ltdot:a$,lthree:u$,ltimes:l$,ltlarr:c$,ltquest:d$,ltri:f$,ltrie:h$,ltrif:p$,ltrPar:m$,lurdshar:g$,luruhar:b$,lvertneqq:y$,lvnE:x$,macr:v$,male:k$,malt:w$,maltese:C$,Map:"",map:S$,mapsto:E$,mapstodown:A$,mapstoleft:_$,mapstoup:M$,marker:T$,mcomma:D$,Mcy:L$,mcy:O$,mdash:R$,mDDot:N$,measuredangle:H$,MediumSpace:I$,Mellintrf:F$,Mfr:P$,mfr:B$,mho:$$,micro:z$,midast:V$,midcir:q$,mid:j$,middot:U$,minusb:W$,minus:Z$,minusd:K$,minusdu:G$,MinusPlus:J$,mlcp:Y$,mldr:X$,mnplus:Q$,models:ez,Mopf:tz,mopf:nz,mp:rz,mscr:iz,Mscr:oz,mstpos:sz,Mu:az,mu:uz,multimap:lz,mumap:cz,nabla:dz,Nacute:fz,nacute:hz,nang:pz,nap:mz,napE:gz,napid:bz,napos:yz,napprox:xz,natural:vz,naturals:kz,natur:wz,nbsp:Cz,nbump:Sz,nbumpe:Ez,ncap:Az,Ncaron:_z,ncaron:Mz,Ncedil:Tz,ncedil:Dz,ncong:Lz,ncongdot:Oz,ncup:Rz,Ncy:Nz,ncy:Hz,ndash:Iz,nearhk:Fz,nearr:Pz,neArr:Bz,nearrow:$z,ne:zz,nedot:Vz,NegativeMediumSpace:qz,NegativeThickSpace:jz,NegativeThinSpace:Uz,NegativeVeryThinSpace:Wz,nequiv:Zz,nesear:Kz,nesim:Gz,NestedGreaterGreater:Jz,NestedLessLess:Yz,NewLine:Xz,nexist:Qz,nexists:eV,Nfr:tV,nfr:nV,ngE:rV,nge:iV,ngeq:oV,ngeqq:sV,ngeqslant:aV,nges:uV,nGg:lV,ngsim:cV,nGt:dV,ngt:fV,ngtr:hV,nGtv:pV,nharr:mV,nhArr:gV,nhpar:bV,ni:yV,nis:xV,nisd:vV,niv:kV,NJcy:wV,njcy:CV,nlarr:SV,nlArr:EV,nldr:AV,nlE:_V,nle:MV,nleftarrow:TV,nLeftarrow:DV,nleftrightarrow:LV,nLeftrightarrow:OV,nleq:RV,nleqq:NV,nleqslant:HV,nles:IV,nless:FV,nLl:PV,nlsim:BV,nLt:$V,nlt:zV,nltri:VV,nltrie:qV,nLtv:jV,nmid:UV,NoBreak:WV,NonBreakingSpace:ZV,nopf:KV,Nopf:GV,Not:JV,not:YV,NotCongruent:XV,NotCupCap:QV,NotDoubleVerticalBar:eq,NotElement:tq,NotEqual:nq,NotEqualTilde:rq,NotExists:iq,NotGreater:oq,NotGreaterEqual:sq,NotGreaterFullEqual:aq,NotGreaterGreater:uq,NotGreaterLess:lq,NotGreaterSlantEqual:cq,NotGreaterTilde:dq,NotHumpDownHump:fq,NotHumpEqual:hq,notin:pq,notindot:mq,notinE:gq,notinva:bq,notinvb:yq,notinvc:xq,NotLeftTriangleBar:vq,NotLeftTriangle:kq,NotLeftTriangleEqual:wq,NotLess:Cq,NotLessEqual:Sq,NotLessGreater:Eq,NotLessLess:Aq,NotLessSlantEqual:_q,NotLessTilde:Mq,NotNestedGreaterGreater:Tq,NotNestedLessLess:Dq,notni:Lq,notniva:Oq,notnivb:Rq,notnivc:Nq,NotPrecedes:Hq,NotPrecedesEqual:Iq,NotPrecedesSlantEqual:Fq,NotReverseElement:Pq,NotRightTriangleBar:Bq,NotRightTriangle:$q,NotRightTriangleEqual:zq,NotSquareSubset:Vq,NotSquareSubsetEqual:qq,NotSquareSuperset:jq,NotSquareSupersetEqual:Uq,NotSubset:Wq,NotSubsetEqual:Zq,NotSucceeds:Kq,NotSucceedsEqual:Gq,NotSucceedsSlantEqual:Jq,NotSucceedsTilde:Yq,NotSuperset:Xq,NotSupersetEqual:Qq,NotTilde:ej,NotTildeEqual:tj,NotTildeFullEqual:nj,NotTildeTilde:rj,NotVerticalBar:ij,nparallel:oj,npar:sj,nparsl:aj,npart:uj,npolint:lj,npr:cj,nprcue:dj,nprec:fj,npreceq:hj,npre:pj,nrarrc:mj,nrarr:gj,nrArr:bj,nrarrw:yj,nrightarrow:xj,nRightarrow:vj,nrtri:kj,nrtrie:wj,nsc:Cj,nsccue:Sj,nsce:Ej,Nscr:Aj,nscr:_j,nshortmid:Mj,nshortparallel:Tj,nsim:Dj,nsime:Lj,nsimeq:Oj,nsmid:Rj,nspar:Nj,nsqsube:Hj,nsqsupe:Ij,nsub:Fj,nsubE:Pj,nsube:Bj,nsubset:$j,nsubseteq:zj,nsubseteqq:Vj,nsucc:qj,nsucceq:jj,nsup:Uj,nsupE:Wj,nsupe:Zj,nsupset:Kj,nsupseteq:Gj,nsupseteqq:Jj,ntgl:Yj,Ntilde:Xj,ntilde:Qj,ntlg:eU,ntriangleleft:tU,ntrianglelefteq:nU,ntriangleright:rU,ntrianglerighteq:iU,Nu:oU,nu:sU,num:aU,numero:uU,numsp:lU,nvap:cU,nvdash:dU,nvDash:fU,nVdash:hU,nVDash:pU,nvge:mU,nvgt:gU,nvHarr:bU,nvinfin:yU,nvlArr:xU,nvle:vU,nvlt:kU,nvltrie:wU,nvrArr:CU,nvrtrie:SU,nvsim:EU,nwarhk:AU,nwarr:_U,nwArr:MU,nwarrow:TU,nwnear:DU,Oacute:LU,oacute:OU,oast:RU,Ocirc:NU,ocirc:HU,ocir:IU,Ocy:FU,ocy:PU,odash:BU,Odblac:$U,odblac:zU,odiv:VU,odot:qU,odsold:jU,OElig:UU,oelig:WU,ofcir:ZU,Ofr:KU,ofr:GU,ogon:JU,Ograve:YU,ograve:XU,ogt:QU,ohbar:eW,ohm:tW,oint:nW,olarr:rW,olcir:iW,olcross:oW,oline:sW,olt:aW,Omacr:uW,omacr:lW,Omega:cW,omega:dW,Omicron:fW,omicron:hW,omid:pW,ominus:mW,Oopf:gW,oopf:bW,opar:yW,OpenCurlyDoubleQuote:xW,OpenCurlyQuote:vW,operp:kW,oplus:wW,orarr:CW,Or:SW,or:EW,ord:AW,order:_W,orderof:MW,ordf:TW,ordm:DW,origof:LW,oror:OW,orslope:RW,orv:NW,oS:HW,Oscr:IW,oscr:FW,Oslash:PW,oslash:BW,osol:$W,Otilde:zW,otilde:VW,otimesas:qW,Otimes:jW,otimes:UW,Ouml:WW,ouml:ZW,ovbar:KW,OverBar:GW,OverBrace:JW,OverBracket:YW,OverParenthesis:XW,para:QW,parallel:eZ,par:tZ,parsim:nZ,parsl:rZ,part:iZ,PartialD:oZ,Pcy:sZ,pcy:aZ,percnt:uZ,period:lZ,permil:cZ,perp:dZ,pertenk:fZ,Pfr:hZ,pfr:pZ,Phi:mZ,phi:gZ,phiv:bZ,phmmat:yZ,phone:xZ,Pi:vZ,pi:kZ,pitchfork:wZ,piv:CZ,planck:SZ,planckh:EZ,plankv:AZ,plusacir:_Z,plusb:MZ,pluscir:TZ,plus:DZ,plusdo:LZ,plusdu:OZ,pluse:RZ,PlusMinus:NZ,plusmn:HZ,plussim:IZ,plustwo:FZ,pm:PZ,Poincareplane:BZ,pointint:$Z,popf:zZ,Popf:VZ,pound:qZ,prap:jZ,Pr:UZ,pr:WZ,prcue:ZZ,precapprox:KZ,prec:GZ,preccurlyeq:JZ,Precedes:YZ,PrecedesEqual:XZ,PrecedesSlantEqual:QZ,PrecedesTilde:eK,preceq:tK,precnapprox:nK,precneqq:rK,precnsim:iK,pre:oK,prE:sK,precsim:aK,prime:uK,Prime:lK,primes:cK,prnap:dK,prnE:fK,prnsim:hK,prod:pK,Product:mK,profalar:gK,profline:bK,profsurf:yK,prop:xK,Proportional:vK,Proportion:kK,propto:wK,prsim:CK,prurel:SK,Pscr:EK,pscr:AK,Psi:_K,psi:MK,puncsp:TK,Qfr:DK,qfr:LK,qint:OK,qopf:RK,Qopf:NK,qprime:HK,Qscr:IK,qscr:FK,quaternions:PK,quatint:BK,quest:$K,questeq:zK,quot:VK,QUOT:qK,rAarr:jK,race:UK,Racute:WK,racute:ZK,radic:KK,raemptyv:GK,rang:JK,Rang:YK,rangd:XK,range:QK,rangle:eG,raquo:tG,rarrap:nG,rarrb:rG,rarrbfs:iG,rarrc:oG,rarr:sG,Rarr:aG,rArr:uG,rarrfs:lG,rarrhk:cG,rarrlp:dG,rarrpl:fG,rarrsim:hG,Rarrtl:pG,rarrtl:mG,rarrw:gG,ratail:bG,rAtail:yG,ratio:xG,rationals:vG,rbarr:kG,rBarr:wG,RBarr:CG,rbbrk:SG,rbrace:EG,rbrack:AG,rbrke:_G,rbrksld:MG,rbrkslu:TG,Rcaron:DG,rcaron:LG,Rcedil:OG,rcedil:RG,rceil:NG,rcub:HG,Rcy:IG,rcy:FG,rdca:PG,rdldhar:BG,rdquo:$G,rdquor:zG,rdsh:VG,real:qG,realine:jG,realpart:UG,reals:WG,Re:ZG,rect:KG,reg:GG,REG:JG,ReverseElement:YG,ReverseEquilibrium:XG,ReverseUpEquilibrium:QG,rfisht:eJ,rfloor:tJ,rfr:nJ,Rfr:rJ,rHar:iJ,rhard:oJ,rharu:sJ,rharul:aJ,Rho:uJ,rho:lJ,rhov:cJ,RightAngleBracket:dJ,RightArrowBar:fJ,rightarrow:hJ,RightArrow:pJ,Rightarrow:mJ,RightArrowLeftArrow:gJ,rightarrowtail:bJ,RightCeiling:yJ,RightDoubleBracket:xJ,RightDownTeeVector:vJ,RightDownVectorBar:kJ,RightDownVector:wJ,RightFloor:CJ,rightharpoondown:SJ,rightharpoonup:EJ,rightleftarrows:AJ,rightleftharpoons:_J,rightrightarrows:MJ,rightsquigarrow:TJ,RightTeeArrow:DJ,RightTee:LJ,RightTeeVector:OJ,rightthreetimes:RJ,RightTriangleBar:NJ,RightTriangle:HJ,RightTriangleEqual:IJ,RightUpDownVector:FJ,RightUpTeeVector:PJ,RightUpVectorBar:BJ,RightUpVector:$J,RightVectorBar:zJ,RightVector:VJ,ring:qJ,risingdotseq:jJ,rlarr:UJ,rlhar:WJ,rlm:ZJ,rmoustache:KJ,rmoust:GJ,rnmid:JJ,roang:YJ,roarr:XJ,robrk:QJ,ropar:eY,ropf:tY,Ropf:nY,roplus:rY,rotimes:iY,RoundImplies:oY,rpar:sY,rpargt:aY,rppolint:uY,rrarr:lY,Rrightarrow:cY,rsaquo:dY,rscr:fY,Rscr:hY,rsh:pY,Rsh:mY,rsqb:gY,rsquo:bY,rsquor:yY,rthree:xY,rtimes:vY,rtri:kY,rtrie:wY,rtrif:CY,rtriltri:SY,RuleDelayed:EY,ruluhar:AY,rx:_Y,Sacute:MY,sacute:TY,sbquo:DY,scap:LY,Scaron:OY,scaron:RY,Sc:NY,sc:HY,sccue:IY,sce:FY,scE:PY,Scedil:BY,scedil:$Y,Scirc:zY,scirc:VY,scnap:qY,scnE:jY,scnsim:UY,scpolint:WY,scsim:ZY,Scy:KY,scy:GY,sdotb:JY,sdot:YY,sdote:XY,searhk:QY,searr:eX,seArr:tX,searrow:nX,sect:rX,semi:iX,seswar:oX,setminus:sX,setmn:aX,sext:uX,Sfr:lX,sfr:cX,sfrown:dX,sharp:fX,SHCHcy:hX,shchcy:pX,SHcy:mX,shcy:gX,ShortDownArrow:bX,ShortLeftArrow:yX,shortmid:xX,shortparallel:vX,ShortRightArrow:kX,ShortUpArrow:wX,shy:CX,Sigma:SX,sigma:EX,sigmaf:AX,sigmav:_X,sim:MX,simdot:TX,sime:DX,simeq:LX,simg:OX,simgE:RX,siml:NX,simlE:HX,simne:IX,simplus:FX,simrarr:PX,slarr:BX,SmallCircle:$X,smallsetminus:zX,smashp:VX,smeparsl:qX,smid:jX,smile:UX,smt:WX,smte:ZX,smtes:KX,SOFTcy:GX,softcy:JX,solbar:YX,solb:XX,sol:QX,Sopf:eQ,sopf:tQ,spades:nQ,spadesuit:rQ,spar:iQ,sqcap:oQ,sqcaps:sQ,sqcup:aQ,sqcups:uQ,Sqrt:lQ,sqsub:cQ,sqsube:dQ,sqsubset:fQ,sqsubseteq:hQ,sqsup:pQ,sqsupe:mQ,sqsupset:gQ,sqsupseteq:bQ,square:yQ,Square:xQ,SquareIntersection:vQ,SquareSubset:kQ,SquareSubsetEqual:wQ,SquareSuperset:CQ,SquareSupersetEqual:SQ,SquareUnion:EQ,squarf:AQ,squ:_Q,squf:MQ,srarr:TQ,Sscr:DQ,sscr:LQ,ssetmn:OQ,ssmile:RQ,sstarf:NQ,Star:HQ,star:IQ,starf:FQ,straightepsilon:PQ,straightphi:BQ,strns:$Q,sub:zQ,Sub:VQ,subdot:qQ,subE:jQ,sube:UQ,subedot:WQ,submult:ZQ,subnE:KQ,subne:GQ,subplus:JQ,subrarr:YQ,subset:XQ,Subset:QQ,subseteq:eee,subseteqq:tee,SubsetEqual:nee,subsetneq:ree,subsetneqq:iee,subsim:oee,subsub:see,subsup:aee,succapprox:uee,succ:lee,succcurlyeq:cee,Succeeds:dee,SucceedsEqual:fee,SucceedsSlantEqual:hee,SucceedsTilde:pee,succeq:mee,succnapprox:gee,succneqq:bee,succnsim:yee,succsim:xee,SuchThat:vee,sum:kee,Sum:wee,sung:Cee,sup1:See,sup2:Eee,sup3:Aee,sup:_ee,Sup:Mee,supdot:Tee,supdsub:Dee,supE:Lee,supe:Oee,supedot:Ree,Superset:Nee,SupersetEqual:Hee,suphsol:Iee,suphsub:Fee,suplarr:Pee,supmult:Bee,supnE:$ee,supne:zee,supplus:Vee,supset:qee,Supset:jee,supseteq:Uee,supseteqq:Wee,supsetneq:Zee,supsetneqq:Kee,supsim:Gee,supsub:Jee,supsup:Yee,swarhk:Xee,swarr:Qee,swArr:ete,swarrow:tte,swnwar:nte,szlig:rte,Tab:ite,target:ote,Tau:ste,tau:ate,tbrk:ute,Tcaron:lte,tcaron:cte,Tcedil:dte,tcedil:fte,Tcy:hte,tcy:pte,tdot:mte,telrec:gte,Tfr:bte,tfr:yte,there4:xte,therefore:vte,Therefore:kte,Theta:wte,theta:Cte,thetasym:Ste,thetav:Ete,thickapprox:Ate,thicksim:_te,ThickSpace:Mte,ThinSpace:Tte,thinsp:Dte,thkap:Lte,thksim:Ote,THORN:Rte,thorn:Nte,tilde:Hte,Tilde:Ite,TildeEqual:Fte,TildeFullEqual:Pte,TildeTilde:Bte,timesbar:$te,timesb:zte,times:Vte,timesd:qte,tint:jte,toea:Ute,topbot:Wte,topcir:Zte,top:Kte,Topf:Gte,topf:Jte,topfork:Yte,tosa:Xte,tprime:Qte,trade:ene,TRADE:tne,triangle:nne,triangledown:rne,triangleleft:ine,trianglelefteq:one,triangleq:sne,triangleright:ane,trianglerighteq:une,tridot:lne,trie:cne,triminus:dne,TripleDot:fne,triplus:hne,trisb:pne,tritime:mne,trpezium:gne,Tscr:bne,tscr:yne,TScy:xne,tscy:vne,TSHcy:kne,tshcy:wne,Tstrok:Cne,tstrok:Sne,twixt:Ene,twoheadleftarrow:Ane,twoheadrightarrow:_ne,Uacute:Mne,uacute:Tne,uarr:Dne,Uarr:Lne,uArr:One,Uarrocir:Rne,Ubrcy:Nne,ubrcy:Hne,Ubreve:Ine,ubreve:Fne,Ucirc:Pne,ucirc:Bne,Ucy:$ne,ucy:zne,udarr:Vne,Udblac:qne,udblac:jne,udhar:Une,ufisht:Wne,Ufr:Zne,ufr:Kne,Ugrave:Gne,ugrave:Jne,uHar:Yne,uharl:Xne,uharr:Qne,uhblk:ere,ulcorn:tre,ulcorner:nre,ulcrop:rre,ultri:ire,Umacr:ore,umacr:sre,uml:are,UnderBar:ure,UnderBrace:lre,UnderBracket:cre,UnderParenthesis:dre,Union:fre,UnionPlus:hre,Uogon:pre,uogon:mre,Uopf:gre,uopf:bre,UpArrowBar:yre,uparrow:xre,UpArrow:vre,Uparrow:kre,UpArrowDownArrow:wre,updownarrow:Cre,UpDownArrow:Sre,Updownarrow:Ere,UpEquilibrium:Are,upharpoonleft:_re,upharpoonright:Mre,uplus:Tre,UpperLeftArrow:Dre,UpperRightArrow:Lre,upsi:Ore,Upsi:Rre,upsih:Nre,Upsilon:Hre,upsilon:Ire,UpTeeArrow:Fre,UpTee:Pre,upuparrows:Bre,urcorn:$re,urcorner:zre,urcrop:Vre,Uring:qre,uring:jre,urtri:Ure,Uscr:Wre,uscr:Zre,utdot:Kre,Utilde:Gre,utilde:Jre,utri:Yre,utrif:Xre,uuarr:Qre,Uuml:eie,uuml:tie,uwangle:nie,vangrt:rie,varepsilon:iie,varkappa:oie,varnothing:sie,varphi:aie,varpi:uie,varpropto:lie,varr:cie,vArr:die,varrho:fie,varsigma:hie,varsubsetneq:pie,varsubsetneqq:mie,varsupsetneq:gie,varsupsetneqq:bie,vartheta:yie,vartriangleleft:xie,vartriangleright:vie,vBar:kie,Vbar:wie,vBarv:Cie,Vcy:Sie,vcy:Eie,vdash:Aie,vDash:_ie,Vdash:Mie,VDash:Tie,Vdashl:Die,veebar:Lie,vee:Oie,Vee:Rie,veeeq:Nie,vellip:Hie,verbar:Iie,Verbar:Fie,vert:Pie,Vert:Bie,VerticalBar:$ie,VerticalLine:zie,VerticalSeparator:Vie,VerticalTilde:qie,VeryThinSpace:jie,Vfr:Uie,vfr:Wie,vltri:Zie,vnsub:Kie,vnsup:Gie,Vopf:Jie,vopf:Yie,vprop:Xie,vrtri:Qie,Vscr:eoe,vscr:toe,vsubnE:noe,vsubne:roe,vsupnE:ioe,vsupne:ooe,Vvdash:soe,vzigzag:aoe,Wcirc:uoe,wcirc:loe,wedbar:coe,wedge:doe,Wedge:foe,wedgeq:hoe,weierp:poe,Wfr:moe,wfr:goe,Wopf:boe,wopf:yoe,wp:xoe,wr:voe,wreath:koe,Wscr:woe,wscr:Coe,xcap:Soe,xcirc:Eoe,xcup:Aoe,xdtri:_oe,Xfr:Moe,xfr:Toe,xharr:Doe,xhArr:Loe,Xi:Ooe,xi:Roe,xlarr:Noe,xlArr:Hoe,xmap:Ioe,xnis:Foe,xodot:Poe,Xopf:Boe,xopf:$oe,xoplus:zoe,xotime:Voe,xrarr:qoe,xrArr:joe,Xscr:Uoe,xscr:Woe,xsqcup:Zoe,xuplus:Koe,xutri:Goe,xvee:Joe,xwedge:Yoe,Yacute:Xoe,yacute:Qoe,YAcy:ese,yacy:tse,Ycirc:nse,ycirc:rse,Ycy:ise,ycy:ose,yen:sse,Yfr:ase,yfr:use,YIcy:lse,yicy:cse,Yopf:dse,yopf:fse,Yscr:hse,yscr:pse,YUcy:mse,yucy:gse,yuml:bse,Yuml:yse,Zacute:xse,zacute:vse,Zcaron:kse,zcaron:wse,Zcy:Cse,zcy:Sse,Zdot:Ese,zdot:Ase,zeetrf:_se,ZeroWidthSpace:Mse,Zeta:Tse,zeta:Dse,zfr:Lse,Zfr:Ose,ZHcy:Rse,zhcy:Nse,zigrarr:Hse,zopf:Ise,Zopf:Fse,Zscr:Pse,zscr:Bse,zwj:$se,zwnj:zse};var N1=Vse,cc=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3E]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,Or={},rh={};function qse(n){var e,t,r=rh[n];if(r)return r;for(r=rh[n]=[],e=0;e<128;e++)t=String.fromCharCode(e),/^[0-9a-z]$/i.test(t)?r.push(t):r.push("%"+("0"+e.toString(16).toUpperCase()).slice(-2));for(e=0;e<n.length;e++)r[n.charCodeAt(e)]=n[e];return r}function ia(n,e,t){var r,i,o,s,a,u="";for(typeof e!="string"&&(t=e,e=ia.defaultChars),typeof t>"u"&&(t=!0),a=qse(e),r=0,i=n.length;r<i;r++){if(o=n.charCodeAt(r),t&&o===37&&r+2<i&&/^[0-9a-f]{2}$/i.test(n.slice(r+1,r+3))){u+=n.slice(r,r+3),r+=2;continue}if(o<128){u+=a[o];continue}if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&r+1<i&&(s=n.charCodeAt(r+1),s>=56320&&s<=57343)){u+=encodeURIComponent(n[r]+n[r+1]),r++;continue}u+="%EF%BF%BD";continue}u+=encodeURIComponent(n[r])}return u}ia.defaultChars=";/?:@&=+$,-_.!~*'()#";ia.componentChars="-_.!~*'()";var jse=ia,ih={};function Use(n){var e,t,r=ih[n];if(r)return r;for(r=ih[n]=[],e=0;e<128;e++)t=String.fromCharCode(e),r.push(t);for(e=0;e<n.length;e++)t=n.charCodeAt(e),r[t]="%"+("0"+t.toString(16).toUpperCase()).slice(-2);return r}function oa(n,e){var t;return typeof e!="string"&&(e=oa.defaultChars),t=Use(e),n.replace(/(%[a-f0-9]{2})+/gi,function(r){var i,o,s,a,u,l,c,d="";for(i=0,o=r.length;i<o;i+=3){if(s=parseInt(r.slice(i+1,i+3),16),s<128){d+=t[s];continue}if((s&224)===192&&i+3<o&&(a=parseInt(r.slice(i+4,i+6),16),(a&192)===128)){c=s<<6&1984|a&63,c<128?d+="":d+=String.fromCharCode(c),i+=3;continue}if((s&240)===224&&i+6<o&&(a=parseInt(r.slice(i+4,i+6),16),u=parseInt(r.slice(i+7,i+9),16),(a&192)===128&&(u&192)===128)){c=s<<12&61440|a<<6&4032|u&63,c<2048||c>=55296&&c<=57343?d+="":d+=String.fromCharCode(c),i+=6;continue}if((s&248)===240&&i+9<o&&(a=parseInt(r.slice(i+4,i+6),16),u=parseInt(r.slice(i+7,i+9),16),l=parseInt(r.slice(i+10,i+12),16),(a&192)===128&&(u&192)===128&&(l&192)===128)){c=s<<18&1835008|a<<12&258048|u<<6&4032|l&63,c<65536||c>1114111?d+="":(c-=65536,d+=String.fromCharCode(55296+(c>>10),56320+(c&1023))),i+=9;continue}d+=""}return d})}oa.defaultChars=";/?:@&=+$,#";oa.componentChars="";var Wse=oa,Zse=function(e){var t="";return t+=e.protocol||"",t+=e.slashes?"//":"",t+=e.auth?e.auth+"@":"",e.hostname&&e.hostname.indexOf(":")!==-1?t+="["+e.hostname+"]":t+=e.hostname||"",t+=e.port?":"+e.port:"",t+=e.pathname||"",t+=e.search||"",t+=e.hash||"",t};function Ms(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}var Kse=/^([a-z0-9.+-]+:)/i,Gse=/:[0-9]*$/,Jse=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Yse=["<",">",'"',"`"," ","\r",`
`,"	"],Xse=["{","}","|","\\","^","`"].concat(Yse),Qse=["'"].concat(Xse),oh=["%","/","?",";","#"].concat(Qse),sh=["/","?","#"],eae=255,ah=/^[+a-z0-9A-Z_-]{0,63}$/,tae=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,uh={javascript:!0,"javascript:":!0},lh={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function nae(n,e){if(n&&n instanceof Ms)return n;var t=new Ms;return t.parse(n,e),t}Ms.prototype.parse=function(n,e){var t,r,i,o,s,a=n;if(a=a.trim(),!e&&n.split("#").length===1){var u=Jse.exec(a);if(u)return this.pathname=u[1],u[2]&&(this.search=u[2]),this}var l=Kse.exec(a);if(l&&(l=l[0],i=l.toLowerCase(),this.protocol=l,a=a.substr(l.length)),(e||l||a.match(/^\/\/[^@\/]+@[^@\/]+/))&&(s=a.substr(0,2)==="//",s&&!(l&&uh[l])&&(a=a.substr(2),this.slashes=!0)),!uh[l]&&(s||l&&!lh[l])){var c=-1;for(t=0;t<sh.length;t++)o=a.indexOf(sh[t]),o!==-1&&(c===-1||o<c)&&(c=o);var d,f;for(c===-1?f=a.lastIndexOf("@"):f=a.lastIndexOf("@",c),f!==-1&&(d=a.slice(0,f),a=a.slice(f+1),this.auth=d),c=-1,t=0;t<oh.length;t++)o=a.indexOf(oh[t]),o!==-1&&(c===-1||o<c)&&(c=o);c===-1&&(c=a.length),a[c-1]===":"&&c--;var h=a.slice(0,c);a=a.slice(c),this.parseHost(h),this.hostname=this.hostname||"";var p=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!p){var m=this.hostname.split(/\./);for(t=0,r=m.length;t<r;t++){var g=m[t];if(g&&!g.match(ah)){for(var y="",x=0,v=g.length;x<v;x++)g.charCodeAt(x)>127?y+="x":y+=g[x];if(!y.match(ah)){var b=m.slice(0,t),w=m.slice(t+1),k=g.match(tae);k&&(b.push(k[1]),w.unshift(k[2])),w.length&&(a=w.join(".")+a),this.hostname=b.join(".");break}}}}this.hostname.length>eae&&(this.hostname=""),p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}var C=a.indexOf("#");C!==-1&&(this.hash=a.substr(C),a=a.slice(0,C));var E=a.indexOf("?");return E!==-1&&(this.search=a.substr(E),a=a.slice(0,E)),a&&(this.pathname=a),lh[i]&&this.hostname&&!this.pathname&&(this.pathname=""),this};Ms.prototype.parseHost=function(n){var e=Gse.exec(n);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),n=n.substr(0,n.length-e.length)),n&&(this.hostname=n)};var rae=nae;Or.encode=jse;Or.decode=Wse;Or.format=Zse;Or.parse=rae;var An={},su,ch;function H1(){return ch||(ch=1,su=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/),su}var au,dh;function I1(){return dh||(dh=1,au=/[\0-\x1F\x7F-\x9F]/),au}var uu,fh;function iae(){return fh||(fh=1,uu=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/),uu}var lu,hh;function F1(){return hh||(hh=1,lu=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/),lu}var ph;function oae(){return ph||(ph=1,An.Any=H1(),An.Cc=I1(),An.Cf=iae(),An.P=cc,An.Z=F1()),An}(function(n){function e(M){return Object.prototype.toString.call(M)}function t(M){return e(M)==="[object String]"}var r=Object.prototype.hasOwnProperty;function i(M,R){return r.call(M,R)}function o(M){var R=Array.prototype.slice.call(arguments,1);return R.forEach(function(D){if(D){if(typeof D!="object")throw new TypeError(D+"must be object");Object.keys(D).forEach(function(P){M[P]=D[P]})}}),M}function s(M,R,D){return[].concat(M.slice(0,R),D,M.slice(R+1))}function a(M){return!(M>=55296&&M<=57343||M>=64976&&M<=65007||(M&65535)===65535||(M&65535)===65534||M>=0&&M<=8||M===11||M>=14&&M<=31||M>=127&&M<=159||M>1114111)}function u(M){if(M>65535){M-=65536;var R=55296+(M>>10),D=56320+(M&1023);return String.fromCharCode(R,D)}return String.fromCharCode(M)}var l=/\\([!"#$%&'()*+,\-.\/:;<=>?@[\\\]^_`{|}~])/g,c=/&([a-z#][a-z0-9]{1,31});/gi,d=new RegExp(l.source+"|"+c.source,"gi"),f=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i,h=N1;function p(M,R){var D;return i(h,R)?h[R]:R.charCodeAt(0)===35&&f.test(R)&&(D=R[1].toLowerCase()==="x"?parseInt(R.slice(2),16):parseInt(R.slice(1),10),a(D))?u(D):M}function m(M){return M.indexOf("\\")<0?M:M.replace(l,"$1")}function g(M){return M.indexOf("\\")<0&&M.indexOf("&")<0?M:M.replace(d,function(R,D,P){return D||p(R,P)})}var y=/[&<>"]/,x=/[&<>"]/g,v={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function b(M){return v[M]}function w(M){return y.test(M)?M.replace(x,b):M}var k=/[.?*+^$[\]\\(){}|-]/g;function C(M){return M.replace(k,"\\$&")}function E(M){switch(M){case 9:case 32:return!0}return!1}function A(M){if(M>=8192&&M<=8202)return!0;switch(M){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}var T=cc;function I(M){return T.test(M)}function V(M){switch(M){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function U(M){return M=M.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(M=M.replace(//g,"")),M.toLowerCase().toUpperCase()}n.lib={},n.lib.mdurl=Or,n.lib.ucmicro=oae(),n.assign=o,n.isString=t,n.has=i,n.unescapeMd=m,n.unescapeAll=g,n.isValidEntityCode=a,n.fromCodePoint=u,n.escapeHtml=w,n.arrayReplaceAt=s,n.isSpace=E,n.isWhiteSpace=A,n.isMdAsciiPunct=V,n.isPunctChar=I,n.escapeRE=C,n.normalizeReference=U})(ee);var sa={},sae=function(e,t,r){var i,o,s,a,u=-1,l=e.posMax,c=e.pos;for(e.pos=t+1,i=1;e.pos<l;){if(s=e.src.charCodeAt(e.pos),s===93&&(i--,i===0)){o=!0;break}if(a=e.pos,e.md.inline.skipToken(e),s===91){if(a===e.pos-1)i++;else if(r)return e.pos=c,-1}}return o&&(u=e.pos),e.pos=c,u},mh=ee.unescapeAll,aae=function(e,t,r){var i,o,s=t,a={ok:!1,pos:0,lines:0,str:""};if(e.charCodeAt(s)===60){for(s++;s<r;){if(i=e.charCodeAt(s),i===10||i===60)return a;if(i===62)return a.pos=s+1,a.str=mh(e.slice(t+1,s)),a.ok=!0,a;if(i===92&&s+1<r){s+=2;continue}s++}return a}for(o=0;s<r&&(i=e.charCodeAt(s),!(i===32||i<32||i===127));){if(i===92&&s+1<r){if(e.charCodeAt(s+1)===32)break;s+=2;continue}if(i===40&&(o++,o>32))return a;if(i===41){if(o===0)break;o--}s++}return t===s||o!==0||(a.str=mh(e.slice(t,s)),a.pos=s,a.ok=!0),a},uae=ee.unescapeAll,lae=function(e,t,r){var i,o,s=0,a=t,u={ok:!1,pos:0,lines:0,str:""};if(a>=r||(o=e.charCodeAt(a),o!==34&&o!==39&&o!==40))return u;for(a++,o===40&&(o=41);a<r;){if(i=e.charCodeAt(a),i===o)return u.pos=a+1,u.lines=s,u.str=uae(e.slice(t+1,a)),u.ok=!0,u;if(i===40&&o===41)return u;i===10?s++:i===92&&a+1<r&&(a++,e.charCodeAt(a)===10&&s++),a++}return u};sa.parseLinkLabel=sae;sa.parseLinkDestination=aae;sa.parseLinkTitle=lae;var cae=ee.assign,dae=ee.unescapeAll,Wn=ee.escapeHtml,Rt={};Rt.code_inline=function(n,e,t,r,i){var o=n[e];return"<code"+i.renderAttrs(o)+">"+Wn(o.content)+"</code>"};Rt.code_block=function(n,e,t,r,i){var o=n[e];return"<pre"+i.renderAttrs(o)+"><code>"+Wn(n[e].content)+`</code></pre>
`};Rt.fence=function(n,e,t,r,i){var o=n[e],s=o.info?dae(o.info).trim():"",a="",u="",l,c,d,f,h;return s&&(d=s.split(/(\s+)/g),a=d[0],u=d.slice(2).join("")),t.highlight?l=t.highlight(o.content,a,u)||Wn(o.content):l=Wn(o.content),l.indexOf("<pre")===0?l+`
`:s?(c=o.attrIndex("class"),f=o.attrs?o.attrs.slice():[],c<0?f.push(["class",t.langPrefix+a]):(f[c]=f[c].slice(),f[c][1]+=" "+t.langPrefix+a),h={attrs:f},"<pre><code"+i.renderAttrs(h)+">"+l+`</code></pre>
`):"<pre><code"+i.renderAttrs(o)+">"+l+`</code></pre>
`};Rt.image=function(n,e,t,r,i){var o=n[e];return o.attrs[o.attrIndex("alt")][1]=i.renderInlineAsText(o.children,t,r),i.renderToken(n,e,t)};Rt.hardbreak=function(n,e,t){return t.xhtmlOut?`<br />
`:`<br>
`};Rt.softbreak=function(n,e,t){return t.breaks?t.xhtmlOut?`<br />
`:`<br>
`:`
`};Rt.text=function(n,e){return Wn(n[e].content)};Rt.html_block=function(n,e){return n[e].content};Rt.html_inline=function(n,e){return n[e].content};function Rr(){this.rules=cae({},Rt)}Rr.prototype.renderAttrs=function(e){var t,r,i;if(!e.attrs)return"";for(i="",t=0,r=e.attrs.length;t<r;t++)i+=" "+Wn(e.attrs[t][0])+'="'+Wn(e.attrs[t][1])+'"';return i};Rr.prototype.renderToken=function(e,t,r){var i,o="",s=!1,a=e[t];return a.hidden?"":(a.block&&a.nesting!==-1&&t&&e[t-1].hidden&&(o+=`
`),o+=(a.nesting===-1?"</":"<")+a.tag,o+=this.renderAttrs(a),a.nesting===0&&r.xhtmlOut&&(o+=" /"),a.block&&(s=!0,a.nesting===1&&t+1<e.length&&(i=e[t+1],(i.type==="inline"||i.hidden||i.nesting===-1&&i.tag===a.tag)&&(s=!1))),o+=s?`>
`:">",o)};Rr.prototype.renderInline=function(n,e,t){for(var r,i="",o=this.rules,s=0,a=n.length;s<a;s++)r=n[s].type,typeof o[r]<"u"?i+=o[r](n,s,e,t,this):i+=this.renderToken(n,s,e);return i};Rr.prototype.renderInlineAsText=function(n,e,t){for(var r="",i=0,o=n.length;i<o;i++)n[i].type==="text"?r+=n[i].content:n[i].type==="image"?r+=this.renderInlineAsText(n[i].children,e,t):n[i].type==="softbreak"&&(r+=`
`);return r};Rr.prototype.render=function(n,e,t){var r,i,o,s="",a=this.rules;for(r=0,i=n.length;r<i;r++)o=n[r].type,o==="inline"?s+=this.renderInline(n[r].children,e,t):typeof a[o]<"u"?s+=a[o](n,r,e,t,this):s+=this.renderToken(n,r,e,t);return s};var fae=Rr;function dt(){this.__rules__=[],this.__cache__=null}dt.prototype.__find__=function(n){for(var e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===n)return e;return-1};dt.prototype.__compile__=function(){var n=this,e=[""];n.__rules__.forEach(function(t){t.enabled&&t.alt.forEach(function(r){e.indexOf(r)<0&&e.push(r)})}),n.__cache__={},e.forEach(function(t){n.__cache__[t]=[],n.__rules__.forEach(function(r){r.enabled&&(t&&r.alt.indexOf(t)<0||n.__cache__[t].push(r.fn))})})};dt.prototype.at=function(n,e,t){var r=this.__find__(n),i=t||{};if(r===-1)throw new Error("Parser rule not found: "+n);this.__rules__[r].fn=e,this.__rules__[r].alt=i.alt||[],this.__cache__=null};dt.prototype.before=function(n,e,t,r){var i=this.__find__(n),o=r||{};if(i===-1)throw new Error("Parser rule not found: "+n);this.__rules__.splice(i,0,{name:e,enabled:!0,fn:t,alt:o.alt||[]}),this.__cache__=null};dt.prototype.after=function(n,e,t,r){var i=this.__find__(n),o=r||{};if(i===-1)throw new Error("Parser rule not found: "+n);this.__rules__.splice(i+1,0,{name:e,enabled:!0,fn:t,alt:o.alt||[]}),this.__cache__=null};dt.prototype.push=function(n,e,t){var r=t||{};this.__rules__.push({name:n,enabled:!0,fn:e,alt:r.alt||[]}),this.__cache__=null};dt.prototype.enable=function(n,e){Array.isArray(n)||(n=[n]);var t=[];return n.forEach(function(r){var i=this.__find__(r);if(i<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[i].enabled=!0,t.push(r)},this),this.__cache__=null,t};dt.prototype.enableOnly=function(n,e){Array.isArray(n)||(n=[n]),this.__rules__.forEach(function(t){t.enabled=!1}),this.enable(n,e)};dt.prototype.disable=function(n,e){Array.isArray(n)||(n=[n]);var t=[];return n.forEach(function(r){var i=this.__find__(r);if(i<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[i].enabled=!1,t.push(r)},this),this.__cache__=null,t};dt.prototype.getRules=function(n){return this.__cache__===null&&this.__compile__(),this.__cache__[n]||[]};var dc=dt,hae=/\r\n?|\n/g,pae=/\0/g,mae=function(e){var t;t=e.src.replace(hae,`
`),t=t.replace(pae,""),e.src=t},gae=function(e){var t;e.inlineMode?(t=new e.Token("inline","",0),t.content=e.src,t.map=[0,1],t.children=[],e.tokens.push(t)):e.md.block.parse(e.src,e.md,e.env,e.tokens)},bae=function(e){var t=e.tokens,r,i,o;for(i=0,o=t.length;i<o;i++)r=t[i],r.type==="inline"&&e.md.inline.parse(r.content,e.md,e.env,r.children)},yae=ee.arrayReplaceAt;function xae(n){return/^<a[>\s]/i.test(n)}function vae(n){return/^<\/a\s*>/i.test(n)}var kae=function(e){var t,r,i,o,s,a,u,l,c,d,f,h,p,m,g,y,x=e.tokens,v;if(e.md.options.linkify){for(r=0,i=x.length;r<i;r++)if(!(x[r].type!=="inline"||!e.md.linkify.pretest(x[r].content)))for(o=x[r].children,p=0,t=o.length-1;t>=0;t--){if(a=o[t],a.type==="link_close"){for(t--;o[t].level!==a.level&&o[t].type!=="link_open";)t--;continue}if(a.type==="html_inline"&&(xae(a.content)&&p>0&&p--,vae(a.content)&&p++),!(p>0)&&a.type==="text"&&e.md.linkify.test(a.content)){for(c=a.content,v=e.md.linkify.match(c),u=[],h=a.level,f=0,v.length>0&&v[0].index===0&&t>0&&o[t-1].type==="text_special"&&(v=v.slice(1)),l=0;l<v.length;l++)m=v[l].url,g=e.md.normalizeLink(m),e.md.validateLink(g)&&(y=v[l].text,v[l].schema?v[l].schema==="mailto:"&&!/^mailto:/i.test(y)?y=e.md.normalizeLinkText("mailto:"+y).replace(/^mailto:/,""):y=e.md.normalizeLinkText(y):y=e.md.normalizeLinkText("http://"+y).replace(/^http:\/\//,""),d=v[l].index,d>f&&(s=new e.Token("text","",0),s.content=c.slice(f,d),s.level=h,u.push(s)),s=new e.Token("link_open","a",1),s.attrs=[["href",g]],s.level=h++,s.markup="linkify",s.info="auto",u.push(s),s=new e.Token("text","",0),s.content=y,s.level=h,u.push(s),s=new e.Token("link_close","a",-1),s.level=--h,s.markup="linkify",s.info="auto",u.push(s),f=v[l].lastIndex);f<c.length&&(s=new e.Token("text","",0),s.content=c.slice(f),s.level=h,u.push(s)),x[r].children=o=yae(o,t,u)}}}},P1=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,wae=/\((c|tm|r)\)/i,Cae=/\((c|tm|r)\)/ig,Sae={c:"",r:"",tm:""};function Eae(n,e){return Sae[e.toLowerCase()]}function Aae(n){var e,t,r=0;for(e=n.length-1;e>=0;e--)t=n[e],t.type==="text"&&!r&&(t.content=t.content.replace(Cae,Eae)),t.type==="link_open"&&t.info==="auto"&&r--,t.type==="link_close"&&t.info==="auto"&&r++}function _ae(n){var e,t,r=0;for(e=n.length-1;e>=0;e--)t=n[e],t.type==="text"&&!r&&P1.test(t.content)&&(t.content=t.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),t.type==="link_open"&&t.info==="auto"&&r--,t.type==="link_close"&&t.info==="auto"&&r++}var Mae=function(e){var t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)e.tokens[t].type==="inline"&&(wae.test(e.tokens[t].content)&&Aae(e.tokens[t].children),P1.test(e.tokens[t].content)&&_ae(e.tokens[t].children))},gh=ee.isWhiteSpace,bh=ee.isPunctChar,yh=ee.isMdAsciiPunct,Tae=/['"]/,xh=/['"]/g,vh="";function go(n,e,t){return n.slice(0,e)+t+n.slice(e+1)}function Dae(n,e){var t,r,i,o,s,a,u,l,c,d,f,h,p,m,g,y,x,v,b,w,k;for(b=[],t=0;t<n.length;t++){for(r=n[t],u=n[t].level,x=b.length-1;x>=0&&!(b[x].level<=u);x--);if(b.length=x+1,r.type==="text"){i=r.content,s=0,a=i.length;e:for(;s<a&&(xh.lastIndex=s,o=xh.exec(i),!!o);){if(g=y=!0,s=o.index+1,v=o[0]==="'",c=32,o.index-1>=0)c=i.charCodeAt(o.index-1);else for(x=t-1;x>=0&&!(n[x].type==="softbreak"||n[x].type==="hardbreak");x--)if(n[x].content){c=n[x].content.charCodeAt(n[x].content.length-1);break}if(d=32,s<a)d=i.charCodeAt(s);else for(x=t+1;x<n.length&&!(n[x].type==="softbreak"||n[x].type==="hardbreak");x++)if(n[x].content){d=n[x].content.charCodeAt(0);break}if(f=yh(c)||bh(String.fromCharCode(c)),h=yh(d)||bh(String.fromCharCode(d)),p=gh(c),m=gh(d),m?g=!1:h&&(p||f||(g=!1)),p?y=!1:f&&(m||h||(y=!1)),d===34&&o[0]==='"'&&c>=48&&c<=57&&(y=g=!1),g&&y&&(g=f,y=h),!g&&!y){v&&(r.content=go(r.content,o.index,vh));continue}if(y){for(x=b.length-1;x>=0&&(l=b[x],!(b[x].level<u));x--)if(l.single===v&&b[x].level===u){l=b[x],v?(w=e.md.options.quotes[2],k=e.md.options.quotes[3]):(w=e.md.options.quotes[0],k=e.md.options.quotes[1]),r.content=go(r.content,o.index,k),n[l.token].content=go(n[l.token].content,l.pos,w),s+=k.length-1,l.token===t&&(s+=w.length-1),i=r.content,a=i.length,b.length=x;continue e}}g?b.push({token:t,pos:o.index,single:v,level:u}):y&&v&&(r.content=go(r.content,o.index,vh))}}}}var Lae=function(e){var t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)e.tokens[t].type!=="inline"||!Tae.test(e.tokens[t].content)||Dae(e.tokens[t].children,e)},Oae=function(e){var t,r,i,o,s,a,u=e.tokens;for(t=0,r=u.length;t<r;t++)if(u[t].type==="inline"){for(i=u[t].children,s=i.length,o=0;o<s;o++)i[o].type==="text_special"&&(i[o].type="text");for(o=a=0;o<s;o++)i[o].type==="text"&&o+1<s&&i[o+1].type==="text"?i[o+1].content=i[o].content+i[o+1].content:(o!==a&&(i[a]=i[o]),a++);o!==a&&(i.length=a)}};function Nr(n,e,t){this.type=n,this.tag=e,this.attrs=null,this.map=null,this.nesting=t,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}Nr.prototype.attrIndex=function(e){var t,r,i;if(!this.attrs)return-1;for(t=this.attrs,r=0,i=t.length;r<i;r++)if(t[r][0]===e)return r;return-1};Nr.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]};Nr.prototype.attrSet=function(e,t){var r=this.attrIndex(e),i=[e,t];r<0?this.attrPush(i):this.attrs[r]=i};Nr.prototype.attrGet=function(e){var t=this.attrIndex(e),r=null;return t>=0&&(r=this.attrs[t][1]),r};Nr.prototype.attrJoin=function(e,t){var r=this.attrIndex(e);r<0?this.attrPush([e,t]):this.attrs[r][1]=this.attrs[r][1]+" "+t};var fc=Nr,Rae=fc;function B1(n,e,t){this.src=n,this.env=t,this.tokens=[],this.inlineMode=!1,this.md=e}B1.prototype.Token=Rae;var Nae=B1,Hae=dc,cu=[["normalize",mae],["block",gae],["inline",bae],["linkify",kae],["replacements",Mae],["smartquotes",Lae],["text_join",Oae]];function hc(){this.ruler=new Hae;for(var n=0;n<cu.length;n++)this.ruler.push(cu[n][0],cu[n][1])}hc.prototype.process=function(n){var e,t,r;for(r=this.ruler.getRules(""),e=0,t=r.length;e<t;e++)r[e](n)};hc.prototype.State=Nae;var Iae=hc,du=ee.isSpace;function fu(n,e){var t=n.bMarks[e]+n.tShift[e],r=n.eMarks[e];return n.src.slice(t,r)}function kh(n){var e=[],t=0,r=n.length,i,o=!1,s=0,a="";for(i=n.charCodeAt(t);t<r;)i===124&&(o?(a+=n.substring(s,t-1),s=t):(e.push(a+n.substring(s,t)),a="",s=t+1)),o=i===92,t++,i=n.charCodeAt(t);return e.push(a+n.substring(s)),e}var Fae=function(e,t,r,i){var o,s,a,u,l,c,d,f,h,p,m,g,y,x,v,b,w,k;if(t+2>r||(c=t+1,e.sCount[c]<e.blkIndent)||e.sCount[c]-e.blkIndent>=4||(a=e.bMarks[c]+e.tShift[c],a>=e.eMarks[c])||(w=e.src.charCodeAt(a++),w!==124&&w!==45&&w!==58)||a>=e.eMarks[c]||(k=e.src.charCodeAt(a++),k!==124&&k!==45&&k!==58&&!du(k))||w===45&&du(k))return!1;for(;a<e.eMarks[c];){if(o=e.src.charCodeAt(a),o!==124&&o!==45&&o!==58&&!du(o))return!1;a++}for(s=fu(e,t+1),d=s.split("|"),p=[],u=0;u<d.length;u++){if(m=d[u].trim(),!m){if(u===0||u===d.length-1)continue;return!1}if(!/^:?-+:?$/.test(m))return!1;m.charCodeAt(m.length-1)===58?p.push(m.charCodeAt(0)===58?"center":"right"):m.charCodeAt(0)===58?p.push("left"):p.push("")}if(s=fu(e,t).trim(),s.indexOf("|")===-1||e.sCount[t]-e.blkIndent>=4||(d=kh(s),d.length&&d[0]===""&&d.shift(),d.length&&d[d.length-1]===""&&d.pop(),f=d.length,f===0||f!==p.length))return!1;if(i)return!0;for(x=e.parentType,e.parentType="table",b=e.md.block.ruler.getRules("blockquote"),h=e.push("table_open","table",1),h.map=g=[t,0],h=e.push("thead_open","thead",1),h.map=[t,t+1],h=e.push("tr_open","tr",1),h.map=[t,t+1],u=0;u<d.length;u++)h=e.push("th_open","th",1),p[u]&&(h.attrs=[["style","text-align:"+p[u]]]),h=e.push("inline","",0),h.content=d[u].trim(),h.children=[],h=e.push("th_close","th",-1);for(h=e.push("tr_close","tr",-1),h=e.push("thead_close","thead",-1),c=t+2;c<r&&!(e.sCount[c]<e.blkIndent);c++){for(v=!1,u=0,l=b.length;u<l;u++)if(b[u](e,c,r,!0)){v=!0;break}if(v||(s=fu(e,c).trim(),!s)||e.sCount[c]-e.blkIndent>=4)break;for(d=kh(s),d.length&&d[0]===""&&d.shift(),d.length&&d[d.length-1]===""&&d.pop(),c===t+2&&(h=e.push("tbody_open","tbody",1),h.map=y=[t+2,0]),h=e.push("tr_open","tr",1),h.map=[c,c+1],u=0;u<f;u++)h=e.push("td_open","td",1),p[u]&&(h.attrs=[["style","text-align:"+p[u]]]),h=e.push("inline","",0),h.content=d[u]?d[u].trim():"",h.children=[],h=e.push("td_close","td",-1);h=e.push("tr_close","tr",-1)}return y&&(h=e.push("tbody_close","tbody",-1),y[1]=c),h=e.push("table_close","table",-1),g[1]=c,e.parentType=x,e.line=c,!0},Pae=function(e,t,r){var i,o,s;if(e.sCount[t]-e.blkIndent<4)return!1;for(o=i=t+1;i<r;){if(e.isEmpty(i)){i++;continue}if(e.sCount[i]-e.blkIndent>=4){i++,o=i;continue}break}return e.line=o,s=e.push("code_block","code",0),s.content=e.getLines(t,o,4+e.blkIndent,!1)+`
`,s.map=[t,e.line],!0},Bae=function(e,t,r,i){var o,s,a,u,l,c,d,f=!1,h=e.bMarks[t]+e.tShift[t],p=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||h+3>p||(o=e.src.charCodeAt(h),o!==126&&o!==96)||(l=h,h=e.skipChars(h,o),s=h-l,s<3)||(d=e.src.slice(l,h),a=e.src.slice(h,p),o===96&&a.indexOf(String.fromCharCode(o))>=0))return!1;if(i)return!0;for(u=t;u++,!(u>=r||(h=l=e.bMarks[u]+e.tShift[u],p=e.eMarks[u],h<p&&e.sCount[u]<e.blkIndent));)if(e.src.charCodeAt(h)===o&&!(e.sCount[u]-e.blkIndent>=4)&&(h=e.skipChars(h,o),!(h-l<s)&&(h=e.skipSpaces(h),!(h<p)))){f=!0;break}return s=e.sCount[t],e.line=u+(f?1:0),c=e.push("fence","code",0),c.info=a,c.content=e.getLines(t+1,u,s,!0),c.markup=d,c.map=[t,e.line],!0},$ae=ee.isSpace,zae=function(e,t,r,i){var o,s,a,u,l,c,d,f,h,p,m,g,y,x,v,b,w,k,C,E,A=e.lineMax,T=e.bMarks[t]+e.tShift[t],I=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(T)!==62)return!1;if(i)return!0;for(p=[],m=[],x=[],v=[],k=e.md.block.ruler.getRules("blockquote"),y=e.parentType,e.parentType="blockquote",f=t;f<r&&(E=e.sCount[f]<e.blkIndent,T=e.bMarks[f]+e.tShift[f],I=e.eMarks[f],!(T>=I));f++){if(e.src.charCodeAt(T++)===62&&!E){for(u=e.sCount[f]+1,e.src.charCodeAt(T)===32?(T++,u++,o=!1,b=!0):e.src.charCodeAt(T)===9?(b=!0,(e.bsCount[f]+u)%4===3?(T++,u++,o=!1):o=!0):b=!1,h=u,p.push(e.bMarks[f]),e.bMarks[f]=T;T<I&&(s=e.src.charCodeAt(T),$ae(s));){s===9?h+=4-(h+e.bsCount[f]+(o?1:0))%4:h++;T++}c=T>=I,m.push(e.bsCount[f]),e.bsCount[f]=e.sCount[f]+1+(b?1:0),x.push(e.sCount[f]),e.sCount[f]=h-u,v.push(e.tShift[f]),e.tShift[f]=T-e.bMarks[f];continue}if(c)break;for(w=!1,a=0,l=k.length;a<l;a++)if(k[a](e,f,r,!0)){w=!0;break}if(w){e.lineMax=f,e.blkIndent!==0&&(p.push(e.bMarks[f]),m.push(e.bsCount[f]),v.push(e.tShift[f]),x.push(e.sCount[f]),e.sCount[f]-=e.blkIndent);break}p.push(e.bMarks[f]),m.push(e.bsCount[f]),v.push(e.tShift[f]),x.push(e.sCount[f]),e.sCount[f]=-1}for(g=e.blkIndent,e.blkIndent=0,C=e.push("blockquote_open","blockquote",1),C.markup=">",C.map=d=[t,0],e.md.block.tokenize(e,t,f),C=e.push("blockquote_close","blockquote",-1),C.markup=">",e.lineMax=A,e.parentType=y,d[1]=e.line,a=0;a<v.length;a++)e.bMarks[a+t]=p[a],e.tShift[a+t]=v[a],e.sCount[a+t]=x[a],e.bsCount[a+t]=m[a];return e.blkIndent=g,!0},Vae=ee.isSpace,qae=function(e,t,r,i){var o,s,a,u,l=e.bMarks[t]+e.tShift[t],c=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||(o=e.src.charCodeAt(l++),o!==42&&o!==45&&o!==95))return!1;for(s=1;l<c;){if(a=e.src.charCodeAt(l++),a!==o&&!Vae(a))return!1;a===o&&s++}return s<3?!1:(i||(e.line=t+1,u=e.push("hr","hr",0),u.map=[t,e.line],u.markup=Array(s+1).join(String.fromCharCode(o))),!0)},$1=ee.isSpace;function wh(n,e){var t,r,i,o;return r=n.bMarks[e]+n.tShift[e],i=n.eMarks[e],t=n.src.charCodeAt(r++),t!==42&&t!==45&&t!==43||r<i&&(o=n.src.charCodeAt(r),!$1(o))?-1:r}function Ch(n,e){var t,r=n.bMarks[e]+n.tShift[e],i=r,o=n.eMarks[e];if(i+1>=o||(t=n.src.charCodeAt(i++),t<48||t>57))return-1;for(;;){if(i>=o)return-1;if(t=n.src.charCodeAt(i++),t>=48&&t<=57){if(i-r>=10)return-1;continue}if(t===41||t===46)break;return-1}return i<o&&(t=n.src.charCodeAt(i),!$1(t))?-1:i}function jae(n,e){var t,r,i=n.level+2;for(t=e+2,r=n.tokens.length-2;t<r;t++)n.tokens[t].level===i&&n.tokens[t].type==="paragraph_open"&&(n.tokens[t+2].hidden=!0,n.tokens[t].hidden=!0,t+=2)}var Uae=function(e,t,r,i){var o,s,a,u,l,c,d,f,h,p,m,g,y,x,v,b,w,k,C,E,A,T,I,V,U,M,R,D=t,P=!1,G=!0;if(e.sCount[D]-e.blkIndent>=4||e.listIndent>=0&&e.sCount[D]-e.listIndent>=4&&e.sCount[D]<e.blkIndent)return!1;if(i&&e.parentType==="paragraph"&&e.sCount[D]>=e.blkIndent&&(P=!0),(T=Ch(e,D))>=0){if(d=!0,V=e.bMarks[D]+e.tShift[D],y=Number(e.src.slice(V,T-1)),P&&y!==1)return!1}else if((T=wh(e,D))>=0)d=!1;else return!1;if(P&&e.skipSpaces(T)>=e.eMarks[D])return!1;if(i)return!0;for(g=e.src.charCodeAt(T-1),m=e.tokens.length,d?(R=e.push("ordered_list_open","ol",1),y!==1&&(R.attrs=[["start",y]])):R=e.push("bullet_list_open","ul",1),R.map=p=[D,0],R.markup=String.fromCharCode(g),I=!1,M=e.md.block.ruler.getRules("list"),w=e.parentType,e.parentType="list";D<r;){for(A=T,x=e.eMarks[D],c=v=e.sCount[D]+T-(e.bMarks[D]+e.tShift[D]);A<x;){if(o=e.src.charCodeAt(A),o===9)v+=4-(v+e.bsCount[D])%4;else if(o===32)v++;else break;A++}if(s=A,s>=x?l=1:l=v-c,l>4&&(l=1),u=c+l,R=e.push("list_item_open","li",1),R.markup=String.fromCharCode(g),R.map=f=[D,0],d&&(R.info=e.src.slice(V,T-1)),E=e.tight,C=e.tShift[D],k=e.sCount[D],b=e.listIndent,e.listIndent=e.blkIndent,e.blkIndent=u,e.tight=!0,e.tShift[D]=s-e.bMarks[D],e.sCount[D]=v,s>=x&&e.isEmpty(D+1)?e.line=Math.min(e.line+2,r):e.md.block.tokenize(e,D,r,!0),(!e.tight||I)&&(G=!1),I=e.line-D>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=b,e.tShift[D]=C,e.sCount[D]=k,e.tight=E,R=e.push("list_item_close","li",-1),R.markup=String.fromCharCode(g),D=e.line,f[1]=D,D>=r||e.sCount[D]<e.blkIndent||e.sCount[D]-e.blkIndent>=4)break;for(U=!1,a=0,h=M.length;a<h;a++)if(M[a](e,D,r,!0)){U=!0;break}if(U)break;if(d){if(T=Ch(e,D),T<0)break;V=e.bMarks[D]+e.tShift[D]}else if(T=wh(e,D),T<0)break;if(g!==e.src.charCodeAt(T-1))break}return d?R=e.push("ordered_list_close","ol",-1):R=e.push("bullet_list_close","ul",-1),R.markup=String.fromCharCode(g),p[1]=D,e.line=D,e.parentType=w,G&&jae(e,m),!0},Wae=ee.normalizeReference,bo=ee.isSpace,Zae=function(e,t,r,i){var o,s,a,u,l,c,d,f,h,p,m,g,y,x,v,b,w=0,k=e.bMarks[t]+e.tShift[t],C=e.eMarks[t],E=t+1;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(k)!==91)return!1;for(;++k<C;)if(e.src.charCodeAt(k)===93&&e.src.charCodeAt(k-1)!==92){if(k+1===C||e.src.charCodeAt(k+1)!==58)return!1;break}for(u=e.lineMax,v=e.md.block.ruler.getRules("reference"),p=e.parentType,e.parentType="reference";E<u&&!e.isEmpty(E);E++)if(!(e.sCount[E]-e.blkIndent>3)&&!(e.sCount[E]<0)){for(x=!1,c=0,d=v.length;c<d;c++)if(v[c](e,E,u,!0)){x=!0;break}if(x)break}for(y=e.getLines(t,E,e.blkIndent,!1).trim(),C=y.length,k=1;k<C;k++){if(o=y.charCodeAt(k),o===91)return!1;if(o===93){h=k;break}else o===10?w++:o===92&&(k++,k<C&&y.charCodeAt(k)===10&&w++)}if(h<0||y.charCodeAt(h+1)!==58)return!1;for(k=h+2;k<C;k++)if(o=y.charCodeAt(k),o===10)w++;else if(!bo(o))break;if(m=e.md.helpers.parseLinkDestination(y,k,C),!m.ok||(l=e.md.normalizeLink(m.str),!e.md.validateLink(l)))return!1;for(k=m.pos,w+=m.lines,s=k,a=w,g=k;k<C;k++)if(o=y.charCodeAt(k),o===10)w++;else if(!bo(o))break;for(m=e.md.helpers.parseLinkTitle(y,k,C),k<C&&g!==k&&m.ok?(b=m.str,k=m.pos,w+=m.lines):(b="",k=s,w=a);k<C&&(o=y.charCodeAt(k),!!bo(o));)k++;if(k<C&&y.charCodeAt(k)!==10&&b)for(b="",k=s,w=a;k<C&&(o=y.charCodeAt(k),!!bo(o));)k++;return k<C&&y.charCodeAt(k)!==10||(f=Wae(y.slice(1,h)),!f)?!1:(i||(typeof e.env.references>"u"&&(e.env.references={}),typeof e.env.references[f]>"u"&&(e.env.references[f]={title:b,href:l}),e.parentType=p,e.line=t+w+1),!0)},Kae=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],aa={},Gae="[a-zA-Z_:][a-zA-Z0-9:._-]*",Jae="[^\"'=<>`\\x00-\\x20]+",Yae="'[^']*'",Xae='"[^"]*"',Qae="(?:"+Jae+"|"+Yae+"|"+Xae+")",eue="(?:\\s+"+Gae+"(?:\\s*=\\s*"+Qae+")?)",z1="<[A-Za-z][A-Za-z0-9\\-]*"+eue+"*\\s*\\/?>",V1="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",tue="<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->",nue="<[?][\\s\\S]*?[?]>",rue="<![A-Z]+\\s+[^>]*>",iue="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",oue=new RegExp("^(?:"+z1+"|"+V1+"|"+tue+"|"+nue+"|"+rue+"|"+iue+")"),sue=new RegExp("^(?:"+z1+"|"+V1+")");aa.HTML_TAG_RE=oue;aa.HTML_OPEN_CLOSE_TAG_RE=sue;var aue=Kae,uue=aa.HTML_OPEN_CLOSE_TAG_RE,or=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+aue.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(uue.source+"\\s*$"),/^$/,!1]],lue=function(e,t,r,i){var o,s,a,u,l=e.bMarks[t]+e.tShift[t],c=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||!e.md.options.html||e.src.charCodeAt(l)!==60)return!1;for(u=e.src.slice(l,c),o=0;o<or.length&&!or[o][0].test(u);o++);if(o===or.length)return!1;if(i)return or[o][2];if(s=t+1,!or[o][1].test(u)){for(;s<r&&!(e.sCount[s]<e.blkIndent);s++)if(l=e.bMarks[s]+e.tShift[s],c=e.eMarks[s],u=e.src.slice(l,c),or[o][1].test(u)){u.length!==0&&s++;break}}return e.line=s,a=e.push("html_block","",0),a.map=[t,s],a.content=e.getLines(t,s,e.blkIndent,!0),!0},Sh=ee.isSpace,cue=function(e,t,r,i){var o,s,a,u,l=e.bMarks[t]+e.tShift[t],c=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||(o=e.src.charCodeAt(l),o!==35||l>=c))return!1;for(s=1,o=e.src.charCodeAt(++l);o===35&&l<c&&s<=6;)s++,o=e.src.charCodeAt(++l);return s>6||l<c&&!Sh(o)?!1:(i||(c=e.skipSpacesBack(c,l),a=e.skipCharsBack(c,35,l),a>l&&Sh(e.src.charCodeAt(a-1))&&(c=a),e.line=t+1,u=e.push("heading_open","h"+String(s),1),u.markup="########".slice(0,s),u.map=[t,e.line],u=e.push("inline","",0),u.content=e.src.slice(l,c).trim(),u.map=[t,e.line],u.children=[],u=e.push("heading_close","h"+String(s),-1),u.markup="########".slice(0,s)),!0)},due=function(e,t,r){var i,o,s,a,u,l,c,d,f,h=t+1,p,m=e.md.block.ruler.getRules("paragraph");if(e.sCount[t]-e.blkIndent>=4)return!1;for(p=e.parentType,e.parentType="paragraph";h<r&&!e.isEmpty(h);h++)if(!(e.sCount[h]-e.blkIndent>3)){if(e.sCount[h]>=e.blkIndent&&(l=e.bMarks[h]+e.tShift[h],c=e.eMarks[h],l<c&&(f=e.src.charCodeAt(l),(f===45||f===61)&&(l=e.skipChars(l,f),l=e.skipSpaces(l),l>=c)))){d=f===61?1:2;break}if(!(e.sCount[h]<0)){for(o=!1,s=0,a=m.length;s<a;s++)if(m[s](e,h,r,!0)){o=!0;break}if(o)break}}return d?(i=e.getLines(t,h,e.blkIndent,!1).trim(),e.line=h+1,u=e.push("heading_open","h"+String(d),1),u.markup=String.fromCharCode(f),u.map=[t,e.line],u=e.push("inline","",0),u.content=i,u.map=[t,e.line-1],u.children=[],u=e.push("heading_close","h"+String(d),-1),u.markup=String.fromCharCode(f),e.parentType=p,!0):!1},fue=function(e,t,r){var i,o,s,a,u,l,c=t+1,d=e.md.block.ruler.getRules("paragraph");for(l=e.parentType,e.parentType="paragraph";c<r&&!e.isEmpty(c);c++)if(!(e.sCount[c]-e.blkIndent>3)&&!(e.sCount[c]<0)){for(o=!1,s=0,a=d.length;s<a;s++)if(d[s](e,c,r,!0)){o=!0;break}if(o)break}return i=e.getLines(t,c,e.blkIndent,!1).trim(),e.line=c,u=e.push("paragraph_open","p",1),u.map=[t,e.line],u=e.push("inline","",0),u.content=i,u.map=[t,e.line],u.children=[],u=e.push("paragraph_close","p",-1),e.parentType=l,!0},q1=fc,ua=ee.isSpace;function Nt(n,e,t,r){var i,o,s,a,u,l,c,d;for(this.src=n,this.md=e,this.env=t,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0,this.result="",o=this.src,d=!1,s=a=l=c=0,u=o.length;a<u;a++){if(i=o.charCodeAt(a),!d)if(ua(i)){l++,i===9?c+=4-c%4:c++;continue}else d=!0;(i===10||a===u-1)&&(i!==10&&a++,this.bMarks.push(s),this.eMarks.push(a),this.tShift.push(l),this.sCount.push(c),this.bsCount.push(0),d=!1,l=0,c=0,s=a+1)}this.bMarks.push(o.length),this.eMarks.push(o.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}Nt.prototype.push=function(n,e,t){var r=new q1(n,e,t);return r.block=!0,t<0&&this.level--,r.level=this.level,t>0&&this.level++,this.tokens.push(r),r};Nt.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};Nt.prototype.skipEmptyLines=function(e){for(var t=this.lineMax;e<t&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};Nt.prototype.skipSpaces=function(e){for(var t,r=this.src.length;e<r&&(t=this.src.charCodeAt(e),!!ua(t));e++);return e};Nt.prototype.skipSpacesBack=function(e,t){if(e<=t)return e;for(;e>t;)if(!ua(this.src.charCodeAt(--e)))return e+1;return e};Nt.prototype.skipChars=function(e,t){for(var r=this.src.length;e<r&&this.src.charCodeAt(e)===t;e++);return e};Nt.prototype.skipCharsBack=function(e,t,r){if(e<=r)return e;for(;e>r;)if(t!==this.src.charCodeAt(--e))return e+1;return e};Nt.prototype.getLines=function(e,t,r,i){var o,s,a,u,l,c,d,f=e;if(e>=t)return"";for(c=new Array(t-e),o=0;f<t;f++,o++){for(s=0,d=u=this.bMarks[f],f+1<t||i?l=this.eMarks[f]+1:l=this.eMarks[f];u<l&&s<r;){if(a=this.src.charCodeAt(u),ua(a))a===9?s+=4-(s+this.bsCount[f])%4:s++;else if(u-d<this.tShift[f])s++;else break;u++}s>r?c[o]=new Array(s-r+1).join(" ")+this.src.slice(u,l):c[o]=this.src.slice(u,l)}return c.join("")};Nt.prototype.Token=q1;var hue=Nt,pue=dc,yo=[["table",Fae,["paragraph","reference"]],["code",Pae],["fence",Bae,["paragraph","reference","blockquote","list"]],["blockquote",zae,["paragraph","reference","blockquote","list"]],["hr",qae,["paragraph","reference","blockquote","list"]],["list",Uae,["paragraph","reference","blockquote"]],["reference",Zae],["html_block",lue,["paragraph","reference","blockquote"]],["heading",cue,["paragraph","reference","blockquote"]],["lheading",due],["paragraph",fue]];function la(){this.ruler=new pue;for(var n=0;n<yo.length;n++)this.ruler.push(yo[n][0],yo[n][1],{alt:(yo[n][2]||[]).slice()})}la.prototype.tokenize=function(n,e,t){for(var r,i,o,s=this.ruler.getRules(""),a=s.length,u=e,l=!1,c=n.md.options.maxNesting;u<t&&(n.line=u=n.skipEmptyLines(u),!(u>=t||n.sCount[u]<n.blkIndent));){if(n.level>=c){n.line=t;break}for(o=n.line,i=0;i<a;i++)if(r=s[i](n,u,t,!1),r){if(o>=n.line)throw new Error("block rule didn't increment state.line");break}if(!r)throw new Error("none of the block rules matched");n.tight=!l,n.isEmpty(n.line-1)&&(l=!0),u=n.line,u<t&&n.isEmpty(u)&&(l=!0,u++,n.line=u)}};la.prototype.parse=function(n,e,t,r){var i;n&&(i=new this.State(n,e,t,r),this.tokenize(i,i.line,i.lineMax))};la.prototype.State=hue;var mue=la;function gue(n){switch(n){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}var bue=function(e,t){for(var r=e.pos;r<e.posMax&&!gue(e.src.charCodeAt(r));)r++;return r===e.pos?!1:(t||(e.pending+=e.src.slice(e.pos,r)),e.pos=r,!0)},yue=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i,xue=function(e,t){var r,i,o,s,a,u,l,c;return!e.md.options.linkify||e.linkLevel>0||(r=e.pos,i=e.posMax,r+3>i)||e.src.charCodeAt(r)!==58||e.src.charCodeAt(r+1)!==47||e.src.charCodeAt(r+2)!==47||(o=e.pending.match(yue),!o)||(s=o[1],a=e.md.linkify.matchAtStart(e.src.slice(r-s.length)),!a)||(u=a.url,u.length<=s.length)||(u=u.replace(/\*+$/,""),l=e.md.normalizeLink(u),!e.md.validateLink(l))?!1:(t||(e.pending=e.pending.slice(0,-s.length),c=e.push("link_open","a",1),c.attrs=[["href",l]],c.markup="linkify",c.info="auto",c=e.push("text","",0),c.content=e.md.normalizeLinkText(u),c=e.push("link_close","a",-1),c.markup="linkify",c.info="auto"),e.pos+=u.length-s.length,!0)},vue=ee.isSpace,kue=function(e,t){var r,i,o,s=e.pos;if(e.src.charCodeAt(s)!==10)return!1;if(r=e.pending.length-1,i=e.posMax,!t)if(r>=0&&e.pending.charCodeAt(r)===32)if(r>=1&&e.pending.charCodeAt(r-1)===32){for(o=r-1;o>=1&&e.pending.charCodeAt(o-1)===32;)o--;e.pending=e.pending.slice(0,o),e.push("hardbreak","br",0)}else e.pending=e.pending.slice(0,-1),e.push("softbreak","br",0);else e.push("softbreak","br",0);for(s++;s<i&&vue(e.src.charCodeAt(s));)s++;return e.pos=s,!0},wue=ee.isSpace,pc=[];for(var Eh=0;Eh<256;Eh++)pc.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(n){pc[n.charCodeAt(0)]=1});var Cue=function(e,t){var r,i,o,s,a,u=e.pos,l=e.posMax;if(e.src.charCodeAt(u)!==92||(u++,u>=l))return!1;if(r=e.src.charCodeAt(u),r===10){for(t||e.push("hardbreak","br",0),u++;u<l&&(r=e.src.charCodeAt(u),!!wue(r));)u++;return e.pos=u,!0}return s=e.src[u],r>=55296&&r<=56319&&u+1<l&&(i=e.src.charCodeAt(u+1),i>=56320&&i<=57343&&(s+=e.src[u+1],u++)),o="\\"+s,t||(a=e.push("text_special","",0),r<256&&pc[r]!==0?a.content=s:a.content=o,a.markup=o,a.info="escape"),e.pos=u+1,!0},Sue=function(e,t){var r,i,o,s,a,u,l,c,d=e.pos,f=e.src.charCodeAt(d);if(f!==96)return!1;for(r=d,d++,i=e.posMax;d<i&&e.src.charCodeAt(d)===96;)d++;if(o=e.src.slice(r,d),l=o.length,e.backticksScanned&&(e.backticks[l]||0)<=r)return t||(e.pending+=o),e.pos+=l,!0;for(u=d;(a=e.src.indexOf("`",u))!==-1;){for(u=a+1;u<i&&e.src.charCodeAt(u)===96;)u++;if(c=u-a,c===l)return t||(s=e.push("code_inline","code",0),s.markup=o,s.content=e.src.slice(d,a).replace(/\n/g," ").replace(/^ (.+) $/,"$1")),e.pos=u,!0;e.backticks[c]=a}return e.backticksScanned=!0,t||(e.pending+=o),e.pos+=l,!0},ca={};ca.tokenize=function(e,t){var r,i,o,s,a,u=e.pos,l=e.src.charCodeAt(u);if(t||l!==126||(i=e.scanDelims(e.pos,!0),s=i.length,a=String.fromCharCode(l),s<2))return!1;for(s%2&&(o=e.push("text","",0),o.content=a,s--),r=0;r<s;r+=2)o=e.push("text","",0),o.content=a+a,e.delimiters.push({marker:l,length:0,token:e.tokens.length-1,end:-1,open:i.can_open,close:i.can_close});return e.pos+=i.length,!0};function Ah(n,e){var t,r,i,o,s,a=[],u=e.length;for(t=0;t<u;t++)i=e[t],i.marker===126&&i.end!==-1&&(o=e[i.end],s=n.tokens[i.token],s.type="s_open",s.tag="s",s.nesting=1,s.markup="~~",s.content="",s=n.tokens[o.token],s.type="s_close",s.tag="s",s.nesting=-1,s.markup="~~",s.content="",n.tokens[o.token-1].type==="text"&&n.tokens[o.token-1].content==="~"&&a.push(o.token-1));for(;a.length;){for(t=a.pop(),r=t+1;r<n.tokens.length&&n.tokens[r].type==="s_close";)r++;r--,t!==r&&(s=n.tokens[r],n.tokens[r]=n.tokens[t],n.tokens[t]=s)}}ca.postProcess=function(e){var t,r=e.tokens_meta,i=e.tokens_meta.length;for(Ah(e,e.delimiters),t=0;t<i;t++)r[t]&&r[t].delimiters&&Ah(e,r[t].delimiters)};var da={};da.tokenize=function(e,t){var r,i,o,s=e.pos,a=e.src.charCodeAt(s);if(t||a!==95&&a!==42)return!1;for(i=e.scanDelims(e.pos,a===42),r=0;r<i.length;r++)o=e.push("text","",0),o.content=String.fromCharCode(a),e.delimiters.push({marker:a,length:i.length,token:e.tokens.length-1,end:-1,open:i.can_open,close:i.can_close});return e.pos+=i.length,!0};function _h(n,e){var t,r,i,o,s,a,u=e.length;for(t=u-1;t>=0;t--)r=e[t],!(r.marker!==95&&r.marker!==42)&&r.end!==-1&&(i=e[r.end],a=t>0&&e[t-1].end===r.end+1&&e[t-1].marker===r.marker&&e[t-1].token===r.token-1&&e[r.end+1].token===i.token+1,s=String.fromCharCode(r.marker),o=n.tokens[r.token],o.type=a?"strong_open":"em_open",o.tag=a?"strong":"em",o.nesting=1,o.markup=a?s+s:s,o.content="",o=n.tokens[i.token],o.type=a?"strong_close":"em_close",o.tag=a?"strong":"em",o.nesting=-1,o.markup=a?s+s:s,o.content="",a&&(n.tokens[e[t-1].token].content="",n.tokens[e[r.end+1].token].content="",t--))}da.postProcess=function(e){var t,r=e.tokens_meta,i=e.tokens_meta.length;for(_h(e,e.delimiters),t=0;t<i;t++)r[t]&&r[t].delimiters&&_h(e,r[t].delimiters)};var Eue=ee.normalizeReference,hu=ee.isSpace,Aue=function(e,t){var r,i,o,s,a,u,l,c,d,f="",h="",p=e.pos,m=e.posMax,g=e.pos,y=!0;if(e.src.charCodeAt(e.pos)!==91||(a=e.pos+1,s=e.md.helpers.parseLinkLabel(e,e.pos,!0),s<0))return!1;if(u=s+1,u<m&&e.src.charCodeAt(u)===40){for(y=!1,u++;u<m&&(i=e.src.charCodeAt(u),!(!hu(i)&&i!==10));u++);if(u>=m)return!1;if(g=u,l=e.md.helpers.parseLinkDestination(e.src,u,e.posMax),l.ok){for(f=e.md.normalizeLink(l.str),e.md.validateLink(f)?u=l.pos:f="",g=u;u<m&&(i=e.src.charCodeAt(u),!(!hu(i)&&i!==10));u++);if(l=e.md.helpers.parseLinkTitle(e.src,u,e.posMax),u<m&&g!==u&&l.ok)for(h=l.str,u=l.pos;u<m&&(i=e.src.charCodeAt(u),!(!hu(i)&&i!==10));u++);}(u>=m||e.src.charCodeAt(u)!==41)&&(y=!0),u++}if(y){if(typeof e.env.references>"u")return!1;if(u<m&&e.src.charCodeAt(u)===91?(g=u+1,u=e.md.helpers.parseLinkLabel(e,u),u>=0?o=e.src.slice(g,u++):u=s+1):u=s+1,o||(o=e.src.slice(a,s)),c=e.env.references[Eue(o)],!c)return e.pos=p,!1;f=c.href,h=c.title}return t||(e.pos=a,e.posMax=s,d=e.push("link_open","a",1),d.attrs=r=[["href",f]],h&&r.push(["title",h]),e.linkLevel++,e.md.inline.tokenize(e),e.linkLevel--,d=e.push("link_close","a",-1)),e.pos=u,e.posMax=m,!0},_ue=ee.normalizeReference,pu=ee.isSpace,Mue=function(e,t){var r,i,o,s,a,u,l,c,d,f,h,p,m,g="",y=e.pos,x=e.posMax;if(e.src.charCodeAt(e.pos)!==33||e.src.charCodeAt(e.pos+1)!==91||(u=e.pos+2,a=e.md.helpers.parseLinkLabel(e,e.pos+1,!1),a<0))return!1;if(l=a+1,l<x&&e.src.charCodeAt(l)===40){for(l++;l<x&&(i=e.src.charCodeAt(l),!(!pu(i)&&i!==10));l++);if(l>=x)return!1;for(m=l,d=e.md.helpers.parseLinkDestination(e.src,l,e.posMax),d.ok&&(g=e.md.normalizeLink(d.str),e.md.validateLink(g)?l=d.pos:g=""),m=l;l<x&&(i=e.src.charCodeAt(l),!(!pu(i)&&i!==10));l++);if(d=e.md.helpers.parseLinkTitle(e.src,l,e.posMax),l<x&&m!==l&&d.ok)for(f=d.str,l=d.pos;l<x&&(i=e.src.charCodeAt(l),!(!pu(i)&&i!==10));l++);else f="";if(l>=x||e.src.charCodeAt(l)!==41)return e.pos=y,!1;l++}else{if(typeof e.env.references>"u")return!1;if(l<x&&e.src.charCodeAt(l)===91?(m=l+1,l=e.md.helpers.parseLinkLabel(e,l),l>=0?s=e.src.slice(m,l++):l=a+1):l=a+1,s||(s=e.src.slice(u,a)),c=e.env.references[_ue(s)],!c)return e.pos=y,!1;g=c.href,f=c.title}return t||(o=e.src.slice(u,a),e.md.inline.parse(o,e.md,e.env,p=[]),h=e.push("image","img",0),h.attrs=r=[["src",g],["alt",""]],h.children=p,h.content=o,f&&r.push(["title",f])),e.pos=l,e.posMax=x,!0},Tue=/^([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,Due=/^([a-zA-Z][a-zA-Z0-9+.\-]{1,31}):([^<>\x00-\x20]*)$/,Lue=function(e,t){var r,i,o,s,a,u,l=e.pos;if(e.src.charCodeAt(l)!==60)return!1;for(a=e.pos,u=e.posMax;;){if(++l>=u||(s=e.src.charCodeAt(l),s===60))return!1;if(s===62)break}return r=e.src.slice(a+1,l),Due.test(r)?(i=e.md.normalizeLink(r),e.md.validateLink(i)?(t||(o=e.push("link_open","a",1),o.attrs=[["href",i]],o.markup="autolink",o.info="auto",o=e.push("text","",0),o.content=e.md.normalizeLinkText(r),o=e.push("link_close","a",-1),o.markup="autolink",o.info="auto"),e.pos+=r.length+2,!0):!1):Tue.test(r)?(i=e.md.normalizeLink("mailto:"+r),e.md.validateLink(i)?(t||(o=e.push("link_open","a",1),o.attrs=[["href",i]],o.markup="autolink",o.info="auto",o=e.push("text","",0),o.content=e.md.normalizeLinkText(r),o=e.push("link_close","a",-1),o.markup="autolink",o.info="auto"),e.pos+=r.length+2,!0):!1):!1},Oue=aa.HTML_TAG_RE;function Rue(n){return/^<a[>\s]/i.test(n)}function Nue(n){return/^<\/a\s*>/i.test(n)}function Hue(n){var e=n|32;return e>=97&&e<=122}var Iue=function(e,t){var r,i,o,s,a=e.pos;return!e.md.options.html||(o=e.posMax,e.src.charCodeAt(a)!==60||a+2>=o)||(r=e.src.charCodeAt(a+1),r!==33&&r!==63&&r!==47&&!Hue(r))||(i=e.src.slice(a).match(Oue),!i)?!1:(t||(s=e.push("html_inline","",0),s.content=i[0],Rue(s.content)&&e.linkLevel++,Nue(s.content)&&e.linkLevel--),e.pos+=i[0].length,!0)},Mh=N1,Fue=ee.has,Pue=ee.isValidEntityCode,Th=ee.fromCodePoint,Bue=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,$ue=/^&([a-z][a-z0-9]{1,31});/i,zue=function(e,t){var r,i,o,s,a=e.pos,u=e.posMax;if(e.src.charCodeAt(a)!==38||a+1>=u)return!1;if(r=e.src.charCodeAt(a+1),r===35){if(o=e.src.slice(a).match(Bue),o)return t||(i=o[1][0].toLowerCase()==="x"?parseInt(o[1].slice(1),16):parseInt(o[1],10),s=e.push("text_special","",0),s.content=Pue(i)?Th(i):Th(65533),s.markup=o[0],s.info="entity"),e.pos+=o[0].length,!0}else if(o=e.src.slice(a).match($ue),o&&Fue(Mh,o[1]))return t||(s=e.push("text_special","",0),s.content=Mh[o[1]],s.markup=o[0],s.info="entity"),e.pos+=o[0].length,!0;return!1};function Dh(n){var e,t,r,i,o,s,a,u,l={},c=n.length;if(c){var d=0,f=-2,h=[];for(e=0;e<c;e++)if(r=n[e],h.push(0),(n[d].marker!==r.marker||f!==r.token-1)&&(d=e),f=r.token,r.length=r.length||0,!!r.close){for(l.hasOwnProperty(r.marker)||(l[r.marker]=[-1,-1,-1,-1,-1,-1]),o=l[r.marker][(r.open?3:0)+r.length%3],t=d-h[d]-1,s=t;t>o;t-=h[t]+1)if(i=n[t],i.marker===r.marker&&i.open&&i.end<0&&(a=!1,(i.close||r.open)&&(i.length+r.length)%3===0&&(i.length%3!==0||r.length%3!==0)&&(a=!0),!a)){u=t>0&&!n[t-1].open?h[t-1]+1:0,h[e]=e-t+u,h[t]=u,r.open=!1,i.end=e,i.close=!1,s=-1,f=-2;break}s!==-1&&(l[r.marker][(r.open?3:0)+(r.length||0)%3]=s)}}}var Vue=function(e){var t,r=e.tokens_meta,i=e.tokens_meta.length;for(Dh(e.delimiters),t=0;t<i;t++)r[t]&&r[t].delimiters&&Dh(r[t].delimiters)},que=function(e){var t,r,i=0,o=e.tokens,s=e.tokens.length;for(t=r=0;t<s;t++)o[t].nesting<0&&i--,o[t].level=i,o[t].nesting>0&&i++,o[t].type==="text"&&t+1<s&&o[t+1].type==="text"?o[t+1].content=o[t].content+o[t+1].content:(t!==r&&(o[r]=o[t]),r++);t!==r&&(o.length=r)},mc=fc,Lh=ee.isWhiteSpace,Oh=ee.isPunctChar,Rh=ee.isMdAsciiPunct;function Pi(n,e,t,r){this.src=n,this.env=t,this.md=e,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}Pi.prototype.pushPending=function(){var n=new mc("text","",0);return n.content=this.pending,n.level=this.pendingLevel,this.tokens.push(n),this.pending="",n};Pi.prototype.push=function(n,e,t){this.pending&&this.pushPending();var r=new mc(n,e,t),i=null;return t<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,t>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],i={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(i),r};Pi.prototype.scanDelims=function(n,e){var t=n,r,i,o,s,a,u,l,c,d,f=!0,h=!0,p=this.posMax,m=this.src.charCodeAt(n);for(r=n>0?this.src.charCodeAt(n-1):32;t<p&&this.src.charCodeAt(t)===m;)t++;return o=t-n,i=t<p?this.src.charCodeAt(t):32,l=Rh(r)||Oh(String.fromCharCode(r)),d=Rh(i)||Oh(String.fromCharCode(i)),u=Lh(r),c=Lh(i),c?f=!1:d&&(u||l||(f=!1)),u?h=!1:l&&(c||d||(h=!1)),e?(s=f,a=h):(s=f&&(!h||l),a=h&&(!f||d)),{can_open:s,can_close:a,length:o}};Pi.prototype.Token=mc;var jue=Pi,Nh=dc,mu=[["text",bue],["linkify",xue],["newline",kue],["escape",Cue],["backticks",Sue],["strikethrough",ca.tokenize],["emphasis",da.tokenize],["link",Aue],["image",Mue],["autolink",Lue],["html_inline",Iue],["entity",zue]],gu=[["balance_pairs",Vue],["strikethrough",ca.postProcess],["emphasis",da.postProcess],["fragments_join",que]];function Bi(){var n;for(this.ruler=new Nh,n=0;n<mu.length;n++)this.ruler.push(mu[n][0],mu[n][1]);for(this.ruler2=new Nh,n=0;n<gu.length;n++)this.ruler2.push(gu[n][0],gu[n][1])}Bi.prototype.skipToken=function(n){var e,t,r=n.pos,i=this.ruler.getRules(""),o=i.length,s=n.md.options.maxNesting,a=n.cache;if(typeof a[r]<"u"){n.pos=a[r];return}if(n.level<s){for(t=0;t<o;t++)if(n.level++,e=i[t](n,!0),n.level--,e){if(r>=n.pos)throw new Error("inline rule didn't increment state.pos");break}}else n.pos=n.posMax;e||n.pos++,a[r]=n.pos};Bi.prototype.tokenize=function(n){for(var e,t,r,i=this.ruler.getRules(""),o=i.length,s=n.posMax,a=n.md.options.maxNesting;n.pos<s;){if(r=n.pos,n.level<a){for(t=0;t<o;t++)if(e=i[t](n,!1),e){if(r>=n.pos)throw new Error("inline rule didn't increment state.pos");break}}if(e){if(n.pos>=s)break;continue}n.pending+=n.src[n.pos++]}n.pending&&n.pushPending()};Bi.prototype.parse=function(n,e,t,r){var i,o,s,a=new this.State(n,e,t,r);for(this.tokenize(a),o=this.ruler2.getRules(""),s=o.length,i=0;i<s;i++)o[i](a)};Bi.prototype.State=jue;var Uue=Bi,bu,Hh;function Wue(){return Hh||(Hh=1,bu=function(n){var e={};n=n||{},e.src_Any=H1().source,e.src_Cc=I1().source,e.src_Z=F1().source,e.src_P=cc.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");var t="[><]";return e.src_pseudo_letter="(?:(?!"+t+"|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|"+t+"|"+e.src_ZPCc+")(?!"+(n["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|"+t+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(n["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy="(^|"+t+'|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}),bu}function ul(n){var e=Array.prototype.slice.call(arguments,1);return e.forEach(function(t){t&&Object.keys(t).forEach(function(r){n[r]=t[r]})}),n}function fa(n){return Object.prototype.toString.call(n)}function Zue(n){return fa(n)==="[object String]"}function Kue(n){return fa(n)==="[object Object]"}function Gue(n){return fa(n)==="[object RegExp]"}function Ih(n){return fa(n)==="[object Function]"}function Jue(n){return n.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var j1={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function Yue(n){return Object.keys(n||{}).reduce(function(e,t){return e||j1.hasOwnProperty(t)},!1)}var Xue={"http:":{validate:function(n,e,t){var r=n.slice(e);return t.re.http||(t.re.http=new RegExp("^\\/\\/"+t.re.src_auth+t.re.src_host_port_strict+t.re.src_path,"i")),t.re.http.test(r)?r.match(t.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(n,e,t){var r=n.slice(e);return t.re.no_http||(t.re.no_http=new RegExp("^"+t.re.src_auth+"(?:localhost|(?:(?:"+t.re.src_domain+")\\.)+"+t.re.src_domain_root+")"+t.re.src_port+t.re.src_host_terminator+t.re.src_path,"i")),t.re.no_http.test(r)?e>=3&&n[e-3]===":"||e>=3&&n[e-3]==="/"?0:r.match(t.re.no_http)[0].length:0}},"mailto:":{validate:function(n,e,t){var r=n.slice(e);return t.re.mailto||(t.re.mailto=new RegExp("^"+t.re.src_email_name+"@"+t.re.src_host_strict,"i")),t.re.mailto.test(r)?r.match(t.re.mailto)[0].length:0}}},Que="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",ele="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function tle(n){n.__index__=-1,n.__text_cache__=""}function nle(n){return function(e,t){var r=e.slice(t);return n.test(r)?r.match(n)[0].length:0}}function Fh(){return function(n,e){e.normalize(n)}}function Ts(n){var e=n.re=Wue()(n.__opts__),t=n.__tlds__.slice();n.onCompile(),n.__tlds_replaced__||t.push(Que),t.push(e.src_xn),e.src_tlds=t.join("|");function r(a){return a.replace("%TLDS%",e.src_tlds)}e.email_fuzzy=RegExp(r(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(r(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(r(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(r(e.tpl_host_fuzzy_test),"i");var i=[];n.__compiled__={};function o(a,u){throw new Error('(LinkifyIt) Invalid schema "'+a+'": '+u)}Object.keys(n.__schemas__).forEach(function(a){var u=n.__schemas__[a];if(u!==null){var l={validate:null,link:null};if(n.__compiled__[a]=l,Kue(u)){Gue(u.validate)?l.validate=nle(u.validate):Ih(u.validate)?l.validate=u.validate:o(a,u),Ih(u.normalize)?l.normalize=u.normalize:u.normalize?o(a,u):l.normalize=Fh();return}if(Zue(u)){i.push(a);return}o(a,u)}}),i.forEach(function(a){n.__compiled__[n.__schemas__[a]]&&(n.__compiled__[a].validate=n.__compiled__[n.__schemas__[a]].validate,n.__compiled__[a].normalize=n.__compiled__[n.__schemas__[a]].normalize)}),n.__compiled__[""]={validate:null,normalize:Fh()};var s=Object.keys(n.__compiled__).filter(function(a){return a.length>0&&n.__compiled__[a]}).map(Jue).join("|");n.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+s+")","i"),n.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+s+")","ig"),n.re.schema_at_start=RegExp("^"+n.re.schema_search.source,"i"),n.re.pretest=RegExp("("+n.re.schema_test.source+")|("+n.re.host_fuzzy_test.source+")|@","i"),tle(n)}function rle(n,e){var t=n.__index__,r=n.__last_index__,i=n.__text_cache__.slice(t,r);this.schema=n.__schema__.toLowerCase(),this.index=t+e,this.lastIndex=r+e,this.raw=i,this.text=i,this.url=i}function ll(n,e){var t=new rle(n,e);return n.__compiled__[t.schema].normalize(t,n),t}function je(n,e){if(!(this instanceof je))return new je(n,e);e||Yue(n)&&(e=n,n={}),this.__opts__=ul({},j1,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=ul({},Xue,n),this.__compiled__={},this.__tlds__=ele,this.__tlds_replaced__=!1,this.re={},Ts(this)}je.prototype.add=function(e,t){return this.__schemas__[e]=t,Ts(this),this};je.prototype.set=function(e){return this.__opts__=ul(this.__opts__,e),this};je.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;var t,r,i,o,s,a,u,l,c;if(this.re.schema_test.test(e)){for(u=this.re.schema_search,u.lastIndex=0;(t=u.exec(e))!==null;)if(o=this.testSchemaAt(e,t[2],u.lastIndex),o){this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+o;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=e.search(this.re.host_fuzzy_test),l>=0&&(this.__index__<0||l<this.__index__)&&(r=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(s=r.index+r[1].length,(this.__index__<0||s<this.__index__)&&(this.__schema__="",this.__index__=s,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(c=e.indexOf("@"),c>=0&&(i=e.match(this.re.email_fuzzy))!==null&&(s=i.index+i[1].length,a=i.index+i[0].length,(this.__index__<0||s<this.__index__||s===this.__index__&&a>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=s,this.__last_index__=a))),this.__index__>=0};je.prototype.pretest=function(e){return this.re.pretest.test(e)};je.prototype.testSchemaAt=function(e,t,r){return this.__compiled__[t.toLowerCase()]?this.__compiled__[t.toLowerCase()].validate(e,r,this):0};je.prototype.match=function(e){var t=0,r=[];this.__index__>=0&&this.__text_cache__===e&&(r.push(ll(this,t)),t=this.__last_index__);for(var i=t?e.slice(t):e;this.test(i);)r.push(ll(this,t)),i=i.slice(this.__last_index__),t+=this.__last_index__;return r.length?r:null};je.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;var t=this.re.schema_at_start.exec(e);if(!t)return null;var r=this.testSchemaAt(e,t[2],t[0].length);return r?(this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+r,ll(this,0)):null};je.prototype.tlds=function(e,t){return e=Array.isArray(e)?e:[e],t?(this.__tlds__=this.__tlds__.concat(e).sort().filter(function(r,i,o){return r!==o[i-1]}).reverse(),Ts(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,Ts(this),this)};je.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),e.schema==="mailto:"&&!/^mailto:/i.test(e.url)&&(e.url="mailto:"+e.url)};je.prototype.onCompile=function(){};var ile=je;const br=2147483647,St=36,gc=1,_i=26,ole=38,sle=700,U1=72,W1=128,Z1="-",ale=/^xn--/,ule=/[^\0-\x7F]/,lle=/[\x2E\u3002\uFF0E\uFF61]/g,cle={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},yu=St-gc,Et=Math.floor,xu=String.fromCharCode;function tn(n){throw new RangeError(cle[n])}function dle(n,e){const t=[];let r=n.length;for(;r--;)t[r]=e(n[r]);return t}function K1(n,e){const t=n.split("@");let r="";t.length>1&&(r=t[0]+"@",n=t[1]),n=n.replace(lle,".");const i=n.split("."),o=dle(i,e).join(".");return r+o}function bc(n){const e=[];let t=0;const r=n.length;for(;t<r;){const i=n.charCodeAt(t++);if(i>=55296&&i<=56319&&t<r){const o=n.charCodeAt(t++);(o&64512)==56320?e.push(((i&1023)<<10)+(o&1023)+65536):(e.push(i),t--)}else e.push(i)}return e}const G1=n=>String.fromCodePoint(...n),fle=function(n){return n>=48&&n<58?26+(n-48):n>=65&&n<91?n-65:n>=97&&n<123?n-97:St},Ph=function(n,e){return n+22+75*(n<26)-((e!=0)<<5)},J1=function(n,e,t){let r=0;for(n=t?Et(n/sle):n>>1,n+=Et(n/e);n>yu*_i>>1;r+=St)n=Et(n/yu);return Et(r+(yu+1)*n/(n+ole))},yc=function(n){const e=[],t=n.length;let r=0,i=W1,o=U1,s=n.lastIndexOf(Z1);s<0&&(s=0);for(let a=0;a<s;++a)n.charCodeAt(a)>=128&&tn("not-basic"),e.push(n.charCodeAt(a));for(let a=s>0?s+1:0;a<t;){const u=r;for(let c=1,d=St;;d+=St){a>=t&&tn("invalid-input");const f=fle(n.charCodeAt(a++));f>=St&&tn("invalid-input"),f>Et((br-r)/c)&&tn("overflow"),r+=f*c;const h=d<=o?gc:d>=o+_i?_i:d-o;if(f<h)break;const p=St-h;c>Et(br/p)&&tn("overflow"),c*=p}const l=e.length+1;o=J1(r-u,l,u==0),Et(r/l)>br-i&&tn("overflow"),i+=Et(r/l),r%=l,e.splice(r++,0,i)}return String.fromCodePoint(...e)},xc=function(n){const e=[];n=bc(n);const t=n.length;let r=W1,i=0,o=U1;for(const u of n)u<128&&e.push(xu(u));const s=e.length;let a=s;for(s&&e.push(Z1);a<t;){let u=br;for(const c of n)c>=r&&c<u&&(u=c);const l=a+1;u-r>Et((br-i)/l)&&tn("overflow"),i+=(u-r)*l,r=u;for(const c of n)if(c<r&&++i>br&&tn("overflow"),c===r){let d=i;for(let f=St;;f+=St){const h=f<=o?gc:f>=o+_i?_i:f-o;if(d<h)break;const p=d-h,m=St-h;e.push(xu(Ph(h+p%m,0))),d=Et(p/m)}e.push(xu(Ph(d,0))),o=J1(i,l,a===s),i=0,++a}++i,++r}return e.join("")},Y1=function(n){return K1(n,function(e){return ale.test(e)?yc(e.slice(4).toLowerCase()):e})},X1=function(n){return K1(n,function(e){return ule.test(e)?"xn--"+xc(e):e})},hle={version:"2.3.1",ucs2:{decode:bc,encode:G1},decode:yc,encode:xc,toASCII:X1,toUnicode:Y1},ple=Object.freeze(Object.defineProperty({__proto__:null,decode:yc,default:hle,encode:xc,toASCII:X1,toUnicode:Y1,ucs2decode:bc,ucs2encode:G1},Symbol.toStringTag,{value:"Module"})),mle=P0(ple);var gle={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},ble={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},yle={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},si=ee,xle=sa,vle=fae,kle=Iae,wle=mue,Cle=Uue,Sle=ile,On=Or,Q1=mle,Ele={default:gle,zero:ble,commonmark:yle},Ale=/^(vbscript|javascript|file|data):/,_le=/^data:image\/(gif|png|jpeg|webp);/;function Mle(n){var e=n.trim().toLowerCase();return Ale.test(e)?!!_le.test(e):!0}var em=["http:","https:","mailto:"];function Tle(n){var e=On.parse(n,!0);if(e.hostname&&(!e.protocol||em.indexOf(e.protocol)>=0))try{e.hostname=Q1.toASCII(e.hostname)}catch{}return On.encode(On.format(e))}function Dle(n){var e=On.parse(n,!0);if(e.hostname&&(!e.protocol||em.indexOf(e.protocol)>=0))try{e.hostname=Q1.toUnicode(e.hostname)}catch{}return On.decode(On.format(e),On.decode.defaultChars+"%")}function nt(n,e){if(!(this instanceof nt))return new nt(n,e);e||si.isString(n)||(e=n||{},n="default"),this.inline=new Cle,this.block=new wle,this.core=new kle,this.renderer=new vle,this.linkify=new Sle,this.validateLink=Mle,this.normalizeLink=Tle,this.normalizeLinkText=Dle,this.utils=si,this.helpers=si.assign({},xle),this.options={},this.configure(n),e&&this.set(e)}nt.prototype.set=function(n){return si.assign(this.options,n),this};nt.prototype.configure=function(n){var e=this,t;if(si.isString(n)&&(t=n,n=Ele[t],!n))throw new Error('Wrong `markdown-it` preset "'+t+'", check name');if(!n)throw new Error("Wrong `markdown-it` preset, can't be empty");return n.options&&e.set(n.options),n.components&&Object.keys(n.components).forEach(function(r){n.components[r].rules&&e[r].ruler.enableOnly(n.components[r].rules),n.components[r].rules2&&e[r].ruler2.enableOnly(n.components[r].rules2)}),this};nt.prototype.enable=function(n,e){var t=[];Array.isArray(n)||(n=[n]),["core","block","inline"].forEach(function(i){t=t.concat(this[i].ruler.enable(n,!0))},this),t=t.concat(this.inline.ruler2.enable(n,!0));var r=n.filter(function(i){return t.indexOf(i)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};nt.prototype.disable=function(n,e){var t=[];Array.isArray(n)||(n=[n]),["core","block","inline"].forEach(function(i){t=t.concat(this[i].ruler.disable(n,!0))},this),t=t.concat(this.inline.ruler2.disable(n,!0));var r=n.filter(function(i){return t.indexOf(i)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};nt.prototype.use=function(n){var e=[this].concat(Array.prototype.slice.call(arguments,1));return n.apply(n,e),this};nt.prototype.parse=function(n,e){if(typeof n!="string")throw new Error("Input data should be a String");var t=new this.core.State(n,this,e);return this.core.process(t),t.tokens};nt.prototype.render=function(n,e){return e=e||{},this.renderer.render(this.parse(n,e),this.options,e)};nt.prototype.parseInline=function(n,e){var t=new this.core.State(n,this,e);return t.inlineMode=!0,this.core.process(t),t.tokens};nt.prototype.renderInline=function(n,e){return e=e||{},this.renderer.render(this.parseInline(n,e),this.options,e)};var Lle=nt,Ole=Lle;const tm=Ni(Ole);var cl=!0,nm=!1,rm=!1,Rle=function(n,e){e&&(cl=!e.enabled,nm=!!e.label,rm=!!e.labelAfter),n.core.ruler.after("inline","github-task-lists",function(t){for(var r=t.tokens,i=2;i<r.length;i++)Hle(r,i)&&(Ile(r[i],t.Token),Bh(r[i-2],"class","task-list-item"+(cl?"":" enabled")),Bh(r[Nle(r,i-2)],"class","contains-task-list"))})};function Bh(n,e,t){var r=n.attrIndex(e),i=[e,t];r<0?n.attrPush(i):n.attrs[r]=i}function Nle(n,e){for(var t=n[e].level-1,r=e-1;r>=0;r--)if(n[r].level===t)return r;return-1}function Hle(n,e){return zle(n[e])&&Vle(n[e-1])&&qle(n[e-2])&&jle(n[e])}function Ile(n,e){if(n.children.unshift(Fle(n,e)),n.children[1].content=n.children[1].content.slice(3),n.content=n.content.slice(3),nm)if(rm){n.children.pop();var t="task-item-"+Math.ceil(Math.random()*(1e4*1e3)-1e3);n.children[0].content=n.children[0].content.slice(0,-1)+' id="'+t+'">',n.children.push($le(n.content,t,e))}else n.children.unshift(Ple(e)),n.children.push(Ble(e))}function Fle(n,e){var t=new e("html_inline","",0),r=cl?' disabled="" ':"";return n.content.indexOf("[ ] ")===0?t.content='<input class="task-list-item-checkbox"'+r+'type="checkbox">':(n.content.indexOf("[x] ")===0||n.content.indexOf("[X] ")===0)&&(t.content='<input class="task-list-item-checkbox" checked=""'+r+'type="checkbox">'),t}function Ple(n){var e=new n("html_inline","",0);return e.content="<label>",e}function Ble(n){var e=new n("html_inline","",0);return e.content="</label>",e}function $le(n,e,t){var r=new t("html_inline","",0);return r.content='<label class="task-list-item-label" for="'+e+'">'+n+"</label>",r.attrs=[{for:e}],r}function zle(n){return n.type==="inline"}function Vle(n){return n.type==="paragraph_open"}function qle(n){return n.type==="list_item_open"}function jle(n){return n.content.indexOf("[ ] ")===0||n.content.indexOf("[x] ")===0||n.content.indexOf("[X] ")===0}const Ule=Ni(Rle);var Wle=Object.defineProperty,Zle=(n,e,t)=>e in n?Wle(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,dl=(n,e,t)=>(Zle(n,typeof e!="symbol"?e+"":e,t),t);const Kle=re.create({name:"markdownTightLists",addOptions:()=>({tight:!0,tightClass:"tight",listTypes:["bulletList","orderedList"]}),addGlobalAttributes(){return[{types:this.options.listTypes,attributes:{tight:{default:this.options.tight,parseHTML:n=>n.getAttribute("data-tight")==="true"||!n.querySelector("p"),renderHTML:n=>({class:n.tight?this.options.tightClass:null,"data-tight":n.tight?"true":null})}}}]},addCommands(){var n=this;return{toggleTight:function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return t=>{let{editor:r,commands:i}=t;function o(s){if(!r.isActive(s))return!1;const a=r.getAttributes(s);return i.updateAttributes(s,{tight:e??!(a!=null&&a.tight)})}return n.options.listTypes.some(s=>o(s))}}}}}),$h=tm();function im(n,e){return $h.inline.State.prototype.scanDelims.call({src:n,posMax:n.length}),new $h.inline.State(n,null,null,[]).scanDelims(e,!0)}function om(n,e,t,r){let i=n.substring(0,t)+n.substring(t+e.length);return i=i.substring(0,t+r)+e+i.substring(t+r),i}function Gle(n,e,t,r){let i=t,o=n;for(;i<r&&!im(o,i).can_open;)o=om(o,e,i,1),i++;return{text:o,from:i,to:r}}function Jle(n,e,t,r){let i=r,o=n;for(;i>t&&!im(o,i).can_close;)o=om(o,e,i,-1),i--;return{text:o,from:t,to:i}}function Yle(n,e,t,r){let i={text:n,from:t,to:r};return i=Gle(i.text,e,i.from,i.to),i=Jle(i.text,e,i.from,i.to),i.to-i.from<e.length+1&&(i.text=i.text.substring(0,i.from)+i.text.substring(i.to+e.length)),i.text}class Xle extends R1{constructor(e,t,r){super(e,t,r??{}),this.inlines=[]}render(e,t,r){super.render(e,t,r);const i=this.inlines[this.inlines.length-1];if(i!=null&&i.start&&i!==null&&i!==void 0&&i.end){const{delimiter:o,start:s,end:a}=this.normalizeInline(i);this.out=Yle(this.out,o,s,a),this.inlines.pop()}}markString(e,t,r,i){const o=this.marks[e.type.name];if(o.expelEnclosingWhitespace)if(t)this.inlines.push({start:this.out.length,delimiter:o.open});else{const s=this.inlines.pop();this.inlines.push({...s,end:this.out.length})}return super.markString(e,t,r,i)}normalizeInline(e){let{start:t,end:r}=e;for(;this.out.charAt(t).match(/\s/);)t++;return{...e,start:t}}}const sm=de.create({name:"markdownHTMLMark",addStorage(){return{markdown:{serialize:{open(n,e){var t,r;return this.editor.storage.markdown.options.html?(t=(r=zh(e))===null||r===void 0?void 0:r[0])!==null&&t!==void 0?t:"":(console.warn(`Tiptap Markdown: "${e.type.name}" mark is only available in html mode`),"")},close(n,e){var t,r;return this.editor.storage.markdown.options.html&&(t=(r=zh(e))===null||r===void 0?void 0:r[1])!==null&&t!==void 0?t:""}},parse:{}}}}});function zh(n){const e=n.type.schema,t=e.text(" ",[n]),i=Rl(_.from(t),e).match(/^(<.*?>) (<\/.*?>)$/);return i?[i[1],i[2]]:null}function vc(n){const e=`<body>${n}</body>`;return new window.DOMParser().parseFromString(e,"text/html").body}function Qle(n){return n==null?void 0:n.replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ece(n){const e=n.parentElement,t=e.cloneNode();for(;e.firstChild&&e.firstChild!==n;)t.appendChild(e.firstChild);t.childNodes.length>0&&e.parentElement.insertBefore(t,e),e.parentElement.insertBefore(n,e),e.childNodes.length===0&&e.remove()}function tce(n){const e=n.parentNode;for(;n.firstChild;)e.insertBefore(n.firstChild,n);e.removeChild(n)}const kc=K.create({name:"markdownHTMLNode",addStorage(){return{markdown:{serialize(n,e,t){this.editor.storage.markdown.options.html?n.write(nce(e,t)):(console.warn(`Tiptap Markdown: "${e.type.name}" node is only available in html mode`),n.write(`[${e.type.name}]`)),e.isBlock&&n.closeBlock(e)},parse:{}}}}});function nce(n,e){const t=n.type.schema,r=Rl(_.from(n),t);return n.isBlock&&(e instanceof _||e.type.name===t.topNodeType.name)?rce(r):r}function rce(n){const t=vc(n).firstElementChild;return t.innerHTML=t.innerHTML.trim()?`
${t.innerHTML}
`:`
`,t.outerHTML}const ice=K.create({name:"blockquote"}),oce=ice.extend({addStorage(){return{markdown:{serialize:ct.nodes.blockquote,parse:{}}}}}),sce=K.create({name:"bulletList"}),am=sce.extend({addStorage(){return{markdown:{serialize(n,e){return n.renderList(e,"  ",()=>(this.editor.storage.markdown.options.bulletListMarker||"-")+" ")},parse:{}}}}}),ace=K.create({name:"codeBlock"}),uce=ace.extend({addStorage(){return{markdown:{serialize(n,e){n.write("```"+(e.attrs.language||"")+`
`),n.text(e.textContent,!1),n.ensureNewLine(),n.write("```"),n.closeBlock(e)},parse:{setup(n){var e;n.set({langPrefix:(e=this.options.languageClassPrefix)!==null&&e!==void 0?e:"language-"})},updateDOM(n){n.innerHTML=n.innerHTML.replace(/\n<\/code><\/pre>/g,"</code></pre>")}}}}}}),lce=K.create({name:"hardBreak"}),um=lce.extend({addStorage(){return{markdown:{serialize:ct.nodes.hard_break,parse:{}}}}}),cce=K.create({name:"heading"}),dce=cce.extend({addStorage(){return{markdown:{serialize:ct.nodes.heading,parse:{}}}}}),fce=K.create({name:"horizontalRule"}),hce=fce.extend({addStorage(){return{markdown:{serialize:ct.nodes.horizontal_rule,parse:{}}}}}),pce=K.create({name:"image"}),mce=pce.extend({addStorage(){return{markdown:{serialize:ct.nodes.image,parse:{}}}}}),gce=K.create({name:"listItem"}),bce=gce.extend({addStorage(){return{markdown:{serialize:ct.nodes.list_item,parse:{}}}}}),yce=K.create({name:"orderedList"});function xce(n,e,t){let r=0;for(;t-r>0&&e.child(t-r-1).type.name===n.type.name;r++);return r}const vce=yce.extend({addStorage(){return{markdown:{serialize(n,e,t,r){const i=e.attrs.start||1,o=String(i+e.childCount-1).length,s=n.repeat(" ",o+2),u=xce(e,t,r)%2?") ":". ";n.renderList(e,s,l=>{const c=String(i+l);return n.repeat(" ",o-c.length)+c+u})},parse:{}}}}}),kce=K.create({name:"paragraph"}),wce=kce.extend({addStorage(){return{markdown:{serialize:ct.nodes.paragraph,parse:{}}}}});function vu(n){var e,t;return(e=n==null||(t=n.content)===null||t===void 0?void 0:t.content)!==null&&e!==void 0?e:[]}const Cce=K.create({name:"table"}),Sce=Cce.extend({addStorage(){return{markdown:{serialize(n,e,t){if(!Ece(e)){kc.storage.markdown.serialize.call(this,n,e,t);return}e.forEach((r,i,o)=>{if(n.write("| "),r.forEach((s,a,u)=>{u&&n.write(" | ");const l=s.firstChild;l.textContent.trim()&&n.renderInline(l)}),n.write(" |"),n.ensureNewLine(),!o){const s=Array.from({length:r.childCount}).map(()=>"---").join(" | ");n.write(`| ${s} |`),n.ensureNewLine()}}),n.closeBlock(e)},parse:{}}}}});function Vh(n){return n.attrs.colspan>1||n.attrs.rowspan>1}function Ece(n){const e=vu(n),t=e[0],r=e.slice(1);return!(vu(t).some(i=>i.type.name!=="tableHeader"||Vh(i)||i.childCount>1)||r.some(i=>vu(i).some(o=>o.type.name==="tableHeader"||Vh(o)||o.childCount>1)))}const Ace=K.create({name:"taskItem"}),_ce=Ace.extend({addStorage(){return{markdown:{serialize(n,e){const t=e.attrs.checked?"[x]":"[ ]";n.write(`${t} `),n.renderContent(e)},parse:{updateDOM(n){[...n.querySelectorAll(".task-list-item")].forEach(e=>{const t=e.querySelector("input");e.setAttribute("data-type","taskItem"),t&&(e.setAttribute("data-checked",t.checked),t.remove())})}}}}}}),Mce=K.create({name:"taskList"}),Tce=Mce.extend({addStorage(){return{markdown:{serialize:am.storage.markdown.serialize,parse:{setup(n){n.use(Ule)},updateDOM(n){[...n.querySelectorAll(".contains-task-list")].forEach(e=>{e.setAttribute("data-type","taskList")})}}}}}}),Dce=K.create({name:"text"}),Lce=Dce.extend({addStorage(){return{markdown:{serialize(n,e){n.text(Qle(e.text))},parse:{}}}}}),Oce=de.create({name:"bold"}),Rce=Oce.extend({addStorage(){return{markdown:{serialize:ct.marks.strong,parse:{}}}}}),Nce=de.create({name:"code"}),Hce=Nce.extend({addStorage(){return{markdown:{serialize:ct.marks.code,parse:{}}}}}),Ice=de.create({name:"italic"}),Fce=Ice.extend({addStorage(){return{markdown:{serialize:ct.marks.em,parse:{}}}}}),Pce=de.create({name:"link"}),Bce=Pce.extend({addStorage(){return{markdown:{serialize:ct.marks.link,parse:{}}}}}),$ce=de.create({name:"strike"}),zce=$ce.extend({addStorage(){return{markdown:{serialize:{open:"~~",close:"~~",expelEnclosingWhitespace:!0},parse:{}}}}}),Vce=[oce,am,uce,um,dce,hce,kc,mce,bce,vce,wce,Sce,_ce,Tce,Lce,Rce,Hce,sm,Fce,Bce,zce];function Ds(n){var e,t;const r=(e=n.storage)===null||e===void 0?void 0:e.markdown,i=(t=Vce.find(o=>o.name===n.name))===null||t===void 0?void 0:t.storage.markdown;return r||i?{...i,...r}:null}class qce{constructor(e){dl(this,"editor",null),this.editor=e}serialize(e){const t=new Xle(this.nodes,this.marks,{hardBreakNodeName:um.name});return t.renderContent(e),t.out}get nodes(){var e;return{...Object.fromEntries(Object.keys(this.editor.schema.nodes).map(t=>[t,this.serializeNode(kc)])),...Object.fromEntries((e=this.editor.extensionManager.extensions.filter(t=>t.type==="node"&&this.serializeNode(t)).map(t=>[t.name,this.serializeNode(t)]))!==null&&e!==void 0?e:[])}}get marks(){var e;return{...Object.fromEntries(Object.keys(this.editor.schema.marks).map(t=>[t,this.serializeMark(sm)])),...Object.fromEntries((e=this.editor.extensionManager.extensions.filter(t=>t.type==="mark"&&this.serializeMark(t)).map(t=>[t.name,this.serializeMark(t)]))!==null&&e!==void 0?e:[])}}serializeNode(e){var t;return(t=Ds(e))===null||t===void 0||(t=t.serialize)===null||t===void 0?void 0:t.bind({editor:this.editor,options:e.options})}serializeMark(e){var t;const r=(t=Ds(e))===null||t===void 0?void 0:t.serialize;return r?{...r,open:typeof r.open=="function"?r.open.bind({editor:this.editor,options:e.options}):r.open,close:typeof r.close=="function"?r.close.bind({editor:this.editor,options:e.options}):r.close}:null}}class jce{constructor(e,t){dl(this,"editor",null),dl(this,"md",null);let{html:r,linkify:i,breaks:o}=t;this.editor=e,this.md=this.withPatchedRenderer(tm({html:r,linkify:i,breaks:o}))}parse(e){let{inline:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof e=="string"){this.editor.extensionManager.extensions.forEach(o=>{var s;return(s=Ds(o))===null||s===void 0||(s=s.parse)===null||s===void 0||(s=s.setup)===null||s===void 0?void 0:s.call({editor:this.editor,options:o.options},this.md)});const r=this.md.render(e),i=vc(r);return this.editor.extensionManager.extensions.forEach(o=>{var s;return(s=Ds(o))===null||s===void 0||(s=s.parse)===null||s===void 0||(s=s.updateDOM)===null||s===void 0?void 0:s.call({editor:this.editor,options:o.options},i)}),this.normalizeDOM(i,{inline:t,content:e}),i.innerHTML}return e}normalizeDOM(e,t){let{inline:r,content:i}=t;return this.normalizeBlocks(e),e.querySelectorAll("*").forEach(o=>{var s;((s=o.nextSibling)===null||s===void 0?void 0:s.nodeType)===Node.TEXT_NODE&&!o.closest("pre")&&(o.nextSibling.textContent=o.nextSibling.textContent.replace(/^\n/,""))}),r&&this.normalizeInline(e,i),e}normalizeBlocks(e){const r=Object.values(this.editor.schema.nodes).filter(i=>i.isBlock).map(i=>{var o;return(o=i.spec.parseDOM)===null||o===void 0?void 0:o.map(s=>s.tag)}).flat().filter(Boolean).join(",");r&&[...e.querySelectorAll(r)].forEach(i=>{i.parentElement.matches("p")&&ece(i)})}normalizeInline(e,t){var r;if((r=e.firstElementChild)!==null&&r!==void 0&&r.matches("p")){var i,o,s,a;const u=e.firstElementChild,{nextElementSibling:l}=u,c=(i=(o=t.match(/^\s+/))===null||o===void 0?void 0:o[0])!==null&&i!==void 0?i:"",d=l?"":(s=(a=t.match(/\s+$/))===null||a===void 0?void 0:a[0])!==null&&s!==void 0?s:"";if(t.match(/^\n\n/)){u.innerHTML=`${u.innerHTML}${d}`;return}tce(u),e.innerHTML=`${c}${e.innerHTML}${d}`}}withPatchedRenderer(e){const t=r=>function(){const i=r(...arguments);return i===`
`?i:i[i.length-1]===`
`?i.slice(0,-1):i};return e.renderer.rules.hardbreak=t(e.renderer.rules.hardbreak),e.renderer.rules.softbreak=t(e.renderer.rules.softbreak),e.renderer.rules.fence=t(e.renderer.rules.fence),e.renderer.rules.code_block=t(e.renderer.rules.code_block),e.renderer.renderToken=t(e.renderer.renderToken.bind(e.renderer)),e}}const Uce=re.create({name:"markdownClipboard",addOptions(){return{transformPastedText:!1,transformCopiedText:!1}},addProseMirrorPlugins(){return[new oe({key:new ae("markdownClipboard"),props:{clipboardTextParser:(n,e,t)=>{if(t||!this.options.transformPastedText)return null;const r=this.editor.storage.markdown.parser.parse(n,{inline:!0});return Mi.fromSchema(this.editor.schema).parseSlice(vc(r),{preserveWhitespace:!0,context:e})},clipboardTextSerializer:n=>this.options.transformCopiedText?this.editor.storage.markdown.serializer.serialize(n.content):null}})]}}),Wce=re.create({name:"markdown",priority:50,addOptions(){return{html:!0,tightLists:!0,tightListClass:"tight",bulletListMarker:"-",linkify:!1,breaks:!1,transformPastedText:!1,transformCopiedText:!1}},addCommands(){const n=f0.Commands.config.addCommands();return{setContent:(e,t,r)=>i=>n.setContent(i.editor.storage.markdown.parser.parse(e),t,r)(i),insertContentAt:(e,t,r)=>i=>n.insertContentAt(e,i.editor.storage.markdown.parser.parse(t,{inline:!0}),r)(i)}},onBeforeCreate(){this.editor.storage.markdown={options:{...this.options},parser:new jce(this.editor,this.options),serializer:new qce(this.editor),getMarkdown:()=>this.editor.storage.markdown.serializer.serialize(this.editor.state.doc)},this.editor.options.initialContent=this.editor.options.content,this.editor.options.content=this.editor.storage.markdown.parser.parse(this.editor.options.content)},onCreate(){this.editor.options.content=this.editor.options.initialContent,delete this.editor.options.initialContent},addStorage(){return{}},addExtensions(){return[Kle.configure({tight:this.options.tightLists,tightClass:this.options.tightListClass}),Uce.configure({transformPastedText:this.options.transformPastedText,transformCopiedText:this.options.transformCopiedText})]}});var Zce=function(e,t,r){function i(h){return h.trim().split(" ",2)[0]===t}function o(h,p,m,g,y){return h[p].nesting===1&&h[p].attrJoin("class",t),y.renderToken(h,p,m,g,y)}r=r||{};var s=3,a=r.marker||":",u=a.charCodeAt(0),l=a.length,c=r.validate||i,d=r.render||o;function f(h,p,m,g){var y,x,v,b,w,k,C,E,A=!1,T=h.bMarks[p]+h.tShift[p],I=h.eMarks[p];if(u!==h.src.charCodeAt(T))return!1;for(y=T+1;y<=I&&a[(y-T)%l]===h.src[y];y++);if(v=Math.floor((y-T)/l),v<s||(y-=(y-T)%l,b=h.src.slice(T,y),w=h.src.slice(y,I),!c(w,b)))return!1;if(g)return!0;for(x=p;x++,!(x>=m||(T=h.bMarks[x]+h.tShift[x],I=h.eMarks[x],T<I&&h.sCount[x]<h.blkIndent));)if(u===h.src.charCodeAt(T)&&!(h.sCount[x]-h.blkIndent>=4)){for(y=T+1;y<=I&&a[(y-T)%l]===h.src[y];y++);if(!(Math.floor((y-T)/l)<v)&&(y-=(y-T)%l,y=h.skipSpaces(y),!(y<I))){A=!0;break}}return C=h.parentType,E=h.lineMax,h.parentType="container",h.lineMax=x,k=h.push("container_"+t+"_open","div",1),k.markup=b,k.block=!0,k.info=w,k.map=[p,x],h.md.block.tokenize(h,p+1,x),k=h.push("container_"+t+"_close","div",-1),k.markup=h.src.slice(T,y),k.block=!0,h.parentType=C,h.lineMax=E,h.line=x+(A?1:0),!0}e.block.ruler.before("fence","container_"+t,f,{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules["container_"+t+"_open"]=d,e.renderer.rules["container_"+t+"_close"]=d};const Kce=Ni(Zce),Gce=/^:::([a-z]+)?[\s\n]$/,Jce=K.create({name:"container",group:"block",content:"block+",defining:!0,addOptions(){return{classes:["info","warning","danger"],HTMLAttributes:{class:"container-wrapper"}}},addStorage(){return{markdown:{serialize(n,e){n.write("::: "+(e.attrs.containerClass||"")+`
`),n.renderContent(e),n.flushClose(1),n.write(":::"),n.closeBlock(e)},parse:{setup:n=>{this.options.classes.forEach(e=>{n.use(Kce,e)})}}}}},addAttributes(){return{containerClass:{default:null,parseHTML:n=>[...n.classList].find(e=>this.options.classes.includes(e)),renderHTML:n=>({class:n.containerClass})}}},parseHTML(){return[{tag:"div",getAttrs:n=>{const e=n,t=["container-wrapper"].concat(this.options.classes);return[...e.classList].find(r=>t.includes(r))?null:!1}}]},renderHTML({HTMLAttributes:n}){return["div",J(this.options.HTMLAttributes,n),0]},addCommands(){return{setContainer:n=>({commands:e})=>e.wrapIn(this.name,{containerClass:n}),toggleContainer:n=>({commands:e})=>e.toggleWrap(this.name,{containerClass:n}),unsetContainer:()=>({commands:n})=>n.lift(this.name)}},addInputRules(){return[qn({find:Gce,type:this.type,getAttributes:n=>({containerClass:n[1]})})]}}),Yce=z0.extend({addAttributes(){var n;return{...(n=this.parent)==null?void 0:n.call(this),id:{default:null}}}}),Xce=(n,e)=>{var r,i,o,s,a,u,l,c,d,f,h,p,m,g,y,x,v,b,w;const t=e.cbName&&e.cbUrl?[cf.configure({history:!1,codeBlock:!1,heading:!1})]:[cf.configure({codeBlock:!1,heading:!1})];return t.push(hw,pw,mw,Yce,xw.configure({uploadUrl:(r=e.attachment)==null?void 0:r.uploadUrl,uploadHeaders:(i=e.attachment)==null?void 0:i.uploadHeaders,uploader:((o=e.attachment)==null?void 0:o.uploader)||e.uploader,uploaderEvent:(s=e.attachment)==null?void 0:s.uploaderEvent}),vw,R6,Cw.configure({multicolor:!0}),Sw,Ew,Aw,_w.configure({types:["heading","paragraph"]}),Mw,Lw.configure({allowBase64:typeof((a=e.image)==null?void 0:a.allowBase64)>"u"?!0:(u=e.image)==null?void 0:u.allowBase64,defaultSize:((l=e.image)==null?void 0:l.defaultSize)||350,uploadUrl:(c=e.image)==null?void 0:c.uploadUrl,uploadHeaders:(d=e.image)==null?void 0:d.uploadHeaders,uploader:((f=e.image)==null?void 0:f.uploader)||e.uploader,uploaderEvent:(h=e.image)==null?void 0:h.uploaderEvent}),N4.configure({resizable:!0,lastColumnResizable:!0,allowTableNodeSelection:!0}),H4,I4,F4,P4,a6.configure({openOnClick:!1,autolink:typeof((p=e.link)==null?void 0:p.autolink)>"u"?!0:(m=e.link)==null?void 0:m.autolink,HTMLAttributes:{ref:(g=e==null?void 0:e.link)==null?void 0:g.rel,class:(y=e==null?void 0:e.link)==null?void 0:y.class}}),u6,l6,c6,f6.configure({nested:!0}),p6.configure({uploadUrl:(x=e.video)==null?void 0:x.uploadUrl,uploadHeaders:(v=e.video)==null?void 0:v.uploadHeaders,uploader:((b=e.video)==null?void 0:b.uploader)||e.uploader,uploaderEvent:(w=e.video)==null?void 0:w.uploaderEvent}),m6,Wce.configure({html:!0,tightLists:!0,tightListClass:"tight",bulletListMarker:"-",linkify:!0,breaks:!0,transformPastedText:!0,transformCopiedText:!1}),Jce,...E6(n)),e.placeholder&&t.push(A6.configure({placeholder:e.placeholder})),e.onMentionQuery&&t.push(O6(e.onMentionQuery)),t};const Qce={default:"",delete:"",confirm:"",undo:"",redo:"",brush:"",container:"",eraser:"",heading:"/","font-family":"","font-size":"",bold:"",italic:"",underline:"",strike:"",link:"",code:"",subscript:"",superscript:"",hr:"",todo:"",emoji:"",highlight:"","font-color":"",align:"","line-height":"","bullet-list":"","ordered-list":"","indent-decrease":"","indent-increase":"",break:"",image:"",video:"",attachment:"",quote:"","code-block":"",table:"",printer:"",fullscreen:"",ai:"",paragraph:"",h1:" 1",h2:" 2",h3:" 3",h4:" 4",h5:" 5",h6:" 6",standardColors:"",historyColors:"",insertTable:"",row:"",column:"","align-left":"","align-right":"","align-center":"","align-justify":"","insert-column-left":"","insert-column-right":"","insert-row-top":"","insert-row-bottom":"","delete-column":"","delete-row":"","merge-cells-horizontal":"","merge-cells-vertical":"","split-cells-horizontal":"","split-cells-vertical":"","delete-table":"","edit-link":"",unlink:"","visit-link":"","link-address":"","link-open-type":"","link-open-blank":"","default-font-size":"","default-font-family":""},ede={default:"Default",delete:"Delete",confirm:"Confirm",undo:"Undo",redo:"Redo",brush:"Format Painter",container:"Highlight container",eraser:"clear format",heading:"Paragraph/Heading","font-family":"Font Family","font-size":"Font Size",bold:"Bold",italic:"Italics",underline:"Underline",strike:"Strikethrough",link:"Link",code:"Inline code",subscript:"Subscript",superscript:"Superscript",hr:"Dividing line",todo:"Task list",emoji:"Emoji expression",highlight:"Highlight","font-color":"Font color",align:"Alignment","line-height":"Line height","bullet-list":"Unordered list","ordered-list":"Ordered list","indent-decrease":"Decrease indent","indent-increase":"Increase indent",break:"Force line break",image:"Image",video:"video",attachment:"Attachment",quote:"Quote","code-block":"Code block",table:"Table",printer:"Print",fullscreen:"Full screen",ai:"AI",paragraph:"Paragraph",h1:"H1",h2:"H2",h3:"H3",h4:"H4",h5:"H5",h6:"H6",standardColors:"Standard colors",historyColors:"Recently used colors",insertTable:"Insert Table",row:"Row",column:"Column","align-left":"Align left","align-right":"Align right","align-center":"Align center","align-justify":"Align justify","insert-column-left":"Insert column left","insert-column-right":"Insert column right","insert-row-top":"Insert row top","insert-row-bottom":"Insert row bottom","delete-column":"Delete column","delete-row":"Delete row","merge-cells-horizontal":"Merge cells","merge-cells-vertical":"Merge cells","split-cells-horizontal":"Split cells","split-cells-vertical":"Split cells","delete-table":"Delete table","edit-link":"Edit link",unlink:"Unlink","visit-link":"Visit link","link-address":"Link address","link-open-type":"Open type","link-open-blank":"Blank","default-font-size":"Size","default-font-family":"Default font"};window.customElements.define("aie-header",pk);window.customElements.define("aie-footer",mk);const tde={theme:"light",lang:"zh",contentRetentionKey:"ai-editor-content",editable:!0,placeholder:""};class lm extends rx{constructor(t,r,i={}){super(i);N(this,"aiEditor");N(this,"userOptions");this.aiEditor=t,this.userOptions=r}parseHtml(t){function r(o){return new window.DOMParser().parseFromString(`<body>${o}</body>`,"text/html").body}return Mi.fromSchema(this.schema).parse(r(t),{}).content}parseMarkdown(t){var i,o,s;const r=(s=(o=(i=this.storage.markdown)==null?void 0:i.parser)==null?void 0:o.parse)==null?void 0:s.call(o,t,{inline:!1});return this.parseHtml(r)}}class nde{constructor(e){N(this,"customLayout",!1);N(this,"innerEditor");N(this,"container");N(this,"header");N(this,"mainEl");N(this,"footer");N(this,"options");N(this,"eventComponents",[]);this.options={...tde,...e},this.initI18nAndInnerEditor()}initI18nAndInnerEditor(){const e=this.options.i18n||{},t={en:{translation:{...ede,...e.en}},zh:{translation:{...Qce,...e.zh}}};for(let r of Object.keys(e))r!="en"&&r!="zh"&&(t[r]={translation:{...e[r]}});Ce.init({lng:this.options.lang,resources:t},(r,i)=>{this.initInnerEditor()})}initInnerEditor(){const e=typeof this.options.element=="string"?document.querySelector(this.options.element):this.options.element;e.classList.add(`aie-theme-${this.options.theme}`),this.container=e.querySelector(".aie-container"),this.container?this.customLayout=!0:(this.container=document.createElement("div"),this.container.classList.add("aie-container")),e.appendChild(this.container),this.mainEl=document.createElement("div"),this.mainEl.style.flexGrow="1",this.mainEl.style.overflow="auto",this.header=document.createElement("aie-header"),this.footer=document.createElement("aie-footer"),this.eventComponents.push(this.header),this.eventComponents.push(this.footer);let t=this.options.content;if(this.options.contentRetention&&this.options.contentRetentionKey){const i=localStorage.getItem(this.options.contentRetentionKey);i&&(t=JSON.parse(i))}let r=Xce(this,this.options);if(this.options.onCreateBefore){const i=this.options.onCreateBefore(this,r);i||(r=i)}this.innerEditor=new lm(this,this.options,{element:this.mainEl,content:t,editable:this.options.editable,extensions:r,onCreate:i=>this.onCreate(i),onTransaction:i=>this.onTransaction(i),onDestroy:()=>this.onDestroy,editorProps:{attributes:{class:"aie-content"}}})}onCreate(e){this.innerEditor.view.dom.style.height="calc(100% - 20px)",this.eventComponents.forEach(o=>{o.onCreate&&o.onCreate(e,this.options)}),(this.container.querySelector(".aie-container-header")||this.container).appendChild(this.header),(this.container.querySelector(".aie-container-main")||this.container).appendChild(this.mainEl),(this.container.querySelector(".aie-container-footer")||this.container).appendChild(this.footer),this.options.ai&&Gs.init(this.innerEditor,this.options.ai),this.options.onCreated&&this.options.onCreated(this)}onTransaction(e){if(this.eventComponents.forEach(t=>{t.onTransaction&&t.onTransaction(e)}),!e.transaction.getMeta("ignoreChanged")&&(e.transaction.docChanged&&this.options.onChange&&this.options.onChange(this),e.transaction.docChanged&&this.options.contentRetention&&this.options.contentRetentionKey)){const t=this.innerEditor.getHTML();t==="<p></p>"||t===""?localStorage.removeItem(this.options.contentRetentionKey):localStorage.setItem(this.options.contentRetentionKey,JSON.stringify(this.innerEditor.getJSON()))}}onDestroy(){console.log("AiEditor has destroyed!")}getHtml(){return this.innerEditor.getHTML()}getJson(){return this.innerEditor.getJSON()}getText(){return this.innerEditor.getText()}getSelectedText(){const e=this.innerEditor.state.selection;return e.empty?"":Vs(this.innerEditor.state.doc,{from:e.from,to:e.to})}getMarkdown(){return this.innerEditor.storage.markdown.getMarkdown()}getOptions(){return this.options}getOutline(){const e=this.innerEditor.state.doc,t=[];return e.descendants((r,i)=>{if(r.type.name==="heading"){const o=`aie-heading-${t.length+1}`;if(r.attrs.id!==o){const{state:{tr:a},view:{dispatch:u}}=this.innerEditor;u(a.setNodeMarkup(i,void 0,{...r.attrs,id:o}).setMeta("ignoreChanged",!0))}let s="";r.descendants(a=>{a.text&&(s+=a.text)}),t.push({id:o,text:s,level:r.attrs.level,pos:i,size:r.nodeSize})}}),t}focus(){return this.innerEditor.commands.focus(),this}focusPos(e){return this.innerEditor.commands.focus(e),this}focusStart(){return this.innerEditor.commands.focus("start"),this}focusEnd(){return this.innerEditor.commands.focus("end"),this}isFocused(){return this.innerEditor.isFocused}blur(){return this.innerEditor.commands.blur(),this}insert(e){return this.innerEditor.commands.insertContent(e),this}setEditable(e){return this.innerEditor.setEditable(e,!0),this}setContent(e){return this.focus().clear().insert(e),this}clear(){return this.innerEditor.commands.clearContent(!0),this}isEmpty(){return this.innerEditor.isEmpty}changeLang(e){return this.destroy(),this.options.lang=e,Ce.changeLanguage(e),this.initInnerEditor(),this}removeRetention(){return this.options.contentRetentionKey&&localStorage.removeItem(this.options.contentRetentionKey),this}destroy(){this.options.onDestroy&&this.options.onDestroy(this),this.innerEditor.destroy(),this.eventComponents=[],this.customLayout?(this.header.remove(),this.mainEl.remove(),this.footer.remove()):this.container.remove()}isDestroyed(){return this.innerEditor.isDestroyed}}exports.AiEditor=nde;exports.InnerEditor=lm;
